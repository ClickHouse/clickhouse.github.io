<!DOCTYPE html><html lang=fr data-version=master data-single-page=false> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>MergeTree - Documentation ClickHouse</title><link rel="shortcut icon" href=/favicon.ico><meta property=og:title content="MergeTree - Documentation ClickHouse "><meta property=og:description content="Mergetree Le MergeTree moteur et autres moteurs de cette famille (*MergeTree) sont les moteurs de table ClickHouse les p"><meta property=og:type content=website><meta property=og:image content=https://clickhouse.tech/images/logo.png><meta property=twitter:title content="MergeTree - Documentation ClickHouse "><meta name=description content="Mergetree Le MergeTree moteur et autres moteurs de cette famille (*MergeTree) sont les moteurs de table ClickHouse les p"><meta name=keywords content="ClickHouse, DBMS, OLAP, relational, analytics, analytical, big data, open-source, SQL, web-analytics"><link href=/css/base.css?1d858e50 media=all rel=stylesheet></head> <body dir=ltr data-spy=scroll data-target=#toc data-offset=80> <nav id=top-nav class="navbar navbar-dark navbar-expand-md bg-dark-alt text-white sticky-top"> <div class="container-fluid justify-content-between"> <a href=/ class="d-block navbar-brand mr-3"> <img id=docs-logo-icon src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"> </a> <div class="w-100 navbar-text text-left d-none d-md-block"> <h1 class="h3 m-0 p-0 d-inline"> <a href=# class="text-white text-decoration-none"> MergeTree </a> </h1> </div> <div class="d-none d-md-block"> <ul class="navbar-nav ml-auto mt-2 mt-lg-0 justify-content-end"> <li class=nav-item> <a href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/fr/engines/table_engines/mergetree_family/mergetree.md title="Edit this article" class=nav-link rel="external nofollow noreferrer" target=_blank><img src=/images/mkdocs/edit.svg alt="Edit this article" class=mt-1 height=22></a> </li> <li class=nav-item> <a class=nav-link href=https://github.com/ClickHouse/ClickHouse rel="external nofollow noreferrer"> <img src=/images/index/github.svg alt="GitHub repository" title="Go to GitHub" height=32> </a> </li> <li id=languages-wrapper class="nav-item dropdown"> <div id=languages-dropdown> <a class="nav-link dropdown-toggle d-inline-block mt-1 text-muted" href=# id=lang-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false> <img src=/images/flags/fr.svg alt=Français title=Français width=32 class="d-inline-block mt-n1"> </a> <div class="dropdown-menu bg-dark" aria-labelledby=lang-dropdown> <a href=/docs/en/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/en.svg alt title width=32 class="d-inline-block mr-2">English </a> <a href=/docs/zh/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/zh.svg alt title width=32 class="d-inline-block mr-2">中文 </a> <a href=/docs/es/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/es.svg alt title width=32 class="d-inline-block mr-2">Español </a> <a href=/docs/fr/engines/table_engines/mergetree_family/mergetree/ class="dropdown-item disabled"> <img src=/images/flags/fr.svg alt title width=32 class="d-inline-block mr-2">Français </a> <a href=/docs/ru/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/ru.svg alt title width=32 class="d-inline-block mr-2">Русский </a> <a href=/docs/ja/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/ja.svg alt title width=32 class="d-inline-block mr-2">日本語 </a> <a href=/docs/fa/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/fa.svg alt title width=32 class="d-inline-block mr-2">فارسی </a> </div> </div> </li> </ul> </div> <form id=search-form class="form-inline m-0"> <div class=input-group> <div class="input-group-prepend w-100"> <span class="input-group-text bg-secondary-alt text-muted border-0 mr-n1" id=search-icon> <img src=/images/mkdocs/search.svg> </span> <input id=docsearch-input class="form-control bg-secondary-alt text-muted border-0 pl-1" type=search placeholder=Search aria-label=Search> </div> </div> </form> <button id=navbar-toggler class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#sidebar aria-controls=sidebar aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> </nav> <div class=container-fluid> <div class="row justify-content-end justify-content-xl-center"> <div id=sidebar class="col-xl-2 col-md-4 bg-secondary-alt p-3 d-print-none min-vh-100 overflow-auto"> <div class=overflow-auto> <div id=single-page-switch class="btn-group mb-2 float-right" role=group aria-label="Multi-page ou une seule page"> <a href=../../../.. role=button class="btn btn-dark active" aria-pressed=true> <img src=/images/mkdocs/multi.svg alt="Multi-version de la page" title="Multi-version de la page"> </a> <a href=../../../../single/ role=button class="btn btn-dark-alt active" aria-pressed=true> <img src=/images/mkdocs/single.svg alt="Version d'une seule page" title="Version d'une seule page"> </a> </div> <div class="dropdown mb-3"> <a class="btn btn-dark dropdown-toggle text-muted" href=# role=button id=select-version data-toggle=dropdown aria-haspopup=true aria-expanded=false> Version: <span class=text-light>dernier</span> </a> <div class="dropdown-menu bg-dark text-muted p-1" aria-labelledby=select-version> <a href=/docs/fr/ class="dropdown-item disable"> <span class=text-light>dernier</span> </a> <a href=/docs/v20.3/fr/ class=dropdown-item>v20.3</a> <a href=/docs/v20.1/fr/ class=dropdown-item>v20.1</a> <a href=/docs/v19.17/fr/ class=dropdown-item>v19.17</a> <a href=/docs/v19.16/fr/ class=dropdown-item>v19.16</a> <a href=/docs/v19.15/fr/ class=dropdown-item>v19.15</a> <a href=/docs/v19.14/fr/ class=dropdown-item>v19.14</a> <a href=/docs/v19.13/fr/ class=dropdown-item>v19.13</a> <a href=/docs/v19.11/fr/ class=dropdown-item>v19.11</a> <a href=/docs/v19.10/fr/ class=dropdown-item>v19.10</a> <a href=/docs/v19.9/fr/ class=dropdown-item>v19.9</a> <a href=/docs/v19.8/fr/ class=dropdown-item>v19.8</a> </div> </div> <nav id=sidebar-nav class="nav flex-column mb-5"> <a href=#sidebar-sidebar-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-1 title=Introduction class="nav-link text-light text-wrap dropdown-toggle px-0">Introduction</a> <div id=sidebar-sidebar-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../introduction/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../introduction/distinctive_features/ title=particularité class="nav-link text-light text-wrap d-inline-block w-100 px-0">particularité</a> <a href=../../../../introduction/features_considered_disadvantages/ title="Caractéristiques de ClickHouse qui peuvent être considérées comme des inconvénients" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Caractéristiques de ClickHouse qui peuvent être considérées comme des inconvénients</a> <a href=../../../../introduction/performance/ title=Performance class="nav-link text-light text-wrap d-inline-block w-100 px-0">Performance</a> <a href=../../../../introduction/history/ title=Histoire class="nav-link text-light text-wrap d-inline-block w-100 px-0">Histoire</a> <a href=../../../../introduction/adopters/ title=Adoptant class="nav-link text-light text-wrap d-inline-block w-100 px-0">Adoptant</a> </nav> </div> <a href=../../../../ title=Aperçu class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aperçu</a> <a href=#sidebar-sidebar-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3 title="Getting Started" class="nav-link text-light text-wrap dropdown-toggle px-0">Getting Started</a> <div id=sidebar-sidebar-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../getting_started/ title=cachés class="nav-link text-light text-wrap d-inline-block w-100 px-0">cachés</a> <a href=../../../../getting_started/install/ title=Installation class="nav-link text-light text-wrap d-inline-block w-100 px-0">Installation</a> <a href=#sidebar-sidebar-3-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-3 title="Example Datasets" class="nav-link text-light text-wrap dropdown-toggle px-0">Example Datasets</a> <div id=sidebar-sidebar-3-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../getting_started/example_datasets/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../getting_started/example_datasets/ontime/ title=OnTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">OnTime</a> <a href=../../../../getting_started/example_datasets/nyc_taxi/ title="New York Taxi Données" class="nav-link text-light text-wrap d-inline-block w-100 px-0">New York Taxi Données</a> <a href=../../../../getting_started/example_datasets/amplab_benchmark/ title="AMPLab Big Data Benchmark" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AMPLab Big Data Benchmark</a> <a href=../../../../getting_started/example_datasets/wikistat/ title=WikiStat class="nav-link text-light text-wrap d-inline-block w-100 px-0">WikiStat</a> <a href=../../../../getting_started/example_datasets/criteo/ title="Téraoctet click Logs de Criteo" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Téraoctet click Logs de Criteo</a> <a href=../../../../getting_started/example_datasets/star_schema/ title="Référence Du Schéma En Étoile" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Référence Du Schéma En Étoile</a> <a href=../../../../getting_started/example_datasets/metrica/ title="Yandex.Metrica De Données" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Yandex.Metrica De Données</a> </nav> </div> <a href=../../../../getting_started/tutorial/ title=Tutoriel class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tutoriel</a> <a href=../../../../getting_started/playground/ title=Récréation class="nav-link text-light text-wrap d-inline-block w-100 px-0">Récréation</a> </nav> </div> <a href=#sidebar-sidebar-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4 title=Interfaces class="nav-link text-light text-wrap dropdown-toggle px-0">Interfaces</a> <div id=sidebar-sidebar-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../interfaces/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../interfaces/cli/ title="Client De Ligne De Commande" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Client De Ligne De Commande</a> <a href=../../../../interfaces/tcp/ title="Interface Native (TCP)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interface Native (TCP)</a> <a href=../../../../interfaces/http/ title="Interface HTTP" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interface HTTP</a> <a href=../../../../interfaces/mysql/ title="Interface MySQL" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interface MySQL</a> <a href=../../../../interfaces/formats/ title="Formats d'entrée et de sortie" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Formats d'entrée et de sortie</a> <a href=../../../../interfaces/jdbc/ title=JDBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC</a> <a href=../../../../interfaces/odbc/ title="Pilote ODBC" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Pilote ODBC</a> <a href=../../../../interfaces/cpp/ title="Bibliothèque Client C++" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bibliothèque Client C++</a> <a href=#sidebar-sidebar-4-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-10 title=Third-Party class="nav-link text-light text-wrap dropdown-toggle px-0">Third-Party</a> <div id=sidebar-sidebar-4-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../interfaces/third-party/ title=Third-Party class="nav-link text-light text-wrap d-inline-block w-100 px-0">Third-Party</a> <a href=../../../../interfaces/third-party/client_libraries/ title="Bibliothèques Clientes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bibliothèques Clientes</a> <a href=../../../../interfaces/third-party/integrations/ title=Intégration class="nav-link text-light text-wrap d-inline-block w-100 px-0">Intégration</a> <a href=../../../../interfaces/third-party/gui/ title="Les Interfaces Visuelles" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Interfaces Visuelles</a> <a href=../../../../interfaces/third-party/proxy/ title=Proxy class="nav-link text-light text-wrap d-inline-block w-100 px-0">Proxy</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5 title=Engines class="nav-link text-light text-wrap dropdown-toggle px-0">Engines</a> <div id=sidebar-sidebar-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/ title=Engines class="nav-link text-light text-wrap d-inline-block w-100 px-0">Engines</a> <a href=#sidebar-sidebar-5-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2 title="Table Engines" class="nav-link text-light text-wrap dropdown-toggle px-0">Table Engines</a> <div id=sidebar-sidebar-5-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=#sidebar-sidebar-5-2-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-2 title="MergeTree Family" class="nav-link text-light text-wrap dropdown-toggle px-0">MergeTree Family</a> <div id=sidebar-sidebar-5-2-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/mergetree_family/ title="MergeTree Family" class="nav-link text-light text-wrap d-inline-block w-100 px-0">MergeTree Family</a> <a href=../../../../engines/table_engines/mergetree_family/mergetree/ title=MergeTree class="nav-link text-white active text-wrap d-inline-block w-100 px-0">MergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/replication/ title="Réplication Des Données" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Réplication Des Données</a> <a href=../../../../engines/table_engines/mergetree_family/custom_partitioning_key/ title="Clé De Partitionnement Personnalisée" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clé De Partitionnement Personnalisée</a> <a href=../../../../engines/table_engines/mergetree_family/replacingmergetree/ title=ReplacingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">ReplacingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/summingmergetree/ title=SummingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">SummingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/aggregatingmergetree/ title=AggregatingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregatingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/collapsingmergetree/ title=CollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">CollapsingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/versionedcollapsingmergetree/ title=VersionedCollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">VersionedCollapsingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/graphitemergetree/ title=GraphiteMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">GraphiteMergeTree</a> </nav> </div> <a href=#sidebar-sidebar-5-2-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-3 title="Log Family" class="nav-link text-light text-wrap dropdown-toggle px-0">Log Family</a> <div id=sidebar-sidebar-5-2-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/log_family/ title="Log Family" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Log Family</a> <a href=../../../../engines/table_engines/log_family/log_family/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../engines/table_engines/log_family/stripelog/ title=StripeLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">StripeLog</a> <a href=../../../../engines/table_engines/log_family/log/ title=Journal class="nav-link text-light text-wrap d-inline-block w-100 px-0">Journal</a> <a href=../../../../engines/table_engines/log_family/tinylog/ title=TinyLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">TinyLog</a> </nav> </div> <a href=#sidebar-sidebar-5-2-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-4 title=Integrations class="nav-link text-light text-wrap dropdown-toggle px-0">Integrations</a> <div id=sidebar-sidebar-5-2-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/integrations/ title=Integrations class="nav-link text-light text-wrap d-inline-block w-100 px-0">Integrations</a> <a href=../../../../engines/table_engines/integrations/kafka/ title=Kafka class="nav-link text-light text-wrap d-inline-block w-100 px-0">Kafka</a> <a href=../../../../engines/table_engines/integrations/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../../../engines/table_engines/integrations/jdbc/ title=JDBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC</a> <a href=../../../../engines/table_engines/integrations/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> <a href=../../../../engines/table_engines/integrations/hdfs/ title=HDFS class="nav-link text-light text-wrap d-inline-block w-100 px-0">HDFS</a> </nav> </div> <a href=#sidebar-sidebar-5-2-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-5 title=Special class="nav-link text-light text-wrap dropdown-toggle px-0">Special</a> <div id=sidebar-sidebar-5-2-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/special/ title=Special class="nav-link text-light text-wrap d-inline-block w-100 px-0">Special</a> <a href=../../../../engines/table_engines/special/distributed/ title=Distribué class="nav-link text-light text-wrap d-inline-block w-100 px-0">Distribué</a> <a href=../../../../engines/table_engines/special/external_data/ title="De données externes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">De données externes</a> <a href=../../../../engines/table_engines/special/dictionary/ title=Dictionnaire class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionnaire</a> <a href=../../../../engines/table_engines/special/merge/ title=Fusionner class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fusionner</a> <a href=../../../../engines/table_engines/special/file/ title=Fichier class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fichier</a> <a href=../../../../engines/table_engines/special/null/ title=NULL class="nav-link text-light text-wrap d-inline-block w-100 px-0">NULL</a> <a href=../../../../engines/table_engines/special/set/ title=Définir class="nav-link text-light text-wrap d-inline-block w-100 px-0">Définir</a> <a href=../../../../engines/table_engines/special/join/ title=Rejoindre class="nav-link text-light text-wrap d-inline-block w-100 px-0">Rejoindre</a> <a href=../../../../engines/table_engines/special/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../../../../engines/table_engines/special/view/ title=Vue class="nav-link text-light text-wrap d-inline-block w-100 px-0">Vue</a> <a href=../../../../engines/table_engines/special/materializedview/ title=MaterializedView class="nav-link text-light text-wrap d-inline-block w-100 px-0">MaterializedView</a> <a href=../../../../engines/table_engines/special/memory/ title=Mémoire class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mémoire</a> <a href=../../../../engines/table_engines/special/buffer/ title=Tampon class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tampon</a> <a href=../../../../engines/table_engines/special/generate/ title=GenerateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">GenerateRandom</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-3 title="Database Engines" class="nav-link text-light text-wrap dropdown-toggle px-0">Database Engines</a> <div id=sidebar-sidebar-5-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/database_engines/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../engines/database_engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../../../engines/database_engines/lazy/ title=Paresseux class="nav-link text-light text-wrap d-inline-block w-100 px-0">Paresseux</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6 title="SQL Reference" class="nav-link text-light text-wrap dropdown-toggle px-0">SQL Reference</a> <div id=sidebar-sidebar-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/ title=cachés class="nav-link text-light text-wrap d-inline-block w-100 px-0">cachés</a> <a href=#sidebar-sidebar-6-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-2 title=Statements class="nav-link text-light text-wrap dropdown-toggle px-0">Statements</a> <div id=sidebar-sidebar-6-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/statements/ title=Statements class="nav-link text-light text-wrap d-inline-block w-100 px-0">Statements</a> <a href=../../../../sql_reference/statements/select/ title=SELECT class="nav-link text-light text-wrap d-inline-block w-100 px-0">SELECT</a> <a href=../../../../sql_reference/statements/insert_into/ title="INSERT INTO" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INSERT INTO</a> <a href=../../../../sql_reference/statements/create/ title=CREATE class="nav-link text-light text-wrap d-inline-block w-100 px-0">CREATE</a> <a href=../../../../sql_reference/statements/alter/ title=ALTER class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALTER</a> <a href=../../../../sql_reference/statements/system/ title=SYSTEM class="nav-link text-light text-wrap d-inline-block w-100 px-0">SYSTEM</a> <a href=../../../../sql_reference/statements/show/ title=SHOW class="nav-link text-light text-wrap d-inline-block w-100 px-0">SHOW</a> <a href=../../../../sql_reference/statements/misc/ title=Autre class="nav-link text-light text-wrap d-inline-block w-100 px-0">Autre</a> </nav> </div> <a href=../../../../sql_reference/syntax/ title=Syntaxe class="nav-link text-light text-wrap d-inline-block w-100 px-0">Syntaxe</a> <a href=#sidebar-sidebar-6-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-4 title=Functions class="nav-link text-light text-wrap dropdown-toggle px-0">Functions</a> <div id=sidebar-sidebar-6-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../sql_reference/functions/arithmetic_functions/ title=Arithmétique class="nav-link text-light text-wrap d-inline-block w-100 px-0">Arithmétique</a> <a href=../../../../sql_reference/functions/comparison_functions/ title=Comparaison class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comparaison</a> <a href=../../../../sql_reference/functions/logical_functions/ title=Logique class="nav-link text-light text-wrap d-inline-block w-100 px-0">Logique</a> <a href=../../../../sql_reference/functions/type_conversion_functions/ title="La Conversion De Type" class="nav-link text-light text-wrap d-inline-block w-100 px-0">La Conversion De Type</a> <a href=../../../../sql_reference/functions/date_time_functions/ title="Travailler avec les Dates et les heures" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec les Dates et les heures</a> <a href=../../../../sql_reference/functions/string_functions/ title="Travailler avec des chaînes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des chaînes</a> <a href=../../../../sql_reference/functions/string_search_functions/ title="Pour Rechercher Des Chaînes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Pour Rechercher Des Chaînes</a> <a href=../../../../sql_reference/functions/string_replace_functions/ title="Pour remplacer dans les chaînes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Pour remplacer dans les chaînes</a> <a href=../../../../sql_reference/functions/conditional_functions/ title=Conditionnel class="nav-link text-light text-wrap d-inline-block w-100 px-0">Conditionnel</a> <a href=../../../../sql_reference/functions/math_functions/ title=Mathématique class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mathématique</a> <a href=../../../../sql_reference/functions/rounding_functions/ title=Arrondi class="nav-link text-light text-wrap d-inline-block w-100 px-0">Arrondi</a> <a href=../../../../sql_reference/functions/array_functions/ title="Travailler avec des tableaux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des tableaux</a> <a href=../../../../sql_reference/functions/splitting_merging_functions/ title="Fractionnement et fusion de chaînes et de tableaux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fractionnement et fusion de chaînes et de tableaux</a> <a href=../../../../sql_reference/functions/bit_functions/ title=Bit class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bit</a> <a href=../../../../sql_reference/functions/bitmap_functions/ title=Bitmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bitmap</a> <a href=../../../../sql_reference/functions/hash_functions/ title=Hachage class="nav-link text-light text-wrap d-inline-block w-100 px-0">Hachage</a> <a href=../../../../sql_reference/functions/random_functions/ title="La Génération De Nombres Pseudo-Aléatoires" class="nav-link text-light text-wrap d-inline-block w-100 px-0">La Génération De Nombres Pseudo-Aléatoires</a> <a href=../../../../sql_reference/functions/encoding_functions/ title=Encodage class="nav-link text-light text-wrap d-inline-block w-100 px-0">Encodage</a> <a href=../../../../sql_reference/functions/uuid_functions/ title="Travailler avec UUID" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec UUID</a> <a href=../../../../sql_reference/functions/url_functions/ title="Travailler avec des URL" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des URL</a> <a href=../../../../sql_reference/functions/ip_address_functions/ title="Travailler avec des adresses IP" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des adresses IP</a> <a href=../../../../sql_reference/functions/json_functions/ title="Travailler avec JSON" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec JSON</a> <a href=../../../../sql_reference/functions/higher_order_functions/ title="D'Ordre Supérieur" class="nav-link text-light text-wrap d-inline-block w-100 px-0">D'Ordre Supérieur</a> <a href=../../../../sql_reference/functions/ext_dict_functions/ title="Travailler avec des dictionnaires externes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des dictionnaires externes</a> <a href=../../../../sql_reference/functions/ym_dict_functions/ title="Travailler avec Yandex.Dictionnaires Metrica" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec Yandex.Dictionnaires Metrica</a> <a href=../../../../sql_reference/functions/in_functions/ title="Mise en œuvre de L'opérateur IN" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mise en œuvre de L'opérateur IN</a> <a href=../../../../sql_reference/functions/array_join/ title=arrayJoin class="nav-link text-light text-wrap d-inline-block w-100 px-0">arrayJoin</a> <a href=../../../../sql_reference/functions/geo/ title="Travailler avec des coordonnées géographiques" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des coordonnées géographiques</a> <a href=../../../../sql_reference/functions/functions_for_nulls/ title="Travailler avec des arguments nullables" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des arguments nullables</a> <a href=../../../../sql_reference/functions/machine_learning_functions/ title="Fonctions D'Apprentissage Automatique" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fonctions D'Apprentissage Automatique</a> <a href=../../../../sql_reference/functions/introspection/ title=Introspection class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introspection</a> <a href=../../../../sql_reference/functions/other_functions/ title=Autre class="nav-link text-light text-wrap d-inline-block w-100 px-0">Autre</a> </nav> </div> <a href=#sidebar-sidebar-6-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-5 title="Aggregate Functions" class="nav-link text-light text-wrap dropdown-toggle px-0">Aggregate Functions</a> <div id=sidebar-sidebar-6-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/aggregate_functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../sql_reference/aggregate_functions/reference/ title=Référence class="nav-link text-light text-wrap d-inline-block w-100 px-0">Référence</a> <a href=../../../../sql_reference/aggregate_functions/combinators/ title="Combinateurs de fonction d'agrégat" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Combinateurs de fonction d'agrégat</a> <a href=../../../../sql_reference/aggregate_functions/parametric_functions/ title="Fonctions d'agrégat paramétriques" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fonctions d'agrégat paramétriques</a> </nav> </div> <a href=#sidebar-sidebar-6-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-6 title="Table Functions" class="nav-link text-light text-wrap dropdown-toggle px-0">Table Functions</a> <div id=sidebar-sidebar-6-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/table_functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../sql_reference/table_functions/file/ title=fichier class="nav-link text-light text-wrap d-inline-block w-100 px-0">fichier</a> <a href=../../../../sql_reference/table_functions/merge/ title=fusionner class="nav-link text-light text-wrap d-inline-block w-100 px-0">fusionner</a> <a href=../../../../sql_reference/table_functions/numbers/ title=nombre class="nav-link text-light text-wrap d-inline-block w-100 px-0">nombre</a> <a href=../../../../sql_reference/table_functions/remote/ title=distant class="nav-link text-light text-wrap d-inline-block w-100 px-0">distant</a> <a href=../../../../sql_reference/table_functions/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../../../../sql_reference/table_functions/mysql/ title=mysql class="nav-link text-light text-wrap d-inline-block w-100 px-0">mysql</a> <a href=../../../../sql_reference/table_functions/jdbc/ title=jdbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">jdbc</a> <a href=../../../../sql_reference/table_functions/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> <a href=../../../../sql_reference/table_functions/hdfs/ title=hdfs class="nav-link text-light text-wrap d-inline-block w-100 px-0">hdfs</a> <a href=../../../../sql_reference/table_functions/input/ title=entrée class="nav-link text-light text-wrap d-inline-block w-100 px-0">entrée</a> <a href=../../../../sql_reference/table_functions/generate/ title=generateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">generateRandom</a> </nav> </div> <a href=#sidebar-sidebar-6-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-7 title=Dictionaries class="nav-link text-light text-wrap dropdown-toggle px-0">Dictionaries</a> <div id=sidebar-sidebar-6-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/dictionaries/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=#sidebar-sidebar-6-7-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-7-2 title="External Dictionaries" class="nav-link text-light text-wrap dropdown-toggle px-0">External Dictionaries</a> <div id=sidebar-sidebar-6-7-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/dictionaries/external_dictionaries/ title="External Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">External Dictionaries</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts/ title="Description Générale" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Description Générale</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict/ title="Configuration D'un dictionnaire externe" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Configuration D'un dictionnaire externe</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_layout/ title="Stockage des dictionnaires en mémoire" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Stockage des dictionnaires en mémoire</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_lifetime/ title="Mises À Jour Du Dictionnaire" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mises À Jour Du Dictionnaire</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_sources/ title="Sources de dictionnaires externes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Sources de dictionnaires externes</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_structure/ title="Clé et champs du dictionnaire" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clé et champs du dictionnaire</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_hierarchical/ title="Dictionnaires hiérarchiques" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionnaires hiérarchiques</a> </nav> </div> <a href=../../../../sql_reference/dictionaries/internal_dicts/ title="Dictionnaires Internes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionnaires Internes</a> </nav> </div> <a href=#sidebar-sidebar-6-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8 title="Data Types" class="nav-link text-light text-wrap dropdown-toggle px-0">Data Types</a> <div id=sidebar-sidebar-6-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../sql_reference/data_types/int_uint/ title="UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64</a> <a href=../../../../sql_reference/data_types/float/ title="Float32, Float64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Float32, Float64</a> <a href=../../../../sql_reference/data_types/decimal/ title=Décimal class="nav-link text-light text-wrap d-inline-block w-100 px-0">Décimal</a> <a href=../../../../sql_reference/data_types/boolean/ title=Booléen class="nav-link text-light text-wrap d-inline-block w-100 px-0">Booléen</a> <a href=../../../../sql_reference/data_types/string/ title=Chaîne class="nav-link text-light text-wrap d-inline-block w-100 px-0">Chaîne</a> <a href=../../../../sql_reference/data_types/fixedstring/ title="FixedString (N)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">FixedString (N)</a> <a href=../../../../sql_reference/data_types/uuid/ title=UUID class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUID</a> <a href=../../../../sql_reference/data_types/date/ title=Date class="nav-link text-light text-wrap d-inline-block w-100 px-0">Date</a> <a href=../../../../sql_reference/data_types/datetime/ title=DateTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime</a> <a href=../../../../sql_reference/data_types/datetime64/ title=DateTime64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime64</a> <a href=../../../../sql_reference/data_types/enum/ title=Enum class="nav-link text-light text-wrap d-inline-block w-100 px-0">Enum</a> <a href=../../../../sql_reference/data_types/array/ title=Array(T) class="nav-link text-light text-wrap d-inline-block w-100 px-0">Array(T)</a> <a href=../../../../sql_reference/data_types/aggregatefunction/ title="AggregateFunction (nom, types_of_arguments...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregateFunction (nom, types_of_arguments...)</a> <a href=../../../../sql_reference/data_types/tuple/ title="Tuple (T1, T2,...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tuple (T1, T2,...)</a> <a href=#sidebar-sidebar-6-8-16 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8-16 title="Nested Data Structures" class="nav-link text-light text-wrap dropdown-toggle px-0">Nested Data Structures</a> <div id=sidebar-sidebar-6-8-16 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/nested_data_structures/ title=cachés class="nav-link text-light text-wrap d-inline-block w-100 px-0">cachés</a> <a href=../../../../sql_reference/data_types/nested_data_structures/nested/ title="Imbriquée(Type1 Nom1, Nom2 Type2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Imbriquée(Type1 Nom1, Nom2 Type2, ...)</a> </nav> </div> <a href=../../../../sql_reference/data_types/nullable/ title=Nullable class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nullable</a> <a href=#sidebar-sidebar-6-8-18 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8-18 title="Special Data Types" class="nav-link text-light text-wrap dropdown-toggle px-0">Special Data Types</a> <div id=sidebar-sidebar-6-8-18 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/special_data_types/ title=cachés class="nav-link text-light text-wrap d-inline-block w-100 px-0">cachés</a> <a href=../../../../sql_reference/data_types/special_data_types/expression/ title=Expression class="nav-link text-light text-wrap d-inline-block w-100 px-0">Expression</a> <a href=../../../../sql_reference/data_types/special_data_types/set/ title=Définir class="nav-link text-light text-wrap d-inline-block w-100 px-0">Définir</a> <a href=../../../../sql_reference/data_types/special_data_types/nothing/ title=Rien class="nav-link text-light text-wrap d-inline-block w-100 px-0">Rien</a> <a href=../../../../sql_reference/data_types/special_data_types/interval/ title=Intervalle class="nav-link text-light text-wrap d-inline-block w-100 px-0">Intervalle</a> </nav> </div> <a href=#sidebar-sidebar-6-8-19 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8-19 title=Domains class="nav-link text-light text-wrap dropdown-toggle px-0">Domains</a> <div id=sidebar-sidebar-6-8-19 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/domains/ title=Domains class="nav-link text-light text-wrap d-inline-block w-100 px-0">Domains</a> <a href=../../../../sql_reference/data_types/domains/overview/ title=Aperçu class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aperçu</a> <a href=../../../../sql_reference/data_types/domains/ipv4/ title=IPv4 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv4</a> <a href=../../../../sql_reference/data_types/domains/ipv6/ title=IPv6 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv6</a> </nav> </div> </nav> </div> <a href=../../../../sql_reference/operators/ title=Opérateur class="nav-link text-light text-wrap d-inline-block w-100 px-0">Opérateur</a> </nav> </div> <a href=#sidebar-sidebar-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7 title=Guides class="nav-link text-light text-wrap dropdown-toggle px-0">Guides</a> <div id=sidebar-sidebar-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../guides/ title=Aperçu class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aperçu</a> <a href=../../../../guides/apply_catboost_model/ title="Application Des Modèles CatBoost" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Application Des Modèles CatBoost</a> </nav> </div> <a href=#sidebar-sidebar-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8 title=Operations class="nav-link text-light text-wrap dropdown-toggle px-0">Operations</a> <div id=sidebar-sidebar-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../operations/requirements/ title=Exigence class="nav-link text-light text-wrap d-inline-block w-100 px-0">Exigence</a> <a href=../../../../operations/monitoring/ title=Surveiller class="nav-link text-light text-wrap d-inline-block w-100 px-0">Surveiller</a> <a href=../../../../operations/troubleshooting/ title=Dépannage class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dépannage</a> <a href=../../../../operations/update/ title="Mise À Jour De ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mise À Jour De ClickHouse</a> <a href=../../../../operations/access_rights/ title="Les Droits D'Accès" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Droits D'Accès</a> <a href=../../../../operations/backup/ title="La Sauvegarde Des Données" class="nav-link text-light text-wrap d-inline-block w-100 px-0">La Sauvegarde Des Données</a> <a href=../../../../operations/configuration_files/ title="Fichiers De Configuration" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fichiers De Configuration</a> <a href=../../../../operations/quotas/ title=Quota class="nav-link text-light text-wrap d-inline-block w-100 px-0">Quota</a> <a href=../../../../operations/system_tables/ title="Les Tables Système" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Tables Système</a> <a href=#sidebar-sidebar-8-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-11 title="Optimizing Performance" class="nav-link text-light text-wrap dropdown-toggle px-0">Optimizing Performance</a> <div id=sidebar-sidebar-8-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/optimizing_performance/ title="Optimizing Performance" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Optimizing Performance</a> <a href=../../../../operations/optimizing_performance/sampling_query_profiler/ title="Profilage De Requête" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Profilage De Requête</a> </nav> </div> <a href=#sidebar-sidebar-8-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-12 title="Server Configuration Parameters" class="nav-link text-light text-wrap dropdown-toggle px-0">Server Configuration Parameters</a> <div id=sidebar-sidebar-8-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/server_configuration_parameters/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../operations/server_configuration_parameters/settings/ title="Les Paramètres Du Serveur" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Paramètres Du Serveur</a> </nav> </div> <a href=../../../../operations/performance_test/ title="Tester Le Matériel" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tester Le Matériel</a> <a href=#sidebar-sidebar-8-14 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-14 title=Settings class="nav-link text-light text-wrap dropdown-toggle px-0">Settings</a> <div id=sidebar-sidebar-8-14 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/settings/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../operations/settings/permissions_for_queries/ title="Autorisations pour les requêtes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Autorisations pour les requêtes</a> <a href=../../../../operations/settings/query_complexity/ title="Restrictions sur la complexité des requêtes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Restrictions sur la complexité des requêtes</a> <a href=../../../../operations/settings/settings/ title=Paramètre class="nav-link text-light text-wrap d-inline-block w-100 px-0">Paramètre</a> <a href=../../../../operations/settings/settings_profiles/ title="Les Paramètres Des Profils" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Paramètres Des Profils</a> <a href=../../../../operations/settings/constraints_on_settings/ title="Contraintes sur les paramètres" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Contraintes sur les paramètres</a> <a href=../../../../operations/settings/settings_users/ title="Les Paramètres De L'Utilisateur" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Paramètres De L'Utilisateur</a> </nav> </div> <a href=#sidebar-sidebar-8-15 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-15 title=Utilities class="nav-link text-light text-wrap dropdown-toggle px-0">Utilities</a> <div id=sidebar-sidebar-8-15 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/utilities/ title=Aperçu class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aperçu</a> <a href=../../../../operations/utilities/clickhouse-copier/ title=clickhouse-copieur class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-copieur</a> <a href=../../../../operations/utilities/clickhouse-local/ title=clickhouse-local class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-local</a> <a href=../../../../operations/utilities/clickhouse-benchmark/ title=clickhouse-benchmark class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-benchmark</a> </nav> </div> <a href=../../../../operations/tips/ title="Recommandations D'Utilisation" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Recommandations D'Utilisation</a> </nav> </div> <a href=#sidebar-sidebar-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-9 title=Development class="nav-link text-light text-wrap dropdown-toggle px-0">Development</a> <div id=sidebar-sidebar-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../development/ title=cachés class="nav-link text-light text-wrap d-inline-block w-100 px-0">cachés</a> <a href=../../../../development/developer_instruction/ title="Le Débutant Clickhouse Developer Instruction" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Le Débutant Clickhouse Developer Instruction</a> <a href=../../../../development/architecture/ title="Vue d'ensemble de L'Architecture ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Vue d'ensemble de L'Architecture ClickHouse</a> <a href=../../../../development/browse_code/ title="Parcourir Le Code Source De ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Parcourir Le Code Source De ClickHouse</a> <a href=../../../../development/build/ title="Comment Construire ClickHouse sur Linux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment Construire ClickHouse sur Linux</a> <a href=../../../../development/build_osx/ title="Comment Construire ClickHouse sur Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment Construire ClickHouse sur Mac OS X</a> <a href=../../../../development/build_cross_osx/ title="Comment Construire ClickHouse sur Linux pour Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment Construire ClickHouse sur Linux pour Mac OS X</a> <a href=../../../../development/build_cross_arm/ title="Comment Construire ClickHouse sur Linux pour AARCH64 (ARM64)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment Construire ClickHouse sur Linux pour AARCH64 (ARM64)</a> <a href=../../../../development/style/ title="Comment écrire du Code C++" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment écrire du Code C++</a> <a href=../../../../development/tests/ title="Comment exécuter des Tests ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment exécuter des Tests ClickHouse</a> <a href=../../../../development/contrib/ title="Bibliothèques Tierces Utilisées" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bibliothèques Tierces Utilisées</a> </nav> </div> <a href=#sidebar-sidebar-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-10 title=Commercial class="nav-link text-light text-wrap dropdown-toggle px-0">Commercial</a> <div id=sidebar-sidebar-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../commercial/ title=Commercial class="nav-link text-light text-wrap d-inline-block w-100 px-0">Commercial</a> <a href=../../../../commercial/cloud/ title="Fournisseurs De Services Cloud ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fournisseurs De Services Cloud ClickHouse</a> </nav> </div> <a href=#sidebar-sidebar-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11 title="What's New" class="nav-link text-light text-wrap dropdown-toggle px-0">What's New</a> <div id=sidebar-sidebar-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../whats_new/ title="What's New" class="nav-link text-light text-wrap d-inline-block w-100 px-0">What's New</a> <a href=#sidebar-sidebar-11-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11-2 title=Changelog class="nav-link text-light text-wrap dropdown-toggle px-0">Changelog</a> <div id=sidebar-sidebar-11-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../whats_new/changelog/ title=2020 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2020</a> <a href=../../../../whats_new/changelog/2019/ title=2019 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2019</a> <a href=../../../../whats_new/changelog/2018/ title=2018 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2018</a> <a href=../../../../whats_new/changelog/2017/ title=2017 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2017</a> </nav> </div> <a href=../../../../whats_new/roadmap/ title="Feuille de route" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Feuille de route</a> <a href=../../../../whats_new/security_changelog/ title="Sécurité Changelog" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Sécurité Changelog</a> </nav> </div> <a href=#sidebar-sidebar-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-12 title=F.A.Q. class="nav-link text-light text-wrap dropdown-toggle px-0">F.A.Q.</a> <div id=sidebar-sidebar-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../faq/ title=F.A.Q. class="nav-link text-light text-wrap d-inline-block w-100 px-0">F.A.Q.</a> <a href=../../../../faq/general/ title="Questions Générales" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Questions Générales</a> </nav> </div> <a href=../../../../single/clickhouse_fr.pdf class="nav-link border-top border-secondary mt-3 px-0 pt-3 text-light"> <img src=/images/mkdocs/pdf.svg alt="Version PDF" title="Version PDF" height=24 class="d-block mr-1 float-left"><div>Version PDF</div> </a> </nav> </div> </div> <div id=content-wrapper class="col-md-8 p-2 p-md-5"> <div id=content> <div class="alert alert-primary" role=alert> <p class="display-5 mb-2">Demander de l'aide!</p> <p class=lead>Le contenu suivant de cette page de documentation a été traduit à la machine. Mais contrairement à d'autres sites web, il ne se fait pas à la volée. Ce texte traduit vit sur le dépôt GitHub aux côtés de la base de code ClickHouse principale et attend que d'autres locuteurs natifs le rendent plus lisible par l'homme.</p> <p class=lead> <a class="btn btn-lg btn-primary text-white" href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/fr/engines/table_engines/mergetree_family/mergetree.md target=_blank rel="external nofollow noreferrer"> Aide clickhouse documentation en éditant cette page </a> </p> </div> <h1 id=table_engines-mergetree>Mergetree<a class=headerlink href=#table_engines-mergetree title="Permanent link">&para;</a></h1> <p>Le <code>MergeTree</code> moteur et autres moteurs de cette famille (<code>*MergeTree</code>) sont les moteurs de table ClickHouse les plus robustes.</p> <p>Les moteurs de la <code>MergeTree</code> famille sont conçus pour l'insertion d'une très grande quantité de données dans une table. Les données sont rapidement écrites dans la table partie par partie, puis des règles sont appliquées pour fusionner les parties en arrière-plan. Cette méthode est beaucoup plus efficace que de réécrire continuellement les données dans le stockage pendant l'insertion.</p> <p>Principales caractéristiques:</p> <ul> <li> <p>Stocke les données triées par clé primaire.</p> <p>Cela vous permet de créer un petit index clairsemé qui aide à trouver les données plus rapidement.</p> </li> <li> <p>Les Partitions peuvent être utilisées si <a href=../custom_partitioning_key/ >clé de partitionnement</a> est spécifié.</p> <p>ClickHouse prend en charge certaines opérations avec des partitions plus efficaces que les opérations générales sur les mêmes données avec le même résultat. ClickHouse Coupe également automatiquement les données de partition où la clé de partitionnement est spécifiée dans la requête. Cela améliore également les performances de la requête.</p> </li> <li> <p>Prise en charge de la réplication des données.</p> <p>La famille de <code>ReplicatedMergeTree</code> tables fournit la réplication des données. Pour plus d'informations, voir <a href=../replication/ >Réplication des données</a>.</p> </li> <li> <p>Appui d'échantillonnage de données.</p> <p>Si nécessaire, vous pouvez définir la méthode d'échantillonnage des données dans le tableau.</p> </li> </ul> <div class="admonition info"> <p class=admonition-title>Info</p> <p>Le <a href=../../special/merge/ >Fusionner</a> le moteur n'appartient pas à la <code>*MergeTree</code> famille.</p> </div> <h2 id=table_engine-mergetree-creating-a-table>Création d'une Table<a class=headerlink href=#table_engine-mergetree-creating-a-table title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=p>[</span><span class=k>IF</span> <span class=k>NOT</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=k>cluster</span><span class=p>]</span>
<span class=p>(</span>
    <span class=n>name1</span> <span class=p>[</span><span class=n>type1</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr1</span><span class=p>]</span> <span class=p>[</span><span class=n>TTL</span> <span class=n>expr1</span><span class=p>],</span>
    <span class=n>name2</span> <span class=p>[</span><span class=n>type2</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr2</span><span class=p>]</span> <span class=p>[</span><span class=n>TTL</span> <span class=n>expr2</span><span class=p>],</span>
    <span class=p>...</span>
    <span class=k>INDEX</span> <span class=n>index_name1</span> <span class=n>expr1</span> <span class=k>TYPE</span> <span class=n>type1</span><span class=p>(...)</span> <span class=n>GRANULARITY</span> <span class=n>value1</span><span class=p>,</span>
    <span class=k>INDEX</span> <span class=n>index_name2</span> <span class=n>expr2</span> <span class=k>TYPE</span> <span class=n>type2</span><span class=p>(...)</span> <span class=n>GRANULARITY</span> <span class=n>value2</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span><span class=p>()</span>
<span class=p>[</span><span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=k>ORDER</span> <span class=k>BY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=k>PRIMARY</span> <span class=k>KEY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=n>SAMPLE</span> <span class=k>BY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=n>TTL</span> <span class=n>expr</span> <span class=p>[</span><span class=k>DELETE</span><span class=o>|</span><span class=k>TO</span> <span class=n>DISK</span> <span class=s1>&#39;xxx&#39;</span><span class=o>|</span><span class=k>TO</span> <span class=n>VOLUME</span> <span class=s1>&#39;xxx&#39;</span><span class=p>],</span> <span class=p>...]</span>
<span class=p>[</span><span class=n>SETTINGS</span> <span class=n>name</span><span class=o>=</span><span class=n>value</span><span class=p>,</span> <span class=p>...]</span>
</code></pre></div> <p>Pour une description des paramètres, voir <a href=../../../../sql_reference/statements/create/ >Créer une description de requête</a>.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p><code>INDEX</code> est une fonctionnalité expérimentale, voir <a href=#table_engine-mergetree-data_skipping-indexes>Index De Saut De Données</a>.</p> </div> <h3 id=mergetree-query-clauses>Les Clauses De Requête<a class=headerlink href=#mergetree-query-clauses title="Permanent link">&para;</a></h3> <ul> <li> <p><code>ENGINE</code> — Name and parameters of the engine. <code>ENGINE = MergeTree()</code>. Le <code>MergeTree</code> le moteur n'a pas de paramètres.</p> </li> <li> <p><code>PARTITION BY</code> — The <a href=../custom_partitioning_key/ >clé de partitionnement</a>.</p> <p>Pour le partitionnement par mois, utilisez les <code>toYYYYMM(date_column)</code> l'expression, où <code>date_column</code> est une colonne avec une date du type <a href=../../../../sql_reference/data_types/date/ >Date</a>. Les noms de partition ici ont le <code>"YYYYMM"</code> format.</p> </li> <li> <p><code>ORDER BY</code> — The sorting key.</p> <p>Un tuple de colonnes ou d'expressions arbitraires. Exemple: <code>ORDER BY (CounterID, EventDate)</code>.</p> </li> <li> <p><code>PRIMARY KEY</code> — The primary key if it <a href=./ >diffère de la clé de tri</a>.</p> <p>Par défaut, la clé primaire est la même que la clé de tri (qui est spécifiée par <code>ORDER BY</code> clause). Ainsi dans la plupart des cas il n'est pas nécessaire de spécifier un <code>PRIMARY KEY</code> clause.</p> </li> <li> <p><code>SAMPLE BY</code> — An expression for sampling.</p> <p>Si un échantillonnage expression est utilisée, la clé primaire doit contenir. Exemple: <code>SAMPLE BY intHash32(UserID) ORDER BY (CounterID, EventDate, intHash32(UserID))</code>.</p> </li> <li> <p><code>TTL</code> — A list of rules specifying storage duration of rows and defining logic of automatic parts movement <a href=#table_engine-mergetree-multiple-volumes>entre disques et volumes</a>.</p> <p>L'Expression doit en avoir une <code>Date</code> ou <code>DateTime</code> colonne comme un résultat. Exemple:<br> <code>TTL date + INTERVAL 1 DAY</code></p> <p>Le Type de la règle <code>DELETE|TO DISK 'xxx'|TO VOLUME 'xxx'</code> spécifie une action à effectuer avec la partie si l'expression est satisfaite (atteint l'heure actuelle): suppression des Lignes expirées, déplacement d'une partie (si l'expression est satisfaite pour toutes les lignes d'une partie) sur le disque spécifié (<code>TO DISK 'xxx'</code>) ou de volume (<code>TO VOLUME 'xxx'</code>). Le type par défaut de la règle est suppression (<code>DELETE</code>). Liste de règles multiples peut spécifié, mais il ne devrait pas y avoir plus d'un <code>DELETE</code> règle.</p> <p>Pour plus de détails, voir <a href=#table_engine-mergetree-ttl>TTL pour les colonnes et les tableaux</a></p> </li> <li> <p><code>SETTINGS</code> — Additional parameters that control the behavior of the <code>MergeTree</code>:</p> <ul> <li><code>index_granularity</code> — Maximum number of data rows between the marks of an index. Default value: 8192. See <a href=#mergetree-data-storage>Le Stockage De Données</a>.</li> <li><code>index_granularity_bytes</code> — Maximum size of data granules in bytes. Default value: 10Mb. To restrict the granule size only by number of rows, set to 0 (not recommended). See <a href=#mergetree-data-storage>Le Stockage De Données</a>.</li> <li><code>enable_mixed_granularity_parts</code> — Enables or disables transitioning to control the granule size with the <code>index_granularity_bytes</code> paramètre. Avant la version 19.11, il n'y avait que le <code>index_granularity</code> réglage pour restreindre la taille des granules. Le <code>index_granularity_bytes</code> le paramètre améliore les performances de ClickHouse lors de la sélection de données à partir de tables avec de grandes lignes (des dizaines et des centaines de mégaoctets). Si vous avez des tables avec de grandes lignes, vous pouvez activer ce paramètre pour les tables d'améliorer l'efficacité de <code>SELECT</code> requête.</li> <li><code>use_minimalistic_part_header_in_zookeeper</code> — Storage method of the data parts headers in ZooKeeper. If <code>use_minimalistic_part_header_in_zookeeper=1</code>, puis Zookeeper stocke moins de données. Pour plus d'informations, voir le <a href=../../../../operations/server_configuration_parameters/settings/#server-settings-use_minimalistic_part_header_in_zookeeper>Description du réglage</a> dans “Server configuration parameters”.</li> <li><code>min_merge_bytes_to_use_direct_io</code> — The minimum data volume for merge operation that is required for using direct I/O access to the storage disk. When merging data parts, ClickHouse calculates the total storage volume of all the data to be merged. If the volume exceeds <code>min_merge_bytes_to_use_direct_io</code> octets, ClickHouse lit et écrit les données sur le disque de stockage en utilisant l'interface d'E/S directe (<code>O_DIRECT</code> option). Si <code>min_merge_bytes_to_use_direct_io = 0</code>, puis les e/s directes sont désactivées. Valeur par défaut: <code>10 * 1024 * 1024 * 1024</code> octet.<br> <a name=mergetree_setting-merge_with_ttl_timeout></a></li> <li><code>merge_with_ttl_timeout</code> — Minimum delay in seconds before repeating a merge with TTL. Default value: 86400 (1 day).</li> <li><code>write_final_mark</code> — Enables or disables writing the final index mark at the end of data part (after the last byte). Default value: 1. Don't turn it off.</li> <li><code>merge_max_block_size</code> — Maximum number of rows in block for merge operations. Default value: 8192.</li> <li><code>storage_policy</code> — Storage policy. See <a href=#table_engine-mergetree-multiple-volumes>Utilisation de plusieurs périphériques de bloc pour le stockage de données</a>.</li> </ul> </li> </ul> <p><strong>Exemple de réglage des Sections</strong></p> <div class=codehilite><pre><span></span><code><span class=n>ENGINE</span> <span class=n>MergeTree</span><span class=p>()</span> <span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>EventDate</span><span class=p>)</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=p>(</span><span class=n>CounterID</span><span class=p>,</span> <span class=n>EventDate</span><span class=p>,</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>))</span> <span class=n>SAMPLE</span> <span class=k>BY</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>)</span> <span class=n>SETTINGS</span> <span class=n>index_granularity</span><span class=o>=</span><span class=mi>8192</span>
</code></pre></div> <p>Dans l'exemple, nous définissons le partitionnement par mois.</p> <p>Nous définissons également une expression pour l'échantillonnage en tant que hachage par l'ID utilisateur. Cela vous permet de pseudorandomiser les données dans la table pour chaque <code>CounterID</code> et <code>EventDate</code>. Si vous définissez un <a href=../../../../sql_reference/statements/select/#select-sample-clause>SAMPLE</a> clause lors de la sélection des données, ClickHouse retournera un échantillon de données uniformément pseudo-aléatoire pour un sous-ensemble d'utilisateurs.</p> <p>Le <code>index_granularity</code> paramètre peut être omis, car 8192 est la valeur par défaut.</p> <details> <p><summary>Méthode obsolète pour créer une Table</summary></p> <div class="admonition attention"> <p class=admonition-title>Attention</p> <p>N'utilisez pas cette méthode dans les nouveaux projets. Si possible, optez anciens projets à la méthode décrite ci-dessus.</p> </div> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=p>[</span><span class=k>IF</span> <span class=k>NOT</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=k>cluster</span><span class=p>]</span>
<span class=p>(</span>
    <span class=n>name1</span> <span class=p>[</span><span class=n>type1</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr1</span><span class=p>],</span>
    <span class=n>name2</span> <span class=p>[</span><span class=n>type2</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr2</span><span class=p>],</span>
    <span class=p>...</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=p>[</span><span class=o>=</span><span class=p>]</span> <span class=n>MergeTree</span><span class=p>(</span><span class=nb>date</span><span class=o>-</span><span class=k>column</span> <span class=p>[,</span> <span class=n>sampling_expression</span><span class=p>],</span> <span class=p>(</span><span class=k>primary</span><span class=p>,</span> <span class=k>key</span><span class=p>),</span> <span class=n>index_granularity</span><span class=p>)</span>
</code></pre></div> <p><strong>Paramètres MergeTree ()</strong></p> <ul> <li><code>date-column</code> — The name of a column of the <a href=../../../../sql_reference/data_types/date/ >Date</a> type. ClickHouse crée automatiquement des partitions par mois en fonction de cette colonne. Les noms de partition sont dans le <code>"YYYYMM"</code> format.</li> <li><code>sampling_expression</code> — An expression for sampling.</li> <li><code>(primary, key)</code> — Primary key. Type: <a href=../../../../sql_reference/data_types/tuple/ >Tuple()</a></li> <li><code>index_granularity</code> — The granularity of an index. The number of data rows between the “marks” d'un index. La valeur 8192 est appropriée pour la plupart des tâches.</li> </ul> <p><strong>Exemple</strong></p> <div class=codehilite><pre><span></span><code><span class=n>MergeTree</span><span class=p>(</span><span class=n>EventDate</span><span class=p>,</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>),</span> <span class=p>(</span><span class=n>CounterID</span><span class=p>,</span> <span class=n>EventDate</span><span class=p>,</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>)),</span> <span class=mi>8192</span><span class=p>)</span>
</code></pre></div> <p>Le <code>MergeTree</code> le moteur est configuré de la même manière que dans l'exemple ci-dessus pour la méthode de configuration du moteur principal.</p> </details> <h2 id=mergetree-data-storage>Le Stockage De Données<a class=headerlink href=#mergetree-data-storage title="Permanent link">&para;</a></h2> <p>Une table se compose de parties de données triées par clé primaire.</p> <p>Lorsque des données sont insérées dans une table, des parties de données distinctes sont créées et chacune d'elles est lexicographiquement triée par clé primaire. Par exemple, si la clé primaire est <code>(CounterID, Date)</code>, les données de la pièce sont triées par <code>CounterID</code> et au sein de chaque <code>CounterID</code> il est commandé par <code>Date</code>.</p> <p>Les données appartenant à différentes partitions sont séparés en différentes parties. En arrière-plan, ClickHouse fusionne des parties de données pour un stockage plus efficace. Les parties appartenant à des partitions différentes ne sont pas fusionnées. La fusion mécanisme ne garantit pas que toutes les lignes avec la même clé primaire sera dans la même partie des données.</p> <p>Chaque partie de données est logiquement divisée en granules. Un granule est le plus petit ensemble de données indivisible que ClickHouse lit lors de la sélection des données. ClickHouse ne divise pas les lignes ou les valeurs, de sorte que chaque granule contient toujours un nombre entier de lignes. La première rangée de granules est marqué avec la valeur de la clé primaire de la ligne. Pour chaque partie de données, ClickHouse crée un fichier d'index qui stocke les marques. Pour chaque colonne, que ce soit dans la clé primaire ou non, ClickHouse stocke également les mêmes marques. Ces marques vous permettent de trouver des données directement dans les fichiers de colonnes.</p> <p>La taille de granule est limitée par <code>index_granularity</code> et <code>index_granularity_bytes</code> paramètres du moteur de table. Le nombre de lignes dans un granule jette dans la <code>[1, index_granularity]</code> gamme, en fonction de la taille des lignes. La taille des granulés peut dépasser <code>index_granularity_bytes</code> si la taille d'une seule ligne est supérieure à la valeur du paramètre. Dans ce cas, la taille du granule est égale à la taille de la ligne.</p> <h2 id=primary-keys-and-indexes-in-queries>Clés primaires et Index dans les requêtes<a class=headerlink href=#primary-keys-and-indexes-in-queries title="Permanent link">&para;</a></h2> <p>Prendre la <code>(CounterID, Date)</code> clé primaire comme un exemple. Dans ce cas, le tri et l'index peuvent être illustrés comme suit:</p> <div class=codehilite><pre><span></span><code><span class=w>  </span><span class=n>Whole</span><span class=w> </span><span class=k>data</span><span class=err>:</span><span class=w>     </span><span class=o>[</span><span class=n>---------------------------------------------</span><span class=o>]</span><span class=w></span>
<span class=w>  </span><span class=nl>CounterID</span><span class=p>:</span><span class=w>      </span><span class=o>[</span><span class=n>aaaaaaaaaaaaaaaaaabbbbcdeeeeeeeeeeeeefgggggggghhhhhhhhhiiiiiiiiikllllllll</span><span class=o>]</span><span class=w></span>
<span class=w>  </span><span class=nc>Date</span><span class=err>:</span><span class=w>           </span><span class=o>[</span><span class=n>1111111222222233331233211111222222333211111112122222223111112223311122333</span><span class=o>]</span><span class=w></span>
<span class=w>  </span><span class=nl>Marks</span><span class=p>:</span><span class=w>           </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w></span>
<span class=w>                  </span><span class=n>a</span><span class=p>,</span><span class=mi>1</span><span class=w>    </span><span class=n>a</span><span class=p>,</span><span class=mi>2</span><span class=w>    </span><span class=n>a</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>b</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>e</span><span class=p>,</span><span class=mi>2</span><span class=w>    </span><span class=n>e</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>g</span><span class=p>,</span><span class=mi>1</span><span class=w>    </span><span class=n>h</span><span class=p>,</span><span class=mi>2</span><span class=w>    </span><span class=n>i</span><span class=p>,</span><span class=mi>1</span><span class=w>    </span><span class=n>i</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>l</span><span class=p>,</span><span class=mi>3</span><span class=w></span>
<span class=w>  </span><span class=n>Marks</span><span class=w> </span><span class=nl>numbers</span><span class=p>:</span><span class=w>   </span><span class=mi>0</span><span class=w>      </span><span class=mi>1</span><span class=w>      </span><span class=mi>2</span><span class=w>      </span><span class=mi>3</span><span class=w>      </span><span class=mi>4</span><span class=w>      </span><span class=mi>5</span><span class=w>      </span><span class=mi>6</span><span class=w>      </span><span class=mi>7</span><span class=w>      </span><span class=mi>8</span><span class=w>      </span><span class=mi>9</span><span class=w>      </span><span class=mi>10</span><span class=w></span>
</code></pre></div> <p>Si la requête de données spécifie:</p> <ul> <li><code>CounterID in ('a', 'h')</code> le serveur lit les données dans les gammes des marques <code>[0, 3)</code> et <code>[6, 8)</code>.</li> <li><code>CounterID IN ('a', 'h') AND Date = 3</code> le serveur lit les données dans les gammes des marques <code>[1, 3)</code> et <code>[7, 8)</code>.</li> <li><code>Date = 3</code>, le serveur lit les données de la plage de marque <code>[1, 10]</code>.</li> </ul> <p>Les exemples ci-dessus montrent qu'il est toujours plus efficace d'utiliser un indice qu'une analyse complète.</p> <p>Un index clairsemé permet de lire des données supplémentaires. Lors de la lecture d'une plage unique de la clé primaire, jusqu'à <code>index_granularity * 2</code> lignes supplémentaires dans chaque bloc de données peut être lu.</p> <p>Les index clairsemés vous permettent de travailler avec un très grand nombre de lignes de table, car dans la plupart des cas, ces index tiennent dans la RAM de l'ordinateur.</p> <p>ClickHouse ne nécessite pas de clé primaire unique. Vous pouvez insérer plusieurs lignes avec la même clé primaire.</p> <h3 id=selecting-the-primary-key>Sélection de la clé primaire<a class=headerlink href=#selecting-the-primary-key title="Permanent link">&para;</a></h3> <p>Le nombre de colonnes de la clé primaire n'est pas explicitement limitée. Selon la structure de données, vous pouvez inclure plus ou moins de colonnes dans la clé primaire. Cela peut:</p> <ul> <li> <p>Améliorer la performance d'un indice.</p> <p>Si la clé primaire est <code>(a, b)</code>, puis ajouter une autre colonne <code>c</code> pour améliorer les performances si les conditions suivantes sont réunies:</p> <ul> <li>Il y a des requêtes avec une condition sur la colonne <code>c</code>.</li> <li>Longues plages de données (plusieurs fois plus longues que <code>index_granularity</code>) avec des valeurs identiques pour <code>(a, b)</code> sont communs. En d'autres termes, lors de l'ajout d'une autre colonne vous permet de passer très longues plages de données.</li> </ul> </li> <li> <p>Améliorer la compression des données.</p> <p>ClickHouse trie les données par clé primaire, donc plus la cohérence est élevée, meilleure est la compression.</p> </li> <li> <p>Fournir une logique supplémentaire lors de la fusion de parties de <a href=../collapsingmergetree/#table_engine-collapsingmergetree>CollapsingMergeTree</a> et <a href=../summingmergetree/ >SummingMergeTree</a> moteur.</p> <p>Dans ce cas, on peut spécifier l' <em>clé de tri</em> qui est différente de la clé primaire.</p> </li> </ul> <p>Une clé primaire longue affectera négativement les performances d'insertion et la consommation de mémoire, mais des colonnes supplémentaires dans la clé primaire n'affecteront pas les performances de ClickHouse pendant <code>SELECT</code> requête.</p> <h3 id=choosing-a-primary-key-that-differs-from-the-sorting-key>Choisir une clé primaire qui diffère de la clé de tri<a class=headerlink href=#choosing-a-primary-key-that-differs-from-the-sorting-key title="Permanent link">&para;</a></h3> <p>Il est possible de spécifier une clé primaire (une expression avec des valeurs qui sont écrites dans le fichier d'index pour chaque marque) qui est différente de la clé de tri (une expression pour trier les lignes dans les parties de données). Dans ce cas, le tuple d'expression de clé primaire doit être un préfixe du tuple d'expression de clé de tri.</p> <p>Cette fonctionnalité est utile lorsque vous utilisez le <a href=../summingmergetree/ >SummingMergeTree</a> et<br> <a href=../aggregatingmergetree/ >AggregatingMergeTree</a> table des moteurs. Dans un cas courant lors de l'utilisation de ces moteurs, la table a deux types de colonnes: <em>dimension</em> et <em>mesure</em>. Les requêtes typiques agrégent les valeurs des colonnes de mesure avec arbitraire <code>GROUP BY</code> et filtrage par dimensions. Comme SummingMergeTree et AggregatingMergeTree regroupent des lignes avec la même valeur de la clé de tri, il est naturel d'y ajouter toutes les dimensions. En conséquence, l'expression se compose d'une longue liste de colonnes, et cette liste doit être mise à jour fréquemment avec nouvellement ajoutée.</p> <p>Dans ce cas, il est logique de ne laisser que quelques colonnes dans la clé primaire qui fourniront des analyses de plage efficaces et ajouteront les colonnes de dimension restantes au tuple de clé de tri.</p> <p><a href=../../../../sql_reference/statements/alter/ >ALTER</a> la clé de tri est une opération légère car lorsqu'une nouvelle colonne est ajoutée simultanément à la table et à la clé de tri, les parties de données existantes n'ont pas besoin d'être modifiées. Comme l'ancienne clé de tri est un préfixe de la nouvelle clé de tri et qu'il n'y a pas de données dans la colonne nouvellement ajoutée, les données sont triées à la fois par l'ancienne et la nouvelle clé de tri au moment de la modification de la table.</p> <h3 id=use-of-indexes-and-partitions-in-queries>Utilisation D'Index et de Partitions dans les requêtes<a class=headerlink href=#use-of-indexes-and-partitions-in-queries title="Permanent link">&para;</a></h3> <p>Pour <code>SELECT</code> requêtes, clickhouse analyse si un index peut être utilisé. Un index peut être utilisé si le <code>WHERE/PREWHERE</code> clause a une expression (comme l'un des éléments de conjonction, ou entièrement) qui représente une opération de comparaison d'égalité ou d'inégalité, ou si elle a <code>IN</code> ou <code>LIKE</code> avec un préfixe fixe sur les colonnes ou les expressions qui sont dans la clé primaire ou la clé de partitionnement, ou sur certaines fonctions partiellement répétitives de ces colonnes, ou les relations logiques de ces expressions.</p> <p>Ainsi, il est possible d'exécuter des requêtes sur une ou plusieurs plages de la clé primaire. Dans cet exemple, les requêtes seront rapides lorsqu'elles sont exécutées pour une balise de suivi spécifique, pour une balise et une plage de dates spécifiques, pour une balise et une date spécifiques, pour plusieurs balises avec une plage de dates, etc.</p> <p>Regardons le moteur configuré comme suit:</p> <div class=codehilite><pre><span></span><code><span class=err>  ENGINE MergeTree() PARTITION BY toYYYYMM(EventDate) ORDER BY (CounterID, EventDate) SETTINGS index_granularity=8192</span>
</code></pre></div> <p>Dans ce cas, dans les requêtes:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>EventDate</span> <span class=o>=</span> <span class=n>toDate</span><span class=p>(</span><span class=n>now</span><span class=p>())</span> <span class=k>AND</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>34</span>
<span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>EventDate</span> <span class=o>=</span> <span class=n>toDate</span><span class=p>(</span><span class=n>now</span><span class=p>())</span> <span class=k>AND</span> <span class=p>(</span><span class=n>CounterID</span> <span class=o>=</span> <span class=mi>34</span> <span class=k>OR</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>42</span><span class=p>)</span>
<span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=p>((</span><span class=n>EventDate</span> <span class=o>&gt;=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-01-01&#39;</span><span class=p>)</span> <span class=k>AND</span> <span class=n>EventDate</span> <span class=o>&lt;=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-01-31&#39;</span><span class=p>))</span> <span class=k>OR</span> <span class=n>EventDate</span> <span class=o>=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-05-01&#39;</span><span class=p>))</span> <span class=k>AND</span> <span class=n>CounterID</span> <span class=k>IN</span> <span class=p>(</span><span class=mi>101500</span><span class=p>,</span> <span class=mi>731962</span><span class=p>,</span> <span class=mi>160656</span><span class=p>)</span> <span class=k>AND</span> <span class=p>(</span><span class=n>CounterID</span> <span class=o>=</span> <span class=mi>101500</span> <span class=k>OR</span> <span class=n>EventDate</span> <span class=o>!=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-05-01&#39;</span><span class=p>))</span>
</code></pre></div> <p>ClickHouse utilisera l'index de clé primaire pour supprimer les données incorrectes et la clé de partitionnement mensuel pour supprimer les partitions qui se trouvent dans des plages de dates incorrectes.</p> <p>Les requêtes ci-dessus montrent que l'index est utilisé même pour les expressions complexes. La lecture de la table est organisée de sorte que l'utilisation de l'index ne peut pas être plus lente qu'une analyse complète.</p> <p>Dans l'exemple ci-dessous, l'index ne peut pas être utilisé.</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>34</span> <span class=k>OR</span> <span class=n>URL</span> <span class=k>LIKE</span> <span class=s1>&#39;%upyachka%&#39;</span>
</code></pre></div> <p>Pour vérifier si ClickHouse pouvez utiliser l'index lors de l'exécution d'une requête, utilisez les paramètres <a href=../../../../operations/settings/settings/#settings-force_index_by_date>force_index_by_date</a> et <a href=../../../../operations/settings/settings/ >force_primary_key</a>.</p> <p>La clé de partitionnement par mois permet de lire uniquement les blocs de données qui contiennent des dates de la plage appropriée. Dans ce cas, le bloc de données peut contenir des données pour plusieurs dates (jusqu'à un mois entier). Dans un bloc, les données sont triées par clé primaire, qui peut ne pas contenir la date comme première colonne. Pour cette raison, l'utilisation d'une requête avec seulement une condition de date qui ne spécifie pas le préfixe de clé primaire entraînera la lecture de plus de données que pour une seule date.</p> <h3 id=use-of-index-for-partially-monotonic-primary-keys>Utilisation de L'Index pour les clés primaires partiellement monotones<a class=headerlink href=#use-of-index-for-partially-monotonic-primary-keys title="Permanent link">&para;</a></h3> <p>Considérons, par exemple, les jours du mois. Ils forment un <a href=https://en.wikipedia.org/wiki/Monotonic_function rel="external nofollow noreferrer">monotone de la séquence</a> pendant un mois, mais pas monotone pendant des périodes plus longues. C'est une séquence partiellement monotone. Si un utilisateur crée la table avec une clé primaire partiellement monotone, ClickHouse crée un index clairsemé comme d'habitude. Lorsqu'un utilisateur sélectionne des données à partir de ce type de table, ClickHouse analyse les conditions de requête. Si L'utilisateur veut obtenir des données entre deux marques de l'index et que ces deux marques tombent dans un mois, ClickHouse peut utiliser l'index dans ce cas particulier car il peut calculer la distance entre les paramètres d'une requête et les marques d'index.</p> <p>ClickHouse ne peut pas utiliser un index si les valeurs de la clé primaire dans la plage de paramètres de requête ne représentent pas une séquence monotone. Dans ce cas, ClickHouse utilise la méthode full scan.</p> <p>ClickHouse utilise cette logique non seulement pour les séquences de jours du mois, mais pour toute clé primaire qui représente une séquence partiellement monotone.</p> <h3 id=table_engine-mergetree-data_skipping-indexes>Index de saut de données (expérimental)<a class=headerlink href=#table_engine-mergetree-data_skipping-indexes title="Permanent link">&para;</a></h3> <p>La déclaration d'index se trouve dans la section colonnes du <code>CREATE</code> requête.</p> <div class=codehilite><pre><span></span><code><span class=k>INDEX</span> <span class=n>index_name</span> <span class=n>expr</span> <span class=k>TYPE</span> <span class=k>type</span><span class=p>(...)</span> <span class=n>GRANULARITY</span> <span class=n>granularity_value</span>
</code></pre></div> <p>Pour les tables de la <code>*MergeTree</code> famille, les indices de saut de données peuvent être spécifiés.</p> <p>Ces indices agrégent certaines informations sur l'expression spécifiée sur les blocs, qui consistent en <code>granularity_value</code> granules (la taille du granule est spécifiée en utilisant <code>index_granularity</code> réglage dans le moteur de table). Ensuite, ces agrégats sont utilisés dans <code>SELECT</code> requêtes pour réduire la quantité de données à lire à partir du disque en ignorant de gros blocs de données <code>where</code> la requête ne peut pas être satisfait.</p> <p><strong>Exemple</strong></p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=k>table_name</span>
<span class=p>(</span>
    <span class=n>u64</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>i32</span> <span class=n>Int32</span><span class=p>,</span>
    <span class=n>s</span> <span class=n>String</span><span class=p>,</span>
    <span class=p>...</span>
    <span class=k>INDEX</span> <span class=n>a</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=n>i32</span><span class=p>,</span> <span class=n>s</span><span class=p>)</span> <span class=k>TYPE</span> <span class=n>minmax</span> <span class=n>GRANULARITY</span> <span class=mi>3</span><span class=p>,</span>
    <span class=k>INDEX</span> <span class=n>b</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>s</span><span class=p>))</span> <span class=k>TYPE</span> <span class=k>set</span><span class=p>(</span><span class=mi>1000</span><span class=p>)</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span><span class=p>()</span>
<span class=p>...</span>
</code></pre></div> <p>Les Indices de L'exemple peuvent être utilisés par ClickHouse pour réduire la quantité de données à lire à partir du disque dans les requêtes suivantes:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>s</span> <span class=o>&lt;</span> <span class=s1>&#39;z&#39;</span>
<span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>u64</span> <span class=o>*</span> <span class=n>i32</span> <span class=o>==</span> <span class=mi>10</span> <span class=k>AND</span> <span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>1234</span>
</code></pre></div> <h4 id=available-types-of-indices>Types D'Indices Disponibles<a class=headerlink href=#available-types-of-indices title="Permanent link">&para;</a></h4> <ul> <li> <p><code>minmax</code></p> <p>Magasins extrêmes de l'expression spécifiée (si l'expression est <code>tuple</code> puis il stocke les extrêmes pour chaque élément de <code>tuple</code>), utilise les informations stockées pour sauter des blocs de données comme la clé primaire.</p> </li> <li> <p><code>set(max_rows)</code></p> <p>Stocke les valeurs uniques de l'expression spécifiée (pas plus de <code>max_rows</code> rangée, <code>max_rows=0</code> moyen “no limits”). Utilise les valeurs pour vérifier si le <code>WHERE</code> l'expression n'est pas satisfiable sur un bloc de données.</p> </li> <li> <p><code>ngrambf_v1(n, size_of_bloom_filter_in_bytes, number_of_hash_functions, random_seed)</code></p> <p>Magasins un <a href=https://en.wikipedia.org/wiki/Bloom_filter rel="external nofollow noreferrer">Filtre de Bloom</a> qui contient tous les ngrams d'un bloc de données. Fonctionne uniquement avec des chaînes. Peut être utilisé pour l'optimisation de <code>equals</code>, <code>like</code> et <code>in</code> expression.</p> <ul> <li><code>n</code> — ngram size,</li> <li><code>size_of_bloom_filter_in_bytes</code> — Bloom filter size in bytes (you can use large values here, for example, 256 or 512, because it can be compressed well).</li> <li><code>number_of_hash_functions</code> — The number of hash functions used in the Bloom filter.</li> <li><code>random_seed</code> — The seed for Bloom filter hash functions.</li> </ul> </li> <li> <p><code>tokenbf_v1(size_of_bloom_filter_in_bytes, number_of_hash_functions, random_seed)</code></p> <p>Le même que <code>ngrambf_v1</code>, mais stocke des jetons au lieu de ngrams. Les jetons sont des séquences séparées par des caractères non alphanumériques.</p> </li> <li> <p><code>bloom_filter([false_positive])</code> — Stores a <a href=https://en.wikipedia.org/wiki/Bloom_filter rel="external nofollow noreferrer">Filtre de Bloom</a> pour les colonnes spécifiées.</p> <p>Facultatif <code>false_positive</code> le paramètre est la probabilité de recevoir une réponse faussement positive du filtre. Valeurs possibles: (0, 1). Valeur par défaut: 0.025.</p> <p>Types de données pris en charge: <code>Int*</code>, <code>UInt*</code>, <code>Float*</code>, <code>Enum</code>, <code>Date</code>, <code>DateTime</code>, <code>String</code>, <code>FixedString</code>, <code>Array</code>, <code>LowCardinality</code>, <code>Nullable</code>.</p> <p>Les fonctions suivantes peuvent l'utiliser: <a href=../../../../sql_reference/functions/comparison_functions/ >égal</a>, <a href=../../../../sql_reference/functions/comparison_functions/ >notEquals</a>, <a href=../../../../sql_reference/functions/in_functions/ >dans</a>, <a href=../../../../sql_reference/functions/in_functions/ >notIn</a>, <a href=../../../../sql_reference/functions/array_functions/ >avoir</a>.</p> </li> </ul> <!-- --> <div class=codehilite><pre><span></span><code><span class=k>INDEX</span> <span class=n>sample_index</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>s</span><span class=p>))</span> <span class=k>TYPE</span> <span class=n>minmax</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
<span class=k>INDEX</span> <span class=n>sample_index2</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>str</span><span class=p>),</span> <span class=n>i32</span> <span class=o>+</span> <span class=n>f64</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=nb>date</span><span class=p>,</span> <span class=n>str</span><span class=p>)</span> <span class=k>TYPE</span> <span class=k>set</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
<span class=k>INDEX</span> <span class=n>sample_index3</span> <span class=p>(</span><span class=k>lower</span><span class=p>(</span><span class=n>str</span><span class=p>),</span> <span class=n>str</span><span class=p>)</span> <span class=k>TYPE</span> <span class=n>ngrambf_v1</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>256</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
</code></pre></div> <h4 id=functions-support>Les Fonctions De Soutien<a class=headerlink href=#functions-support title="Permanent link">&para;</a></h4> <p>Les Conditions dans le <code>WHERE</code> la clause contient des appels des fonctions qui fonctionnent avec des colonnes. Si la colonne fait partie d'un index, ClickHouse essaie d'utiliser cet index lors de l'exécution des fonctions. ClickHouse prend en charge différents sous-ensembles de fonctions pour l'utilisation d'index.</p> <p>Le <code>set</code> l'indice peut être utilisé avec toutes les fonctions. Les sous-ensembles de fonctions pour les autres index sont présentés dans le tableau ci-dessous.</p> <table> <thead> <tr> <th>Fonction (opérateur) / Indice de</th> <th>clé primaire</th> <th>minmax</th> <th>ngrambf_v1</th> <th>tokenbf_v1</th> <th>bloom_filter</th> </tr> </thead> <tbody> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-equals>égal (=, ==)</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-notequals>notEquals (!=, \&lt;>)</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_search_functions/#function-like>comme</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_search_functions/#function-notlike>notLike</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_functions/#startswith>startsWith</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_functions/#endswith>endsWith</a></td> <td>✗</td> <td>✗</td> <td>✔</td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_search_functions/#function-multisearchany>multiSearchAny</a></td> <td>✗</td> <td>✗</td> <td>✔</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/in_functions/#in-functions>dans</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/in_functions/#in-functions>notIn</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-less>peu (\&lt;)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-greater>grand (>)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-lessorequals>lessOrEquals (\&lt;=)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-greaterorequals>greaterOrEquals ( > =)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/array_functions/#function-empty>vide</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/array_functions/#function-notempty>notEmpty</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td>hasToken</td> <td>✗</td> <td>✗</td> <td>✗</td> <td>✔</td> <td>✗</td> </tr> </tbody> </table> <p>Les fonctions avec un argument constant inférieur à la taille ngram ne peuvent pas être utilisées par <code>ngrambf_v1</code> pour l'optimisation de la requête.</p> <p>Les filtres Bloom peuvent avoir des correspondances faussement positives, de sorte que le <code>ngrambf_v1</code>, <code>tokenbf_v1</code>, et <code>bloom_filter</code> les index ne peuvent pas être utilisés pour optimiser les requêtes où le résultat d'une fonction est censé être faux, par exemple:</p> <ul> <li>Peut être optimisé:<ul> <li><code>s LIKE '%test%'</code></li> <li><code>NOT s NOT LIKE '%test%'</code></li> <li><code>s = 1</code></li> <li><code>NOT s != 1</code></li> <li><code>startsWith(s, 'test')</code></li> </ul> </li> <li>Ne peut pas être optimisé:<ul> <li><code>NOT s LIKE '%test%'</code></li> <li><code>s NOT LIKE '%test%'</code></li> <li><code>NOT s = 1</code></li> <li><code>s != 1</code></li> <li><code>NOT startsWith(s, 'test')</code></li> </ul> </li> </ul> <h2 id=concurrent-data-access>Accès Simultané Aux Données<a class=headerlink href=#concurrent-data-access title="Permanent link">&para;</a></h2> <p>Pour l'accès aux tables simultanées, nous utilisons le multi-versioning. En d'autres termes, lorsqu'une table est lue et mise à jour simultanément, les données sont lues à partir d'un ensemble de parties en cours au moment de la requête. Il n'y a pas de longues mèches. Les Inserts ne gênent pas les opérations de lecture.</p> <p>Lecture à partir d'un tableau est automatiquement parallélisée.</p> <h2 id=table_engine-mergetree-ttl>TTL pour les colonnes et les tableaux<a class=headerlink href=#table_engine-mergetree-ttl title="Permanent link">&para;</a></h2> <p>Détermine la durée de vie de des valeurs.</p> <p>Le <code>TTL</code> clause peut être définie pour la table entière et pour chaque colonne individuelle. Ttl de niveau Table peut également spécifier la logique de déplacement automatique des données entre les disques et les volumes.</p> <p>Les Expressions doivent évaluer pour <a href=../../../../sql_reference/data_types/date/ >Date</a> ou <a href=../../../../sql_reference/data_types/datetime/ >DateTime</a> type de données.</p> <p>Exemple:</p> <div class=codehilite><pre><span></span><code><span class=n>TTL</span> <span class=n>time_column</span>
<span class=n>TTL</span> <span class=n>time_column</span> <span class=o>+</span> <span class=nb>interval</span>
</code></pre></div> <p>Définir <code>interval</code>, utiliser <a href=../../../../sql_reference/operators/#operators-datetime>intervalle</a> opérateur.</p> <div class=codehilite><pre><span></span><code><span class=n>TTL</span> <span class=n>date_time</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span>
<span class=n>TTL</span> <span class=n>date_time</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>15</span> <span class=n>HOUR</span>
</code></pre></div> <h3 id=mergetree-column-ttl>Colonne TTL<a class=headerlink href=#mergetree-column-ttl title="Permanent link">&para;</a></h3> <p>Lorsque les valeurs de la colonne expirent, ClickHouse les remplace par les valeurs par défaut du type de données de la colonne. Si toutes les valeurs de colonne de la partie données expirent, ClickHouse supprime cette colonne de la partie données d'un système de fichiers.</p> <p>Le <code>TTL</code> la clause ne peut pas être utilisée pour les colonnes clés.</p> <p>Exemple:</p> <p>Création d'une table avec TTL</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>example_table</span>
<span class=p>(</span>
    <span class=n>d</span> <span class=n>DateTime</span><span class=p>,</span>
    <span class=n>a</span> <span class=nb>Int</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span><span class=p>,</span>
    <span class=n>b</span> <span class=nb>Int</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span><span class=p>,</span>
    <span class=k>c</span> <span class=n>String</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>d</span><span class=p>;</span>
</code></pre></div> <p>Ajout de TTL à une colonne d'une table existante</p> <div class=codehilite><pre><span></span><code><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>example_table</span>
    <span class=k>MODIFY</span> <span class=k>COLUMN</span>
    <span class=k>c</span> <span class=n>String</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>DAY</span><span class=p>;</span>
</code></pre></div> <p>Modification de TTL de la colonne</p> <div class=codehilite><pre><span></span><code><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>example_table</span>
    <span class=k>MODIFY</span> <span class=k>COLUMN</span>
    <span class=k>c</span> <span class=n>String</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span><span class=p>;</span>
</code></pre></div> <h3 id=mergetree-table-ttl>Tableau TTL<a class=headerlink href=#mergetree-table-ttl title="Permanent link">&para;</a></h3> <p>Table peut avoir une expression pour la suppression de Lignes expirées, et plusieurs expressions pour le déplacement automatique de pièces entre <a href=#table_engine-mergetree-multiple-volumes>disques ou volumes</a>. Lorsque les lignes de la table expirent, ClickHouse supprime toutes les lignes correspondantes. Pour les pièces en mouvement, toutes les lignes d'une pièce doivent satisfaire aux critères d'expression de mouvement.</p> <div class=codehilite><pre><span></span><code><span class=n>TTL</span> <span class=n>expr</span> <span class=p>[</span><span class=k>DELETE</span><span class=o>|</span><span class=k>TO</span> <span class=n>DISK</span> <span class=s1>&#39;aaa&#39;</span><span class=o>|</span><span class=k>TO</span> <span class=n>VOLUME</span> <span class=s1>&#39;bbb&#39;</span><span class=p>],</span> <span class=p>...</span>
</code></pre></div> <p>Type de règle TTL peut suivre chaque expression TTL. Il affecte une action qui doit être faite une fois que l'expression est satisfaite (atteint l'heure actuelle):</p> <ul> <li><code>DELETE</code> - supprimer les Lignes expirées (action par défaut);</li> <li><code>TO DISK 'aaa'</code> - déplacer la partie sur le disque <code>aaa</code>;</li> <li><code>TO VOLUME 'bbb'</code> - déplacer la partie sur le disque <code>bbb</code>.</li> </ul> <p>Exemple:</p> <p>Création d'une table avec TTL</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>example_table</span>
<span class=p>(</span>
    <span class=n>d</span> <span class=n>DateTime</span><span class=p>,</span>
    <span class=n>a</span> <span class=nb>Int</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>d</span>
<span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span> <span class=p>[</span><span class=k>DELETE</span><span class=p>],</span>
    <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=n>WEEK</span> <span class=k>TO</span> <span class=n>VOLUME</span> <span class=s1>&#39;aaa&#39;</span><span class=p>,</span>
    <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>2</span> <span class=n>WEEK</span> <span class=k>TO</span> <span class=n>DISK</span> <span class=s1>&#39;bbb&#39;</span><span class=p>;</span>
</code></pre></div> <p>Modification de TTL de la table</p> <div class=codehilite><pre><span></span><code><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>example_table</span>
    <span class=k>MODIFY</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>DAY</span><span class=p>;</span>
</code></pre></div> <p><strong>Suppression De Données</strong></p> <p>Les données avec un TTL expiré sont supprimées lorsque ClickHouse fusionne des parties de données.</p> <p>Lorsque ClickHouse voit que les données sont expirées, il effectue une fusion hors calendrier. Pour contrôler la fréquence de ces fusions, vous pouvez définir <a href=#mergetree_setting-merge_with_ttl_timeout>merge_with_ttl_timeout</a>. Si la valeur est trop faible, il effectuera de nombreuses fusions hors calendrier qui peuvent consommer beaucoup de ressources.</p> <p>Si vous effectuez la <code>SELECT</code> requête entre les fusionne, vous pouvez obtenir des données expirées. Pour éviter cela, utilisez la <a href=../../../../sql_reference/statements/misc/#misc_operations-optimize>OPTIMIZE</a> requête avant de l' <code>SELECT</code>.</p> <h2 id=table_engine-mergetree-multiple-volumes>Utilisation De Plusieurs Périphériques De Bloc Pour Le Stockage De Données<a class=headerlink href=#table_engine-mergetree-multiple-volumes title="Permanent link">&para;</a></h2> <h3 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h3> <p><code>MergeTree</code> les moteurs de table de famille peuvent stocker des données sur plusieurs périphériques de bloc. Par exemple, il peut être utile lorsque les données d'un tableau sont implicitement divisé en “hot” et “cold”. Les données les plus récentes sont régulièrement demandées mais ne nécessitent qu'une petite quantité d'espace. Au contraire, les données historiques à queue grasse sont rarement demandées. Si plusieurs disques sont disponibles, la “hot” les données peuvent être situées sur des disques rapides (par exemple, SSD NVMe ou en mémoire), tandis que le “cold” des données relativement lente (par exemple, disque dur).</p> <p>La partie de données est l'unité mobile minimum pour <code>MergeTree</code>-tables de moteur. Les données appartenant à une partie sont stockées sur un disque. Les parties de données peuvent être déplacées entre les disques en arrière-plan (selon les paramètres de l'utilisateur) ainsi qu'au moyen du <a href=../../../../sql_reference/statements/alter/#alter_move-partition>ALTER</a> requête.</p> <h3 id=terms>Terme<a class=headerlink href=#terms title="Permanent link">&para;</a></h3> <ul> <li>Disk — Block device mounted to the filesystem.</li> <li>Default disk — Disk that stores the path specified in the <a href=../../../../operations/server_configuration_parameters/settings/#server_configuration_parameters-path>chemin</a> paramètre de serveur.</li> <li>Volume — Ordered set of equal disks (similar to <a href=https://en.wikipedia.org/wiki/Non-RAID_drive_architectures rel="external nofollow noreferrer">JBOD</a>).</li> <li>Storage policy — Set of volumes and the rules for moving data between them.</li> </ul> <p>Les noms donnés aux entités décrites peuvent être trouvés dans les tables système, <a href=../../../../operations/system_tables/#system_tables-storage_policies>système.storage_policies</a> et <a href=../../../../operations/system_tables/#system_tables-disks>système.disque</a>. Pour appliquer l'une des stratégies de stockage configurées pour une table, utilisez <code>storage_policy</code> réglage de <code>MergeTree</code>-moteur de table de famille.</p> <h3 id=table_engine-mergetree-multiple-volumes-configure>Configuration<a class=headerlink href=#table_engine-mergetree-multiple-volumes-configure title="Permanent link">&para;</a></h3> <p>Les disques, les volumes et les stratégies de stockage doivent être déclarés <code>&lt;storage_configuration&gt;</code> étiquette, soit dans le fichier principal <code>config.xml</code> ou dans un fichier distinct dans le <code>config.d</code> répertoire.</p> <p>Structure de Configuration:</p> <div class=codehilite><pre><span></span><code><span class=nt>&lt;storage_configuration&gt;</span>
    <span class=nt>&lt;disks&gt;</span>
        <span class=nt>&lt;disk_name_1&gt;</span> <span class=c>&lt;!-- disk name --&gt;</span>
            <span class=nt>&lt;path&gt;</span>/mnt/fast_ssd/clickhouse<span class=nt>&lt;/path&gt;</span>
        <span class=nt>&lt;/disk_name_1&gt;</span>
        <span class=nt>&lt;disk_name_2&gt;</span>
            <span class=nt>&lt;path&gt;</span>/mnt/hdd1/clickhouse<span class=nt>&lt;/path&gt;</span>
            <span class=nt>&lt;keep_free_space_bytes&gt;</span>10485760<span class=nt>&lt;/keep_free_space_bytes&gt;</span>
        <span class=nt>&lt;/disk_name_2&gt;</span>
        <span class=nt>&lt;disk_name_3&gt;</span>
            <span class=nt>&lt;path&gt;</span>/mnt/hdd2/clickhouse<span class=nt>&lt;/path&gt;</span>
            <span class=nt>&lt;keep_free_space_bytes&gt;</span>10485760<span class=nt>&lt;/keep_free_space_bytes&gt;</span>
        <span class=nt>&lt;/disk_name_3&gt;</span>

        ...
    <span class=nt>&lt;/disks&gt;</span>

    ...
<span class=nt>&lt;/storage_configuration&gt;</span>
</code></pre></div> <p>Balise:</p> <ul> <li><code>&lt;disk_name_N&gt;</code> — Disk name. Names must be different for all disks.</li> <li><code>path</code> — path under which a server will store data (<code>data</code> et <code>shadow</code> des dossiers), doit être terminé par ‘/’.</li> <li><code>keep_free_space_bytes</code> — the amount of free disk space to be reserved.</li> </ul> <p>L'ordre du disque définition n'est pas important.</p> <p>Stratégies de stockage balisage de configuration:</p> <div class=codehilite><pre><span></span><code><span class=nt>&lt;storage_configuration&gt;</span>
    ...
    <span class=nt>&lt;policies&gt;</span>
        <span class=nt>&lt;policy_name_1&gt;</span>
            <span class=nt>&lt;volumes&gt;</span>
                <span class=nt>&lt;volume_name_1&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk_name_from_disks_configuration<span class=nt>&lt;/disk&gt;</span>
                    <span class=nt>&lt;max_data_part_size_bytes&gt;</span>1073741824<span class=nt>&lt;/max_data_part_size_bytes&gt;</span>
                <span class=nt>&lt;/volume_name_1&gt;</span>
                <span class=nt>&lt;volume_name_2&gt;</span>
                    <span class=c>&lt;!-- configuration --&gt;</span>
                <span class=nt>&lt;/volume_name_2&gt;</span>
                <span class=c>&lt;!-- more volumes --&gt;</span>
            <span class=nt>&lt;/volumes&gt;</span>
            <span class=nt>&lt;move_factor&gt;</span>0.2<span class=nt>&lt;/move_factor&gt;</span>
        <span class=nt>&lt;/policy_name_1&gt;</span>
        <span class=nt>&lt;policy_name_2&gt;</span>
            <span class=c>&lt;!-- configuration --&gt;</span>
        <span class=nt>&lt;/policy_name_2&gt;</span>

        <span class=c>&lt;!-- more policies --&gt;</span>
    <span class=nt>&lt;/policies&gt;</span>
    ...
<span class=nt>&lt;/storage_configuration&gt;</span>
</code></pre></div> <p>Balise:</p> <ul> <li><code>policy_name_N</code> — Policy name. Policy names must be unique.</li> <li><code>volume_name_N</code> — Volume name. Volume names must be unique.</li> <li><code>disk</code> — a disk within a volume.</li> <li><code>max_data_part_size_bytes</code> — the maximum size of a part that can be stored on any of the volume's disks.</li> <li><code>move_factor</code> — when the amount of available space gets lower than this factor, data automatically start to move on the next volume if any (by default, 0.1).</li> </ul> <p>Exemples de Cofiguration:</p> <div class=codehilite><pre><span></span><code><span class=nt>&lt;storage_configuration&gt;</span>
    ...
    <span class=nt>&lt;policies&gt;</span>
        <span class=nt>&lt;hdd_in_order&gt;</span> <span class=c>&lt;!-- policy name --&gt;</span>
            <span class=nt>&lt;volumes&gt;</span>
                <span class=nt>&lt;single&gt;</span> <span class=c>&lt;!-- volume name --&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk1<span class=nt>&lt;/disk&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk2<span class=nt>&lt;/disk&gt;</span>
                <span class=nt>&lt;/single&gt;</span>
            <span class=nt>&lt;/volumes&gt;</span>
        <span class=nt>&lt;/hdd_in_order&gt;</span>

        <span class=nt>&lt;moving_from_ssd_to_hdd&gt;</span>
            <span class=nt>&lt;volumes&gt;</span>
                <span class=nt>&lt;hot&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>fast_ssd<span class=nt>&lt;/disk&gt;</span>
                    <span class=nt>&lt;max_data_part_size_bytes&gt;</span>1073741824<span class=nt>&lt;/max_data_part_size_bytes&gt;</span>
                <span class=nt>&lt;/hot&gt;</span>
                <span class=nt>&lt;cold&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk1<span class=nt>&lt;/disk&gt;</span>
                <span class=nt>&lt;/cold&gt;</span>
            <span class=nt>&lt;/volumes&gt;</span>
            <span class=nt>&lt;move_factor&gt;</span>0.2<span class=nt>&lt;/move_factor&gt;</span>
        <span class=nt>&lt;/moving_from_ssd_to_hdd&gt;</span>
    <span class=nt>&lt;/policies&gt;</span>
    ...
<span class=nt>&lt;/storage_configuration&gt;</span>
</code></pre></div> <p>Dans l'exemple donné, la <code>hdd_in_order</code> politique met en œuvre les <a href=https://en.wikipedia.org/wiki/Round-robin_scheduling rel="external nofollow noreferrer">round-robin</a> approche. Ainsi cette politique ne définit qu'un seul volume (<code>single</code>), les parties des données sont stockées sur tous ses disques dans l'ordre circulaire. Une telle politique peut être très utile s'il y a plusieurs disques similaires sont montés sur le système, mais RAID N'est pas configuré. Gardez à l'esprit que chaque lecteur de disque n'est pas fiable et vous pouvez compenser avec facteur de réplication de 3 ou plus.</p> <p>S'il existe différents types de disques disponibles dans le système, <code>moving_from_ssd_to_hdd</code> la stratégie peut être utilisée à la place. Volume <code>hot</code> se compose d'un disque SSD (<code>fast_ssd</code>), et la taille maximale d'une pièce qui peut être stocké sur ce volume est de 1 go. Toutes les pièces avec la taille plus grande que 1 GB sera stocké directement sur le <code>cold</code> le volume, qui contient un disque dur de disque <code>disk1</code>.<br> Aussi, une fois le disque <code>fast_ssd</code> est complété par plus de 80%, les données seront transférées à la <code>disk1</code> par un processus d'arrière-plan.</p> <p>L'ordre d'énumération des volumes dans une stratégie de stockage est important. Une fois qu'un volume est surchargé, les données sont déplacées vers le suivant. L'ordre d'énumération des disques est important parce que les données sont stockées dans les virages.</p> <p>Lors de la création d'une table, on peut lui appliquer l'une des stratégies de stockage configurées:</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>table_with_non_default_policy</span> <span class=p>(</span>
    <span class=n>EventDate</span> <span class=nb>Date</span><span class=p>,</span>
    <span class=n>OrderID</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>BannerID</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>SearchPhrase</span> <span class=n>String</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=p>(</span><span class=n>OrderID</span><span class=p>,</span> <span class=n>BannerID</span><span class=p>)</span>
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>EventDate</span><span class=p>)</span>
<span class=n>SETTINGS</span> <span class=n>storage_policy</span> <span class=o>=</span> <span class=s1>&#39;moving_from_ssd_to_hdd&#39;</span>
</code></pre></div> <p>Le <code>default</code> la Politique de stockage implique d'utiliser un seul volume, qui se compose d'un seul disque donné dans <code>&lt;path&gt;</code>. Une fois qu'une table est créée, sa stratégie de stockage ne peut pas être modifiée.</p> <h3 id=details>Détail<a class=headerlink href=#details title="Permanent link">&para;</a></h3> <p>Dans le cas de <code>MergeTree</code> les tableaux, les données sont sur le disque de différentes façons:</p> <ul> <li>En tant que résultat d'un insert (<code>INSERT</code> requête).</li> <li>En arrière-plan fusionne et <a href=../../../../sql_reference/statements/alter/#alter-mutations>mutation</a>.</li> <li>Lors du téléchargement à partir d'une autre réplique.</li> <li>À la suite du gel de la partition <a href=../../../../sql_reference/statements/alter/#alter_freeze-partition>ALTER TABLE … FREEZE PARTITION</a>.</li> </ul> <p>Dans tous ces cas, à l'exception des mutations et du gel de partition, une pièce est stockée sur un volume et un disque selon la Politique de stockage donnée:</p> <ol> <li>Le premier volume (dans l'ordre de définition) qui a suffisamment d'espace disque pour stocker une pièce (<code>unreserved_space &gt; current_part_size</code>) et permet de stocker des pièces d'une taille donnée (<code>max_data_part_size_bytes &gt; current_part_size</code>) est choisi.</li> <li>Dans ce volume, ce disque est choisi qui suit celui, qui a été utilisé pour stocker le bloc de données précédent, et qui a de l'espace libre plus que la taille de la pièce (<code>unreserved_space - keep_free_space_bytes &gt; current_part_size</code>).</li> </ol> <p>Sous le capot, les mutations et la congélation des cloisons utilisent <a href=https://en.wikipedia.org/wiki/Hard_link rel="external nofollow noreferrer">des liens en dur</a>. Les liens durs entre différents disques ne sont pas pris en charge, donc dans de tels cas, les pièces résultantes sont stockées sur les mêmes disques que les disques initiaux.</p> <p>En arrière - plan, les pièces sont déplacées entre les volumes en fonction de la quantité d'espace libre (<code>move_factor</code> paramètre) selon l'ordre les volumes sont déclarées dans le fichier de configuration.<br> Les données ne sont jamais transférées du dernier et dans le premier. On peut utiliser des tables système <a href=../../../../operations/system_tables/#system_tables-part-log>système.part_log</a> (champ <code>type = MOVE_PART</code>) et <a href=../../../../operations/system_tables/#system_tables-parts>système.partie</a> (Fields <code>path</code> et <code>disk</code>) pour surveiller l'arrière-plan se déplace. Aussi, les informations détaillées peuvent être trouvées dans les journaux du serveur.</p> <p>L'utilisateur peut forcer le déplacement d'une partie ou d'une partition d'un volume à l'autre à l'aide de la requête <a href=../../../../sql_reference/statements/alter/#alter_move-partition>ALTER TABLE … MOVE PART|PARTITION … TO VOLUME|DISK …</a>, toutes les restrictions pour les opérations de fond sont prises en compte. La requête initie un mouvement seul et n'attend pas que les opérations d'arrière-plan soient terminées. L'utilisateur recevra un message d'erreur si pas assez d'espace libre est disponible ou si l'une des conditions requises ne sont pas remplies.</p> <p>Le déplacement des données n'interfère pas avec la réplication des données. Par conséquent, différentes stratégies de stockage peuvent être spécifiées pour la même table sur différents réplicas.</p> <p>Après l'achèvement des fusions d'arrière-plan et des mutations, les anciennes parties ne sont supprimées qu'après un certain temps (<code>old_parts_lifetime</code>).<br> Pendant ce temps, ils ne sont pas déplacés vers d'autres volumes ou des disques. Par conséquent, jusqu'à ce que les pièces soient finalement supprimées, elles sont toujours prises en compte pour l'évaluation de l'espace disque occupé.</p> </div> <div id=content-footer class="text-muted pt-5"> <div class=float-right>©2016–2020 Yandex LLC</div> <div>Construit à partir de <a href=https://github.com/ClickHouse/ClickHouse/commit/a24471233fce463ffd70bff561f7842d4d0b7bd9 rel="external nofollow noreferrer" target=_blank class=text-reset>a24471233f</a></div> </div> </div> <div id=toc class="col-xl-2 d-none d-xl-block d-print-none p-3 overflow-auto toc-right mb-5"> <nav class="nav flex-column text-wrap"> <label for=toc>Table des matières</label> <a href=#table_engine-mergetree-creating-a-table title="Création d'une Table" class="nav-link text-wrap d-inline-block w-100"> Création d'une Table </a> <nav id=toc-toc-1 class="nav flex-column pl-2"> <a href=#mergetree-query-clauses title="Les Clauses De Requête" class="nav-link text-wrap d-inline-block w-100"> Les Clauses De Requête </a> </nav> <a href=#mergetree-data-storage title="Le Stockage De Données" class="nav-link text-wrap d-inline-block w-100"> Le Stockage De Données </a> <a href=#primary-keys-and-indexes-in-queries title="Clés primaires et Index dans les requêtes" class="nav-link text-wrap d-inline-block w-100"> Clés primaires et Index dans les requêtes </a> <nav id=toc-toc-3 class="nav flex-column pl-2"> <a href=#selecting-the-primary-key title="Sélection de la clé primaire" class="nav-link text-wrap d-inline-block w-100"> Sélection de la clé primaire </a> <a href=#choosing-a-primary-key-that-differs-from-the-sorting-key title="Choisir une clé primaire qui diffère de la clé de tri" class="nav-link text-wrap d-inline-block w-100"> Choisir une clé primaire qui diffère de la clé de tri </a> <a href=#use-of-indexes-and-partitions-in-queries title="Utilisation D'Index et de Partitions dans les requêtes" class="nav-link text-wrap d-inline-block w-100"> Utilisation D'Index et de Partitions dans les requêtes </a> <a href=#use-of-index-for-partially-monotonic-primary-keys title="Utilisation de L'Index pour les clés primaires partiellement monotones" class="nav-link text-wrap d-inline-block w-100"> Utilisation de L'Index pour les clés primaires partiellement monotones </a> <a href=#table_engine-mergetree-data_skipping-indexes title="Index de saut de données (expérimental)" class="nav-link text-wrap d-inline-block w-100"> Index de saut de données (expérimental) </a> <nav id=toc-toc-3-5 class="nav flex-column pl-2"> <a href=#available-types-of-indices title="Types D'Indices Disponibles" class="nav-link text-wrap d-inline-block w-100"> Types D'Indices Disponibles </a> <a href=#functions-support title="Les Fonctions De Soutien" class="nav-link text-wrap d-inline-block w-100"> Les Fonctions De Soutien </a> </nav> </nav> <a href=#concurrent-data-access title="Accès Simultané Aux Données" class="nav-link text-wrap d-inline-block w-100"> Accès Simultané Aux Données </a> <a href=#table_engine-mergetree-ttl title="TTL pour les colonnes et les tableaux" class="nav-link text-wrap d-inline-block w-100"> TTL pour les colonnes et les tableaux </a> <nav id=toc-toc-5 class="nav flex-column pl-2"> <a href=#mergetree-column-ttl title="Colonne TTL" class="nav-link text-wrap d-inline-block w-100"> Colonne TTL </a> <a href=#mergetree-table-ttl title="Tableau TTL" class="nav-link text-wrap d-inline-block w-100"> Tableau TTL </a> </nav> <a href=#table_engine-mergetree-multiple-volumes title="Utilisation De Plusieurs Périphériques De Bloc Pour Le Stockage De Données" class="nav-link text-wrap d-inline-block w-100"> Utilisation De Plusieurs Périphériques De Bloc Pour Le Stockage De Données </a> <nav id=toc-toc-6 class="nav flex-column pl-2"> <a href=#introduction title=Introduction class="nav-link text-wrap d-inline-block w-100"> Introduction </a> <a href=#terms title=Terme class="nav-link text-wrap d-inline-block w-100"> Terme </a> <a href=#table_engine-mergetree-multiple-volumes-configure title=Configuration class="nav-link text-wrap d-inline-block w-100"> Configuration </a> <a href=#details title=Détail class="nav-link text-wrap d-inline-block w-100"> Détail </a> </nav> </nav> </div> </div> </div> <script async type=text/javascript src=/js/base.js?7bd05efd></script> <noscript> <div><img src=https://mc.yandex.ru/watch/18343495 alt=Yandex></div> </noscript> </body> </html>