<!DOCTYPE html><html lang=fa data-version=v19.11 data-single-page=false> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Changelog - مستندات v19.11ClickHouse</title><link rel="shortcut icon" href=/favicon.ico><meta property=og:title content="Changelog - مستندات v19.11ClickHouse"><meta property=og:description content="ClickHouse release 19.9.4.1, 2019-07-05 Исправления ошибок Исправлен segmentation fault в кодеке сжатия Delta в колонках"><meta property=og:type content=website><meta property=og:image content=https://clickhouse.tech/images/logo.png><meta property=twitter:title content="Changelog - مستندات v19.11ClickHouse"><meta name=description content="ClickHouse release 19.9.4.1, 2019-07-05 Исправления ошибок Исправлен segmentation fault в кодеке сжатия Delta в колонках"><meta name=keywords content="ClickHouse, DBMS, OLAP, relational, analytics, analytical, big data, open-source, SQL, web-analytics"><link href=/css/base.css?1d858e50 media=all rel=stylesheet></head> <body dir=rtl data-spy=scroll data-target=#toc data-offset=80> <nav id=top-nav class="navbar navbar-dark navbar-expand-md bg-dark-alt text-white sticky-top"> <div class="container-fluid justify-content-between"> <a href=/ class="d-block navbar-brand mr-3"> <img id=docs-logo-icon src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"> </a> <div class="w-100 navbar-text text-left d-none d-md-block"> <h1 class="h3 m-0 p-0 d-inline"> <a href=# class="text-white text-decoration-none"> Changelog </a> </h1> </div> <div class="d-none d-md-block"> <ul class="navbar-nav ml-auto mt-2 mt-lg-0 justify-content-end"> <li class=nav-item> <a href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/fa/changelog.md title="Edit this article" class=nav-link rel="external nofollow noreferrer" target=_blank><img src=/images/mkdocs/edit.svg alt="Edit this article" class=mt-1 height=22></a> </li> <li class=nav-item> <a class=nav-link href=https://github.com/ClickHouse/ClickHouse rel="external nofollow noreferrer"> <img src=/images/index/github.svg alt="GitHub repository" title="Go to GitHub" height=32> </a> </li> <li id=languages-wrapper class="nav-item dropdown"> <div id=languages-dropdown> <a class="nav-link dropdown-toggle d-inline-block mt-1 text-muted" href=# id=lang-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false> <img src=/images/flags/fa.svg alt=فارسی title=فارسی width=32 class="d-inline-block mt-n1"> </a> <div class="dropdown-menu bg-dark" aria-labelledby=lang-dropdown> <a href=/docs/v19.11/en/changelog/ class=dropdown-item> <img src=/images/flags/en.svg alt title width=32 class="d-inline-block mr-2">English </a> <a href=/docs/v19.11/zh/changelog/ class=dropdown-item> <img src=/images/flags/zh.svg alt title width=32 class="d-inline-block mr-2">中文 </a> <a href=/docs/v19.11/es/changelog/ class=dropdown-item> <img src=/images/flags/es.svg alt title width=32 class="d-inline-block mr-2">Español </a> <a href=/docs/v19.11/fr/changelog/ class=dropdown-item> <img src=/images/flags/fr.svg alt title width=32 class="d-inline-block mr-2">Français </a> <a href=/docs/v19.11/ru/changelog/ class=dropdown-item> <img src=/images/flags/ru.svg alt title width=32 class="d-inline-block mr-2">Русский </a> <a href=/docs/v19.11/ja/changelog/ class=dropdown-item> <img src=/images/flags/ja.svg alt title width=32 class="d-inline-block mr-2">日本語 </a> <a href=/docs/v19.11/fa/changelog/ class="dropdown-item disabled"> <img src=/images/flags/fa.svg alt title width=32 class="d-inline-block mr-2">فارسی </a> </div> </div> </li> </ul> </div> <form id=search-form class="form-inline m-0"> <div class=input-group> <div class="input-group-prepend w-100"> <span class="input-group-text bg-secondary-alt text-muted border-0 mr-n1" id=search-icon> <img src=/images/mkdocs/search.svg> </span> <input id=docsearch-input class="form-control bg-secondary-alt text-muted border-0 pl-1" type=search placeholder=Search aria-label=Search> </div> </div> </form> <button id=navbar-toggler class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#sidebar aria-controls=sidebar aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> </nav> <div class="container-fluid text-right"> <div class="row justify-content-end justify-content-xl-center"> <div id=sidebar class="col-xl-2 col-md-4 bg-secondary-alt p-3 d-print-none min-vh-100 overflow-auto"> <div class=overflow-auto> <div id=single-page-switch class="btn-group mb-2 float-right" role=group aria-label="چند صفحه یا یک صفحه"> <a href=.. role=button class="btn btn-dark active" aria-pressed=true> <img src=/images/mkdocs/multi.svg alt="نسخه چند صفحه ای" title="نسخه چند صفحه ای"> </a> <a href=../single/ role=button class="btn btn-dark-alt active" aria-pressed=true> <img src=/images/mkdocs/single.svg alt="نسخه تک صفحه ای" title="نسخه تک صفحه ای"> </a> </div> <div class="dropdown mb-3"> <a class="btn btn-dark dropdown-toggle text-muted" href=# role=button id=select-version data-toggle=dropdown aria-haspopup=true aria-expanded=false> نسخه: <span class=text-light>v19.11</span> </a> <div class="dropdown-menu bg-dark text-muted p-1" aria-labelledby=select-version> <a href=/docs/fa/ class=dropdown-item> <span class=text-light>جدیدترین</span> </a> <a href=/docs/v20.3/fa/ class=dropdown-item>v20.3</a> <a href=/docs/v20.1/fa/ class=dropdown-item>v20.1</a> <a href=/docs/v19.17/fa/ class=dropdown-item>v19.17</a> <a href=/docs/v19.16/fa/ class=dropdown-item>v19.16</a> <a href=/docs/v19.15/fa/ class=dropdown-item>v19.15</a> <a href=/docs/v19.14/fa/ class=dropdown-item>v19.14</a> <a href=/docs/v19.13/fa/ class=dropdown-item>v19.13</a> <a href=/docs/v19.11/fa/ class="dropdown-item disable">v19.11</a> <a href=/docs/v19.10/fa/ class=dropdown-item>v19.10</a> <a href=/docs/v19.9/fa/ class=dropdown-item>v19.9</a> <a href=/docs/v19.8/fa/ class=dropdown-item>v19.8</a> </div> </div> <nav id=sidebar-nav class="nav flex-column mb-5"> <a href=#sidebar-sidebar-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-1 title=Introduction class="nav-link text-light text-wrap dropdown-toggle px-0">Introduction</a> <div id=sidebar-sidebar-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../ title="ClickHouse چیست؟" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ClickHouse چیست؟</a> <a href=../introduction/distinctive_features/ title=" ویژگی های برجسته ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> ویژگی های برجسته ClickHouse</a> <a href=../introduction/features_considered_disadvantages/ title=" ویژگی های از ClickHouse که می تواند معایبی باشد" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> ویژگی های از ClickHouse که می تواند معایبی باشد</a> <a href=../introduction/performance/ title=Performance class="nav-link text-light text-wrap d-inline-block w-100 px-0">Performance</a> <a href=../introduction/ya_metrika_task/ title="The Yandex.Metrica task" class="nav-link text-light text-wrap d-inline-block w-100 px-0">The Yandex.Metrica task</a> </nav> </div> <a href=#sidebar-sidebar-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2 title="Getting started" class="nav-link text-light text-wrap dropdown-toggle px-0">Getting started</a> <div id=sidebar-sidebar-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../getting_started/ title=" شروع به کار" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> شروع به کار</a> <a href=#sidebar-sidebar-2-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2-2 title="Example datasets" class="nav-link text-light text-wrap dropdown-toggle px-0">Example datasets</a> <div id=sidebar-sidebar-2-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../getting_started/example_datasets/ontime/ title=OnTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">OnTime</a> <a href=../getting_started/example_datasets/nyc_taxi/ title=" داده های تاکسی New York" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> داده های تاکسی New York</a> <a href=../getting_started/example_datasets/amplab_benchmark/ title=" بنچمارک AMPLab Big Data" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> بنچمارک AMPLab Big Data</a> <a href=../getting_started/example_datasets/wikistat/ title=WikiStat class="nav-link text-light text-wrap d-inline-block w-100 px-0">WikiStat</a> <a href=../getting_started/example_datasets/criteo/ title=" ترابایت از لاگ های کلیک از سرویس Criteo" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> ترابایت از لاگ های کلیک از سرویس Criteo</a> <a href=../getting_started/example_datasets/star_schema/ title=" بنچمارک Star Schema" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> بنچمارک Star Schema</a> <a href=../getting_started/example_datasets/metrica/ title="Yandex.Metrica Data" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Yandex.Metrica Data</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3 title=Interfaces class="nav-link text-light text-wrap dropdown-toggle px-0">Interfaces</a> <div id=sidebar-sidebar-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../interfaces/ title="Interface ها" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interface ها</a> <a href=../interfaces/cli/ title=" کلاینت Command-line" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> کلاینت Command-line</a> <a href=../interfaces/tcp/ title="Native interface (TCP)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Native interface (TCP)</a> <a href=../interfaces/http/ title="HTTP interface" class="nav-link text-light text-wrap d-inline-block w-100 px-0">HTTP interface</a> <a href=../interfaces/formats/ title=" فرمت های Input و Output" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> فرمت های Input و Output</a> <a href=../interfaces/jdbc/ title=" درایور JDBC" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> درایور JDBC</a> <a href=../interfaces/odbc/ title=" درایور ODBC" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> درایور ODBC</a> <a href=#sidebar-sidebar-3-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-8 title=Third-party class="nav-link text-light text-wrap dropdown-toggle px-0">Third-party</a> <div id=sidebar-sidebar-3-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../interfaces/third-party/client_libraries/ title="کتابخانه های مشتری" class="nav-link text-light text-wrap d-inline-block w-100 px-0">کتابخانه های مشتری</a> <a href=../interfaces/third-party/integrations/ title=یکپارچگی class="nav-link text-light text-wrap d-inline-block w-100 px-0">یکپارچگی</a> <a href=../interfaces/third-party/gui/ title="رابط های بصری" class="nav-link text-light text-wrap d-inline-block w-100 px-0">رابط های بصری</a> <a href=../interfaces/third-party/proxy/ title=پروکسی class="nav-link text-light text-wrap d-inline-block w-100 px-0">پروکسی</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4 title="Data types" class="nav-link text-light text-wrap dropdown-toggle px-0">Data types</a> <div id=sidebar-sidebar-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../data_types/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../data_types/int_uint/ title="UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64</a> <a href=../data_types/float/ title="Float32, Float64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Float32, Float64</a> <a href=../data_types/decimal/ title=Decimal class="nav-link text-light text-wrap d-inline-block w-100 px-0">Decimal</a> <a href=../data_types/boolean/ title=" مقادیر Boolean" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> مقادیر Boolean</a> <a href=../data_types/string/ title=String class="nav-link text-light text-wrap d-inline-block w-100 px-0">String</a> <a href=../data_types/fixedstring/ title=FixedString(N) class="nav-link text-light text-wrap d-inline-block w-100 px-0">FixedString(N)</a> <a href=../data_types/uuid/ title=UUID class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUID</a> <a href=../data_types/date/ title=Date class="nav-link text-light text-wrap d-inline-block w-100 px-0">Date</a> <a href=../data_types/datetime/ title=DateTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime</a> <a href=../data_types/enum/ title=Enum class="nav-link text-light text-wrap d-inline-block w-100 px-0">Enum</a> <a href=../data_types/array/ title=Array(T) class="nav-link text-light text-wrap d-inline-block w-100 px-0">Array(T)</a> <a href=../data_types/nested_data_structures/aggregatefunction/ title="AggregateFunction(name, types_of_arguments...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregateFunction(name, types_of_arguments...)</a> <a href=../data_types/tuple/ title="Tuple(T1, T2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tuple(T1, T2, ...)</a> <a href=../data_types/nullable/ title=Nullable class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nullable</a> <a href=#sidebar-sidebar-4-16 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-16 title="Nested data structures" class="nav-link text-light text-wrap dropdown-toggle px-0">Nested data structures</a> <div id=sidebar-sidebar-4-16 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../data_types/nested_data_structures/nested/ title="Nested(Name1 Type1, Name2 Type2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nested(Name1 Type1, Name2 Type2, ...)</a> </nav> </div> <a href=#sidebar-sidebar-4-17 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-17 title="Special data types" class="nav-link text-light text-wrap dropdown-toggle px-0">Special data types</a> <div id=sidebar-sidebar-4-17 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../data_types/special_data_types/expression/ title=Expression class="nav-link text-light text-wrap d-inline-block w-100 px-0">Expression</a> <a href=../data_types/special_data_types/set/ title=Set class="nav-link text-light text-wrap d-inline-block w-100 px-0">Set</a> <a href=../data_types/special_data_types/nothing/ title=Nothing class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nothing</a> </nav> </div> <a href=#sidebar-sidebar-4-18 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-18 title=Domains class="nav-link text-light text-wrap dropdown-toggle px-0">Domains</a> <div id=sidebar-sidebar-4-18 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../data_types/domains/overview/ title=Overview class="nav-link text-light text-wrap d-inline-block w-100 px-0">Overview</a> <a href=../data_types/domains/ipv4/ title=IPv4 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv4</a> <a href=../data_types/domains/ipv6/ title=IPv6 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv6</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5 title="Table Engines" class="nav-link text-light text-wrap dropdown-toggle px-0">Table Engines</a> <div id=sidebar-sidebar-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/table_engines/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=#sidebar-sidebar-5-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2 title="MergeTree Family" class="nav-link text-light text-wrap dropdown-toggle px-0">MergeTree Family</a> <div id=sidebar-sidebar-5-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/table_engines/mergetree/ title=MergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">MergeTree</a> <a href=../operations/table_engines/replication/ title="Data Replication" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Data Replication</a> <a href=../operations/table_engines/custom_partitioning_key/ title="Custom Partitioning Key" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Custom Partitioning Key</a> <a href=../operations/table_engines/replacingmergetree/ title=ReplacingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">ReplacingMergeTree</a> <a href=../operations/table_engines/summingmergetree/ title=SummingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">SummingMergeTree</a> <a href=../operations/table_engines/aggregatingmergetree/ title=AggregatingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregatingMergeTree</a> <a href=../operations/table_engines/collapsingmergetree/ title=CollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">CollapsingMergeTree</a> <a href=../operations/table_engines/versionedcollapsingmergetree/ title=VersionedCollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">VersionedCollapsingMergeTree</a> <a href=../operations/table_engines/graphitemergetree/ title=GraphiteMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">GraphiteMergeTree</a> </nav> </div> <a href=#sidebar-sidebar-5-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-3 title="Log Family" class="nav-link text-light text-wrap dropdown-toggle px-0">Log Family</a> <div id=sidebar-sidebar-5-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/table_engines/log_family/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../operations/table_engines/stripelog/ title=StripeLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">StripeLog</a> <a href=../operations/table_engines/log/ title=Log class="nav-link text-light text-wrap d-inline-block w-100 px-0">Log</a> <a href=../operations/table_engines/tinylog/ title=TinyLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">TinyLog</a> </nav> </div> <a href=#sidebar-sidebar-5-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-4 title=Integrations class="nav-link text-light text-wrap dropdown-toggle px-0">Integrations</a> <div id=sidebar-sidebar-5-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/table_engines/kafka/ title=Kafka class="nav-link text-light text-wrap d-inline-block w-100 px-0">Kafka</a> <a href=../operations/table_engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> </nav> </div> <a href=#sidebar-sidebar-5-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-5 title=Special class="nav-link text-light text-wrap dropdown-toggle px-0">Special</a> <div id=sidebar-sidebar-5-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/table_engines/distributed/ title=Distributed class="nav-link text-light text-wrap d-inline-block w-100 px-0">Distributed</a> <a href=../operations/table_engines/external_data/ title="External data" class="nav-link text-light text-wrap d-inline-block w-100 px-0">External data</a> <a href=../operations/table_engines/dictionary/ title=Dictionary class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionary</a> <a href=../operations/table_engines/merge/ title=Merge class="nav-link text-light text-wrap d-inline-block w-100 px-0">Merge</a> <a href=../operations/table_engines/file/ title=File class="nav-link text-light text-wrap d-inline-block w-100 px-0">File</a> <a href=../operations/table_engines/null/ title=Null class="nav-link text-light text-wrap d-inline-block w-100 px-0">Null</a> <a href=../operations/table_engines/set/ title=Set class="nav-link text-light text-wrap d-inline-block w-100 px-0">Set</a> <a href=../operations/table_engines/join/ title=Join class="nav-link text-light text-wrap d-inline-block w-100 px-0">Join</a> <a href=../operations/table_engines/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../operations/table_engines/view/ title=View class="nav-link text-light text-wrap d-inline-block w-100 px-0">View</a> <a href=../operations/table_engines/materializedview/ title=MaterializedView class="nav-link text-light text-wrap d-inline-block w-100 px-0">MaterializedView</a> <a href=../operations/table_engines/memory/ title=Memory class="nav-link text-light text-wrap d-inline-block w-100 px-0">Memory</a> <a href=../operations/table_engines/buffer/ title=Buffer class="nav-link text-light text-wrap d-inline-block w-100 px-0">Buffer</a> <a href=../operations/table_engines/jdbc/ title=JDBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC</a> <a href=../operations/table_engines/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6 title="SQL Reference" class="nav-link text-light text-wrap dropdown-toggle px-0">SQL Reference</a> <div id=sidebar-sidebar-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/select/ title=SELECT class="nav-link text-light text-wrap d-inline-block w-100 px-0">SELECT</a> <a href=../query_language/insert_into/ title="INSERT INTO" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INSERT INTO</a> <a href=../query_language/create/ title=CREATE class="nav-link text-light text-wrap d-inline-block w-100 px-0">CREATE</a> <a href=../query_language/alter/ title=ALTER class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALTER</a> <a href=../query_language/system/ title=SYSTEM class="nav-link text-light text-wrap d-inline-block w-100 px-0">SYSTEM</a> <a href=../query_language/misc/ title="Other Kinds of Queries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Other Kinds of Queries</a> <a href=#sidebar-sidebar-6-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8 title=Functions class="nav-link text-light text-wrap dropdown-toggle px-0">Functions</a> <div id=sidebar-sidebar-6-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../query_language/functions/arithmetic_functions/ title=Arithmetic class="nav-link text-light text-wrap d-inline-block w-100 px-0">Arithmetic</a> <a href=../query_language/functions/comparison_functions/ title=Comparison class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comparison</a> <a href=../query_language/functions/logical_functions/ title=Logical class="nav-link text-light text-wrap d-inline-block w-100 px-0">Logical</a> <a href=../query_language/functions/type_conversion_functions/ title="Type Conversion" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Type Conversion</a> <a href=../query_language/functions/date_time_functions/ title="Working with Dates and Times" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with Dates and Times</a> <a href=../query_language/functions/string_functions/ title="Working with strings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with strings</a> <a href=../query_language/functions/string_search_functions/ title="For Searching Strings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">For Searching Strings</a> <a href=../query_language/functions/string_replace_functions/ title="For Replacing in Strings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">For Replacing in Strings</a> <a href=../query_language/functions/conditional_functions/ title="Conditional " class="nav-link text-light text-wrap d-inline-block w-100 px-0">Conditional </a> <a href=../query_language/functions/math_functions/ title=Mathematical class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mathematical</a> <a href=../query_language/functions/rounding_functions/ title=Rounding class="nav-link text-light text-wrap d-inline-block w-100 px-0">Rounding</a> <a href=../query_language/functions/array_functions/ title="Working with Arrays" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with Arrays</a> <a href=../query_language/functions/splitting_merging_functions/ title="Splitting and Merging Strings and Arrays" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Splitting and Merging Strings and Arrays</a> <a href=../query_language/functions/bit_functions/ title=Bit class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bit</a> <a href=../query_language/functions/bitmap_functions/ title=Bitmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bitmap</a> <a href=../query_language/functions/hash_functions/ title=Hash class="nav-link text-light text-wrap d-inline-block w-100 px-0">Hash</a> <a href=../query_language/functions/random_functions/ title="Generating Pseudo-Random Numbers" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Generating Pseudo-Random Numbers</a> <a href=../query_language/functions/encoding_functions/ title=Encoding class="nav-link text-light text-wrap d-inline-block w-100 px-0">Encoding</a> <a href=../query_language/functions/uuid_functions/ title="Working with UUID" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with UUID</a> <a href=../query_language/functions/url_functions/ title="Working with URLs" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with URLs</a> <a href=../query_language/functions/ip_address_functions/ title="Working with IP Addresses" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with IP Addresses</a> <a href=../query_language/functions/json_functions/ title="Working with JSON." class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with JSON.</a> <a href=../query_language/functions/higher_order_functions/ title=Higher-Order class="nav-link text-light text-wrap d-inline-block w-100 px-0">Higher-Order</a> <a href=../query_language/functions/ext_dict_functions/ title="Working with External Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with External Dictionaries</a> <a href=../query_language/functions/ym_dict_functions/ title="Working with Yandex.Metrica Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with Yandex.Metrica Dictionaries</a> <a href=../query_language/functions/in_functions/ title="Implementing the IN Operator" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implementing the IN Operator</a> <a href=../query_language/functions/array_join/ title=arrayJoin class="nav-link text-light text-wrap d-inline-block w-100 px-0">arrayJoin</a> <a href=../query_language/functions/geo/ title="Working with geographical coordinates" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with geographical coordinates</a> <a href=../query_language/functions/functions_for_nulls/ title="Working with Nullable arguments" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with Nullable arguments</a> <a href=../query_language/functions/machine_learning_functions/ title="Machine Learning Functions" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Machine Learning Functions</a> <a href=../query_language/functions/other_functions/ title=Other class="nav-link text-light text-wrap d-inline-block w-100 px-0">Other</a> </nav> </div> <a href=#sidebar-sidebar-6-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-9 title="Aggregate Functions" class="nav-link text-light text-wrap dropdown-toggle px-0">Aggregate Functions</a> <div id=sidebar-sidebar-6-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/agg_functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../query_language/agg_functions/reference/ title=Reference class="nav-link text-light text-wrap d-inline-block w-100 px-0">Reference</a> <a href=../query_language/agg_functions/combinators/ title="Aggregate function combinators" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aggregate function combinators</a> <a href=../query_language/agg_functions/parametric_functions/ title="Parametric aggregate functions" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Parametric aggregate functions</a> </nav> </div> <a href=#sidebar-sidebar-6-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-10 title="Table Functions" class="nav-link text-light text-wrap dropdown-toggle px-0">Table Functions</a> <div id=sidebar-sidebar-6-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/table_functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../query_language/table_functions/file/ title=file class="nav-link text-light text-wrap d-inline-block w-100 px-0">file</a> <a href=../query_language/table_functions/merge/ title=merge class="nav-link text-light text-wrap d-inline-block w-100 px-0">merge</a> <a href=../query_language/table_functions/numbers/ title=numbers class="nav-link text-light text-wrap d-inline-block w-100 px-0">numbers</a> <a href=../query_language/table_functions/remote/ title=remote class="nav-link text-light text-wrap d-inline-block w-100 px-0">remote</a> <a href=../query_language/table_functions/url/ title=url class="nav-link text-light text-wrap d-inline-block w-100 px-0">url</a> <a href=../query_language/table_functions/mysql/ title=mysql class="nav-link text-light text-wrap d-inline-block w-100 px-0">mysql</a> <a href=../query_language/table_functions/jdbc/ title=jdbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">jdbc</a> <a href=../query_language/table_functions/odbc/ title=odbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">odbc</a> </nav> </div> <a href=#sidebar-sidebar-6-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-11 title=Dictionaries class="nav-link text-light text-wrap dropdown-toggle px-0">Dictionaries</a> <div id=sidebar-sidebar-6-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/dicts/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=#sidebar-sidebar-6-11-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-11-2 title="External Dictionaries" class="nav-link text-light text-wrap dropdown-toggle px-0">External Dictionaries</a> <div id=sidebar-sidebar-6-11-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/dicts/external_dicts/ title="General Description" class="nav-link text-light text-wrap d-inline-block w-100 px-0">General Description</a> <a href=../query_language/dicts/external_dicts_dict/ title="Configuring an External Dictionary" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Configuring an External Dictionary</a> <a href=../query_language/dicts/external_dicts_dict_layout/ title="Storing Dictionaries in Memory" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Storing Dictionaries in Memory</a> <a href=../query_language/dicts/external_dicts_dict_lifetime/ title="Dictionary Updates" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionary Updates</a> <a href=../query_language/dicts/external_dicts_dict_sources/ title="Sources of External Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Sources of External Dictionaries</a> <a href=../query_language/dicts/external_dicts_dict_structure/ title="Dictionary Key and Fields" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionary Key and Fields</a> </nav> </div> <a href=../query_language/dicts/internal_dicts/ title="Internal Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Internal Dictionaries</a> <a href=../query_language/operators/ title=Operators class="nav-link text-light text-wrap d-inline-block w-100 px-0">Operators</a> <a href=../query_language/syntax/ title="General Syntax" class="nav-link text-light text-wrap d-inline-block w-100 px-0">General Syntax</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7 title=Operations class="nav-link text-light text-wrap dropdown-toggle px-0">Operations</a> <div id=sidebar-sidebar-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../operations/requirements/ title=Requirements class="nav-link text-light text-wrap d-inline-block w-100 px-0">Requirements</a> <a href=../operations/monitoring/ title=Monitoring class="nav-link text-light text-wrap d-inline-block w-100 px-0">Monitoring</a> <a href=../operations/troubleshooting/ title=Troubleshooting class="nav-link text-light text-wrap d-inline-block w-100 px-0">Troubleshooting</a> <a href=../operations/tips/ title="Usage Recommendations" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Usage Recommendations</a> <a href=../operations/update/ title="ClickHouse Update" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ClickHouse Update</a> <a href=../operations/access_rights/ title="Access Rights" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Access Rights</a> <a href=../operations/backup/ title="Data Backup" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Data Backup</a> <a href=../operations/configuration_files/ title="Configuration Files" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Configuration Files</a> <a href=../operations/quotas/ title=Quotas class="nav-link text-light text-wrap d-inline-block w-100 px-0">Quotas</a> <a href=../operations/system_tables/ title="System Tables" class="nav-link text-light text-wrap d-inline-block w-100 px-0">System Tables</a> <a href=#sidebar-sidebar-7-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-12 title="Server Configuration Parameters" class="nav-link text-light text-wrap dropdown-toggle px-0">Server Configuration Parameters</a> <div id=sidebar-sidebar-7-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/server_settings/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../operations/server_settings/settings/ title="Server Settings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Server Settings</a> </nav> </div> <a href=#sidebar-sidebar-7-13 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-13 title=Settings class="nav-link text-light text-wrap dropdown-toggle px-0">Settings</a> <div id=sidebar-sidebar-7-13 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/settings/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../operations/settings/permissions_for_queries/ title="Permissions for Queries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Permissions for Queries</a> <a href=../operations/settings/query_complexity/ title="Restrictions on Query Complexity" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Restrictions on Query Complexity</a> <a href=../operations/settings/settings/ title=Settings class="nav-link text-light text-wrap d-inline-block w-100 px-0">Settings</a> <a href=../operations/settings/settings_profiles/ title="Settings Profiles" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Settings Profiles</a> <a href=../operations/settings/settings_users/ title="User Settings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">User Settings</a> <a href=../operations/settings/constraints_on_settings/ title="Constraints on Settings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Constraints on Settings</a> </nav> </div> <a href=#sidebar-sidebar-7-14 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-14 title=Utilities class="nav-link text-light text-wrap dropdown-toggle px-0">Utilities</a> <div id=sidebar-sidebar-7-14 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/utils/ title=Overview class="nav-link text-light text-wrap d-inline-block w-100 px-0">Overview</a> <a href=../operations/utils/clickhouse-copier/ title=clickhouse-copier class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-copier</a> <a href=../operations/utils/clickhouse-local/ title=clickhouse-local class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-local</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8 title=F.A.Q. class="nav-link text-light text-wrap dropdown-toggle px-0">F.A.Q.</a> <div id=sidebar-sidebar-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../faq/general/ title="General Questions" class="nav-link text-light text-wrap d-inline-block w-100 px-0">General Questions</a> </nav> </div> <a href=#sidebar-sidebar-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-9 title=Development class="nav-link text-light text-wrap dropdown-toggle px-0">Development</a> <div id=sidebar-sidebar-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../development/architecture/ title="Overview of ClickHouse Architecture" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Overview of ClickHouse Architecture</a> <a href=../development/build/ title="How to Build ClickHouse on Linux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">How to Build ClickHouse on Linux</a> <a href=../development/build_osx/ title="How to Build ClickHouse on Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">How to Build ClickHouse on Mac OS X</a> <a href=../development/style/ title="How to Write C++ code" class="nav-link text-light text-wrap d-inline-block w-100 px-0">How to Write C++ code</a> <a href=../development/tests/ title="How to Run ClickHouse Tests" class="nav-link text-light text-wrap d-inline-block w-100 px-0">How to Run ClickHouse Tests</a> <a href=../development/contrib/ title="Third-Party Libraries Used" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Third-Party Libraries Used</a> </nav> </div> <a href=#sidebar-sidebar-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-10 title="What's New" class="nav-link text-light text-wrap dropdown-toggle px-0">What's New</a> <div id=sidebar-sidebar-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../roadmap/ title=Roadmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">Roadmap</a> <a href=../changelog/ title=Changelog class="nav-link text-white active text-wrap d-inline-block w-100 px-0">Changelog</a> <a href=../security_changelog/ title="Security Changelog" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Security Changelog</a> </nav> </div> <a href=../single/clickhouse_fa.pdf class="nav-link border-top border-secondary mt-3 px-0 pt-3 text-light"> <img src=/images/mkdocs/pdf.svg alt="نسخه PDF" title="نسخه PDF" height=24 class="d-block mr-1 float-left"><div>نسخه PDF</div> </a> </nav> </div> </div> <div id=content-wrapper class="col-md-8 p-2 p-md-5"> <div id=content> <h2 id=clickhouse-release-19-9-4-1-2019-07-05>ClickHouse release 19.9.4.1, 2019-07-05<a class=headerlink href=#clickhouse-release-19-9-4-1-2019-07-05 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok title="Permanent link">&para;</a></h3> <ul> <li>Исправлен segmentation fault в кодеке сжатия Delta в колонках с величинами размером меньше 32 бит. Ошибка могла приводить к повреждениям памяти. <a href=https://github.com/yandex/ClickHouse/pull/5786 rel="external nofollow noreferrer">#5786</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлена ошибка в проверке кусков в LowCardinality колонках. <a href=https://github.com/yandex/ClickHouse/pull/5832 rel="external nofollow noreferrer">#5832</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлен segmentation fault при слиянии кусков с истекшим TTL в случае, когда в блоке присутствуют столбцы, не входящие в структуру таблицы. <a href=https://github.com/yandex/ClickHouse/pull/5819 rel="external nofollow noreferrer">#5819</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Исправлена существовавшая возможность ухода в бесконечное ожидание на низко-приоритетных запросах. <a href=https://github.com/yandex/ClickHouse/pull/5842 rel="external nofollow noreferrer">#5842</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка определения таймзоны по умолчанию (UCT вместо UTC). <a href=https://github.com/yandex/ClickHouse/pull/5828 rel="external nofollow noreferrer">#5828</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка в распределенных запросах вида DROP/ALTER/TRUNCATE/OPTIMIZE ON CLUSTER. <a href=https://github.com/yandex/ClickHouse/pull/5757 rel="external nofollow noreferrer">#5757</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлена ошибка, которая при распределенных запросах могла привести к тому, что некоторые запросы не появлялись в query_log сразу после SYSTEM FLUSH LOGS запроса. <a href=https://github.com/yandex/ClickHouse/pull/5685 rel="external nofollow noreferrer">#5685</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Добавлена отсутствовавшая поддержка константных аргументов для функции <code>evalMLModel</code>. <a href=https://github.com/yandex/ClickHouse/pull/5820 rel="external nofollow noreferrer">#5820</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-7-6-1-2019-07-05>ClickHouse release 19.7.6.1, 2019-07-05<a class=headerlink href=#clickhouse-release-19-7-6-1-2019-07-05 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_1>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_1 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена просадка производительности в методе JOIN в некоторых видах запросов. <a href=https://github.com/yandex/ClickHouse/pull/5192 rel="external nofollow noreferrer">#5192</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> </ul> <h2 id=clickhouse-release-19-8-3-8-2019-06-11>ClickHouse release 19.8.3.8, 2019-06-11<a class=headerlink href=#clickhouse-release-19-8-3-8-2019-06-11 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti>Новые возможности<a class=headerlink href=#novye-vozmozhnosti title="Permanent link">&para;</a></h3> <ul> <li>Добавлены функции для работы с JSON. <a href=https://github.com/yandex/ClickHouse/pull/4686 rel="external nofollow noreferrer">#4686</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>) <a href=https://github.com/yandex/ClickHouse/pull/5124 rel="external nofollow noreferrer">#5124</a>. (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Добавлена функция <code>basename</code>, аналогичная функции <code>basename</code> в различных языках программирования (<code>os.path.basename</code> в python, <code>basename</code> в PHP, и т.д.). Работает с UNIX и Windows подобными путями. <a href=https://github.com/yandex/ClickHouse/pull/5136 rel="external nofollow noreferrer">#5136</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Добавлена возможность указать смещение в секции LIMIT BY с помощью синтаксиса <code>LIMIT n, m BY</code> или <code>LIMIT m OFFSET n BY</code>. <a href=https://github.com/yandex/ClickHouse/pull/5138 rel="external nofollow noreferrer">#5138</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Добавлен новый тип данных <code>SimpleAggregateFunction</code>, который позволяет создавать столбцы с легковесной агрегацией в AggregatingMergeTree. Он может использоваться только с простыми функциями, такими как <code>any</code>,<code>anyLast</code>, <code>sum</code>,<code>min</code>, <code>max</code>.<br> <a href=https://github.com/yandex/ClickHouse/pull/4629 rel="external nofollow noreferrer">#4629</a> (<a href=https://github.com/bgranvea rel="external nofollow noreferrer">Boris Granveaud</a>)</li> <li>Добавлена поддержка неконстантных аргументов в функции <code>ngramDistance</code> <a href=https://github.com/yandex/ClickHouse/pull/5198 rel="external nofollow noreferrer">#5198</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Добавлены функции <code>skewPop</code>, <code>skewSamp</code>, <code>kurtPop</code> и <code>kurtSamp</code>, которые вычисляют для последовательности коэффициент асимметрии, выборочный коэффициент асимметрии, коэффициент эксцесса и выборочный коэффициент эксцесса соответсвенно. <a href=https://github.com/yandex/ClickHouse/pull/5200 rel="external nofollow noreferrer">#5200</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> <li>Добавлена поддержка операции <code>RENAME</code> для движка <code>MaterializedView</code>. <a href=https://github.com/yandex/ClickHouse/pull/5209 rel="external nofollow noreferrer">#5209</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Сервер, позволяющий подключаться к ClickHouse через клиент MySQL. <a href=https://github.com/yandex/ClickHouse/pull/4715 rel="external nofollow noreferrer">#4715</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Добавлены функции <code>toDecimal*OrZero</code> и <code>toDecimal*OrNull</code>. <a href=https://github.com/yandex/ClickHouse/pull/5291 rel="external nofollow noreferrer">#5291</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Добавлена поддержка Decimal в функциях: <code>quantile</code>, <code>quantiles</code>, <code>median</code>, <code>quantileExactWeighted</code>, <code>quantilesExactWeighted</code>, <code>medianExactWeighted</code>. <a href=https://github.com/yandex/ClickHouse/pull/5304 rel="external nofollow noreferrer">#5304</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Добавлена функция <code>toValidUTF8</code>, которая заменяет все некорректные символы в кодировке UTF-8 на заменяющий символ � (U+FFFD). <a href=https://github.com/yandex/ClickHouse/pull/5322 rel="external nofollow noreferrer">#5322</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Добавлена функция <code>format</code>, которая выполняет подстановку в константный шаблон (упрощенный шаблон форматирования, используемый в Python) строк, переданных в аргументах функции. <a href=https://github.com/yandex/ClickHouse/pull/5330 rel="external nofollow noreferrer">#5330</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Добавлена системная таблица <code>system.detached_parts</code>, содержащая информацию о кусках из директории <code>detached</code> для таблиц семейства <code>MergeTree</code>. <a href=https://github.com/yandex/ClickHouse/pull/5353 rel="external nofollow noreferrer">#5353</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Добавлена функция <code>ngramSearch</code> для вычисления несимметричной разности между <code>needle</code> и <code>haystack</code>. <a href=https://github.com/yandex/ClickHouse/pull/5418 rel="external nofollow noreferrer">#5418</a><a href=https://github.com/yandex/ClickHouse/pull/5422 rel="external nofollow noreferrer">#5422</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Реализованы основные методы машинного обучения (стохастическая линейная регрессия и логистическая регрессия) в виде агрегатных функций. Для вычисления весов могут использоваться различные методы (градиентный спуск, градиентный спуск с накоплением импульса, метод Нестерова). Также поддерживаются mini-batches произвольного размера. <a href=https://github.com/yandex/ClickHouse/pull/4943 rel="external nofollow noreferrer">#4943</a> (<a href=https://github.com/Quid37 rel="external nofollow noreferrer">Quid37</a>)</li> <li>Добавлены функции <code>geohashEncode</code> и <code>geohashDecode</code>. <a href=https://github.com/yandex/ClickHouse/pull/5003 rel="external nofollow noreferrer">#5003</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Добавлена агрегатная функция <code>timeSeriesGroupSum</code>, которая агрегирует временные ряды в которых не совпадают моменты. Функция использует линейную интерполяцию между двумя значениями времени, а затем суммирует значения для одного и того же момента. Добавлена агрегатная функция <code>timeSeriesGroupRateSum</code>, которая вычисляет производные по timestamp для рядов, а затем суммирует полученные производные для всех рядов для одного значения timestamp. <a href=https://github.com/yandex/ClickHouse/pull/4542 rel="external nofollow noreferrer">#4542</a> (<a href=https://github.com/LiuYangkuan rel="external nofollow noreferrer">Yangkuan Liu</a>)</li> <li>Добавлены функции <code>IPv4CIDRtoIPv4Range</code> and <code>IPv6CIDRtoIPv6Range</code>, которые вычисляют диапазон подсети, используя CIDR. <a href=https://github.com/yandex/ClickHouse/pull/5095 rel="external nofollow noreferrer">#5095</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Добавлен заголовок X-ClickHouse-Summary при отправке HTTP запроса с включенной настройкой <code>send_progress_in_http_headers</code>. Он содержит инфорцию о X-ClickHouse-Progress, а также информацию о том сколько строк и байт было записано в таблицу и подобное. <a href=https://github.com/yandex/ClickHouse/pull/5116 rel="external nofollow noreferrer">#5116</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> </ul> <h3 id=uluchsheniia>Улучшения<a class=headerlink href=#uluchsheniia title="Permanent link">&para;</a></h3> <ul> <li>Добавлена настройка <code>max_parts_in_total</code> (по умолчанию: 100 000) для таблиц семейства MergeTree, предотвращающая неправильное задание ключа партиционирования #5166. <a href=https://github.com/yandex/ClickHouse/pull/5171 rel="external nofollow noreferrer">#5171</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>clickhouse-obfuscator</code>: теперь seed вычисляется для столбцов путем комбинирования начального seed и имени колонки, а не ее позиции. Это необходимо для того, чтобы оставить таблицы пригодными для JOIN-ов при преобразовании датасетов с несколькими таблицами. <a href=https://github.com/yandex/ClickHouse/pull/5178 rel="external nofollow noreferrer">#5178</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлены функции <code>JSONExtractRaw</code>, <code>JSONExtractKeyAndValues</code>. Функции вида <code>jsonExtract&lt;type&gt;</code> переименованы в <code>JSONExtract&lt;type&gt;</code>. Теперь, в случае ошибки эти функции возвращают соответсвующие типу значения, а не <code>NULL</code>. Теперь возвращаемый тип передается в функцию <code>JSONExtract</code> последним параметром. Если недоступны иструкции AVX2, то JSON функции выполняются с использованием бибилиотеки RapidJSON. Обновлена библиотека Simdjson. <a href=https://github.com/yandex/ClickHouse/pull/5235 rel="external nofollow noreferrer">#5235</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Теперь функции <code>if</code> and <code>multiIf</code> не зависят от условных <code>Nullable</code> типов. <a href=https://github.com/yandex/ClickHouse/pull/5238 rel="external nofollow noreferrer">#5238</a> (<a href=https://github.com/janplus rel="external nofollow noreferrer">Jian Wu</a>)</li> <li>Оператор <code>IN</code> теперь возвращает <code>Null</code> для значений равных <code>Null</code> (аналогично функции <code>Equal</code>). <a href=https://github.com/yandex/ClickHouse/pull/5152 rel="external nofollow noreferrer">#5152</a> (<a href=https://github.com/janplus rel="external nofollow noreferrer">Jian Wu</a>)</li> <li>Добавлена проверка ограничения по времени выполенения запроса через каждые (flush_interval / poll_timeout) строк при чтении из движка Kafka. Это позволяет чаще прерывать чтение из движка Kafka и чаще проверять ограничение по времени на более высоком уровне конвеера выполнения запроса. <a href=https://github.com/yandex/ClickHouse/pull/5249 rel="external nofollow noreferrer">#5249</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Теперь библиотека rdkafka линкуется c bundled библиотекой SASL. Это позволяет использовать SASL SCRAM аутентификацию. <a href=https://github.com/yandex/ClickHouse/pull/5253 rel="external nofollow noreferrer">#5253</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>clickhouse-server: более информативные сообщения об ошибках прослушивания. <a href=https://github.com/yandex/ClickHouse/pull/5268 rel="external nofollow noreferrer">#5268</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>clickhouse-copier: добавлена поддержка словарей в функциях в секции <code>&lt;sharding_key&gt;</code>. <a href=https://github.com/yandex/ClickHouse/pull/5270 rel="external nofollow noreferrer">#5270</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Добавлена настройка <code>kafka_commit_every_batch</code> для регулирования чтения данных из движка Kafka. Позволяет установить вид чтения: после каждого полученного пакета сообщений или после того как блок записан в таблицу. <a href=https://github.com/yandex/ClickHouse/pull/5308 rel="external nofollow noreferrer">#5308</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Добавлена поддержка беззнаковых целых типов отличных от UInt32 в функциях <code>windowFunnel</code>, <code>sequenceMatch</code>. <a href=https://github.com/yandex/ClickHouse/pull/5339 rel="external nofollow noreferrer">#5339</a> <a href=https://github.com/yandex/ClickHouse/pull/5320 rel="external nofollow noreferrer">#5320</a> (<a href=https://github.com/sundy-li rel="external nofollow noreferrer">sundyli</a>)</li> <li>В движке Merge виртуальный столбец с названием <code>_table</code> (содержащий название таблицы) теперь недоступен, если он присутствует в таблицах-источниках. <a href=https://github.com/yandex/ClickHouse/pull/5325 rel="external nofollow noreferrer">#5325</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Более понятные сообщения об ошибках, если чексуммы не совпадают вероятнее всего из-за ошибок на аппаратном уровне. <a href=https://github.com/yandex/ClickHouse/pull/5355 rel="external nofollow noreferrer">#5355</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Для движка <code>Merge</code> добавлена проверка на то, что таблицы-источники поддерживают семплирование. <a href=https://github.com/yandex/ClickHouse/pull/5366 rel="external nofollow noreferrer">#5366</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Теперь после использования MySQL в качестве внешнего словаря закрывается соединение. <a href=https://github.com/yandex/ClickHouse/pull/5395 rel="external nofollow noreferrer">#5395</a> (<a href=https://github.com/clemrodriguez rel="external nofollow noreferrer">Clément Rodriguez</a>)</li> <li>Улучшения в протоколе MySQL Wire. Формат переименован из <code>MySQL</code> to <code>MySQLWire</code>. Теперь SSL недоступно, если не удалось создать SSL контекст. <a href=https://github.com/yandex/ClickHouse/pull/5419 rel="external nofollow noreferrer">#5419</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>clickhouse-client: теперь можно запустить клиент, если файл истории недоступен. <a href=https://github.com/yandex/ClickHouse/pull/5431 rel="external nofollow noreferrer">#5431</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Теперь учитываются настройки запроса при асинхронных вставках в таблицу типа Distributed. <a href=https://github.com/yandex/ClickHouse/pull/4936 rel="external nofollow noreferrer">#4936</a> (<a href=https://github.com/TCeason rel="external nofollow noreferrer">TCeason</a>)</li> <li>Переименованы функции <code>leastSqr</code> в <code>simpleLinearRegression</code>, <code>LinearRegression</code> в <code>linearRegression</code>, <code>LogisticRegression</code> в <code>logisticRegression</code>. <a href=https://github.com/yandex/ClickHouse/pull/5391 rel="external nofollow noreferrer">#5391</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> </ul> <h3 id=uluchsheniia-proizvoditelnosti>Улучшения производительности<a class=headerlink href=#uluchsheniia-proizvoditelnosti title="Permanent link">&para;</a></h3> <ul> <li>Паралелльная обработка кусков в запросах <code>ALTER ... MODIFY</code>. <a href=https://github.com/yandex/ClickHouse/pull/4639 rel="external nofollow noreferrer">#4639</a> (<a href=https://github.com/IvanKush rel="external nofollow noreferrer">Ivan Kush</a>)</li> <li>Оптимизации в обработке регулярных выражений. <a href=https://github.com/yandex/ClickHouse/pull/5193 rel="external nofollow noreferrer">#5193</a> <a href=https://github.com/yandex/ClickHouse/pull/5191 rel="external nofollow noreferrer">#5191</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Теперь столбец правой таблицы, который используется только в секции <code>JOIN ON</code> не добавляется в результат. <a href=https://github.com/yandex/ClickHouse/pull/5260 rel="external nofollow noreferrer">#5260</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Теперь чтение из буфера движка Kafka приостанавливается после первого пустого ответа. Это позволяет не вызывать несколько раз метод <code>ReadBuffer::next()</code> для пустого результата. <a href=https://github.com/yandex/ClickHouse/pull/5283 rel="external nofollow noreferrer">#5283</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Оптимизация функции <code>concat</code> для нескольких аргументов. <a href=https://github.com/yandex/ClickHouse/pull/5357 rel="external nofollow noreferrer">#5357</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Оптимизация запросов. Прокидывание выражения оператора <code>IN</code> при конвертации <code>commа/cross join</code> в <code>inner</code>. <a href=https://github.com/yandex/ClickHouse/pull/5396 rel="external nofollow noreferrer">#5396</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Улучшение реализации LZ4 для более быстрого разжатия данных. <a href=https://github.com/yandex/ClickHouse/pull/5070 rel="external nofollow noreferrer">#5070</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Реализована MSD-сортировка, а также на ее основе частичная сортировка. <a href=https://github.com/yandex/ClickHouse/pull/5129 rel="external nofollow noreferrer">#5129</a> (<a href=https://github.com/kvinty rel="external nofollow noreferrer">Evgenii Pravda</a>)</li> </ul> <h3 id=ispravleniia-oshibok_2>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_2 title="Permanent link">&para;</a></h3> <ul> <li>Исправлено прокидывание необходимых для чтения столбцов в join. <a href=https://github.com/yandex/ClickHouse/pull/5192 rel="external nofollow noreferrer">#5192</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Исправлено неправильное поведение команды <code>sudo service clickhouse-server forcerestart</code> в случае, если сервер запущен при помощи systemd. <a href=https://github.com/yandex/ClickHouse/pull/5204 rel="external nofollow noreferrer">#5204</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлены коды ошибок при передаче кусков (раньше даже при ошибках возвращался код 200). <a href=https://github.com/yandex/ClickHouse/pull/5216 rel="external nofollow noreferrer">#5216</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлено использование типа SimpleAggregateFunction со строками длиннее чем <code>MAX_SMALL_STRING_SIZE</code> <a href=https://github.com/yandex/ClickHouse/pull/5311 rel="external nofollow noreferrer">#5311</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Исправлена ошибка конвертации типа <code>Decimal</code> в <code>Nullable(Decimal)</code> в секции IN. Добавлена возможность конвертации между различными типами Decimal (including different scales). <a href=https://github.com/yandex/ClickHouse/pull/5350 rel="external nofollow noreferrer">#5350</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлено затирание регистров FPU в библиотеке simdjson, которое приводило к неправильным вычислениям в агрегатных функциях <code>uniqHLL</code> и <code>uniqCombined</code>, а также математических функциях, таких как <code>log</code>. <a href=https://github.com/yandex/ClickHouse/pull/5354 rel="external nofollow noreferrer">#5354</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлены обработка константных и неконстантных аргументов одновременно в JSON функциях. <a href=https://github.com/yandex/ClickHouse/pull/5435 rel="external nofollow noreferrer">#5435</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Исправлен возвращаемый тип в функции <code>quantileExact</code> с типом <code>Decimal</code>. <a href=https://github.com/yandex/ClickHouse/pull/5304 rel="external nofollow noreferrer">#5304</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=uluchsheniia-sborki-testirovaniia-i-paketirovaniia>Улучшения сборки, тестирования и пакетирования<a class=headerlink href=#uluchsheniia-sborki-testirovaniia-i-paketirovaniia title="Permanent link">&para;</a></h3> <ul> <li>Исправлены срабатывания address-санитайзера, показывающие потенциальную ошибку use-after-free.<a href=https://github.com/yandex/ClickHouse/pull/5139 rel="external nofollow noreferrer">#5139</a> <a href=https://github.com/yandex/ClickHouse/pull/5143 rel="external nofollow noreferrer">#5143</a> <a href=https://github.com/yandex/ClickHouse/pull/5393 rel="external nofollow noreferrer">#5393</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Тесты производительности перемещены в одну директорию. <a href=https://github.com/yandex/ClickHouse/pull/5158 rel="external nofollow noreferrer">#5158</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлены некоторые тесты производительности. <a href=https://github.com/yandex/ClickHouse/pull/5255 rel="external nofollow noreferrer">#5255</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлена утилита, позволяющая вычислять чексуммы, полученные в результате возможных инверсий битов. Она помогает отлаживать аппаратные ошибки. <a href=https://github.com/yandex/ClickHouse/pull/5334 rel="external nofollow noreferrer">#5334</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Улучшение скрипта для запуска интеграционных тестов. <a href=https://github.com/yandex/ClickHouse/pull/5340 rel="external nofollow noreferrer">#5340</a><a href=https://github.com/yandex/ClickHouse/pull/5360 rel="external nofollow noreferrer">#5360</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Добавлена инструкция о том, как писать тесты производительности. <a href=https://github.com/yandex/ClickHouse/pull/5408 rel="external nofollow noreferrer">#5408</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлена возможность делать подстановки в запросах create, fill и drop в тестах производительности. <a href=https://github.com/yandex/ClickHouse/pull/5367 rel="external nofollow noreferrer">#5367</a> (<a href=https://github.com/stavrolia rel="external nofollow noreferrer">Olga Khvostikova</a>)</li> </ul> <h2 id=clickhouse-release-19-7-5-27-2019-06-09>ClickHouse release 19.7.5.27, 2019-06-09<a class=headerlink href=#clickhouse-release-19-7-5-27-2019-06-09 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_1>Новые возможности<a class=headerlink href=#novye-vozmozhnosti_1 title="Permanent link">&para;</a></h3> <ul> <li>Добавлены функции для битмапов <code>bitmapHasAny</code> и <code>bitmapHasAll</code> (аналогично функциям <code>hasAny</code> и <code>hasAll</code> для массивов). <a href=https://github.com/yandex/ClickHouse/pull/5279 rel="external nofollow noreferrer">#5279</a> (<a href=https://github.com/svladykin rel="external nofollow noreferrer">Sergi Vladykin</a>)</li> </ul> <h3 id=ispravleniia-oshibok_3>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_3 title="Permanent link">&para;</a></h3> <ul> <li>Исправлен segfault при использовании <code>minmax</code> индекса со значениями <code>Null</code>. <a href=https://github.com/yandex/ClickHouse/pull/5246 rel="external nofollow noreferrer">#5246</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Исправлена ошибка 'Not found column', возникавшая в некоторых распределенных запросах. <a href=https://github.com/yandex/ClickHouse/pull/5407 rel="external nofollow noreferrer">#5407</a> (<a href=https://github.com/kvap rel="external nofollow noreferrer">Constantin S. Pan</a>)</li> <li>Исправлена ошибка "Column '0' already exists" в запросах <code>SELECT .. PREWHERE</code> со столбцами с указанным <code>DEFAULT</code> <a href=https://github.com/yandex/ClickHouse/pull/5397 rel="external nofollow noreferrer">#5397</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлен запрос <code>ALTER MODIFY TTL</code> для таблиц типа <code>ReplicatedMergeTree</code>. <a href=https://github.com/yandex/ClickHouse/pull/5539/commits rel="external nofollow noreferrer">#5539</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Теперь сервер не падает, если подписчики Kafka не смогли запуститься. <a href=https://github.com/yandex/ClickHouse/pull/5285 rel="external nofollow noreferrer">#5285</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Исправлены bitmap функции. <a href=https://github.com/yandex/ClickHouse/pull/5359 rel="external nofollow noreferrer">#5359</a> (<a href=https://github.com/andyyzh rel="external nofollow noreferrer">Andy Yang</a>)</li> <li>Исправлено значение <code>element_count</code> в таблице <code>system.dictionaries</code> для словарей типа hashed (теперь не подсчитываются дубликаты). <a href=https://github.com/yandex/ClickHouse/pull/5440 rel="external nofollow noreferrer">#5440</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Для определения имени таймзоны теперь используется переменная среды TZ. В некоторых случаях это помогает правильно определять таймзону по умолчанию. <a href=https://github.com/yandex/ClickHouse/pull/5443 rel="external nofollow noreferrer">#5443</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Убрано неявное преобразование целых типов в функциях <code>dictGetT</code>, т.к. оно работало неправильно. Вместо этого теперь бросается исключение. <a href=https://github.com/yandex/ClickHouse/pull/5446 rel="external nofollow noreferrer">#5446</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлены настройки во внешних данных HTTP запроса. <a href=https://github.com/yandex/ClickHouse/pull/5455 rel="external nofollow noreferrer">#5455</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Исправлена ошибка, приводящая к тому, что куски удалялись только из файловой системы, но не из Zookeeper. <a href=https://github.com/yandex/ClickHouse/pull/5520 rel="external nofollow noreferrer">#5520</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлен segfault в функции <code>bitmapHasAny</code>. <a href=https://github.com/yandex/ClickHouse/pull/5528 rel="external nofollow noreferrer">#5528</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang Yu</a>)</li> <li>Исправлена ошибка, приводящая к тому, что при репликации не вычислялся заново адрес хоста, даже если DNS кеш был сброшен. <a href=https://github.com/yandex/ClickHouse/pull/5534 rel="external nofollow noreferrer">#5534</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлен запрос <code>DROP INDEX IF EXISTS</code>. Теперь запрос <code>ALTER TABLE ... DROP INDEX IF EXISTS ...</code> не выкидывает исключение. <a href=https://github.com/yandex/ClickHouse/pull/5524 rel="external nofollow noreferrer">#5524</a> (<a href=https://github.com/NanoBjorn rel="external nofollow noreferrer">Gleb Novikov</a>)</li> <li>Исправлен тип результируещего столбца в запросе <code>UNION ALL</code>. Раньше могли быть случаи, когда тип и данные столбца были несогласованы. <a href=https://github.com/yandex/ClickHouse/pull/5503 rel="external nofollow noreferrer">#5503</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлена ошибка, вследствие которой поток <code>DDLWorker</code>-а мог быть остановлен, если одна нода удалила <code>znode</code> из очереди задач, а другая уже получила ее, но не успела выполнить. <a href=https://github.com/yandex/ClickHouse/pull/5489 rel="external nofollow noreferrer">#5489</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Исправлена вставка в Distributed таблицы с материализованныси столбцами. <a href=https://github.com/yandex/ClickHouse/pull/5429 rel="external nofollow noreferrer">#5429</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> </ul> <h2 id=clickhouse-release-19-7-3-9-2019-05-30>ClickHouse release 19.7.3.9, 2019-05-30<a class=headerlink href=#clickhouse-release-19-7-3-9-2019-05-30 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_2>Новые возможности<a class=headerlink href=#novye-vozmozhnosti_2 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена возможность ограничить значения конфигурационных параметров,<br> которые может задать пользователь. Эти ограничения устанавливаются в профиле<br> настроек пользователя. <a href=https://github.com/yandex/ClickHouse/pull/4931 rel="external nofollow noreferrer">#4931</a><br> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Добавлен вариант функции <code>groupUniqArray</code> с дополнительным параметром<br> <code>max_size</code>, который ограничивает размер результирующего массива, аналогично<br> функции <code>groupArray(max_size)(x)</code>.<br> <a href=https://github.com/yandex/ClickHouse/pull/5026 rel="external nofollow noreferrer">#5026</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume<br> Tassery</a>)</li> <li>Для входных файлов формата TSVWithNames и CSVWithNames появилась возможность<br> определить порядок колонок в файле исходя из его заголовка. Это поведение<br> управляется конфигурационным параметром <code>input_format_with_names_use_header</code>.<br> <a href=https://github.com/yandex/ClickHouse/pull/5081 rel="external nofollow noreferrer">#5081</a><br> (<a href=https://github.com/Akazz rel="external nofollow noreferrer">Alexander</a>)</li> </ul> <h3 id=ispravleniia-oshibok_4>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_4 title="Permanent link">&para;</a></h3> <ul> <li>Падение в процессе слияния при использовании uncompressed_cache и JOIN<br> (#5197). <a href=https://github.com/yandex/ClickHouse/pull/5133 rel="external nofollow noreferrer">#5133</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila<br> Kutenin</a>)</li> <li>Segmentation fault на запросе к системным таблицам (#5066).<br> <a href=https://github.com/yandex/ClickHouse/pull/5127 rel="external nofollow noreferrer">#5127</a><br> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Потеря загружаемых данных при больших потоках загрузки через KafkaEngine<br> (#4736). <a href=https://github.com/yandex/ClickHouse/pull/5080 rel="external nofollow noreferrer">#5080</a><br> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Исправлен очень редкий data race condition который мог произойти при выполнении запроса с UNION ALL включающего минимум два SELECT из таблиц system.columns, system.tables, system.parts, system.parts_tables или таблиц семейства Merge и одновременно выполняющихся запросов ALTER столбцов соответствующих таблиц. <a href=https://github.com/yandex/ClickHouse/pull/5189 rel="external nofollow noreferrer">#5189</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=uluchsheniia-proizvoditelnosti_1>Улучшения производительности<a class=headerlink href=#uluchsheniia-proizvoditelnosti_1 title="Permanent link">&para;</a></h3> <ul> <li>Используется поразрядная сортировка числовых колонок для <code>ORDER BY</code> без<br> <code>LIMIT</code>. <a href=https://github.com/yandex/ClickHouse/pull/5106 rel="external nofollow noreferrer">#5106</a>,<br> <a href=https://github.com/yandex/ClickHouse/pull/4439 rel="external nofollow noreferrer">#4439</a> (<a href=https://github.com/kvinty rel="external nofollow noreferrer">Evgenii<br> Pravda</a>,<br> <a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a></li> </ul> <h3 id=dokumentatsiia>Документация<a class=headerlink href=#dokumentatsiia title="Permanent link">&para;</a></h3> <ul> <li>Документация для некоторых табличных движков переведена на китайский.<br> <a href=https://github.com/yandex/ClickHouse/pull/5107 rel="external nofollow noreferrer">#5107</a>,<br> <a href=https://github.com/yandex/ClickHouse/pull/5094 rel="external nofollow noreferrer">#5094</a>,<br> <a href=https://github.com/yandex/ClickHouse/pull/5087 rel="external nofollow noreferrer">#5087</a><br> (<a href=https://github.com/AlexZFX rel="external nofollow noreferrer">张风啸</a>,<br> <a href=https://github.com/yandex/ClickHouse/pull/5068 rel="external nofollow noreferrer">#5068</a> (<a href=https://github.com/neverlee rel="external nofollow noreferrer">never<br> lee</a>)</li> </ul> <h3 id=uluchsheniia-sborki-testirovaniia-i-paketirovaniia_1>Улучшения сборки, тестирования и пакетирования<a class=headerlink href=#uluchsheniia-sborki-testirovaniia-i-paketirovaniia_1 title="Permanent link">&para;</a></h3> <ul> <li>Правильно отображаются символы в кодировке UTF-8 в <code>clickhouse-test</code>.<br> <a href=https://github.com/yandex/ClickHouse/pull/5084 rel="external nofollow noreferrer">#5084</a><br> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлен параметр командной строки для <code>clickhouse-client</code>, позволяющий<br> всегда загружать данные подсказок.<br> <a href=https://github.com/yandex/ClickHouse/pull/5102 rel="external nofollow noreferrer">#5102</a><br> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлены некоторые предупреждения PVS-Studio.<br> <a href=https://github.com/yandex/ClickHouse/pull/5082 rel="external nofollow noreferrer">#5082</a><br> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Обновлена библиотека LZ4.<br> <a href=https://github.com/yandex/ClickHouse/pull/5040 rel="external nofollow noreferrer">#5040</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila<br> Kutenin</a>)</li> <li>В зависимости сборки добавлен gperf для поддержки готовящегося PR #5030.<br> <a href=https://github.com/yandex/ClickHouse/pull/5110 rel="external nofollow noreferrer">#5110</a><br> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h2 id=clickhouse-release-19-6-3-18-2019-06-13>ClickHouse release 19.6.3.18, 2019-06-13<a class=headerlink href=#clickhouse-release-19-6-3-18-2019-06-13 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_5>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_5 title="Permanent link">&para;</a></h3> <ul> <li>Исправлено прокидывание условий оператора IN для запросов с табличными функциями <code>mysql</code> and <code>odbc</code> и соответсвующими движками таблиц. <a href=https://github.com/yandex/ClickHouse/pull/5313 rel="external nofollow noreferrer">#5313</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлен deadlock в Zookeeper. <a href=https://github.com/yandex/ClickHouse/pull/5297 rel="external nofollow noreferrer">#5297</a> (<a href=https://github.com/github1youlc rel="external nofollow noreferrer">github1youlc</a>)</li> <li>Для формата CSV добавлена возможность указывать значения типа Decimal в кавычках. <a href=https://github.com/yandex/ClickHouse/pull/5284 rel="external nofollow noreferrer">#5284</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a> </li> <li>Убрана возможность преобразований из float Inf/NaN в Decimal (теперь бросается исключение). <a href=https://github.com/yandex/ClickHouse/pull/5282 rel="external nofollow noreferrer">#5282</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлен data race в запросе <code>RENAME</code>. <a href=https://github.com/yandex/ClickHouse/pull/5247 rel="external nofollow noreferrer">#5247</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Отключен LFAlloc. Использование LFAlloc могло приводить к ошибкам MAP_FAILED при использовании UncompressedCache и в результате к падению запросов на высоконагруженных серверах. <a href=https://github.com/yandex/ClickHouse/commit/cfdba938ce22f16efeec504f7f90206a515b1280 rel="external nofollow noreferrer">cfdba93</a>(<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> </ul> <h2 id=clickhouse-release-19-6-2-11-2019-05-13>ClickHouse release 19.6.2.11, 2019-05-13<a class=headerlink href=#clickhouse-release-19-6-2-11-2019-05-13 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_3>Новые возможности<a class=headerlink href=#novye-vozmozhnosti_3 title="Permanent link">&para;</a></h3> <ul> <li>TTL выражения, позволяющие настроить время жизни и автоматическую очистку данных в таблице или в отдельных её столбцах. <a href=https://github.com/yandex/ClickHouse/pull/4212 rel="external nofollow noreferrer">#4212</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Добавлена поддержка алгоритма сжатия <code>brotli</code> в HTTP ответах (<code>Accept-Encoding: br</code>). Для тела POST запросов, эта возможность уже существовала. <a href=https://github.com/yandex/ClickHouse/pull/4388 rel="external nofollow noreferrer">#4388</a> (<a href=https://github.com/fandyushin rel="external nofollow noreferrer">Mikhail</a>)</li> <li>Добавлена функция <code>isValidUTF8</code> для проверки, содержит ли строка валидные данные в кодировке UTF-8. <a href=https://github.com/yandex/ClickHouse/pull/4934 rel="external nofollow noreferrer">#4934</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Добавлены новое правило балансировки (<code>load_balancing</code>) <code>first_or_random</code> по которому запросы посылаются на первый заданый хост и если он недоступен - на случайные хосты шарда. Полезно для топологий с кросс-репликацией. <a href=https://github.com/yandex/ClickHouse/pull/5012 rel="external nofollow noreferrer">#5012</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> </ul> <h3 id=eksperimentalnye-vozmozhnosti>Экспериментальные возможности<a class=headerlink href=#eksperimentalnye-vozmozhnosti title="Permanent link">&para;</a></h3> <ul> <li>Добавлена настройка <code>index_granularity_bytes</code> (адаптивная гранулярность индекса) для таблиц семейства MergeTree* . <a href=https://github.com/yandex/ClickHouse/pull/4826 rel="external nofollow noreferrer">#4826</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> </ul> <h3 id=uluchsheniia_1>Улучшения<a class=headerlink href=#uluchsheniia_1 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена поддержка для не константных и отрицательных значений аргументов смещения и длины для функции <code>substringUTF8</code>. <a href=https://github.com/yandex/ClickHouse/pull/4989 rel="external nofollow noreferrer">#4989</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Отключение push-down в правую таблицы в left join, левую таблицу в right join, и в обе таблицы в full join. Это исправляет неправильные JOIN результаты в некоторых случаях. <a href=https://github.com/yandex/ClickHouse/pull/4846 rel="external nofollow noreferrer">#4846</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li><code>clickhouse-copier</code>: Автоматическая загрузка конфигурации задачи в zookeeper из <code>--task-file</code> опции <a href=https://github.com/yandex/ClickHouse/pull/4876 rel="external nofollow noreferrer">#4876</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Добавлены подсказки с учётом опечаток для имён движков таблиц и табличных функций. <a href=https://github.com/yandex/ClickHouse/pull/4891 rel="external nofollow noreferrer">#4891</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Поддержка выражений <code>select *</code> и <code>select tablename.*</code> для множественных join без подзапросов <a href=https://github.com/yandex/ClickHouse/pull/4898 rel="external nofollow noreferrer">#4898</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Сообщения об ошибках об отсутствующих столбцах стали более понятными. <a href=https://github.com/yandex/ClickHouse/pull/4915 rel="external nofollow noreferrer">#4915</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=uluchshenie-proizvoditelnosti>Улучшение производительности<a class=headerlink href=#uluchshenie-proizvoditelnosti title="Permanent link">&para;</a></h3> <ul> <li>Существенное ускорение ASOF JOIN <a href=https://github.com/yandex/ClickHouse/pull/4924 rel="external nofollow noreferrer">#4924</a> (<a href=https://github.com/Gladdy rel="external nofollow noreferrer">Martijn Bakker</a>)</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia>Обратно несовместимые изменения<a class=headerlink href=#obratno-nesovmestimye-izmeneniia title="Permanent link">&para;</a></h3> <ul> <li>HTTP заголовок <code>Query-Id</code> переименован в <code>X-ClickHouse-Query-Id</code> для соответствия. <a href=https://github.com/yandex/ClickHouse/pull/4972 rel="external nofollow noreferrer">#4972</a> (<a href=https://github.com/fandyushin rel="external nofollow noreferrer">Mikhail</a>)</li> </ul> <h3 id=ispravleniia-oshibok_6>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_6 title="Permanent link">&para;</a></h3> <ul> <li>Исправлены возможные разыменования нулевого указателя в <code>clickhouse-copier</code>. <a href=https://github.com/yandex/ClickHouse/pull/4900 rel="external nofollow noreferrer">#4900</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлены ошибки в запросах с JOIN + ARRAY JOIN <a href=https://github.com/yandex/ClickHouse/pull/4938 rel="external nofollow noreferrer">#4938</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлено зависание на старте сервера если внешний словарь зависит от другого словаря через использование таблицы из БД с движком <code>Dictionary</code>. <a href=https://github.com/yandex/ClickHouse/pull/4962 rel="external nofollow noreferrer">#4962</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>При использовании <code>distributed_product_mode = 'local'</code> корректно работает использование столбцов локальных таблиц в where/having/order by/... через табличные алиасы. Выкидывает исключение если таблица не имеет алиас. Доступ к столбцам без алиасов пока не возможен. <a href=https://github.com/yandex/ClickHouse/pull/4986 rel="external nofollow noreferrer">#4986</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлен потенциально некорректный результат для <code>SELECT DISTINCT</code> с <code>JOIN</code> <a href=https://github.com/yandex/ClickHouse/pull/5001 rel="external nofollow noreferrer">#5001</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлен очень редкий data race condition который мог произойти при выполнении запроса с UNION ALL включающего минимум два SELECT из таблиц system.columns, system.tables, system.parts, system.parts_tables или таблиц семейства Merge и одновременно выполняющихся запросов ALTER столбцов соответствующих таблиц. <a href=https://github.com/yandex/ClickHouse/pull/5189 rel="external nofollow noreferrer">#5189</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=uluchsheniia-sborki-testirovaniia-paketirovaniia>Улучшения сборки/тестирования/пакетирования<a class=headerlink href=#uluchsheniia-sborki-testirovaniia-paketirovaniia title="Permanent link">&para;</a></h3> <ul> <li>Исправлена неработоспособность тестов, если <code>clickhouse-server</code> запущен на удалённом хосте <a href=https://github.com/yandex/ClickHouse/pull/4713 rel="external nofollow noreferrer">#4713</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li><code>clickhouse-test</code>: Отключена раскраска результата, если команда запускается не в терминале. <a href=https://github.com/yandex/ClickHouse/pull/4937 rel="external nofollow noreferrer">#4937</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li><code>clickhouse-test</code>: Возможность использования не только базы данных test <a href=https://github.com/yandex/ClickHouse/pull/5008 rel="external nofollow noreferrer">#5008</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлены ошибки при запуске тестов под UBSan <a href=https://github.com/yandex/ClickHouse/pull/5037 rel="external nofollow noreferrer">#5037</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Добавлен аллокатор Yandex LFAlloc для аллоцирования MarkCache и UncompressedCache данных разными способами для более надежного отлавливания проездов по памяти <a href=https://github.com/yandex/ClickHouse/pull/4995 rel="external nofollow noreferrer">#4995</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Утилита для упрощения бэкпортирования изменений в старые релизы и составления changelogs. <a href=https://github.com/yandex/ClickHouse/pull/4949 rel="external nofollow noreferrer">#4949</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h2 id=clickhouse-release-19-5-4-22-2019-05-13>ClickHouse release 19.5.4.22, 2019-05-13<a class=headerlink href=#clickhouse-release-19-5-4-22-2019-05-13 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_7>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_7 title="Permanent link">&para;</a></h3> <ul> <li>Исправлены возможные падения в bitmap* функциях <a href=https://github.com/yandex/ClickHouse/pull/5220 rel="external nofollow noreferrer">#5220</a> <a href=https://github.com/yandex/ClickHouse/pull/5228 rel="external nofollow noreferrer">#5228</a> (<a href=https://github.com/andyyzh rel="external nofollow noreferrer">Andy Yang</a>)</li> <li>Исправлен очень редкий data race condition который мог произойти при выполнении запроса с UNION ALL включающего минимум два SELECT из таблиц system.columns, system.tables, system.parts, system.parts_tables или таблиц семейства Merge и одновременно выполняющихся запросов ALTER столбцов соответствующих таблиц. <a href=https://github.com/yandex/ClickHouse/pull/5189 rel="external nofollow noreferrer">#5189</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка <code>Set for IN is not created yet in case of using single LowCardinality column in the left part of IN</code>. Эта ошибка возникала когда LowCardinality столбец была частью primary key. #5031 <a href=https://github.com/yandex/ClickHouse/pull/5154 rel="external nofollow noreferrer">#5154</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Исправление функции retention: только первое соответствующее условие добавлялось в состояние данных. Сейчас все условия которые удовлетворяют в строке данных добавляются в состояние. <a href=https://github.com/yandex/ClickHouse/pull/5119 rel="external nofollow noreferrer">#5119</a> (<a href=https://github.com/nicelulu rel="external nofollow noreferrer">小路</a>)</li> </ul> <h2 id=clickhouse-release-19-5-3-8-2019-04-18>ClickHouse release 19.5.3.8, 2019-04-18<a class=headerlink href=#clickhouse-release-19-5-3-8-2019-04-18 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_8>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_8 title="Permanent link">&para;</a></h3> <ul> <li>Исправлен тип настройки <code>max_partitions_per_insert_block</code> с булевого на UInt64. <a href=https://github.com/yandex/ClickHouse/pull/5028 rel="external nofollow noreferrer">#5028</a> (<a href=https://github.com/mhsekhavat rel="external nofollow noreferrer">Mohammad Hossein Sekhavat</a>)</li> </ul> <h2 id=clickhouse-release-19-5-2-6-2019-04-15>ClickHouse release 19.5.2.6, 2019-04-15<a class=headerlink href=#clickhouse-release-19-5-2-6-2019-04-15 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_4>Новые возможности<a class=headerlink href=#novye-vozmozhnosti_4 title="Permanent link">&para;</a></h3> <ul> <li>Добавлены функции для работы с несколькими регулярными выражениями с помощью библиотеки <a href=https://github.com/intel/hyperscan rel="external nofollow noreferrer">Hyperscan</a>. (<code>multiMatchAny</code>, <code>multiMatchAnyIndex</code>, <code>multiFuzzyMatchAny</code>, <code>multiFuzzyMatchAnyIndex</code>). <a href=https://github.com/yandex/ClickHouse/pull/4780 rel="external nofollow noreferrer">#4780</a>, <a href=https://github.com/yandex/ClickHouse/pull/4841 rel="external nofollow noreferrer">#4841</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Добавлена функция <code>multiSearchFirstPosition</code>. <a href=https://github.com/yandex/ClickHouse/pull/4780 rel="external nofollow noreferrer">#4780</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Реализована возможность указания построчного ограничения доступа к таблицам. <a href=https://github.com/yandex/ClickHouse/pull/4792 rel="external nofollow noreferrer">#4792</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Добавлен новый тип вторичного индекса на базе фильтра Блума (используется в функциях <code>equal</code>, <code>in</code> и <code>like</code>). <a href=https://github.com/yandex/ClickHouse/pull/4499 rel="external nofollow noreferrer">#4499</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Добавлен <code>ASOF JOIN</code> которые позволяет джойнить строки по наиболее близкому известному значению. <a href=https://github.com/yandex/ClickHouse/pull/4774 rel="external nofollow noreferrer">#4774</a> <a href=https://github.com/yandex/ClickHouse/pull/4867 rel="external nofollow noreferrer">#4867</a> <a href=https://github.com/yandex/ClickHouse/pull/4863 rel="external nofollow noreferrer">#4863</a> <a href=https://github.com/yandex/ClickHouse/pull/4875 rel="external nofollow noreferrer">#4875</a> (<a href=https://github.com/Gladdy rel="external nofollow noreferrer">Martijn Bakker</a>, <a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Теперь запрос <code>COMMA JOIN</code> переписывается <code>CROSS JOIN</code>. И затем оба переписываются в <code>INNER JOIN</code>, если это возможно. <a href=https://github.com/yandex/ClickHouse/pull/4661 rel="external nofollow noreferrer">#4661</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=uluchsheniia_2>Улучшения<a class=headerlink href=#uluchsheniia_2 title="Permanent link">&para;</a></h3> <ul> <li>Функции <code>topK</code> и <code>topKWeighted</code> теперь поддерживают произвольный <code>loadFactor</code> (исправляет issue <a href=https://github.com/yandex/ClickHouse/issues/4252 rel="external nofollow noreferrer">#4252</a>). <a href=https://github.com/yandex/ClickHouse/pull/4634 rel="external nofollow noreferrer">#4634</a> (<a href=https://github.com/kirillDanshin rel="external nofollow noreferrer">Kirill Danshin</a>)</li> <li>Добавлена возможность использования настройки <code>parallel_replicas_count &gt; 1</code> для таблиц без семплирования (ранее настройка просто игнорировалась). <a href=https://github.com/yandex/ClickHouse/pull/4637 rel="external nofollow noreferrer">#4637</a> (<a href=https://github.com/digitalist rel="external nofollow noreferrer">Alexey Elymanov</a>)</li> <li>Поддержан запрос <code>CREATE OR REPLACE VIEW</code>. Позволяет создать <code>VIEW</code> или изменить запрос в одном выражении. <a href=https://github.com/yandex/ClickHouse/pull/4654 rel="external nofollow noreferrer">#4654</a> (<a href=https://github.com/bgranvea rel="external nofollow noreferrer">Boris Granveaud</a>)</li> <li>Движок таблиц <code>Buffer</code> теперь поддерживает <code>PREWHERE</code>. <a href=https://github.com/yandex/ClickHouse/pull/4671 rel="external nofollow noreferrer">#4671</a> (<a href=https://github.com/LiuYangkuan rel="external nofollow noreferrer">Yangkuan Liu</a>)</li> <li>Теперь реплицируемые таблицы могу стартовать в <code>readonly</code> режиме даже при отсутствии zookeeper. <a href=https://github.com/yandex/ClickHouse/pull/4691 rel="external nofollow noreferrer">#4691</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлено мигание прогресс-бара в clickhouse-client. Проблема была наиболее заметна при использовании <code>FORMAT Null</code> в потоковых запросах. <a href=https://github.com/yandex/ClickHouse/pull/4811 rel="external nofollow noreferrer">#4811</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлена возможность отключения функций, использующих библиотеку <code>hyperscan</code>, для пользователей, чтобы ограничить возможное неконтролируемое потребление ресурсов. <a href=https://github.com/yandex/ClickHouse/pull/4816 rel="external nofollow noreferrer">#4816</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлено логирование номера версии во все исключения. <a href=https://github.com/yandex/ClickHouse/pull/4824 rel="external nofollow noreferrer">#4824</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Добавлено ограничение на размер строк и количество параметров в функции <code>multiMatch</code>. Теперь они принимают строки умещающиеся в <code>unsigned int</code>. <a href=https://github.com/yandex/ClickHouse/pull/4834 rel="external nofollow noreferrer">#4834</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Улучшено использование памяти и обработка ошибок в Hyperscan. <a href=https://github.com/yandex/ClickHouse/pull/4866 rel="external nofollow noreferrer">#4866</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Теперь системная таблица <code>system.graphite_detentions</code> заполняется из конфигурационного файла для таблиц семейства <code>*GraphiteMergeTree</code>. <a href=https://github.com/yandex/ClickHouse/pull/4584 rel="external nofollow noreferrer">#4584</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer">Mikhail f. Shiryaev</a>)</li> <li>Функция <code>trigramDistance</code> переименована в функцию <code>ngramDistance</code>. Добавлено несколько функций с <code>CaseInsensitive</code> и <code>UTF</code>. <a href=https://github.com/yandex/ClickHouse/pull/4602 rel="external nofollow noreferrer">#4602</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Улучшено вычисление вторичных индексов. <a href=https://github.com/yandex/ClickHouse/pull/4640 rel="external nofollow noreferrer">#4640</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Теперь обычные колонки, а также колонки <code>DEFAULT</code>, <code>MATERIALIZED</code> и <code>ALIAS</code> хранятся в одном списке (исправляет issue <a href=https://github.com/yandex/ClickHouse/issues/2867 rel="external nofollow noreferrer">#2867</a>). <a href=https://github.com/yandex/ClickHouse/pull/4707 rel="external nofollow noreferrer">#4707</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> </ul> <h3 id=ispravleniia-oshibok_9>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_9 title="Permanent link">&para;</a></h3> <ul> <li>В случае невозможности выделить память вместо вызова <code>std::terminate</code> бросается исключение <code>std::bad_alloc</code>. <a href=https://github.com/yandex/ClickHouse/pull/4665 rel="external nofollow noreferrer">#4665</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлены ошибки чтения capnproto из буфера. Иногда файлы не загружались по HTTP. <a href=https://github.com/yandex/ClickHouse/pull/4674 rel="external nofollow noreferrer">#4674</a> (<a href=https://github.com/smirnov-vs rel="external nofollow noreferrer">Vladislav</a>)</li> <li>Исправлена ошибка <code>Unknown log entry type: 0</code> после запроса <code>OPTIMIZE TABLE FINAL</code>. <a href=https://github.com/yandex/ClickHouse/pull/4683 rel="external nofollow noreferrer">#4683</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>При передаче неправильных аргументов в <code>hasAny</code> и <code>hasAll</code> могла происходить ошибка сегментирования. <a href=https://github.com/yandex/ClickHouse/pull/4698 rel="external nofollow noreferrer">#4698</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлен дедлок, который мог происходить при запросе <code>DROP DATABASE dictionary</code>. <a href=https://github.com/yandex/ClickHouse/pull/4701 rel="external nofollow noreferrer">#4701</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено неопределенное поведение в функциях <code>median</code> и <code>quantile</code>. <a href=https://github.com/yandex/ClickHouse/pull/4702 rel="external nofollow noreferrer">#4702</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> <li>Исправлено определение уровня сжатия при указании настройки <code>network_compression_method</code> в нижнем регистре. Было сломано в v19.1. <a href=https://github.com/yandex/ClickHouse/pull/4706 rel="external nofollow noreferrer">#4706</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Настройка <code>&lt;timezone&gt;UTC&lt;/timezone&gt;</code> больше не игнорируется (исправляет issue <a href=https://github.com/yandex/ClickHouse/issues/4658 rel="external nofollow noreferrer">#4658</a>). <a href=https://github.com/yandex/ClickHouse/pull/4718 rel="external nofollow noreferrer">#4718</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлено поведение функции <code>histogram</code> с <code>Distributed</code> таблицами. <a href=https://github.com/yandex/ClickHouse/pull/4741 rel="external nofollow noreferrer">#4741</a> (<a href=https://github.com/olegkv rel="external nofollow noreferrer">olegkv</a>)</li> <li>Исправлено срабатывание thread-санитайзера с ошибкой <code>destroy of a locked mutex</code>. <a href=https://github.com/yandex/ClickHouse/pull/4742 rel="external nofollow noreferrer">#4742</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено срабатывание thread-санитайзера при завершении сервера, вызванное гонкой при использовании системных логов. Также исправлена потенциальная ошибка use-after-free при завершении сервера в котором был включен <code>part_log</code>. <a href=https://github.com/yandex/ClickHouse/pull/4758 rel="external nofollow noreferrer">#4758</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена перепроверка кусков в <code>ReplicatedMergeTreeAlterThread</code> при появлении ошибок. <a href=https://github.com/yandex/ClickHouse/pull/4772 rel="external nofollow noreferrer">#4772</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Исправлена работа арифметических операций с промежуточными состояниями агрегатных функций для константных аргументов (таких как результаты подзапросов). <a href=https://github.com/yandex/ClickHouse/pull/4776 rel="external nofollow noreferrer">#4776</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Теперь имена колонок всегда экранируются в файлах с метаинформацией. В противном случае было невозможно создать таблицу с колонкой с именем <code>index</code>. <a href=https://github.com/yandex/ClickHouse/pull/4782 rel="external nofollow noreferrer">#4782</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено падение в запросе <code>ALTER ... MODIFY ORDER BY</code> к <code>Distributed</code> таблице. <a href=https://github.com/yandex/ClickHouse/pull/4790 rel="external nofollow noreferrer">#4790</a> (<a href=https://github.com/TCeason rel="external nofollow noreferrer">TCeason</a>)</li> <li>Исправлена ошибка сегментирования при запросах с <code>JOIN ON</code> и включенной настройкой <code>enable_optimize_predicate_expression</code>. <a href=https://github.com/yandex/ClickHouse/pull/4794 rel="external nofollow noreferrer">#4794</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Исправлено добавление лишней строки после чтения protobuf-сообщения из таблицы с движком <code>Kafka</code>. <a href=https://github.com/yandex/ClickHouse/pull/4808 rel="external nofollow noreferrer">#4808</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Исправлено падение при запросе с <code>JOIN ON</code> с не <code>nullable</code> и nullable колонкой. Также исправлено поведение при появлении <code>NULLs</code> среди ключей справа в<code>ANY JOIN</code> + <code>join_use_nulls</code>. <a href=https://github.com/yandex/ClickHouse/pull/4815 rel="external nofollow noreferrer">#4815</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлена ошибка сегментирования в <code>clickhouse-copier</code>. <a href=https://github.com/yandex/ClickHouse/pull/4835 rel="external nofollow noreferrer">#4835</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлена гонка при <code>SELECT</code> запросе из <code>system.tables</code> если таблица была конкурентно переименована или к ней был применен <code>ALTER</code> запрос. <a href=https://github.com/yandex/ClickHouse/pull/4836 rel="external nofollow noreferrer">#4836</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена гонка при скачивании куска, который уже является устаревшим. <a href=https://github.com/yandex/ClickHouse/pull/4839 rel="external nofollow noreferrer">#4839</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена редкая гонка при <code>RENAME</code> запросах к таблицам семейства MergeTree. <a href=https://github.com/yandex/ClickHouse/pull/4844 rel="external nofollow noreferrer">#4844</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка сегментирования в функции <code>arrayIntersect</code>. Ошибка возникала при вызове функции с константными и не константными аргументами. <a href=https://github.com/yandex/ClickHouse/pull/4847 rel="external nofollow noreferrer">#4847</a> (<a href=https://github.com/fancyqlx rel="external nofollow noreferrer">Lixiang Qian</a>)</li> <li>Исправлена редкая ошибка при чтении из колонки типа <code>Array(LowCardinality)</code>, которая возникала, если в колонке содержалось большее количество подряд идущих пустых массивов. <a href=https://github.com/yandex/ClickHouse/pull/4850 rel="external nofollow noreferrer">#4850</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Исправлено паление в запроса с <code>FULL/RIGHT JOIN</code> когда объединение происходило по nullable и не nullable колонке. <a href=https://github.com/yandex/ClickHouse/pull/4855 rel="external nofollow noreferrer">#4855</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлена ошибка <code>No message received</code>, возникавшая при скачивании кусков между репликами. <a href=https://github.com/yandex/ClickHouse/pull/4856 rel="external nofollow noreferrer">#4856</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлена ошибка в функции <code>arrayIntersect</code> приводившая к неправильным результатам в случае нескольких повторяющихся значений в массиве. <a href=https://github.com/yandex/ClickHouse/pull/4871 rel="external nofollow noreferrer">#4871</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Исправлена гонка при конкурентных <code>ALTER COLUMN</code> запросах, которая могла приводить к падению сервера (исправляет issue <a href=https://github.com/yandex/ClickHouse/issues/3421 rel="external nofollow noreferrer">#3421</a>). <a href=https://github.com/yandex/ClickHouse/pull/4592 rel="external nofollow noreferrer">#4592</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Исправлен некорректный результат в <code>FULL/RIGHT JOIN</code> запросах с константной колонкой. <a href=https://github.com/yandex/ClickHouse/pull/4723 rel="external nofollow noreferrer">#4723</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлено появление дубликатов в <code>GLOBAL JOIN</code> со звездочкой. <a href=https://github.com/yandex/ClickHouse/pull/4705 rel="external nofollow noreferrer">#4705</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлено определение параметров кодеков в запросах <code>ALTER MODIFY</code>, если тип колонки не был указан. <a href=https://github.com/yandex/ClickHouse/pull/4883 rel="external nofollow noreferrer">#4883</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Функции <code>cutQueryStringAndFragment()</code> и <code>queryStringAndFragment()</code> теперь работают корректно, когда <code>URL</code> содержит фрагмент, но не содержит запроса. <a href=https://github.com/yandex/ClickHouse/pull/4894 rel="external nofollow noreferrer">#4894</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Исправлена редкая ошибка, возникавшая при установке настройки <code>min_bytes_to_use_direct_io</code> больше нуля. Она возникла при необходимости сдвинутся в файле, который уже прочитан до конца. <a href=https://github.com/yandex/ClickHouse/pull/4897 rel="external nofollow noreferrer">#4897</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлено неправильное определение типов аргументов для агрегатных функций с <code>LowCardinality</code> аргументами (исправляет <a href=https://github.com/yandex/ClickHouse/issues/4919 rel="external nofollow noreferrer">#4919</a>). <a href=https://github.com/yandex/ClickHouse/pull/4922 rel="external nofollow noreferrer">#4922</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Исправлена неверная квалификация имён в <code>GLOBAL JOIN</code>. <a href=https://github.com/yandex/ClickHouse/pull/4969 rel="external nofollow noreferrer">#4969</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлен результат функции <code>toISOWeek</code> для 1970 года. <a href=https://github.com/yandex/ClickHouse/pull/4988 rel="external nofollow noreferrer">#4988</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено дублирование <code>DROP</code>, <code>TRUNCATE</code> и <code>OPTIMIZE</code> запросов, когда они выполнялись <code>ON CLUSTER</code> для семейства таблиц <code>ReplicatedMergeTree*</code>. <a href=https://github.com/yandex/ClickHouse/pull/4991 rel="external nofollow noreferrer">#4991</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_1>Обратно несовместимые изменения<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_1 title="Permanent link">&para;</a></h3> <ul> <li>Настройка <code>insert_sample_with_metadata</code> переименована в <code>input_format_defaults_for_omitted_fields</code>. <a href=https://github.com/yandex/ClickHouse/pull/4771 rel="external nofollow noreferrer">#4771</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Добавлена настройка <code>max_partitions_per_insert_block</code> (со значением по умолчанию 100). Если вставляемый блок содержит большое количество партиций, то бросается исключение. Лимит можно убрать выставив настройку в 0 (не рекомендуется). <a href=https://github.com/yandex/ClickHouse/pull/4845 rel="external nofollow noreferrer">#4845</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Функции мультипоиска были переименованы (<code>multiPosition</code> в <code>multiSearchAllPositions</code>, <code>multiSearch</code> в <code>multiSearchAny</code>, <code>firstMatch</code> в <code>multiSearchFirstIndex</code>). <a href=https://github.com/yandex/ClickHouse/pull/4780 rel="external nofollow noreferrer">#4780</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> </ul> <h3 id=uluchshenie-proizvoditelnosti_1>Улучшение производительности<a class=headerlink href=#uluchshenie-proizvoditelnosti_1 title="Permanent link">&para;</a></h3> <ul> <li>Оптимизирован поиска с помощью алгоритма Volnitsky с помощью инлайнинга. Это дает около 5-10% улучшения производительности поиска для запросов ищущих множество слов или много одинаковых биграмм. <a href=https://github.com/yandex/ClickHouse/pull/4862 rel="external nofollow noreferrer">#4862</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Исправлено снижение производительности при выставлении настройки <code>use_uncompressed_cache</code> больше нуля для запросов, данные которых целиком лежат в кеше. <a href=https://github.com/yandex/ClickHouse/pull/4913 rel="external nofollow noreferrer">#4913</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> </ul> <h3 id=uluchsheniia-sborki-testirovaniia-paketirovaniia_1>Улучшения сборки/тестирования/пакетирования<a class=headerlink href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_1 title="Permanent link">&para;</a></h3> <ul> <li>Более строгие настройки для debug-сборок: более гранулярные маппинги памяти и использование ASLR; добавлена защита памяти для кеша засечек и индекса. Это позволяет найти больше ошибок порчи памяти, которые не обнаруживают address-санитайзер и thread-санитайзер. <a href=https://github.com/yandex/ClickHouse/pull/4632 rel="external nofollow noreferrer">#4632</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлены настройки <code>ENABLE_PROTOBUF</code>, <code>ENABLE_PARQUET</code> и <code>ENABLE_BROTLI</code> которые позволяют отключить соответствующие компоненты. <a href=https://github.com/yandex/ClickHouse/pull/4669 rel="external nofollow noreferrer">#4669</a> (<a href=https://github.com/silviucpp rel="external nofollow noreferrer">Silviu Caragea</a>)</li> <li>Теперь при зависании запросов во время работы тестов будет показан список запросов и стек-трейсы всех потоков. <a href=https://github.com/yandex/ClickHouse/pull/4675 rel="external nofollow noreferrer">#4675</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлены ретраи при ошибке <code>Connection loss</code> в <code>clickhouse-test</code>. <a href=https://github.com/yandex/ClickHouse/pull/4682 rel="external nofollow noreferrer">#4682</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлена возможность сборки под FreeBSD в <code>packager</code>-скрипт. <a href=https://github.com/yandex/ClickHouse/pull/4712 rel="external nofollow noreferrer">#4712</a> <a href=https://github.com/yandex/ClickHouse/pull/4748 rel="external nofollow noreferrer">#4748</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Теперь при установке предлагается установить пароль для пользователя <code>'default'</code>. <a href=https://github.com/yandex/ClickHouse/pull/4725 rel="external nofollow noreferrer">#4725</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Убраны предупреждения из библиотеки <code>rdkafka</code> при сборке. <a href=https://github.com/yandex/ClickHouse/pull/4740 rel="external nofollow noreferrer">#4740</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлена возможность сборки без поддержки ssl. <a href=https://github.com/yandex/ClickHouse/pull/4750 rel="external nofollow noreferrer">#4750</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Добавлена возможность запускать докер-образ с clickhouse-server из под любого пользователя. <a href=https://github.com/yandex/ClickHouse/pull/4753 rel="external nofollow noreferrer">#4753</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer">Mikhail f. Shiryaev</a>)</li> <li>Boost обновлен до 1.69. <a href=https://github.com/yandex/ClickHouse/pull/4793 rel="external nofollow noreferrer">#4793</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Отключено использование <code>mremap</code> при сборке с thread-санитайзером, что приводило к ложным срабатываниям. Исправлены ошибки thread-санитайзера в stateful-тестах. <a href=https://github.com/yandex/ClickHouse/pull/4859 rel="external nofollow noreferrer">#4859</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлен тест проверяющий использование схемы форматов для HTTP-интерфейса. <a href=https://github.com/yandex/ClickHouse/pull/4864 rel="external nofollow noreferrer">#4864</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> </ul> <h2 id=clickhouse-release-19-4-4-33-2019-04-17>ClickHouse release 19.4.4.33, 2019-04-17<a class=headerlink href=#clickhouse-release-19-4-4-33-2019-04-17 title="Permanent link">&para;</a></h2> <h3 id=ispravlenie-oshibok>Исправление ошибок<a class=headerlink href=#ispravlenie-oshibok title="Permanent link">&para;</a></h3> <ul> <li>В случае невозможности выделить память вместо вызова <code>std::terminate</code> бросается исключение <code>std::bad_alloc</code>. <a href=https://github.com/yandex/ClickHouse/pull/4665 rel="external nofollow noreferrer">#4665</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлены ошибки чтения capnproto из буфера. Иногда файлы не загружались по HTTP. <a href=https://github.com/yandex/ClickHouse/pull/4674 rel="external nofollow noreferrer">#4674</a> (<a href=https://github.com/smirnov-vs rel="external nofollow noreferrer">Vladislav</a>)</li> <li>Исправлена ошибка <code>Unknown log entry type: 0</code> после запроса <code>OPTIMIZE TABLE FINAL</code>. <a href=https://github.com/yandex/ClickHouse/pull/4683 rel="external nofollow noreferrer">#4683</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>При передаче неправильных аргументов в <code>hasAny</code> и <code>hasAll</code> могла происходить ошибка сегментирования. <a href=https://github.com/yandex/ClickHouse/pull/4698 rel="external nofollow noreferrer">#4698</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлен дедлок, который мог происходить при запросе <code>DROP DATABASE dictionary</code>. <a href=https://github.com/yandex/ClickHouse/pull/4701 rel="external nofollow noreferrer">#4701</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено неопределенное поведение в функциях <code>median</code> и <code>quantile</code>. <a href=https://github.com/yandex/ClickHouse/pull/4702 rel="external nofollow noreferrer">#4702</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> <li>Исправлено определение уровня сжатия при указании настройки <code>network_compression_method</code> в нижнем регистре. Было сломано в v19.1. <a href=https://github.com/yandex/ClickHouse/pull/4706 rel="external nofollow noreferrer">#4706</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Настройка <code>&lt;timezone&gt;UTC&lt;/timezone&gt;</code> больше не игнорируется (исправляет issue <a href=https://github.com/yandex/ClickHouse/issues/4658 rel="external nofollow noreferrer">#4658</a>). <a href=https://github.com/yandex/ClickHouse/pull/4718 rel="external nofollow noreferrer">#4718</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлено поведение функции <code>histogram</code> с <code>Distributed</code> таблицами. <a href=https://github.com/yandex/ClickHouse/pull/4741 rel="external nofollow noreferrer">#4741</a> (<a href=https://github.com/olegkv rel="external nofollow noreferrer">olegkv</a>)</li> <li>Исправлено срабатывание thread-санитайзера с ошибкой <code>destroy of a locked mutex</code>. <a href=https://github.com/yandex/ClickHouse/pull/4742 rel="external nofollow noreferrer">#4742</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено срабатывание thread-санитайзера при завершении сервера, вызванное гонкой при использовании системных логов. Также исправлена потенциальная ошибка use-after-free при завершении сервера в котором был включен <code>part_log</code>. <a href=https://github.com/yandex/ClickHouse/pull/4758 rel="external nofollow noreferrer">#4758</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена перепроверка кусков в <code>ReplicatedMergeTreeAlterThread</code> при появлении ошибок. <a href=https://github.com/yandex/ClickHouse/pull/4772 rel="external nofollow noreferrer">#4772</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Исправлена работа арифметических операций с промежуточными состояниями агрегатных функций для константных аргументов (таких как результаты подзапросов). <a href=https://github.com/yandex/ClickHouse/pull/4776 rel="external nofollow noreferrer">#4776</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Теперь имена колонок всегда экранируются в файлах с метаинформацией. В противном случае было невозможно создать таблицу с колонкой с именем <code>index</code>. <a href=https://github.com/yandex/ClickHouse/pull/4782 rel="external nofollow noreferrer">#4782</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено падение в запросе <code>ALTER ... MODIFY ORDER BY</code> к <code>Distributed</code> таблице. <a href=https://github.com/yandex/ClickHouse/pull/4790 rel="external nofollow noreferrer">#4790</a> (<a href=https://github.com/TCeason rel="external nofollow noreferrer">TCeason</a>)</li> <li>Исправлена ошибка сегментирования при запросах с <code>JOIN ON</code> и включенной настройкой <code>enable_optimize_predicate_expression</code>. <a href=https://github.com/yandex/ClickHouse/pull/4794 rel="external nofollow noreferrer">#4794</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Исправлено добавление лишней строки после чтения protobuf-сообщения из таблицы с движком <code>Kafka</code>. <a href=https://github.com/yandex/ClickHouse/pull/4808 rel="external nofollow noreferrer">#4808</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Исправлена ошибка сегментирования в <code>clickhouse-copier</code>. <a href=https://github.com/yandex/ClickHouse/pull/4835 rel="external nofollow noreferrer">#4835</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлена гонка при <code>SELECT</code> запросе из <code>system.tables</code> если таблица была конкурентно переименована или к ней был применен <code>ALTER</code> запрос. <a href=https://github.com/yandex/ClickHouse/pull/4836 rel="external nofollow noreferrer">#4836</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена гонка при скачивании куска, который уже является устаревшим. <a href=https://github.com/yandex/ClickHouse/pull/4839 rel="external nofollow noreferrer">#4839</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена редкая гонка при <code>RENAME</code> запросах к таблицам семейства MergeTree. <a href=https://github.com/yandex/ClickHouse/pull/4844 rel="external nofollow noreferrer">#4844</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка сегментирования в функции <code>arrayIntersect</code>. Ошибка возникала при вызове функции с константными и не константными аргументами. <a href=https://github.com/yandex/ClickHouse/pull/4847 rel="external nofollow noreferrer">#4847</a> (<a href=https://github.com/fancyqlx rel="external nofollow noreferrer">Lixiang Qian</a>)</li> <li>Исправлена редкая ошибка при чтении из колонки типа <code>Array(LowCardinality)</code>, которая возникала, если в колонке содержалось большее количество подряд идущих пустых массивов. <a href=https://github.com/yandex/ClickHouse/pull/4850 rel="external nofollow noreferrer">#4850</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Исправлена ошибка <code>No message received</code>, возникавшая при скачивании кусков между репликами. <a href=https://github.com/yandex/ClickHouse/pull/4856 rel="external nofollow noreferrer">#4856</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлена ошибка в функции <code>arrayIntersect</code> приводившая к неправильным результатам в случае нескольких повторяющихся значений в массиве. <a href=https://github.com/yandex/ClickHouse/pull/4871 rel="external nofollow noreferrer">#4871</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Исправлена гонка при конкурентных <code>ALTER COLUMN</code> запросах, которая могла приводить к падению сервера (исправляет issue <a href=https://github.com/yandex/ClickHouse/issues/3421 rel="external nofollow noreferrer">#3421</a>). <a href=https://github.com/yandex/ClickHouse/pull/4592 rel="external nofollow noreferrer">#4592</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Исправлено определение параметров кодеков в запросах <code>ALTER MODIFY</code>, если тип колонки не был указан. <a href=https://github.com/yandex/ClickHouse/pull/4883 rel="external nofollow noreferrer">#4883</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Функции <code>cutQueryStringAndFragment()</code> и <code>queryStringAndFragment()</code> теперь работают корректно, когда <code>URL</code> содержит фрагмент, но не содержит запроса. <a href=https://github.com/yandex/ClickHouse/pull/4894 rel="external nofollow noreferrer">#4894</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Исправлена редкая ошибка, возникавшая при установке настройки <code>min_bytes_to_use_direct_io</code> больше нуля. Она возникла при необходимости сдвинутся в файле, который уже прочитан до конца. <a href=https://github.com/yandex/ClickHouse/pull/4897 rel="external nofollow noreferrer">#4897</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлено неправильное определение типов аргументов для агрегатных функций с <code>LowCardinality</code> аргументами (исправляет <a href=https://github.com/yandex/ClickHouse/issues/4919 rel="external nofollow noreferrer">#4919</a>). <a href=https://github.com/yandex/ClickHouse/pull/4922 rel="external nofollow noreferrer">#4922</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Исправлен результат функции <code>toISOWeek</code> для 1970 года. <a href=https://github.com/yandex/ClickHouse/pull/4988 rel="external nofollow noreferrer">#4988</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено дублирование <code>DROP</code>, <code>TRUNCATE</code> и <code>OPTIMIZE</code> запросов, когда они выполнялись <code>ON CLUSTER</code> для семейства таблиц <code>ReplicatedMergeTree*</code>. <a href=https://github.com/yandex/ClickHouse/pull/4991 rel="external nofollow noreferrer">#4991</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> </ul> <h3 id=uluchsheniia_3>Улучшения<a class=headerlink href=#uluchsheniia_3 title="Permanent link">&para;</a></h3> <ul> <li>Теперь обычные колонки, а также колонки <code>DEFAULT</code>, <code>MATERIALIZED</code> и <code>ALIAS</code> хранятся в одном списке (исправляет issue <a href=https://github.com/yandex/ClickHouse/issues/2867 rel="external nofollow noreferrer">#2867</a>). <a href=https://github.com/yandex/ClickHouse/pull/4707 rel="external nofollow noreferrer">#4707</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> </ul> <h2 id=clickhouse-release-19-4-3-11-2019-04-02>ClickHouse release 19.4.3.11, 2019-04-02<a class=headerlink href=#clickhouse-release-19-4-3-11-2019-04-02 title="Permanent link">&para;</a></h2> <h3 id=ispravlenie-oshibok_1>Исправление ошибок<a class=headerlink href=#ispravlenie-oshibok_1 title="Permanent link">&para;</a></h3> <ul> <li>Исправлено паление в запроса с <code>FULL/RIGHT JOIN</code> когда объединение происходило по nullable и не nullable колонке. <a href=https://github.com/yandex/ClickHouse/pull/4855 rel="external nofollow noreferrer">#4855</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлена ошибка сегментирования в <code>clickhouse-copier</code>. <a href=https://github.com/yandex/ClickHouse/pull/4835 rel="external nofollow noreferrer">#4835</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=uluchsheniia-sborki-testirovaniia-paketirovaniia_2>Улучшения сборки/тестирования/пакетирования<a class=headerlink href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_2 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена возможность запускать докер-образ с clickhouse-server из под любого пользователя. <a href=https://github.com/yandex/ClickHouse/pull/4753 rel="external nofollow noreferrer">#4753</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer">Mikhail f. Shiryaev</a>)</li> </ul> <h2 id=clickhouse-release-19-4-2-7-2019-03-30>ClickHouse release 19.4.2.7, 2019-03-30<a class=headerlink href=#clickhouse-release-19-4-2-7-2019-03-30 title="Permanent link">&para;</a></h2> <h3 id=ispravlenie-oshibok_2>Исправление ошибок<a class=headerlink href=#ispravlenie-oshibok_2 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена редкая ошибка при чтении из колонки типа <code>Array(LowCardinality)</code>, которая возникала, если в колонке содержалось большее количество подряд идущих пустых массивов. <a href=https://github.com/yandex/ClickHouse/pull/4850 rel="external nofollow noreferrer">#4850</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> </ul> <h2 id=clickhouse-release-19-4-1-3-2019-03-19>ClickHouse release 19.4.1.3, 2019-03-19<a class=headerlink href=#clickhouse-release-19-4-1-3-2019-03-19 title="Permanent link">&para;</a></h2> <h3 id=ispravlenie-oshibok_3>Исправление ошибок<a class=headerlink href=#ispravlenie-oshibok_3 title="Permanent link">&para;</a></h3> <ul> <li>Исправлено поведение удаленных запросов, которые одновременно содержали <code>LIMIT BY</code> и <code>LIMIT</code>. Раньше для таких запросов <code>LIMIT</code> мог быть выполнен до <code>LIMIT BY</code>, что приводило к перефильтрации. <a href=https://github.com/yandex/ClickHouse/pull/4708 rel="external nofollow noreferrer">#4708</a> (<a href=https://github.com/kvap rel="external nofollow noreferrer">Constantin S. Pan</a>)</li> </ul> <h2 id=clickhouse-release-19-4-0-49-2019-03-09>ClickHouse release 19.4.0.49, 2019-03-09<a class=headerlink href=#clickhouse-release-19-4-0-49-2019-03-09 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_5>Новые возможности<a class=headerlink href=#novye-vozmozhnosti_5 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена полная поддержка формата <code>Protobuf</code> (чтение и запись, вложенные структуры данных). <a href=https://github.com/yandex/ClickHouse/pull/4174 rel="external nofollow noreferrer">#4174</a> <a href=https://github.com/yandex/ClickHouse/pull/4493 rel="external nofollow noreferrer">#4493</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Добавлены функции для работы с битовыми масками с использованием библиотеки Roaring Bitmaps. <a href=https://github.com/yandex/ClickHouse/pull/4207 rel="external nofollow noreferrer">#4207</a> (<a href=https://github.com/andyyzh rel="external nofollow noreferrer">Andy Yang</a>) <a href=https://github.com/yandex/ClickHouse/pull/4568 rel="external nofollow noreferrer">#4568</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Поддержка формата <code>Parquet</code> <a href=https://github.com/yandex/ClickHouse/pull/4448 rel="external nofollow noreferrer">#4448</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Вычисление расстояния между строками с помощью подсчёта N-грам - для приближённого сравнения строк. Алгоритм похож на q-gram metrics в языке R. <a href=https://github.com/yandex/ClickHouse/pull/4466 rel="external nofollow noreferrer">#4466</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Движок таблиц GraphiteMergeTree поддерживает отдельные шаблоны для правил агрегации и для правил времени хранения. <a href=https://github.com/yandex/ClickHouse/pull/4426 rel="external nofollow noreferrer">#4426</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer">Mikhail f. Shiryaev</a>)</li> <li>Добавлены настройки <code>max_execution_speed</code> и <code>max_execution_speed_bytes</code> для того, чтобы ограничить потребление ресурсов запросами. Добавлена настройка <code>min_execution_speed_bytes</code> в дополнение к <code>min_execution_speed</code>. <a href=https://github.com/yandex/ClickHouse/pull/4430 rel="external nofollow noreferrer">#4430</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Добавлена функция <code>flatten</code> - конвертация многомерных массивов в плоский массив. <a href=https://github.com/yandex/ClickHouse/pull/4555 rel="external nofollow noreferrer">#4555</a> <a href=https://github.com/yandex/ClickHouse/pull/4409 rel="external nofollow noreferrer">#4409</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>, <a href=https://github.com/kzon rel="external nofollow noreferrer">kzon</a>)</li> <li>Добавлены функции <code>arrayEnumerateDenseRanked</code> и <code>arrayEnumerateUniqRanked</code> (похожа на <code>arrayEnumerateUniq</code> но позволяет указать глубину, на которую следует смотреть в многомерные массивы). <a href=https://github.com/yandex/ClickHouse/pull/4475 rel="external nofollow noreferrer">#4475</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>) <a href=https://github.com/yandex/ClickHouse/pull/4601 rel="external nofollow noreferrer">#4601</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлена поддержка множества JOIN в одном запросе без подзапросов, с некоторыми ограничениями: без звёздочки и без алиасов сложных выражений в ON/WHERE/GROUP BY/... <a href=https://github.com/yandex/ClickHouse/pull/4462 rel="external nofollow noreferrer">#4462</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=ispravleniia-oshibok_10>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_10 title="Permanent link">&para;</a></h3> <ul> <li>Этот релиз также содержит все исправления из 19.3 и 19.1.</li> <li>Исправлена ошибка во вторичных индексах (экспериментальная возможность): порядок гранул при INSERT был неверным. <a href=https://github.com/yandex/ClickHouse/pull/4407 rel="external nofollow noreferrer">#4407</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Исправлена работа вторичного индекса (экспериментальная возможность) типа <code>set</code> для столбцов типа <code>Nullable</code> и <code>LowCardinality</code>. Ранее их использование вызывало ошибку <code>Data type must be deserialized with multiple streams</code> при запросе SELECT. <a href=https://github.com/yandex/ClickHouse/pull/4594 rel="external nofollow noreferrer">#4594</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Правильное запоминание времени последнего обновления при полной перезагрузке словарей типа <code>executable</code>. <a href=https://github.com/yandex/ClickHouse/pull/4551 rel="external nofollow noreferrer">#4551</a> (<a href=https://github.com/temoon rel="external nofollow noreferrer">Tema Novikov</a>)</li> <li>Исправлена неработоспособность прогресс-бара, возникшая в версии 19.3 <a href=https://github.com/yandex/ClickHouse/pull/4627 rel="external nofollow noreferrer">#4627</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Исправлены неправильные значения MemoryTracker, если кусок памяти был уменьшен в размере, в очень редких случаях. <a href=https://github.com/yandex/ClickHouse/pull/4619 rel="external nofollow noreferrer">#4619</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено undefined behaviour в ThreadPool <a href=https://github.com/yandex/ClickHouse/pull/4612 rel="external nofollow noreferrer">#4612</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено очень редкое падение с сообщением <code>mutex lock failed: Invalid argument</code>, которое могло произойти, если таблица типа MergeTree удалялась одновременно с SELECT. <a href=https://github.com/yandex/ClickHouse/pull/4608 rel="external nofollow noreferrer">#4608</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Совместимость ODBC драйвера с типом данных <code>LowCardinality</code> <a href=https://github.com/yandex/ClickHouse/pull/4381 rel="external nofollow noreferrer">#4381</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправление ошибки <code>AIOcontextPool: Found io_event with unknown id 0</code> под ОС FreeBSD <a href=https://github.com/yandex/ClickHouse/pull/4438 rel="external nofollow noreferrer">#4438</a> (<a href=https://github.com/urgordeadbeef rel="external nofollow noreferrer">urgordeadbeef</a>)</li> <li>Таблица <code>system.part_log</code> создавалась независимо от того, была ли она объявлена в конфигурации. <a href=https://github.com/yandex/ClickHouse/pull/4483 rel="external nofollow noreferrer">#4483</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено undefined behaviour в функции <code>dictIsIn</code> для словарей типа <code>cache</code>. <a href=https://github.com/yandex/ClickHouse/pull/4515 rel="external nofollow noreferrer">#4515</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлен deadlock в случае, если запрос SELECT блокирует одну и ту же таблицу несколько раз (например - из разных потоков, либо при выполнении разных подзапросов) и одновременно с этим производится DDL запрос. <a href=https://github.com/yandex/ClickHouse/pull/4535 rel="external nofollow noreferrer">#4535</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Настройка <code>compile_expressions</code> выключена по-умолчанию до тех пор, пока мы не зафиксируем исходники используемой библиотеки <code>LLVM</code> и не будем проверять её под <code>ASan</code> (сейчас библиотека LLVM берётся из системы). <a href=https://github.com/yandex/ClickHouse/pull/4579 rel="external nofollow noreferrer">#4579</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлено падение по <code>std::terminate</code>, если <code>invalidate_query</code> для внешних словарей с источником <code>clickhouse</code> вернул неправильный результат (пустой; более чем одну строку; более чем один столбец). Исправлена ошибка, из-за которой запрос <code>invalidate_query</code> производился каждые пять секунд, независимо от указанного <code>lifetime</code>. <a href=https://github.com/yandex/ClickHouse/pull/4583 rel="external nofollow noreferrer">#4583</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлен deadlock в случае, если запрос <code>invalidate_query</code> для внешнего словаря с источником <code>clickhouse</code> использовал таблицу <code>system.dictionaries</code> или базу данных типа <code>Dictionary</code> (редкий случай). <a href=https://github.com/yandex/ClickHouse/pull/4599 rel="external nofollow noreferrer">#4599</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена работа CROSS JOIN с пустым WHERE <a href=https://github.com/yandex/ClickHouse/pull/4598 rel="external nofollow noreferrer">#4598</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлен segfault в функции <code>replicate</code> с константным аргументом. <a href=https://github.com/yandex/ClickHouse/pull/4603 rel="external nofollow noreferrer">#4603</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена работа predicate pushdown (настройка <code>enable_optimize_predicate_expression</code>) с лямбда-функциями. <a href=https://github.com/yandex/ClickHouse/pull/4408 rel="external nofollow noreferrer">#4408</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Множественные исправления для множества JOIN в одном запросе. <a href=https://github.com/yandex/ClickHouse/pull/4595 rel="external nofollow noreferrer">#4595</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=uluchsheniia_4>Улучшения<a class=headerlink href=#uluchsheniia_4 title="Permanent link">&para;</a></h3> <ul> <li>Поддержка алиасов в секции JOIN ON для правой таблицы <a href=https://github.com/yandex/ClickHouse/pull/4412 rel="external nofollow noreferrer">#4412</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Используются правильные алиасы в случае множественных JOIN с подзапросами. <a href=https://github.com/yandex/ClickHouse/pull/4474 rel="external nofollow noreferrer">#4474</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлена логика работы predicate pushdown (настройка <code>enable_optimize_predicate_expression</code>) для JOIN. <a href=https://github.com/yandex/ClickHouse/pull/4387 rel="external nofollow noreferrer">#4387</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h3 id=uluchsheniia-proizvoditelnosti_2>Улучшения производительности<a class=headerlink href=#uluchsheniia-proizvoditelnosti_2 title="Permanent link">&para;</a></h3> <ul> <li>Улучшена эвристика оптимизации "перенос в PREWHERE". <a href=https://github.com/yandex/ClickHouse/pull/4405 rel="external nofollow noreferrer">#4405</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Используются настоящие lookup таблицы вместо хэш-таблиц в случае 8 и 16 битных ключей. Интерфейс хэш-таблиц обобщён, чтобы поддерживать этот случай. <a href=https://github.com/yandex/ClickHouse/pull/4536 rel="external nofollow noreferrer">#4536</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Улучшена производительность сравнения строк. <a href=https://github.com/yandex/ClickHouse/pull/4564 rel="external nofollow noreferrer">#4564</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Очередь DDL операций (для запросов ON CLUSTER) очищается в отдельном потоке, чтобы не замедлять основную работу. <a href=https://github.com/yandex/ClickHouse/pull/4502 rel="external nofollow noreferrer">#4502</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Даже если настройка <code>min_bytes_to_use_direct_io</code> выставлена в 1, не каждый файл открывался в режиме O_DIRECT, потому что размер файлов иногда недооценивался на размер одного сжатого блока. <a href=https://github.com/yandex/ClickHouse/pull/4526 rel="external nofollow noreferrer">#4526</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=uluchsheniia-sborki-testirovaniia-paketirovaniia_3>Улучшения сборки/тестирования/пакетирования<a class=headerlink href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_3 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена поддержка компилятора clang-9 <a href=https://github.com/yandex/ClickHouse/pull/4604 rel="external nofollow noreferrer">#4604</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлены неправильные <code>__asm__</code> инструкции <a href=https://github.com/yandex/ClickHouse/pull/4621 rel="external nofollow noreferrer">#4621</a> (<a href=https://github.com/podshumok rel="external nofollow noreferrer">Konstantin Podshumok</a>)</li> <li>Добавлена поддержка задания настроек выполнения запросов для <code>clickhouse-performance-test</code> из командной строки. <a href=https://github.com/yandex/ClickHouse/pull/4437 rel="external nofollow noreferrer">#4437</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Тесты словарей перенесены в интеграционные тесты. <a href=https://github.com/yandex/ClickHouse/pull/4477 rel="external nofollow noreferrer">#4477</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>В набор автоматизированных тестов производительности добавлены запросы, находящиеся в разделе "benchmark" на официальном сайте. <a href=https://github.com/yandex/ClickHouse/pull/4496 rel="external nofollow noreferrer">#4496</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправления сборки в случае использования внешних библиотек lz4 и xxhash. <a href=https://github.com/yandex/ClickHouse/pull/4495 rel="external nofollow noreferrer">#4495</a> (<a href=https://github.com/orivej rel="external nofollow noreferrer">Orivej Desh</a>)</li> <li>Исправлен undefined behaviour, если функция <code>quantileTiming</code> была вызвана с отрицательным или нецелым аргументом (обнаружено с помощью fuzz test под undefined behaviour sanitizer). <a href=https://github.com/yandex/ClickHouse/pull/4506 rel="external nofollow noreferrer">#4506</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлены опечатки в коде. <a href=https://github.com/yandex/ClickHouse/pull/4531 rel="external nofollow noreferrer">#4531</a> (<a href=https://github.com/sdk2 rel="external nofollow noreferrer">sdk2</a>)</li> <li>Исправлена сборка под Mac. <a href=https://github.com/yandex/ClickHouse/pull/4371 rel="external nofollow noreferrer">#4371</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Исправлена сборка под FreeBSD и для некоторых необычных конфигурациях сборки. <a href=https://github.com/yandex/ClickHouse/pull/4444 rel="external nofollow noreferrer">#4444</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h2 id=clickhouse-release-19-3-7-2019-03-12>ClickHouse release 19.3.7, 2019-03-12<a class=headerlink href=#clickhouse-release-19-3-7-2019-03-12 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_11>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_11 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка в #3920. Ошибка проявлялась в виде случайных повреждений кэша (сообщения <code>Unknown codec family code</code>, <code>Cannot seek through file</code>) и segfault. Ошибка впервые возникла в 19.1 и присутствует во всех версиях до 19.1.10 и 19.3.6. <a href=https://github.com/yandex/ClickHouse/pull/4623 rel="external nofollow noreferrer">#4623</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-3-6-2019-03-02>ClickHouse release 19.3.6, 2019-03-02<a class=headerlink href=#clickhouse-release-19-3-6-2019-03-02 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_12>Исправления ошибок<a class=headerlink href=#ispravleniia-oshibok_12 title="Permanent link">&para;</a></h3> <ul> <li>Если в пуле потоков было более 1000 потоков, то при выходе из потока, вызывается <code>std::terminate</code>. <a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a> <a href=https://github.com/yandex/ClickHouse/pull/4485 rel="external nofollow noreferrer">#4485</a> <a href=https://github.com/yandex/ClickHouse/pull/4505 rel="external nofollow noreferrer">#4505</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Теперь возможно создавать таблицы <code>ReplicatedMergeTree*</code> с комментариями столбцов без указания DEFAULT, а также с CODEC но без COMMENT и DEFAULT. Исправлено сравнение CODEC друг с другом. <a href=https://github.com/yandex/ClickHouse/pull/4523 rel="external nofollow noreferrer">#4523</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлено падение при JOIN по массивам и кортежам. <a href=https://github.com/yandex/ClickHouse/pull/4552 rel="external nofollow noreferrer">#4552</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлено падение <code>clickhouse-copier</code> с сообщением <code>ThreadStatus not created</code>. <a href=https://github.com/yandex/ClickHouse/pull/4540 rel="external nofollow noreferrer">#4540</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлено зависание сервера при завершении работы в случае использования распределённых DDL. <a href=https://github.com/yandex/ClickHouse/pull/4472 rel="external nofollow noreferrer">#4472</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>В сообщениях об ошибке при парсинге текстовых форматов, выдавались неправильные номера столбцов, в случае, если номер больше 10. <a href=https://github.com/yandex/ClickHouse/pull/4484 rel="external nofollow noreferrer">#4484</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=uluchsheniia-sborki-testirovaniia-paketirovaniia_4>Улучшения сборки/тестирования/пакетирования<a class=headerlink href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_4 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена сборка с включенным AVX. <a href=https://github.com/yandex/ClickHouse/pull/4527 rel="external nofollow noreferrer">#4527</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена поддержка расширенных метрик выполнения запроса в случае, если ClickHouse был собран на системе с новым ядром Linux, а запускается на системе с существенно более старым ядром. <a href=https://github.com/yandex/ClickHouse/pull/4541 rel="external nofollow noreferrer">#4541</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> <li>Продолжение работы в случае невозможности применить настройку <code>core_dump.size_limit</code> с выводом предупреждения. <a href=https://github.com/yandex/ClickHouse/pull/4473 rel="external nofollow noreferrer">#4473</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Удалено <code>inline</code> для <code>void readBinary(...)</code> в <code>Field.cpp</code>. <a href=https://github.com/yandex/ClickHouse/pull/4530 rel="external nofollow noreferrer">#4530</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> </ul> <h2 id=clickhouse-release-19-3-5-2019-02-21>ClickHouse release 19.3.5, 2019-02-21<a class=headerlink href=#clickhouse-release-19-3-5-2019-02-21 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_13>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_13 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка обработки длинных http-запросов на вставку на стороне сервера. <a href=https://github.com/yandex/ClickHouse/pull/4454 rel="external nofollow noreferrer">#4454</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлена обратная несовместимость со старыми версиями, появившаяся из-за некорректной реализации настройки <code>send_logs_level</code>. <a href=https://github.com/yandex/ClickHouse/pull/4445 rel="external nofollow noreferrer">#4445</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена обратная несовместимость табличной функции <code>remote</code>, появившаяся из-за добавления комментариев колонок. <a href=https://github.com/yandex/ClickHouse/pull/4446 rel="external nofollow noreferrer">#4446</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-3-4-2019-02-16>ClickHouse release 19.3.4, 2019-02-16<a class=headerlink href=#clickhouse-release-19-3-4-2019-02-16 title="Permanent link">&para;</a></h2> <h3 id=uluchsheniia_5>Улучшения:<a class=headerlink href=#uluchsheniia_5 title="Permanent link">&para;</a></h3> <ul> <li>При выполнении запроса <code>ATTACH TABLE</code> при проверке ограничений на используемую память теперь не учитывается память, занимаемая индексом таблицы. Это позволяет избежать ситуации, когда невозможно сделать <code>ATTACH TABLE</code> после соответствующего <code>DETACH TABLE</code>. <a href=https://github.com/yandex/ClickHouse/pull/4396 rel="external nofollow noreferrer">#4396</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Немного увеличены ограничения на максимальный размер строки и массива, полученные от ZooKeeper. Это позволяет продолжать работу после увеличения настройки ZooKeeper <code>CLIENT_JVMFLAGS=-Djute.maxbuffer=...</code>. <a href=https://github.com/yandex/ClickHouse/pull/4398 rel="external nofollow noreferrer">#4398</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Теперь реплику, отключенную на длительный период, можно восстановить, даже если в её очереди скопилось огромное число записей. <a href=https://github.com/yandex/ClickHouse/pull/4399 rel="external nofollow noreferrer">#4399</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Для вторичных индексов типа <code>set</code> добавлен обязательный параметр (максимальное число хранимых значений). <a href=https://github.com/yandex/ClickHouse/pull/4386 rel="external nofollow noreferrer">#4386</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> </ul> <h3 id=ispravleniia-oshibok_14>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_14 title="Permanent link">&para;</a></h3> <ul> <li>Исправлен неверный результат запроса с модификатором <code>WITH ROLLUP</code> при группировке по единственному столбцу типа <code>LowCardinality</code>. <a href=https://github.com/yandex/ClickHouse/pull/4384 rel="external nofollow noreferrer">#4384</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Исправлена ошибка во вторичном индексе типа <code>set</code> (гранулы, в которых было больше, чем <code>max_rows</code> строк, игнорировались). <a href=https://github.com/yandex/ClickHouse/pull/4386 rel="external nofollow noreferrer">#4386</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Исправлена подстановка alias-ов в запросах с подзапросом, содержащим этот же alias (<a href=https://github.com/yandex/ClickHouse/issues/4110 rel="external nofollow noreferrer">#4110</a>). <a href=https://github.com/yandex/ClickHouse/pull/4351 rel="external nofollow noreferrer">#4351</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=uluchsheniia-sborki-testirovaniia-paketirovaniia_5>Улучшения сборки/тестирования/пакетирования:<a class=headerlink href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_5 title="Permanent link">&para;</a></h3> <ul> <li>Множество исправлений для сборки под FreeBSD. <a href=https://github.com/yandex/ClickHouse/pull/4397 rel="external nofollow noreferrer">#4397</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Возможность запускать <code>clickhouse-server</code> для stateless тестов из docker-образа. <a href=https://github.com/yandex/ClickHouse/pull/4347 rel="external nofollow noreferrer">#4347</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> </ul> <h2 id=clickhouse-release-19-3-3-2019-02-13>ClickHouse release 19.3.3, 2019-02-13<a class=headerlink href=#clickhouse-release-19-3-3-2019-02-13 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_6>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_6 title="Permanent link">&para;</a></h3> <ul> <li>Добавлен запрос <code>KILL MUTATION</code>, который позволяет удалять мутации, которые по какой-то причине не могут выполниться. В таблицу <code>system.mutations</code> для облегчения диагностики добавлены столбцы <code>latest_failed_part</code>, <code>latest_fail_time</code>, <code>latest_fail_reason</code>. <a href=https://github.com/yandex/ClickHouse/pull/4287 rel="external nofollow noreferrer">#4287</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Добавлена агрегатная функция <code>entropy</code>, которая вычисляет энтропию Шеннона. <a href=https://github.com/yandex/ClickHouse/pull/4238 rel="external nofollow noreferrer">#4238</a> (<a href=https://github.com/Quid37 rel="external nofollow noreferrer">Quid37</a>)</li> <li>Добавлена обобщённая реализация функции <code>arrayWithConstant</code>. <a href=https://github.com/yandex/ClickHouse/pull/4322 rel="external nofollow noreferrer">#4322</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлен оператор сравнения <code>NOT BETWEEN</code>. <a href=https://github.com/yandex/ClickHouse/pull/4228 rel="external nofollow noreferrer">#4228</a> (<a href=https://github.com/nezed rel="external nofollow noreferrer">Dmitry Naumov</a>)</li> <li>Добавлена функция <code>sumMapFiltered</code> - вариант <code>sumMap</code>, позволяющий указать набор ключей, по которым будет производиться суммирование. <a href=https://github.com/yandex/ClickHouse/pull/4129 rel="external nofollow noreferrer">#4129</a> (<a href=https://github.com/ercolanelli-leo rel="external nofollow noreferrer">Léo Ercolanelli</a>)</li> <li>Добавлена функция <code>sumMapWithOverflow</code>. <a href=https://github.com/yandex/ClickHouse/pull/4151 rel="external nofollow noreferrer">#4151</a> (<a href=https://github.com/ercolanelli-leo rel="external nofollow noreferrer">Léo Ercolanelli</a>)</li> <li>Добавлена поддержка <code>Nullable</code> типов в табличной функции <code>mysql</code>. <a href=https://github.com/yandex/ClickHouse/pull/4198 rel="external nofollow noreferrer">#4198</a> (<a href=https://github.com/edonin rel="external nofollow noreferrer">Emmanuel Donin de Rosière</a>)</li> <li>Добавлена поддержка произвольных константных выражений в секции <code>LIMIT</code>. <a href=https://github.com/yandex/ClickHouse/pull/4246 rel="external nofollow noreferrer">#4246</a> (<a href=https://github.com/k3box rel="external nofollow noreferrer">k3box</a>)</li> <li>Добавлена агрегатная функция <code>topKWeighted</code> - вариант <code>topK</code>, позволяющий задавать (целый неотрицательный) вес добавляемого значения. <a href=https://github.com/yandex/ClickHouse/pull/4245 rel="external nofollow noreferrer">#4245</a> (<a href=https://github.com/andrewgolman rel="external nofollow noreferrer">Andrew Golman</a>)</li> <li>Движок <code>Join</code> теперь поддерживает настройку <code>join_any_take_last_row</code>, которая позволяет перезаписывать значения для существующих ключей. <a href=https://github.com/yandex/ClickHouse/pull/3973 rel="external nofollow noreferrer">#3973</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Добавлена функция <code>toStartOfInterval</code>. <a href=https://github.com/yandex/ClickHouse/pull/4304 rel="external nofollow noreferrer">#4304</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Добавлена функция <code>toStartOfTenMinutes</code>. <a href=https://github.com/yandex/ClickHouse/pull/4298 rel="external nofollow noreferrer">#4298</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Добавлен формат <code>RowBinaryWithNamesAndTypes</code>. <a href=https://github.com/yandex/ClickHouse/pull/4200 rel="external nofollow noreferrer">#4200</a> (<a href=https://github.com/DarkWanderer rel="external nofollow noreferrer">Oleg V. Kozlyuk</a>)</li> <li>Добавлены типы <code>IPv4</code> и <code>IPv6</code>. Более эффективная реализация функций <code>IPv*</code>. <a href=https://github.com/yandex/ClickHouse/pull/3669 rel="external nofollow noreferrer">#3669</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Добавлен выходной формат <code>Protobuf</code>. <a href=https://github.com/yandex/ClickHouse/pull/4005 rel="external nofollow noreferrer">#4005</a> <a href=https://github.com/yandex/ClickHouse/pull/4158 rel="external nofollow noreferrer">#4158</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>В HTTP-интерфейсе добавлена поддержка алгоритма сжатия brotli для вставляемых данных. <a href=https://github.com/yandex/ClickHouse/pull/4235 rel="external nofollow noreferrer">#4235</a> (<a href=https://github.com/fandyushin rel="external nofollow noreferrer">Mikhail</a>)</li> <li>Клиент командной строки теперь подсказывает правильное имя, если пользователь опечатался в названии функции. <a href=https://github.com/yandex/ClickHouse/pull/4239 rel="external nofollow noreferrer">#4239</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>В HTTP-ответ сервера добавлен заголовок <code>Query-Id</code>. <a href=https://github.com/yandex/ClickHouse/pull/4231 rel="external nofollow noreferrer">#4231</a> (<a href=https://github.com/fandyushin rel="external nofollow noreferrer">Mikhail</a>)</li> </ul> <h3 id=eksperimentalnye-vozmozhnosti_1>Экспериментальные возможности:<a class=headerlink href=#eksperimentalnye-vozmozhnosti_1 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена поддержка вторичных индексов типа <code>minmax</code> и <code>set</code> для таблиц семейства MergeTree (позволяют быстро пропускать целые блоки данных). <a href=https://github.com/yandex/ClickHouse/pull/4143 rel="external nofollow noreferrer">#4143</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Добавлена поддержка преобразования <code>CROSS JOIN</code> в <code>INNER JOIN</code>, если это возможно. <a href=https://github.com/yandex/ClickHouse/pull/4221 rel="external nofollow noreferrer">#4221</a> <a href=https://github.com/yandex/ClickHouse/pull/4266 rel="external nofollow noreferrer">#4266</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=ispravleniia-oshibok_15>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_15 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка <code>Not found column</code> для случая дублирующихся столбцов в секции <code>JOIN ON</code>. <a href=https://github.com/yandex/ClickHouse/pull/4279 rel="external nofollow noreferrer">#4279</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Команда <code>START REPLICATED SENDS</code> теперь действительно включает посылку кусков данных при репликации. <a href=https://github.com/yandex/ClickHouse/pull/4229 rel="external nofollow noreferrer">#4229</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> <li>Исправлена агрегация столбцов типа <code>Array(LowCardinality)</code>. <a href=https://github.com/yandex/ClickHouse/pull/4055 rel="external nofollow noreferrer">#4055</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Исправлена ошибка, приводившая к тому, что при исполнении запроса <code>INSERT ... SELECT ... FROM file(...)</code> терялась первая строчка файла, если он был в формате <code>CSVWithNames</code> или <code>TSVWIthNames</code>. <a href=https://github.com/yandex/ClickHouse/pull/4297 rel="external nofollow noreferrer">#4297</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено падение при перезагрузке внешнего словаря, если словарь недоступен. Ошибка возникла в 19.1.6. <a href=https://github.com/yandex/ClickHouse/pull/4188 rel="external nofollow noreferrer">#4188</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлен неверный результат <code>ALL JOIN</code>, если в правой таблице присутствуют дубликаты ключа join. <a href=https://github.com/yandex/ClickHouse/pull/4184 rel="external nofollow noreferrer">#4184</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлено падение сервера при включённой опции <code>use_uncompressed_cache</code>, а также исключение о неправильном размере разжатых данных. <a href=https://github.com/yandex/ClickHouse/pull/4186 rel="external nofollow noreferrer">#4186</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлена ошибка, приводящая к неправильному результату сравнения больших (не помещающихся в Int16) дат при включённой настройке <code>compile_expressions</code>. <a href=https://github.com/yandex/ClickHouse/pull/4341 rel="external nofollow noreferrer">#4341</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлен бесконечный цикл при запросе из табличной функции <code>numbers(0)</code>. <a href=https://github.com/yandex/ClickHouse/pull/4280 rel="external nofollow noreferrer">#4280</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Временно отключён pushdown предикатов в подзапрос, если он содержит <code>ORDER BY</code>. <a href=https://github.com/yandex/ClickHouse/pull/3890 rel="external nofollow noreferrer">#3890</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Исправлена ошибка <code>Illegal instruction</code> при использовании функций для работы с base64 на старых CPU. Ошибка проявлялась только, если ClickHouse был скомпилирован с gcc-8. <a href=https://github.com/yandex/ClickHouse/pull/4275 rel="external nofollow noreferrer">#4275</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка <code>No message received</code> при запросах к PostgreSQL через ODBC-драйвер и TLS-соединение, исправлен segfault при использовании MySQL через ODBC-драйвер. <a href=https://github.com/yandex/ClickHouse/pull/4170 rel="external nofollow noreferrer">#4170</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлен неверный результат при использовании значений типа <code>Date</code> или <code>DateTime</code> в ветвях условного оператора (функции <code>if</code>). Функция <code>if</code> теперь работает для произвольного типа значений в ветвях. <a href=https://github.com/yandex/ClickHouse/pull/4243 rel="external nofollow noreferrer">#4243</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Словари с источником из локального ClickHouse теперь исполняются локально, а не используя TCP-соединение. <a href=https://github.com/yandex/ClickHouse/pull/4166 rel="external nofollow noreferrer">#4166</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено зависание запросов к таблице с движком <code>File</code> после того, как <code>SELECT</code> из этой таблицы завершился с ошибкой <code>No such file or directory</code>. <a href=https://github.com/yandex/ClickHouse/pull/4161 rel="external nofollow noreferrer">#4161</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка, из-за которой при запросе к таблице <code>system.tables</code> могло возникать исключение <code>table doesn't exist</code>. <a href=https://github.com/yandex/ClickHouse/pull/4313 rel="external nofollow noreferrer">#4313</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка, приводившая к падению <code>clickhouse-client</code> в интерактивном режиме, если успеть выйти из него во время загрузки подсказок командной строки. <a href=https://github.com/yandex/ClickHouse/pull/4317 rel="external nofollow noreferrer">#4317</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка, приводившая к неверным результатам исполнения мутаций, содержащих оператор <code>IN</code>. <a href=https://github.com/yandex/ClickHouse/pull/4099 rel="external nofollow noreferrer">#4099</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Исправлена ошибка, из-за которой, если была создана база данных с движком <code>Dictionary</code>, все словари загружались при старте сервера, а словари с источником из локального ClickHouse не могли загрузиться. <a href=https://github.com/yandex/ClickHouse/pull/4255 rel="external nofollow noreferrer">#4255</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено повторное создание таблиц с системными логами (<code>system.query_log</code>, <code>system.part_log</code>) при остановке сервера. <a href=https://github.com/yandex/ClickHouse/pull/4254 rel="external nofollow noreferrer">#4254</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлен вывод типа возвращаемого значения, а также использование блокировок в функции <code>joinGet</code>. <a href=https://github.com/yandex/ClickHouse/pull/4153 rel="external nofollow noreferrer">#4153</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Исправлено падение сервера при использовании настройки <code>allow_experimental_multiple_joins_emulation</code>. <a href=https://github.com/yandex/ClickHouse/commit/52de2cd927f7b5257dd67e175f0a5560a48840d0 rel="external nofollow noreferrer">52de2c</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлено некорректное сравнение значений типа <code>Date</code> и <code>DateTime</code>. <a href=https://github.com/yandex/ClickHouse/pull/4237 rel="external nofollow noreferrer">#4237</a> (<a href=https://github.com/valexey rel="external nofollow noreferrer">valexey</a>)</li> <li>Исправлена ошибка, проявлявшаяся при fuzz-тестировании с undefined behaviour-санитайзером: добавлена проверка типов параметров для семейства функций <code>quantile*Weighted</code>. <a href=https://github.com/yandex/ClickHouse/pull/4145 rel="external nofollow noreferrer">#4145</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена редкая ошибка, из-за которой при удалении старых кусков данных может возникать ошибка <code>File not found</code>. <a href=https://github.com/yandex/ClickHouse/pull/4378 rel="external nofollow noreferrer">#4378</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена установка пакета при отсутствующем файле /etc/clickhouse-server/config.xml. <a href=https://github.com/yandex/ClickHouse/pull/4343 rel="external nofollow noreferrer">#4343</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=uluchsheniia-sborki-testirovaniia-paketirovaniia_6>Улучшения сборки/тестирования/пакетирования:<a class=headerlink href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_6 title="Permanent link">&para;</a></h3> <ul> <li>При установке Debian-пакета символическая ссылка /etc/clickhouse-server/preprocessed теперь создаётся, учитывая пути, прописанные в конфигурационном файле. <a href=https://github.com/yandex/ClickHouse/pull/4205 rel="external nofollow noreferrer">#4205</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправления сборки под FreeBSD. <a href=https://github.com/yandex/ClickHouse/pull/4225 rel="external nofollow noreferrer">#4225</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Добавлена возможность создавать, заполнять и удалять таблицы в тестах производительности. <a href=https://github.com/yandex/ClickHouse/pull/4220 rel="external nofollow noreferrer">#4220</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлен скрипт для поиска дублирующихся include-директив в исходных файлах. <a href=https://github.com/yandex/ClickHouse/pull/4326 rel="external nofollow noreferrer">#4326</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>В тестах производительности добавлена возможность запускать запросы по номеру. <a href=https://github.com/yandex/ClickHouse/pull/4264 rel="external nofollow noreferrer">#4264</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Пакет с debug-символами добавлен в список рекомендованных для основного пакета. <a href=https://github.com/yandex/ClickHouse/pull/4274 rel="external nofollow noreferrer">#4274</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Рефакторинг утилиты performance-test. Улучшено логирование и обработка сигналов. <a href=https://github.com/yandex/ClickHouse/pull/4171 rel="external nofollow noreferrer">#4171</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Задокументирован анонимизированный датасет Яндекс.Метрики. <a href=https://github.com/yandex/ClickHouse/pull/4164 rel="external nofollow noreferrer">#4164</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлен инструмент для конвертирования кусков данных таблиц, созданных с использованием старого синтаксиса с помесячным партиционированием, в новый формат. <a href=https://github.com/yandex/ClickHouse/pull/4195 rel="external nofollow noreferrer">#4195</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Добавлена документация для двух датасетов, загруженных в s3. <a href=https://github.com/yandex/ClickHouse/pull/4144 rel="external nofollow noreferrer">#4144</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлен инструмент, собирающий changelog из описаний pull request-ов. <a href=https://github.com/yandex/ClickHouse/pull/4169 rel="external nofollow noreferrer">#4169</a> <a href=https://github.com/yandex/ClickHouse/pull/4173 rel="external nofollow noreferrer">#4173</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>) (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Добавлен puppet-модуль для Clickhouse. <a href=https://github.com/yandex/ClickHouse/pull/4182 rel="external nofollow noreferrer">#4182</a> (<a href=https://github.com/MaxFedotov rel="external nofollow noreferrer">Maxim Fedotov</a>)</li> <li>Добавлена документация для нескольких недокументированных функций. <a href=https://github.com/yandex/ClickHouse/pull/4168 rel="external nofollow noreferrer">#4168</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Исправления сборки под ARM. <a href=https://github.com/yandex/ClickHouse/pull/4210 rel="external nofollow noreferrer">#4210</a><a href=https://github.com/yandex/ClickHouse/pull/4306 rel="external nofollow noreferrer">#4306</a> <a href=https://github.com/yandex/ClickHouse/pull/4291 rel="external nofollow noreferrer">#4291</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>) (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Добавлена возможность запускать тесты словарей из <code>ctest</code>. <a href=https://github.com/yandex/ClickHouse/pull/4189 rel="external nofollow noreferrer">#4189</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Теперь директорией с SSL-сертификатами по умолчанию является <code>/etc/ssl</code>. <a href=https://github.com/yandex/ClickHouse/pull/4167 rel="external nofollow noreferrer">#4167</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлена проверка доступности SSE и AVX-инструкций на старте. <a href=https://github.com/yandex/ClickHouse/pull/4234 rel="external nofollow noreferrer">#4234</a> (<a href=https://github.com/igron99 rel="external nofollow noreferrer">Igr</a>)</li> <li>Init-скрипт теперь дожидается, пока сервер запустится. <a href=https://github.com/yandex/ClickHouse/pull/4281 rel="external nofollow noreferrer">#4281</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_2>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_2 title="Permanent link">&para;</a></h3> <ul> <li>Удалена настройка <code>allow_experimental_low_cardinality_type</code>. Семейство типов данных <code>LowCardinality</code> готово для использования в production. <a href=https://github.com/yandex/ClickHouse/pull/4323 rel="external nofollow noreferrer">#4323</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Размер кэша засечек и кэша разжатых блоков теперь уменьшается в зависимости от доступного объёма памяти. <a href=https://github.com/yandex/ClickHouse/pull/4240 rel="external nofollow noreferrer">#4240</a> (<a href=https://github.com/k-lopatin rel="external nofollow noreferrer">Lopatin Konstantin</a>)</li> <li>Для запроса <code>CREATE TABLE</code> добавлено ключевое слово <code>INDEX</code>. Имя столбца <code>index</code> теперь надо оборачивать в двойные или обратные кавычки: <code>`index`</code>. <a href=https://github.com/yandex/ClickHouse/pull/4143 rel="external nofollow noreferrer">#4143</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Функция <code>sumMap</code> теперь возвращает тип с большей областью значений вместо переполнения. Если необходимо старое поведение, следует использовать добавленную функцию <code>sumMapWithOverflow</code>. <a href=https://github.com/yandex/ClickHouse/pull/4151 rel="external nofollow noreferrer">#4151</a> (<a href=https://github.com/ercolanelli-leo rel="external nofollow noreferrer">Léo Ercolanelli</a>)</li> </ul> <h3 id=uluchsheniia-proizvoditelnosti_3>Улучшения производительности:<a class=headerlink href=#uluchsheniia-proizvoditelnosti_3 title="Permanent link">&para;</a></h3> <ul> <li>Для запросов без секции <code>LIMIT</code> вместо <code>std::sort</code> теперь используется <code>pdqsort</code>. <a href=https://github.com/yandex/ClickHouse/pull/4236 rel="external nofollow noreferrer">#4236</a> (<a href=https://github.com/kvinty rel="external nofollow noreferrer">Evgenii Pravda</a>)</li> <li>Теперь сервер переиспользует потоки для выполнения запросов из глобального пула потоков. В краевых случаях это влияет на производительность. <a href=https://github.com/yandex/ClickHouse/pull/4150 rel="external nofollow noreferrer">#4150</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=uluchsheniia_6>Улучшения:<a class=headerlink href=#uluchsheniia_6 title="Permanent link">&para;</a></h3> <ul> <li>Теперь, если в нативном протоколе послать запрос <code>INSERT INTO tbl VALUES (....</code> (с данными в запросе), отдельно посылать разобранные данные для вставки не нужно. <a href=https://github.com/yandex/ClickHouse/pull/4301 rel="external nofollow noreferrer">#4301</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлена поддержка AIO для FreeBSD. <a href=https://github.com/yandex/ClickHouse/pull/4305 rel="external nofollow noreferrer">#4305</a> (<a href=https://github.com/urgordeadbeef rel="external nofollow noreferrer">urgordeadbeef</a>)</li> <li>Запрос <code>SELECT * FROM a JOIN b USING a, b</code> теперь возвращает столбцы <code>a</code> и <code>b</code> только из левой таблицы. <a href=https://github.com/yandex/ClickHouse/pull/4141 rel="external nofollow noreferrer">#4141</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Добавлена опция командной строки <code>-C</code> для клиента, которая работает так же, как и опция <code>-c</code>. <a href=https://github.com/yandex/ClickHouse/pull/4232 rel="external nofollow noreferrer">#4232</a> (<a href=https://github.com/syominsergey rel="external nofollow noreferrer">syominsergey</a>)</li> <li>Если для опции <code>--password</code> клиента командной строки не указано значение, пароль запрашивается из стандартного входа. <a href=https://github.com/yandex/ClickHouse/pull/4230 rel="external nofollow noreferrer">#4230</a> (<a href=https://github.com/bsd-conqueror rel="external nofollow noreferrer">BSD_Conqueror</a>)</li> <li>Добавлена подсветка метасимволов в строковых литералах, содержащих выражения для оператора <code>LIKE</code> и регулярные выражения. <a href=https://github.com/yandex/ClickHouse/pull/4327 rel="external nofollow noreferrer">#4327</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлена отмена HTTP-запроса, если сокет клиента отваливается. <a href=https://github.com/yandex/ClickHouse/pull/4213 rel="external nofollow noreferrer">#4213</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> <li>Теперь сервер время от времени посылает пакеты Progress для поддержания соединения. <a href=https://github.com/yandex/ClickHouse/pull/4215 rel="external nofollow noreferrer">#4215</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Немного улучшено сообщение о причине, почему запрос OPTIMIZE не может быть исполнен (если включена настройка <code>optimize_throw_if_noop</code>). <a href=https://github.com/yandex/ClickHouse/pull/4294 rel="external nofollow noreferrer">#4294</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлена поддержка опции <code>--version</code> для <code>clickhouse-server</code>. <a href=https://github.com/yandex/ClickHouse/pull/4251 rel="external nofollow noreferrer">#4251</a> (<a href=https://github.com/k-lopatin rel="external nofollow noreferrer">Lopatin Konstantin</a>)</li> <li>Добавлена поддержка опции <code>--help/-h</code> для <code>clickhouse-server</code>. <a href=https://github.com/yandex/ClickHouse/pull/4233 rel="external nofollow noreferrer">#4233</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Добавлена поддержка скалярных подзапросов, возвращающих состояние агрегатной функции. <a href=https://github.com/yandex/ClickHouse/pull/4348 rel="external nofollow noreferrer">#4348</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Уменьшено время ожидания завершения сервера и завершения запросов <code>ALTER</code>. <a href=https://github.com/yandex/ClickHouse/pull/4372 rel="external nofollow noreferrer">#4372</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлена информация о значении настройки <code>replicated_can_become_leader</code> в таблицу <code>system.replicas</code>. Добавлено логирование в случае, если реплика не собирается стать лидером. <a href=https://github.com/yandex/ClickHouse/pull/4379 rel="external nofollow noreferrer">#4379</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> </ul> <h2 id=clickhouse-release-19-1-14-2019-03-14>ClickHouse release 19.1.14, 2019-03-14<a class=headerlink href=#clickhouse-release-19-1-14-2019-03-14 title="Permanent link">&para;</a></h2> <ul> <li>Исправлена ошибка <code>Column ... queried more than once</code>, которая могла произойти в случае включенной настройки <code>asterisk_left_columns_only</code> в случае использования <code>GLOBAL JOIN</code> а также <code>SELECT *</code> (редкий случай). Эта ошибка изначально отсутствует в версиях 19.3 и более новых. <a href=https://github.com/yandex/ClickHouse/pull/4692/commits/6bac7d8d11a9b0d6de0b32b53c47eb2f6f8e7062 rel="external nofollow noreferrer">6bac7d8d</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h2 id=clickhouse-release-19-1-13-2019-03-12>ClickHouse release 19.1.13, 2019-03-12<a class=headerlink href=#clickhouse-release-19-1-13-2019-03-12 title="Permanent link">&para;</a></h2> <p>Этот релиз содержит такие же исправления ошибок, как и 19.3.7.</p> <h2 id=clickhouse-release-19-1-10-2019-03-03>ClickHouse release 19.1.10, 2019-03-03<a class=headerlink href=#clickhouse-release-19-1-10-2019-03-03 title="Permanent link">&para;</a></h2> <p>Этот релиз содержит такие же исправления ошибок, как и 19.3.6.</p> <h2 id=clickhouse-release-19-1-9-2019-02-21>ClickHouse release 19.1.9, 2019-02-21<a class=headerlink href=#clickhouse-release-19-1-9-2019-02-21 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_16>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_16 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена обратная несовместимость со старыми версиями, появившаяся из-за некорректной реализации настройки <code>send_logs_level</code>. <a href=https://github.com/yandex/ClickHouse/pull/4445 rel="external nofollow noreferrer">#4445</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена обратная несовместимость табличной функции <code>remote</code>, появившаяся из-за добавления комментариев колонок. <a href=https://github.com/yandex/ClickHouse/pull/4446 rel="external nofollow noreferrer">#4446</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-1-8-2019-02-16>ClickHouse release 19.1.8, 2019-02-16<a class=headerlink href=#clickhouse-release-19-1-8-2019-02-16 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_17>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_17 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена установка пакета при отсутствующем файле /etc/clickhouse-server/config.xml. <a href=https://github.com/yandex/ClickHouse/pull/4343 rel="external nofollow noreferrer">#4343</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h2 id=clickhouse-release-19-1-7-2019-02-15>ClickHouse release 19.1.7, 2019-02-15<a class=headerlink href=#clickhouse-release-19-1-7-2019-02-15 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_18>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_18 title="Permanent link">&para;</a></h3> <ul> <li>Исправлен вывод типа возвращаемого значения, а также использование блокировок в функции <code>joinGet</code>. <a href=https://github.com/yandex/ClickHouse/pull/4153 rel="external nofollow noreferrer">#4153</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Исправлено повторное создание таблиц с системными логами (<code>system.query_log</code>, <code>system.part_log</code>) при остановке сервера. <a href=https://github.com/yandex/ClickHouse/pull/4254 rel="external nofollow noreferrer">#4254</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка, из-за которой, если была создана база данных с движком <code>Dictionary</code>, все словари загружались при старте сервера, а словари с источником из локального ClickHouse не могли загрузиться. <a href=https://github.com/yandex/ClickHouse/pull/4255 rel="external nofollow noreferrer">#4255</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка, приводившая к неверным результатам исполнения мутаций, содержащих оператор <code>IN</code>. <a href=https://github.com/yandex/ClickHouse/pull/4099 rel="external nofollow noreferrer">#4099</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Исправлена ошибка, приводившая к падению <code>clickhouse-client</code> в интерактивном режиме, если успеть выйти из него во время загрузки подсказок командной строки. <a href=https://github.com/yandex/ClickHouse/pull/4317 rel="external nofollow noreferrer">#4317</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка, из-за которой при запросе к таблице <code>system.tables</code> могло возникать исключение <code>table doesn't exist</code>. <a href=https://github.com/yandex/ClickHouse/pull/4313 rel="external nofollow noreferrer">#4313</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено зависание запросов к таблице с движком <code>File</code> после того, как <code>SELECT</code> из этой таблицы завершился с ошибкой <code>No such file or directory</code>. <a href=https://github.com/yandex/ClickHouse/pull/4161 rel="external nofollow noreferrer">#4161</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Словари с источником из локального ClickHouse теперь исполняются локально, а не используя TCP-соединение. <a href=https://github.com/yandex/ClickHouse/pull/4166 rel="external nofollow noreferrer">#4166</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка <code>No message received</code> при запросах к PostgreSQL через ODBC-драйвер и TLS-соединение, исправлен segfault при использовании MySQL через ODBC-драйвер. <a href=https://github.com/yandex/ClickHouse/pull/4170 rel="external nofollow noreferrer">#4170</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Временно отключён pushdown предикатов в подзапрос, если он содержит <code>ORDER BY</code>. <a href=https://github.com/yandex/ClickHouse/pull/3890 rel="external nofollow noreferrer">#3890</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Исправлен бесконечный цикл при запросе из табличной функции <code>numbers(0)</code>. <a href=https://github.com/yandex/ClickHouse/pull/4280 rel="external nofollow noreferrer">#4280</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка, приводящая к неправильному результату сравнения больших (не помещающихся в Int16) дат при включённой настройке <code>compile_expressions</code>. <a href=https://github.com/yandex/ClickHouse/pull/4341 rel="external nofollow noreferrer">#4341</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлено падение сервера при включённой опции <code>uncompressed_cache</code>, а также исключение о неправильном размере разжатых данных. <a href=https://github.com/yandex/ClickHouse/pull/4186 rel="external nofollow noreferrer">#4186</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлен неверный результат <code>ALL JOIN</code>, если в правой таблице присутствуют дубликаты ключа join. <a href=https://github.com/yandex/ClickHouse/pull/4184 rel="external nofollow noreferrer">#4184</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Исправлена ошибка, приводившая к тому, что при исполнении запроса <code>INSERT ... SELECT ... FROM file(...)</code> терялась первая строчка файла, если он был в формате <code>CSVWithNames</code> или <code>TSVWIthNames</code>. <a href=https://github.com/yandex/ClickHouse/pull/4297 rel="external nofollow noreferrer">#4297</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена агрегация столбцов типа <code>Array(LowCardinality)</code>. <a href=https://github.com/yandex/ClickHouse/pull/4055 rel="external nofollow noreferrer">#4055</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>При установке Debian-пакета символическая ссылка /etc/clickhouse-server/preprocessed теперь создаётся, учитывая пути, прописанные в конфигурационном файле. <a href=https://github.com/yandex/ClickHouse/pull/4205 rel="external nofollow noreferrer">#4205</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлена ошибка, проявлявшаяся при fuzz-тестировании с undefined behaviour-санитайзером: добавлена проверка типов параметров для семейства функций <code>quantile*Weighted</code>. <a href=https://github.com/yandex/ClickHouse/pull/4145 rel="external nofollow noreferrer">#4145</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Команда <code>START REPLICATED SENDS</code> теперь действительно включает посылку кусков данных при репликации. <a href=https://github.com/yandex/ClickHouse/pull/4229 rel="external nofollow noreferrer">#4229</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> <li>Исправлена ошибка <code>Not found column</code> для случая дублирующихся столбцов в секции <code>JOIN ON</code>. <a href=https://github.com/yandex/ClickHouse/pull/4279 rel="external nofollow noreferrer">#4279</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Теперь директорией с SSL-сертификатами по умолчанию является <code>/etc/ssl</code>. <a href=https://github.com/yandex/ClickHouse/pull/4167 rel="external nofollow noreferrer">#4167</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено падение при перезагрузке внешнего словаря, если словарь недоступен. Ошибка возникла в 19.1.6. <a href=https://github.com/yandex/ClickHouse/pull/4188 rel="external nofollow noreferrer">#4188</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Исправлено некорректное сравнение значений типа <code>Date</code> и <code>DateTime</code>. <a href=https://github.com/yandex/ClickHouse/pull/4237 rel="external nofollow noreferrer">#4237</a> (<a href=https://github.com/valexey rel="external nofollow noreferrer">valexey</a>)</li> <li>Исправлен неверный результат при использовании значений типа <code>Date</code> или <code>DateTime</code> в ветвях условного оператора (функции <code>if</code>). Функция <code>if</code> теперь работает для произвольного типа значений в ветвях. <a href=https://github.com/yandex/ClickHouse/pull/4243 rel="external nofollow noreferrer">#4243</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-1-6-2019-01-24>ClickHouse release 19.1.6, 2019-01-24<a class=headerlink href=#clickhouse-release-19-1-6-2019-01-24 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_7>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_7 title="Permanent link">&para;</a></h3> <ul> <li>Задание формата сжатия для отдельных столбцов. <a href=https://github.com/yandex/ClickHouse/pull/3899 rel="external nofollow noreferrer">#3899</a> <a href=https://github.com/yandex/ClickHouse/pull/4111 rel="external nofollow noreferrer">#4111</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>, <a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>, <a href=https://github.com/Sindbag rel="external nofollow noreferrer">Anatoly</a>)</li> <li>Формат сжатия <code>Delta</code>. <a href=https://github.com/yandex/ClickHouse/pull/4052 rel="external nofollow noreferrer">#4052</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Изменение формата сжатия запросом <code>ALTER</code>. <a href=https://github.com/yandex/ClickHouse/pull/4054 rel="external nofollow noreferrer">#4054</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлены функции <code>left</code>, <code>right</code>, <code>trim</code>, <code>ltrim</code>, <code>rtrim</code>, <code>timestampadd</code>, <code>timestampsub</code> для совместимости со стандартом SQL. <a href=https://github.com/yandex/ClickHouse/pull/3826 rel="external nofollow noreferrer">#3826</a> (<a href=https://github.com/blinkov rel="external nofollow noreferrer">Ivan Blinkov</a>)</li> <li>Поддержка записи в движок <code>HDFS</code> и табличную функцию <code>hdfs</code>. <a href=https://github.com/yandex/ClickHouse/pull/4084 rel="external nofollow noreferrer">#4084</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлены функции поиска набора константных строк в тексте: <code>multiPosition</code>, <code>multiSearch</code> ,<code>firstMatch</code> также с суффиксами <code>-UTF8</code>, <code>-CaseInsensitive</code>, и <code>-CaseInsensitiveUTF8</code>. <a href=https://github.com/yandex/ClickHouse/pull/4053 rel="external nofollow noreferrer">#4053</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Пропуск неиспользуемых шардов в случае, если запрос <code>SELECT</code> содержит фильтрацию по ключу шардирования (настройка <code>optimize_skip_unused_shards</code>). <a href=https://github.com/yandex/ClickHouse/pull/3851 rel="external nofollow noreferrer">#3851</a> (<a href=https://github.com/kanterov rel="external nofollow noreferrer">Gleb Kanterov</a>, <a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Пропуск строк в случае ошибки парсинга для движка <code>Kafka</code> (настройка <code>kafka_skip_broken_messages</code>). <a href=https://github.com/yandex/ClickHouse/pull/4094 rel="external nofollow noreferrer">#4094</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Поддержка применения мультиклассовых моделей <code>CatBoost</code>. Функция <code>modelEvaluate</code> возвращает кортеж в случае использования мультиклассовой модели. <code>libcatboostmodel.so</code> should be built with <a href=https://github.com/catboost/catboost/pull/607 rel="external nofollow noreferrer">#607</a>. <a href=https://github.com/yandex/ClickHouse/pull/3959 rel="external nofollow noreferrer">#3959</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Добавлены функции <code>filesystemAvailable</code>, <code>filesystemFree</code>, <code>filesystemCapacity</code>. <a href=https://github.com/yandex/ClickHouse/pull/4097 rel="external nofollow noreferrer">#4097</a> (<a href=https://github.com/bgranvea rel="external nofollow noreferrer">Boris Granveaud</a>)</li> <li>Добавлены функции хеширования <code>xxHash64</code> и <code>xxHash32</code>. <a href=https://github.com/yandex/ClickHouse/pull/3905 rel="external nofollow noreferrer">#3905</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Добавлена функция хеширования <code>gccMurmurHash</code> (GCC flavoured Murmur hash), использующая те же hash seed, что и <a href=https://github.com/gcc-mirror/gcc/blob/41d6b10e96a1de98e90a7c0378437c3255814b16/libstdc%2B%2B-v3/include/bits/functional_hash.h#L191 rel="external nofollow noreferrer">gcc</a> <a href=https://github.com/yandex/ClickHouse/pull/4000 rel="external nofollow noreferrer">#4000</a> (<a href=https://github.com/sundy-li rel="external nofollow noreferrer">sundyli</a>)</li> <li>Добавлены функции хеширования <code>javaHash</code>, <code>hiveHash</code>. <a href=https://github.com/yandex/ClickHouse/pull/3811 rel="external nofollow noreferrer">#3811</a> (<a href=https://github.com/shangshujie365 rel="external nofollow noreferrer">shangshujie365</a>)</li> <li>Добавлена функция <code>remoteSecure</code>. Функция работает аналогично <code>remote</code>, но использует безопасное соединение. <a href=https://github.com/yandex/ClickHouse/pull/4088 rel="external nofollow noreferrer">#4088</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=eksperimentalnye-vozmozhnosti_2>Экспериментальные возможности:<a class=headerlink href=#eksperimentalnye-vozmozhnosti_2 title="Permanent link">&para;</a></h3> <ul> <li>Эмуляция запросов с несколькими секциями <code>JOIN</code> (настройка <code>allow_experimental_multiple_joins_emulation</code>). <a href=https://github.com/yandex/ClickHouse/pull/3946 rel="external nofollow noreferrer">#3946</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=ispravleniia-oshibok_19>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_19 title="Permanent link">&para;</a></h3> <ul> <li>Ограничен размер кеша скомпилированных выражений в случае, если не указана настройка <code>compiled_expression_cache_size</code> для экономии потребляемой памяти. <a href=https://github.com/yandex/ClickHouse/pull/4041 rel="external nofollow noreferrer">#4041</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлена проблема зависания потоков, выполняющих запрос <code>ALTER</code> для таблиц семейства <code>Replicated</code>, а также потоков, обновляющих конфигурацию из ZooKeeper. <a href=https://github.com/yandex/ClickHouse/issues/2947 rel="external nofollow noreferrer">#2947</a> <a href=https://github.com/yandex/ClickHouse/issues/3891 rel="external nofollow noreferrer">#3891</a> <a href=https://github.com/yandex/ClickHouse/pull/3934 rel="external nofollow noreferrer">#3934</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Исправлен race condition в случае выполнения распределенной задачи запроса <code>ALTER</code>. Race condition приводил к состоянию, когда более чем одна реплика пыталась выполнить задачу, в результате чего все такие реплики, кроме одной, падали с ошибкой обращения к ZooKeeper. <a href=https://github.com/yandex/ClickHouse/pull/3904 rel="external nofollow noreferrer">#3904</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Исправлена проблема обновления настройки <code>from_zk</code>. Настройка, указанная в файле конфигурации, не обновлялась в случае, если запрос к ZooKeeper падал по timeout. <a href=https://github.com/yandex/ClickHouse/issues/2947 rel="external nofollow noreferrer">#2947</a> <a href=https://github.com/yandex/ClickHouse/pull/3947 rel="external nofollow noreferrer">#3947</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Исправлена ошибка в вычислении сетевого префикса при указании IPv4 маски подсети. <a href=https://github.com/yandex/ClickHouse/pull/3945 rel="external nofollow noreferrer">#3945</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлено падение (<code>std::terminate</code>) в редком сценарии, когда новый поток не мог быть создан из-за нехватки ресурсов. <a href=https://github.com/yandex/ClickHouse/pull/3956 rel="external nofollow noreferrer">#3956</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено падение табличной функции <code>remote</code> в случае, когда не удавалось получить структуру таблицы из-за ограничений пользователя. <a href=https://github.com/yandex/ClickHouse/pull/4009 rel="external nofollow noreferrer">#4009</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлена утечка сетевых сокетов. Сокеты создавались в пуле и никогда не закрывались. При создании потока, создавались новые сокеты в случае, если все доступные использовались. <a href=https://github.com/yandex/ClickHouse/pull/4017 rel="external nofollow noreferrer">#4017</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Исправлена проблема закрывания <code>/proc/self/fd</code> раньше, чем все файловые дескрипторы были прочитаны из <code>/proc</code> после создания процесса <code>odbc-bridge</code>. <a href=https://github.com/yandex/ClickHouse/pull/4120 rel="external nofollow noreferrer">#4120</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлен баг в монотонном преобразовании String в UInt в случае использования String в первичном ключе. <a href=https://github.com/yandex/ClickHouse/pull/3870 rel="external nofollow noreferrer">#3870</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Исправлен баг в вычислении монотонности функции преобразования типа целых значений. <a href=https://github.com/yandex/ClickHouse/pull/3921 rel="external nofollow noreferrer">#3921</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлено падение в функциях <code>arrayEnumerateUniq</code>, <code>arrayEnumerateDense</code> при передаче невалидных аргументов. <a href=https://github.com/yandex/ClickHouse/pull/3909 rel="external nofollow noreferrer">#3909</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлен undefined behavior в StorageMerge. <a href=https://github.com/yandex/ClickHouse/pull/3910 rel="external nofollow noreferrer">#3910</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Исправлено падение в функциях <code>addDays</code>, <code>subtractDays</code>. <a href=https://github.com/yandex/ClickHouse/pull/3913 rel="external nofollow noreferrer">#3913</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена проблема, в результате которой функции <code>round</code>, <code>floor</code>, <code>trunc</code>, <code>ceil</code> могли возвращать неверный результат для отрицательных целочисленных аргументов с большим значением. <a href=https://github.com/yandex/ClickHouse/pull/3914 rel="external nofollow noreferrer">#3914</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена проблема, в результате которой 'kill query sync' приводил к падению сервера. <a href=https://github.com/yandex/ClickHouse/pull/3916 rel="external nofollow noreferrer">#3916</a> (<a href=https://github.com/fancyqlx rel="external nofollow noreferrer">muVulDeePecker</a>)</li> <li>Исправлен баг, приводящий к большой задержке в случае пустой очереди репликации. <a href=https://github.com/yandex/ClickHouse/pull/3928 rel="external nofollow noreferrer">#3928</a> <a href=https://github.com/yandex/ClickHouse/pull/3932 rel="external nofollow noreferrer">#3932</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Исправлено избыточное использование памяти в случае вставки в таблицу с <code>LowCardinality</code> в первичном ключе. <a href=https://github.com/yandex/ClickHouse/pull/3955 rel="external nofollow noreferrer">#3955</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Исправлена сериализация пустых массивов типа <code>LowCardinality</code> для формата <code>Native</code>. <a href=https://github.com/yandex/ClickHouse/issues/3907 rel="external nofollow noreferrer">#3907</a> <a href=https://github.com/yandex/ClickHouse/pull/4011 rel="external nofollow noreferrer">#4011</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Исправлен неверный результат в случае использования distinct для числового столбца <code>LowCardinality</code>. <a href=https://github.com/yandex/ClickHouse/issues/3895 rel="external nofollow noreferrer">#3895</a> <a href=https://github.com/yandex/ClickHouse/pull/4012 rel="external nofollow noreferrer">#4012</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Исправлена компиляция вычисления агрегатных функций для ключа <code>LowCardinality</code> (для случая, когда включена настройка <code>compile</code>). <a href=https://github.com/yandex/ClickHouse/pull/3886 rel="external nofollow noreferrer">#3886</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Исправлена передача пользователя и пароля для запросов с реплик. <a href=https://github.com/yandex/ClickHouse/pull/3957 rel="external nofollow noreferrer">#3957</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>) (<a href=https://github.com/nicelulu rel="external nofollow noreferrer">小路</a>)</li> <li>Исправлен очень редкий race condition возникающий при перечислении таблиц из базы данных типа <code>Dictionary</code> во время перезагрузки словарей. <a href=https://github.com/yandex/ClickHouse/pull/3970 rel="external nofollow noreferrer">#3970</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлен неверный результат в случае использования HAVING с ROLLUP или CUBE. <a href=https://github.com/yandex/ClickHouse/issues/3756 rel="external nofollow noreferrer">#3756</a> <a href=https://github.com/yandex/ClickHouse/pull/3837 rel="external nofollow noreferrer">#3837</a> (<a href=https://github.com/reflection rel="external nofollow noreferrer">Sam Chou</a>)</li> <li>Исправлена проблема с алиасами столбцов для запросов с <code>JOIN ON</code> над распределенными таблицами. <a href=https://github.com/yandex/ClickHouse/pull/3980 rel="external nofollow noreferrer">#3980</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Исправлена ошибка в реализации функции <code>quantileTDigest</code> (нашел Artem Vakhrushev). Эта ошибка никогда не происходит в ClickHouse и актуальна только для тех, кто использует кодовую базу ClickHouse напрямую в качестве библиотеки. <a href=https://github.com/yandex/ClickHouse/pull/3935 rel="external nofollow noreferrer">#3935</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=uluchsheniia_7>Улучшения:<a class=headerlink href=#uluchsheniia_7 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена поддержка <code>IF NOT EXISTS</code> в выражении <code>ALTER TABLE ADD COLUMN</code>, <code>IF EXISTS</code> в выражении <code>DROP/MODIFY/CLEAR/COMMENT COLUMN</code>. <a href=https://github.com/yandex/ClickHouse/pull/3900 rel="external nofollow noreferrer">#3900</a> (<a href=https://github.com/bgranvea rel="external nofollow noreferrer">Boris Granveaud</a>)</li> <li>Функция <code>parseDateTimeBestEffort</code> теперь поддерживает форматы <code>DD.MM.YYYY</code>, <code>DD.MM.YY</code>, <code>DD-MM-YYYY</code>, <code>DD-Mon-YYYY</code>, <code>DD/Month/YYYY</code> и аналогичные. <a href=https://github.com/yandex/ClickHouse/pull/3922 rel="external nofollow noreferrer">#3922</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>CapnProtoInputStream</code> теперь поддерживает jagged структуры. <a href=https://github.com/yandex/ClickHouse/pull/4063 rel="external nofollow noreferrer">#4063</a> (<a href=https://github.com/Miniwoffer rel="external nofollow noreferrer">Odin Hultgren Van Der Horst</a>)</li> <li>Улучшение usability: добавлена проверка, что сервер запущен от пользователя, совпадающего с владельцем директории данных. Запрещен запуск от пользователя root в случае, если root не владеет директорией с данными. <a href=https://github.com/yandex/ClickHouse/pull/3785 rel="external nofollow noreferrer">#3785</a> (<a href=https://github.com/sergey-v-galtsev rel="external nofollow noreferrer">sergey-v-galtsev</a>)</li> <li>Улучшена логика проверки столбцов, необходимых для JOIN, на стадии анализа запроса. <a href=https://github.com/yandex/ClickHouse/pull/3930 rel="external nofollow noreferrer">#3930</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Уменьшено число поддерживаемых соединений в случае большого числа распределенных таблиц. <a href=https://github.com/yandex/ClickHouse/pull/3726 rel="external nofollow noreferrer">#3726</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Добавлена поддержка строки с totals для запроса с <code>WITH TOTALS</code> через ODBC драйвер. <a href=https://github.com/yandex/ClickHouse/pull/3836 rel="external nofollow noreferrer">#3836</a> (<a href=https://github.com/nightweb rel="external nofollow noreferrer">Maksim Koritckiy</a>)</li> <li>Поддержано использование <code>Enum</code> в качестве чисел в функции <code>if</code>. <a href=https://github.com/yandex/ClickHouse/pull/3875 rel="external nofollow noreferrer">#3875</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Добавлена настройка <code>low_cardinality_allow_in_native_format</code>. Если она выключена, то тип <code>LowCadrinality</code> не используется в формате <code>Native</code>. <a href=https://github.com/yandex/ClickHouse/pull/3879 rel="external nofollow noreferrer">#3879</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Удалены некоторые избыточные объекты из кеша скомпилированных выражений для уменьшения потребления памяти. <a href=https://github.com/yandex/ClickHouse/pull/4042 rel="external nofollow noreferrer">#4042</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлена проверка того, что в запрос <code>SET send_logs_level = 'value'</code> передается верное значение. <a href=https://github.com/yandex/ClickHouse/pull/3873 rel="external nofollow noreferrer">#3873</a> (<a href=https://github.com/s-mx rel="external nofollow noreferrer">Sabyanin Maxim</a>)</li> <li>Добавлена проверка типов для функций преобразования типов. <a href=https://github.com/yandex/ClickHouse/pull/3896 rel="external nofollow noreferrer">#3896</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> </ul> <h3 id=uluchsheniia-proizvoditelnosti_4>Улучшения производительности:<a class=headerlink href=#uluchsheniia-proizvoditelnosti_4 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена настройка <code>use_minimalistic_part_header_in_zookeeper</code> для движка MergeTree. Если настройка включена, Replicated таблицы будут хранить метаданные куска в компактном виде (в соответствующем znode для этого куска). Это может значительно уменьшить размер для ZooKeeper snapshot (особенно для таблиц с большим числом столбцов). После включения данной настройки будет невозможно сделать откат к версии, которая эту настройку не поддерживает. <a href=https://github.com/yandex/ClickHouse/pull/3960 rel="external nofollow noreferrer">#3960</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Добавлена реализация функций <code>sequenceMatch</code> и <code>sequenceCount</code> на основе конечного автомата в случае, если последовательность событий не содержит условия на время. <a href=https://github.com/yandex/ClickHouse/pull/4004 rel="external nofollow noreferrer">#4004</a> (<a href=https://github.com/ercolanelli-leo rel="external nofollow noreferrer">Léo Ercolanelli</a>)</li> <li>Улучшена производительность сериализации целых чисел. <a href=https://github.com/yandex/ClickHouse/pull/3968 rel="external nofollow noreferrer">#3968</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Добавлен zero left padding для PODArray. Теперь элемент с индексом -1 является валидным нулевым значением. Эта особенность используется для удаления условного выражения при вычислении оффсетов массивов. <a href=https://github.com/yandex/ClickHouse/pull/3920 rel="external nofollow noreferrer">#3920</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Откат версии <code>jemalloc</code>, приводящей к деградации производительности. <a href=https://github.com/yandex/ClickHouse/pull/4018 rel="external nofollow noreferrer">#4018</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_3>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_3 title="Permanent link">&para;</a></h3> <ul> <li>Удалена недокументированная возможность <code>ALTER MODIFY PRIMARY KEY</code>, замененная выражением <code>ALTER MODIFY ORDER BY</code>. <a href=https://github.com/yandex/ClickHouse/pull/3887 rel="external nofollow noreferrer">#3887</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Удалена функция <code>shardByHash</code>. <a href=https://github.com/yandex/ClickHouse/pull/3833 rel="external nofollow noreferrer">#3833</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Запрещено использование скалярных подзапросов с результатом, имеющим тип <code>AggregateFunction</code>. <a href=https://github.com/yandex/ClickHouse/pull/3865 rel="external nofollow noreferrer">#3865</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h3 id=uluchsheniia-sborki-testirovaniia-paketirovaniia_7>Улучшения сборки/тестирования/пакетирования:<a class=headerlink href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_7 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена поддержка сборки под PowerPC (<code>ppc64le</code>). <a href=https://github.com/yandex/ClickHouse/pull/4132 rel="external nofollow noreferrer">#4132</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Функциональные stateful тесты запускаются на публично доступных данных. <a href=https://github.com/yandex/ClickHouse/pull/3969 rel="external nofollow noreferrer">#3969</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлена ошибка, при которой сервер не мог запуститься с сообщением <code>bash: /usr/bin/clickhouse-extract-from-config: Operation not permitted</code> при использовании Docker или systemd-nspawn. <a href=https://github.com/yandex/ClickHouse/pull/4136 rel="external nofollow noreferrer">#4136</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Обновлена библиотека <code>rdkafka</code> до версии v1.0.0-RC5. Использована cppkafka на замену интерфейса языка C. <a href=https://github.com/yandex/ClickHouse/pull/4025 rel="external nofollow noreferrer">#4025</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Обновлена библиотека <code>mariadb-client</code>. Исправлена проблема, обнаруженная с использованием UBSan. <a href=https://github.com/yandex/ClickHouse/pull/3924 rel="external nofollow noreferrer">#3924</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправления для сборок с UBSan. <a href=https://github.com/yandex/ClickHouse/pull/3926 rel="external nofollow noreferrer">#3926</a> <a href=https://github.com/yandex/ClickHouse/pull/3021 rel="external nofollow noreferrer">#3021</a> <a href=https://github.com/yandex/ClickHouse/pull/3948 rel="external nofollow noreferrer">#3948</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлены покоммитные запуски тестов с UBSan сборкой.</li> <li>Добавлены покоммитные запуски тестов со статическим анализатором PVS-Studio.</li> <li>Исправлены проблемы, найденные с использованием PVS-Studio. <a href=https://github.com/yandex/ClickHouse/pull/4013 rel="external nofollow noreferrer">#4013</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправлены проблемы совместимости glibc. <a href=https://github.com/yandex/ClickHouse/pull/4100 rel="external nofollow noreferrer">#4100</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Docker образы перемещены на Ubuntu 18.10, добавлена совместимость с glibc &gt;= 2.28 <a href=https://github.com/yandex/ClickHouse/pull/3965 rel="external nofollow noreferrer">#3965</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Добавлена переменная окружения <code>CLICKHOUSE_DO_NOT_CHOWN</code>, позволяющая не делать shown директории для Docker образа сервера. <a href=https://github.com/yandex/ClickHouse/pull/3967 rel="external nofollow noreferrer">#3967</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Включены большинство предупреждений из <code>-Weverything</code> для clang. Включено <code>-Wpedantic</code>. <a href=https://github.com/yandex/ClickHouse/pull/3986 rel="external nofollow noreferrer">#3986</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Добавлены некоторые предупреждения, специфичные только для clang 8. <a href=https://github.com/yandex/ClickHouse/pull/3993 rel="external nofollow noreferrer">#3993</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>При использовании динамической линковки используется <code>libLLVM</code> вместо библиотеки <code>LLVM</code>. <a href=https://github.com/yandex/ClickHouse/pull/3989 rel="external nofollow noreferrer">#3989</a> (<a href=https://github.com/orivej rel="external nofollow noreferrer">Orivej Desh</a>)</li> <li>Добавлены переменные окружения для параметров <code>TSan</code>, <code>UBSan</code>, <code>ASan</code> в тестовом Docker образе. <a href=https://github.com/yandex/ClickHouse/pull/4072 rel="external nofollow noreferrer">#4072</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Debian пакет <code>clickhouse-server</code> будет рекомендовать пакет <code>libcap2-bin</code> для того, чтобы использовать утилиту <code>setcap</code> для настроек. Данный пакет опционален. <a href=https://github.com/yandex/ClickHouse/pull/4093 rel="external nofollow noreferrer">#4093</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Уменьшено время сборки, убраны ненужные включения заголовочных файлов. <a href=https://github.com/yandex/ClickHouse/pull/3898 rel="external nofollow noreferrer">#3898</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Добавлены тесты производительности для функций хеширования. <a href=https://github.com/yandex/ClickHouse/pull/3918 rel="external nofollow noreferrer">#3918</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Исправлены циклические зависимости библиотек. <a href=https://github.com/yandex/ClickHouse/pull/3958 rel="external nofollow noreferrer">#3958</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Улучшена компиляция при малом объеме памяти. <a href=https://github.com/yandex/ClickHouse/pull/4030 rel="external nofollow noreferrer">#4030</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Добавлен тестовый скрипт для воспроизведения деградации производительности в <code>jemalloc</code>. <a href=https://github.com/yandex/ClickHouse/pull/4036 rel="external nofollow noreferrer">#4036</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Исправления опечаток в комментариях и строковых литералах. <a href=https://github.com/yandex/ClickHouse/pull/4122 rel="external nofollow noreferrer">#4122</a> (<a href=https://github.com/maiha rel="external nofollow noreferrer">maiha</a>)</li> <li>Исправления опечаток в комментариях. <a href=https://github.com/yandex/ClickHouse/pull/4089 rel="external nofollow noreferrer">#4089</a> (<a href=https://github.com/kvinty rel="external nofollow noreferrer">Evgenii Pravda</a>)</li> </ul> <h2 id=clickhouse-release-18-16-1-2018-12-21>ClickHouse release 18.16.1, 2018-12-21<a class=headerlink href=#clickhouse-release-18-16-1-2018-12-21 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_20>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_20 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена проблема, приводившая к невозможности обновить словари с источником ODBC. <a href=https://github.com/yandex/ClickHouse/issues/3825 rel="external nofollow noreferrer">#3825</a>, <a href=https://github.com/yandex/ClickHouse/issues/3829 rel="external nofollow noreferrer">#3829</a></li> <li>JIT-компиляция агрегатных функций теперь работает с LowCardinality столбцами. <a href=https://github.com/yandex/ClickHouse/issues/3838 rel="external nofollow noreferrer">#3838</a></li> </ul> <h3 id=uluchsheniia_8>Улучшения:<a class=headerlink href=#uluchsheniia_8 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена настройка <code>low_cardinality_allow_in_native_format</code> (по умолчанию включена). Если её выключить, столбцы LowCardinality в Native формате будут преобразовываться в соответствующий обычный тип при SELECT и из этого типа при INSERT. <a href=https://github.com/yandex/ClickHouse/pull/3879 rel="external nofollow noreferrer">#3879</a></li> </ul> <h3 id=uluchsheniia-sborki>Улучшения сборки:<a class=headerlink href=#uluchsheniia-sborki title="Permanent link">&para;</a></h3> <ul> <li>Исправления сборки под macOS и ARM.</li> </ul> <h2 id=clickhouse-release-18-16-0-2018-12-14>ClickHouse release 18.16.0, 2018-12-14<a class=headerlink href=#clickhouse-release-18-16-0-2018-12-14 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_8>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_8 title="Permanent link">&para;</a></h3> <ul> <li>Вычисление <code>DEFAULT</code> выражений для отсутствующих полей при загрузке данных в полуструктурированных форматах (<code>JSONEachRow</code>, <code>TSKV</code>) (требуется включить настройку запроса <code>insert_sample_with_metadata</code>). <a href=https://github.com/yandex/ClickHouse/pull/3555 rel="external nofollow noreferrer">#3555</a></li> <li>Для запроса <code>ALTER TABLE</code> добавлено действие <code>MODIFY ORDER BY</code> для изменения ключа сортировки при одновременном добавлении или удалении столбца таблицы. Это полезно для таблиц семейства <code>MergeTree</code>, выполняющих дополнительную работу при слияниях, согласно этому ключу сортировки, как например, <code>SummingMergeTree</code>, <code>AggregatingMergeTree</code> и т. п. <a href=https://github.com/yandex/ClickHouse/pull/3581 rel="external nofollow noreferrer">#3581</a> <a href=https://github.com/yandex/ClickHouse/pull/3755 rel="external nofollow noreferrer">#3755</a></li> <li>Для таблиц семейства <code>MergeTree</code> появилась возможность указать различный ключ сортировки (<code>ORDER BY</code>) и индекс (<code>PRIMARY KEY</code>). Ключ сортировки может быть длиннее, чем индекс. <a href=https://github.com/yandex/ClickHouse/pull/3581 rel="external nofollow noreferrer">#3581</a></li> <li>Добавлена табличная функция <code>hdfs</code> и движок таблиц <code>HDFS</code> для импорта и экспорта данных в HDFS. <a href=https://github.com/yandex/ClickHouse/pull/3617 rel="external nofollow noreferrer">chenxing-xc</a></li> <li>Добавлены функции для работы с base64: <code>base64Encode</code>, <code>base64Decode</code>, <code>tryBase64Decode</code>. <a href=https://github.com/yandex/ClickHouse/pull/3350 rel="external nofollow noreferrer">Alexander Krasheninnikov</a></li> <li>Для агрегатной функции <code>uniqCombined</code> появилась возможность настраивать точность работы с помощью параметра (выбирать количество ячеек HyperLogLog). <a href=https://github.com/yandex/ClickHouse/pull/3406 rel="external nofollow noreferrer">#3406</a></li> <li>Добавлена таблица <code>system.contributors</code>, содержащая имена всех, кто делал коммиты в ClickHouse. <a href=https://github.com/yandex/ClickHouse/pull/3452 rel="external nofollow noreferrer">#3452</a></li> <li>Добавлена возможность не указывать партицию для запроса <code>ALTER TABLE ... FREEZE</code> для бэкапа сразу всех партиций. <a href=https://github.com/yandex/ClickHouse/pull/3514 rel="external nofollow noreferrer">#3514</a></li> <li>Добавлены функции <code>dictGet</code>, <code>dictGetOrDefault</code> без указания типа возвращаемого значения. Тип определяется автоматически из описания словаря. <a href=https://github.com/yandex/ClickHouse/pull/3564 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Возможность указания комментария для столбца в описании таблицы и изменения его с помощью <code>ALTER</code>. <a href=https://github.com/yandex/ClickHouse/pull/3377 rel="external nofollow noreferrer">#3377</a></li> <li>Возможность чтения из таблицы типа <code>Join</code> в случае простых ключей. <a href=https://github.com/yandex/ClickHouse/pull/3728 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Возможность указания настроек <code>join_use_nulls</code>, <code>max_rows_in_join</code>, <code>max_bytes_in_join</code>, <code>join_overflow_mode</code> при создании таблицы типа <code>Join</code>. <a href=https://github.com/yandex/ClickHouse/pull/3728 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Добавлена функция <code>joinGet</code>, позволяющая использовать таблицы типа <code>Join</code> как словарь. <a href=https://github.com/yandex/ClickHouse/pull/3728 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Добавлены столбцы <code>partition_key</code>, <code>sorting_key</code>, <code>primary_key</code>, <code>sampling_key</code> в таблицу <code>system.tables</code>, позволяющие получить информацию о ключах таблицы. <a href=https://github.com/yandex/ClickHouse/pull/3609 rel="external nofollow noreferrer">#3609</a></li> <li>Добавлены столбцы <code>is_in_partition_key</code>, <code>is_in_sorting_key</code>, <code>is_in_primary_key</code>, <code>is_in_sampling_key</code> в таблицу <code>system.columns</code>. <a href=https://github.com/yandex/ClickHouse/pull/3609 rel="external nofollow noreferrer">#3609</a></li> <li>Добавлены столбцы <code>min_time</code>, <code>max_time</code> в таблицу <code>system.parts</code>. Эти столбцы заполняются, если ключ партиционирования является выражением от столбцов типа <code>DateTime</code>. <a href=https://github.com/yandex/ClickHouse/pull/3800 rel="external nofollow noreferrer">Emmanuel Donin de Rosière</a></li> </ul> <h3 id=ispravleniia-oshibok_21>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_21 title="Permanent link">&para;</a></h3> <ul> <li>Исправления и улучшения производительности для типа данных <code>LowCardinality</code>. <code>GROUP BY</code> по <code>LowCardinality(Nullable(...))</code>. Получение <code>extremes</code> значений. Выполнение функций высшего порядка. <code>LEFT ARRAY JOIN</code>. Распределённый <code>GROUP BY</code>. Функции, возвращающие <code>Array</code>. Выполнение <code>ORDER BY</code>. Запись в <code>Distributed</code> таблицы (nicelulu). Обратная совместимость для запросов <code>INSERT</code> от старых клиентов, реализующих <code>Native</code> протокол. Поддержка <code>LowCardinality</code> для <code>JOIN</code>. Производительность при работе в один поток. <a href=https://github.com/yandex/ClickHouse/pull/3823 rel="external nofollow noreferrer">#3823</a> <a href=https://github.com/yandex/ClickHouse/pull/3803 rel="external nofollow noreferrer">#3803</a> <a href=https://github.com/yandex/ClickHouse/pull/3799 rel="external nofollow noreferrer">#3799</a> <a href=https://github.com/yandex/ClickHouse/pull/3769 rel="external nofollow noreferrer">#3769</a> <a href=https://github.com/yandex/ClickHouse/pull/3744 rel="external nofollow noreferrer">#3744</a> <a href=https://github.com/yandex/ClickHouse/pull/3681 rel="external nofollow noreferrer">#3681</a> <a href=https://github.com/yandex/ClickHouse/pull/3651 rel="external nofollow noreferrer">#3651</a> <a href=https://github.com/yandex/ClickHouse/pull/3649 rel="external nofollow noreferrer">#3649</a> <a href=https://github.com/yandex/ClickHouse/pull/3641 rel="external nofollow noreferrer">#3641</a> <a href=https://github.com/yandex/ClickHouse/pull/3632 rel="external nofollow noreferrer">#3632</a> <a href=https://github.com/yandex/ClickHouse/pull/3568 rel="external nofollow noreferrer">#3568</a> <a href=https://github.com/yandex/ClickHouse/pull/3523 rel="external nofollow noreferrer">#3523</a> <a href=https://github.com/yandex/ClickHouse/pull/3518 rel="external nofollow noreferrer">#3518</a></li> <li>Исправлена работа настройки <code>select_sequential_consistency</code>. Ранее, при включенной настройке, после начала записи в новую партицию, мог возвращаться неполный результат. <a href=https://github.com/yandex/ClickHouse/pull/2863 rel="external nofollow noreferrer">#2863</a></li> <li>Корректное указание базы данных при выполнении DDL запросов <code>ON CLUSTER</code>, а также при выполнении <code>ALTER UPDATE/DELETE</code>. <a href=https://github.com/yandex/ClickHouse/pull/3772 rel="external nofollow noreferrer">#3772</a> <a href=https://github.com/yandex/ClickHouse/pull/3460 rel="external nofollow noreferrer">#3460</a></li> <li>Корректное указание базы данных для подзапросов внутри VIEW. <a href=https://github.com/yandex/ClickHouse/pull/3521 rel="external nofollow noreferrer">#3521</a></li> <li>Исправлена работа <code>PREWHERE</code> с <code>FINAL</code> для <code>VersionedCollapsingMergeTree</code>. <a href=https://github.com/yandex/ClickHouse/commit/7167bfd7b365538f7a91c4307ad77e552ab4e8c1 rel="external nofollow noreferrer">7167bfd7</a></li> <li>Возможность с помощью запроса <code>KILL QUERY</code> отмены запросов, которые ещё не начали выполняться из-за ожидания блокировки таблицы. <a href=https://github.com/yandex/ClickHouse/pull/3517 rel="external nofollow noreferrer">#3517</a></li> <li>Исправлены расчёты с датой и временем в случае, если стрелки часов были переведены назад в полночь (это происходит в Иране, а также было Москве с 1981 по 1983 год). Ранее это приводило к тому, что стрелки часов переводились на сутки раньше, чем нужно, а также приводило к некорректному форматированию даты-с-временем в текстовом виде. <a href=https://github.com/yandex/ClickHouse/pull/3819 rel="external nofollow noreferrer">#3819</a></li> <li>Исправлена работа некоторых случаев <code>VIEW</code> и подзапросов без указания базы данных. <a href=https://github.com/yandex/ClickHouse/pull/3521 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Исправлен race condition при одновременном чтении из <code>MATERIALIZED VIEW</code> и удалением <code>MATERIALIZED VIEW</code> из-за отсутствия блокировки внутренней таблицы <code>MATERIALIZED VIEW</code>. <a href=https://github.com/yandex/ClickHouse/pull/3404 rel="external nofollow noreferrer">#3404</a> <a href=https://github.com/yandex/ClickHouse/pull/3694 rel="external nofollow noreferrer">#3694</a></li> <li>Исправлена ошибка <code>Lock handler cannot be nullptr.</code> <a href=https://github.com/yandex/ClickHouse/pull/3689 rel="external nofollow noreferrer">#3689</a></li> <li>Исправления выполнения запросов при включенной настройке <code>compile_expressions</code> (включена по-умолчанию) - убрана свёртка недетерминированных константных выражений, как например, функции <code>now</code>. <a href=https://github.com/yandex/ClickHouse/pull/3457 rel="external nofollow noreferrer">#3457</a></li> <li>Исправлено падение при указании неконстантного аргумента scale в функциях <code>toDecimal32/64/128</code>.</li> <li>Исправлена ошибка при попытке вставки в формате <code>Values</code> массива с <code>NULL</code> элементами в столбец типа <code>Array</code> без <code>Nullable</code> (в случае <code>input_format_values_interpret_expressions</code> = 1). <a href=https://github.com/yandex/ClickHouse/pull/3487 rel="external nofollow noreferrer">#3487</a> <a href=https://github.com/yandex/ClickHouse/pull/3503 rel="external nofollow noreferrer">#3503</a></li> <li>Исправлено непрерывное логгирование ошибок в <code>DDLWorker</code>, если ZooKeeper недоступен. <a href=https://github.com/yandex/ClickHouse/commit/8f50c620334988b28018213ec0092fe6423847e2 rel="external nofollow noreferrer">8f50c620</a></li> <li>Исправлен тип возвращаемого значения для функций <code>quantile*</code> от аргументов типа <code>Date</code> и <code>DateTime</code>. <a href=https://github.com/yandex/ClickHouse/pull/3580 rel="external nofollow noreferrer">#3580</a></li> <li>Исправлена работа секции <code>WITH</code>, если она задаёт простой алиас без выражений. <a href=https://github.com/yandex/ClickHouse/pull/3570 rel="external nofollow noreferrer">#3570</a></li> <li>Исправлена обработка запросов с именованными подзапросами и квалифицированными именами столбцов при включенной настройке <code>enable_optimize_predicate_expression</code>. <a href=https://github.com/yandex/ClickHouse/pull/3588 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Исправлена ошибка <code>Attempt to attach to nullptr thread group</code> при работе материализованных представлений. <a href=https://github.com/yandex/ClickHouse/pull/3623 rel="external nofollow noreferrer">Marek Vavruša</a></li> <li>Исправлено падение при передаче некоторых некорректных аргументов в функцию <code>arrayReverse</code>. <a href=https://github.com/yandex/ClickHouse/commit/73e3a7b662161d6005e7727d8a711b930386b871 rel="external nofollow noreferrer">73e3a7b6</a></li> <li>Исправлен buffer overflow в функции <code>extractURLParameter</code>. Увеличена производительность. Добавлена корректная обработка строк, содержащих нулевые байты. <a href=https://github.com/yandex/ClickHouse/commit/141e9799e49201d84ea8e951d1bed4fb6d3dacb5 rel="external nofollow noreferrer">141e9799</a></li> <li>Исправлен buffer overflow в функциях <code>lowerUTF8</code>, <code>upperUTF8</code>. Удалена возможность выполнения этих функций над аргументами типа <code>FixedString</code>. <a href=https://github.com/yandex/ClickHouse/pull/3662 rel="external nofollow noreferrer">#3662</a></li> <li>Исправлен редкий race condition при удалении таблиц типа <code>MergeTree</code>. <a href=https://github.com/yandex/ClickHouse/pull/3680 rel="external nofollow noreferrer">#3680</a></li> <li>Исправлен race condition при чтении из таблиц типа <code>Buffer</code> и одновременном <code>ALTER</code> либо <code>DROP</code> таблиц назначения. <a href=https://github.com/yandex/ClickHouse/pull/3719 rel="external nofollow noreferrer">#3719</a></li> <li>Исправлен segfault в случае превышения ограничения <code>max_temporary_non_const_columns</code>. <a href=https://github.com/yandex/ClickHouse/pull/3788 rel="external nofollow noreferrer">#3788</a></li> </ul> <h3 id=uluchsheniia_9>Улучшения:<a class=headerlink href=#uluchsheniia_9 title="Permanent link">&para;</a></h3> <ul> <li>Обработанные конфигурационные файлы записываются сервером не в <code>/etc/clickhouse-server/</code> директорию, а в директорию <code>preprocessed_configs</code> внутри <code>path</code>. Это позволяет оставить директорию <code>/etc/clickhouse-server/</code> недоступной для записи пользователем <code>clickhouse</code>, что повышает безопасность. <a href=https://github.com/yandex/ClickHouse/pull/2443 rel="external nofollow noreferrer">#2443</a></li> <li>Настройка <code>min_merge_bytes_to_use_direct_io</code> выставлена по-умолчанию в 10 GiB. Слияния, образующие крупные куски таблиц семейства MergeTree, будут производиться в режиме <code>O_DIRECT</code>, что исключает вымывание кэша. <a href=https://github.com/yandex/ClickHouse/pull/3504 rel="external nofollow noreferrer">#3504</a></li> <li>Ускорен запуск сервера в случае наличия очень большого количества таблиц. <a href=https://github.com/yandex/ClickHouse/pull/3398 rel="external nofollow noreferrer">#3398</a></li> <li>Добавлен пул соединений и HTTP <code>Keep-Alive</code> для соединения между репликами. <a href=https://github.com/yandex/ClickHouse/pull/3594 rel="external nofollow noreferrer">#3594</a></li> <li>В случае ошибки синтаксиса запроса, в <code>HTTP</code> интерфейсе возвращается код <code>400 Bad Request</code> (ранее возвращался код 500). <a href=https://github.com/yandex/ClickHouse/commit/31bc680ac5f4bb1d0360a8ba4696fa84bb47d6ab rel="external nofollow noreferrer">31bc680a</a></li> <li>Для настройки <code>join_default_strictness</code> выбрано значение по-умолчанию <code>ALL</code> для совместимости. <a href=https://github.com/yandex/ClickHouse/commit/120e2cbe2ff4fbad626c28042d9b28781c805afe rel="external nofollow noreferrer">120e2cbe</a></li> <li>Убрано логгирование в <code>stderr</code> из библиотеки <code>re2</code> в случае некорректных или сложных регулярных выражений. <a href=https://github.com/yandex/ClickHouse/pull/3723 rel="external nofollow noreferrer">#3723</a></li> <li>Для движка таблиц <code>Kafka</code>: проверка наличия подписок перед началом чтения из Kafka; настройка таблицы kafka_max_block_size. <a href=https://github.com/yandex/ClickHouse/pull/3396 rel="external nofollow noreferrer">Marek Vavruša</a></li> <li>Функции <code>cityHash64</code>, <code>farmHash64</code>, <code>metroHash64</code>, <code>sipHash64</code>, <code>halfMD5</code>, <code>murmurHash2_32</code>, <code>murmurHash2_64</code>, <code>murmurHash3_32</code>, <code>murmurHash3_64</code> теперь работают для произвольного количества аргументов, а также для аргументов-кортежей. <a href=https://github.com/yandex/ClickHouse/pull/3451 rel="external nofollow noreferrer">#3451</a> <a href=https://github.com/yandex/ClickHouse/pull/3519 rel="external nofollow noreferrer">#3519</a></li> <li>Функция <code>arrayReverse</code> теперь работает с любыми типами массивов. <a href=https://github.com/yandex/ClickHouse/commit/73e3a7b662161d6005e7727d8a711b930386b871 rel="external nofollow noreferrer">73e3a7b6</a></li> <li>Добавлен опциональный параметр - размер слота для функции <code>timeSlots</code>. <a href=https://github.com/yandex/ClickHouse/pull/3724 rel="external nofollow noreferrer">Kirill Shvakov</a></li> <li>Для <code>FULL</code> и <code>RIGHT JOIN</code> учитывается настройка <code>max_block_size</code> для потока неприсоединённых данных из правой таблицы. <a href=https://github.com/yandex/ClickHouse/pull/3699 rel="external nofollow noreferrer">Amos Bird</a></li> <li>В <code>clickhouse-benchmark</code> и <code>clickhouse-performance-test</code> добавлен параметр командной строки <code>--secure</code> для включения TLS. <a href=https://github.com/yandex/ClickHouse/pull/3688 rel="external nofollow noreferrer">#3688</a> <a href=https://github.com/yandex/ClickHouse/pull/3690 rel="external nofollow noreferrer">#3690</a></li> <li>Преобразование типов в случае, если структура таблицы типа <code>Buffer</code> не соответствует структуре таблицы назначения. <a href=https://github.com/yandex/ClickHouse/pull/3603 rel="external nofollow noreferrer">Vitaly Baranov</a></li> <li>Добавлена настройка <code>tcp_keep_alive_timeout</code> для включения keep-alive пакетов после неактивности в течение указанного интервала времени. <a href=https://github.com/yandex/ClickHouse/pull/3441 rel="external nofollow noreferrer">#3441</a></li> <li>Убрано излишнее квотирование значений ключа партиции в таблице <code>system.parts</code>, если он состоит из одного столбца. <a href=https://github.com/yandex/ClickHouse/pull/3652 rel="external nofollow noreferrer">#3652</a></li> <li>Функция деления с остатком работает для типов данных <code>Date</code> и <code>DateTime</code>. <a href=https://github.com/yandex/ClickHouse/pull/3385 rel="external nofollow noreferrer">#3385</a></li> <li>Добавлены синонимы функций <code>POWER</code>, <code>LN</code>, <code>LCASE</code>, <code>UCASE</code>, <code>REPLACE</code>, <code>LOCATE</code>, <code>SUBSTR</code>, <code>MID</code>. <a href=https://github.com/yandex/ClickHouse/pull/3774 rel="external nofollow noreferrer">#3774</a> <a href=https://github.com/yandex/ClickHouse/pull/3763 rel="external nofollow noreferrer">#3763</a> Некоторые имена функций сделаны регистронезависимыми для совместимости со стандартом SQL. Добавлен синтаксический сахар <code>SUBSTRING(expr FROM start FOR length)</code> для совместимости с SQL. <a href=https://github.com/yandex/ClickHouse/pull/3804 rel="external nofollow noreferrer">#3804</a></li> <li>Добавлена возможность фиксации (<code>mlock</code>) страниц памяти, соответствующих исполняемому коду <code>clickhouse-server</code> для предотвращения вытеснения их из памяти. Возможность выключена по-умолчанию. <a href=https://github.com/yandex/ClickHouse/pull/3553 rel="external nofollow noreferrer">#3553</a></li> <li>Увеличена производительность чтения с <code>O_DIRECT</code> (с включенной опцией <code>min_bytes_to_use_direct_io</code>). <a href=https://github.com/yandex/ClickHouse/pull/3405 rel="external nofollow noreferrer">#3405</a></li> <li>Улучшена производительность работы функции <code>dictGet...OrDefault</code> в случае константного аргумента-ключа и неконстантного аргумента-default. <a href=https://github.com/yandex/ClickHouse/pull/3563 rel="external nofollow noreferrer">Amos Bird</a></li> <li>В функции <code>firstSignificantSubdomain</code> добавлена обработка доменов <code>gov</code>, <code>mil</code>, <code>edu</code>. <a href=https://github.com/yandex/ClickHouse/pull/3601 rel="external nofollow noreferrer">Igor Hatarist</a> Увеличена производительность работы. <a href=https://github.com/yandex/ClickHouse/pull/3628 rel="external nofollow noreferrer">#3628</a></li> <li>Возможность указания произвольных переменных окружения для запуска <code>clickhouse-server</code> посредством <code>SYS-V init.d</code>-скрипта с помощью указания <code>CLICKHOUSE_PROGRAM_ENV</code> в <code>/etc/default/clickhouse</code>.<br> <a href=https://github.com/yandex/ClickHouse/pull/3612 rel="external nofollow noreferrer">Pavlo Bashynskyi</a></li> <li>Правильный код возврата init-скрипта clickhouse-server. <a href=https://github.com/yandex/ClickHouse/pull/3516 rel="external nofollow noreferrer">#3516</a></li> <li>В таблицу <code>system.metrics</code> добавлена метрика <code>VersionInteger</code>, а в <code>system.build_options</code> добавлена строчка <code>VERSION_INTEGER</code>, содержащая версию ClickHouse в числовом представлении, вида <code>18016000</code>. <a href=https://github.com/yandex/ClickHouse/pull/3644 rel="external nofollow noreferrer">#3644</a></li> <li>Удалена возможность сравнения типа <code>Date</code> с числом, чтобы избежать потенциальных ошибок вида <code>date = 2018-12-17</code>, где ошибочно не указаны кавычки вокруг даты. <a href=https://github.com/yandex/ClickHouse/pull/3687 rel="external nofollow noreferrer">#3687</a></li> <li>Исправлено поведение функций с состоянием типа <code>rowNumberInAllBlocks</code> - раньше они выдавали число на единицу больше вследствие их запуска во время анализа запроса. <a href=https://github.com/yandex/ClickHouse/pull/3729 rel="external nofollow noreferrer">Amos Bird</a></li> <li>При невозможности удалить файл <code>force_restore_data</code>, выводится сообщение об ошибке. <a href=https://github.com/yandex/ClickHouse/pull/3794 rel="external nofollow noreferrer">Amos Bird</a></li> </ul> <h3 id=uluchshenie-sborki>Улучшение сборки:<a class=headerlink href=#uluchshenie-sborki title="Permanent link">&para;</a></h3> <ul> <li>Обновлена библиотека <code>jemalloc</code>, что исправляет потенциальную утечку памяти. <a href=https://github.com/yandex/ClickHouse/pull/3557 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Для debug сборок включено по-умолчанию профилирование <code>jemalloc</code>. <a href=https://github.com/yandex/ClickHouse/commit/2cc82f5cbe266421cd4c1165286c2c47e5ffcb15 rel="external nofollow noreferrer">2cc82f5c</a></li> <li>Добавлена возможность запуска интеграционных тестов, при наличии установленным в системе лишь <code>Docker</code>. <a href=https://github.com/yandex/ClickHouse/pull/3650 rel="external nofollow noreferrer">#3650</a></li> <li>Добавлен fuzz тест выражений в SELECT запросах. <a href=https://github.com/yandex/ClickHouse/pull/3442 rel="external nofollow noreferrer">#3442</a></li> <li>Добавлен покоммитный стресс-тест, выполняющий функциональные тесты параллельно и в произвольном порядке, позволяющий обнаружить больше race conditions. <a href=https://github.com/yandex/ClickHouse/pull/3438 rel="external nofollow noreferrer">#3438</a></li> <li>Улучшение способа запуска clickhouse-server в Docker образе. <a href=https://github.com/yandex/ClickHouse/pull/3663 rel="external nofollow noreferrer">Elghazal Ahmed</a></li> <li>Для Docker образа добавлена поддержка инициализации базы данных с помощью файлов в директории <code>/docker-entrypoint-initdb.d</code>. <a href=https://github.com/yandex/ClickHouse/pull/3695 rel="external nofollow noreferrer">Konstantin Lebedev</a></li> <li>Исправления для сборки под ARM. <a href=https://github.com/yandex/ClickHouse/pull/3709 rel="external nofollow noreferrer">#3709</a></li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_4>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_4 title="Permanent link">&para;</a></h3> <ul> <li>Удалена возможность сравнения типа <code>Date</code> с числом, необходимо вместо <code>toDate('2018-12-18') = 17883</code>, использовать явное приведение типов <code>= toDate(17883)</code> <a href=https://github.com/yandex/ClickHouse/pull/3687 rel="external nofollow noreferrer">#3687</a></li> </ul> <h2 id=clickhouse-release-18-14-19-2018-12-19>ClickHouse release 18.14.19, 2018-12-19<a class=headerlink href=#clickhouse-release-18-14-19-2018-12-19 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_22>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_22 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена проблема, приводившая к невозможности обновить словари с источником ODBC. <a href=https://github.com/yandex/ClickHouse/issues/3825 rel="external nofollow noreferrer">#3825</a>, <a href=https://github.com/yandex/ClickHouse/issues/3829 rel="external nofollow noreferrer">#3829</a></li> <li>Исправлен segfault в случае превышения ограничения <code>max_temporary_non_const_columns</code>. <a href=https://github.com/yandex/ClickHouse/pull/3788 rel="external nofollow noreferrer">#3788</a></li> <li>Корректное указание базы данных при выполнении DDL запросов <code>ON CLUSTER</code>. <a href=https://github.com/yandex/ClickHouse/pull/3460 rel="external nofollow noreferrer">#3460</a></li> </ul> <h3 id=uluchsheniia-sborki_1>Улучшения сборки:<a class=headerlink href=#uluchsheniia-sborki_1 title="Permanent link">&para;</a></h3> <ul> <li>Исправления сборки под ARM.</li> </ul> <h2 id=clickhouse-release-18-14-18-2018-12-04>ClickHouse release 18.14.18, 2018-12-04<a class=headerlink href=#clickhouse-release-18-14-18-2018-12-04 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_23>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_23 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка в функции <code>dictGet...</code> для словарей типа <code>range</code>, если один из аргументов константный, а другой - нет. <a href=https://github.com/yandex/ClickHouse/pull/3751 rel="external nofollow noreferrer">#3751</a></li> <li>Исправлена ошибка, приводящая к выводу сообщений <code>netlink: '...': attribute type 1 has an invalid length</code> в логе ядра Linux, проявляющаяся на достаточно новых ядрах Linux. <a href=https://github.com/yandex/ClickHouse/pull/3749 rel="external nofollow noreferrer">#3749</a></li> <li>Исправлен segfault при выполнении функции <code>empty</code> от аргумента типа <code>FixedString</code>. <a href=https://github.com/yandex/ClickHouse/pull/3703 rel="external nofollow noreferrer">Daniel, Dao Quang Minh</a></li> <li>Исправлена избыточная аллокация памяти при большом значении настройки <code>max_query_size</code> (кусок памяти размера <code>max_query_size</code> выделялся сразу). <a href=https://github.com/yandex/ClickHouse/pull/3720 rel="external nofollow noreferrer">#3720</a></li> </ul> <h3 id=uluchsheniia-protsessa-sborki-clickhouse>Улучшения процесса сборки ClickHouse:<a class=headerlink href=#uluchsheniia-protsessa-sborki-clickhouse title="Permanent link">&para;</a></h3> <ul> <li>Исправлена сборка с использованием библиотек LLVM/Clang версии 7 из пакетов ОС (эти библиотеки используются для динамической компиляции запросов). <a href=https://github.com/yandex/ClickHouse/pull/3582 rel="external nofollow noreferrer">#3582</a></li> </ul> <h2 id=clickhouse-release-18-14-17-2018-11-30>ClickHouse release 18.14.17, 2018-11-30<a class=headerlink href=#clickhouse-release-18-14-17-2018-11-30 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_24>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_24 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ситуация, при которой ODBC Bridge продолжал работу после завершения работы сервера ClickHouse. Теперь ODBC Bridge всегда завершает работу вместе с сервером. <a href=https://github.com/yandex/ClickHouse/pull/3642 rel="external nofollow noreferrer">#3642</a></li> <li>Исправлена синхронная вставка в <code>Distributed</code> таблицу в случае явного указания неполного списка столбцов или списка столбцов в измененном порядке. <a href=https://github.com/yandex/ClickHouse/pull/3673 rel="external nofollow noreferrer">#3673</a></li> <li>Исправлен редкий race condition, который мог привести к падению сервера при удалении MergeTree-таблиц. <a href=https://github.com/yandex/ClickHouse/pull/3680 rel="external nofollow noreferrer">#3680</a></li> <li>Исправлен deadlock при выполнении запроса, возникающий если создание новых потоков выполнения невозможно из-за ошибки <code>Resource temporarily unavailable</code>. <a href=https://github.com/yandex/ClickHouse/pull/3643 rel="external nofollow noreferrer">#3643</a></li> <li>Исправлена ошибка парсинга <code>ENGINE</code> при создании таблицы с синтаксисом <code>AS table</code> в случае, когда <code>AS table</code> указывался после <code>ENGINE</code>, что приводило к игнорированию указанного движка. <a href=https://github.com/yandex/ClickHouse/pull/3692 rel="external nofollow noreferrer">#3692</a></li> </ul> <h2 id=clickhouse-release-18-14-15-2018-11-21>ClickHouse release 18.14.15, 2018-11-21<a class=headerlink href=#clickhouse-release-18-14-15-2018-11-21 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_25>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_25 title="Permanent link">&para;</a></h3> <ul> <li>При чтении столбцов типа <code>Array(String)</code>, размер требуемого куска памяти оценивался слишком большим, что приводило к исключению "Memory limit exceeded" при выполнении запроса. Ошибка появилась в версии 18.12.13. <a href=https://github.com/yandex/ClickHouse/issues/3589 rel="external nofollow noreferrer">#3589</a></li> </ul> <h2 id=clickhouse-release-18-14-14-2018-11-20>ClickHouse release 18.14.14, 2018-11-20<a class=headerlink href=#clickhouse-release-18-14-14-2018-11-20 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_26>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_26 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена работа запросов <code>ON CLUSTER</code> в случае, когда в конфигурации кластера включено шифрование (флаг <code>&lt;secure&gt;</code>). <a href=https://github.com/yandex/ClickHouse/pull/3599 rel="external nofollow noreferrer">#3599</a></li> </ul> <h3 id=uluchsheniia-protsessa-sborki-clickhouse_1>Улучшения процесса сборки ClickHouse:<a class=headerlink href=#uluchsheniia-protsessa-sborki-clickhouse_1 title="Permanent link">&para;</a></h3> <ul> <li>Исправлены проблемы сборки (llvm-7 из системы, macos) <a href=https://github.com/yandex/ClickHouse/pull/3582 rel="external nofollow noreferrer">#3582</a></li> </ul> <h2 id=clickhouse-release-18-14-13-2018-11-08>ClickHouse release 18.14.13, 2018-11-08<a class=headerlink href=#clickhouse-release-18-14-13-2018-11-08 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_27>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_27 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка <code>Block structure mismatch in MergingSorted stream</code>. <a href=https://github.com/yandex/ClickHouse/issues/3162 rel="external nofollow noreferrer">#3162</a></li> <li>Исправлена работа запросов <code>ON CLUSTER</code> в случае, когда в конфигурации кластера включено шифрование (флаг <code>&lt;secure&gt;</code>). <a href=https://github.com/yandex/ClickHouse/pull/3465 rel="external nofollow noreferrer">#3465</a></li> <li>Исправлена ошибка при использовании <code>SAMPLE</code>, <code>PREWHERE</code> и столбцов-алиасов. <a href=https://github.com/yandex/ClickHouse/pull/3543 rel="external nofollow noreferrer">#3543</a></li> <li>Исправлена редкая ошибка <code>unknown compression method</code> при использовании настройки <code>min_bytes_to_use_direct_io</code>. <a href=https://github.com/yandex/ClickHouse/pull/3544 rel="external nofollow noreferrer">3544</a></li> </ul> <h3 id=uluchsheniia-proizvoditelnosti_5>Улучшения производительности:<a class=headerlink href=#uluchsheniia-proizvoditelnosti_5 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена деградация производительности запросов с <code>GROUP BY</code> столбцов типа Int16, Date на процессорах AMD EPYC. <a href=https://github.com/yandex/ClickHouse/pull/3512 rel="external nofollow noreferrer">Игорь Лапко</a></li> <li>Исправлена деградация производительности при обработке длинных строк. <a href=https://github.com/yandex/ClickHouse/pull/3530 rel="external nofollow noreferrer">#3530</a></li> </ul> <h3 id=uluchsheniia-protsessa-sborki-clickhouse_2>Улучшения процесса сборки ClickHouse:<a class=headerlink href=#uluchsheniia-protsessa-sborki-clickhouse_2 title="Permanent link">&para;</a></h3> <ul> <li>Доработки для упрощения сборки в Arcadia. <a href=https://github.com/yandex/ClickHouse/pull/3475 rel="external nofollow noreferrer">#3475</a>, <a href=https://github.com/yandex/ClickHouse/pull/3535 rel="external nofollow noreferrer">#3535</a></li> </ul> <h2 id=clickhouse-release-18-14-12-2018-11-02>ClickHouse release 18.14.12, 2018-11-02<a class=headerlink href=#clickhouse-release-18-14-12-2018-11-02 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_28>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_28 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка при join-запросе двух неименованных подзапросов. <a href=https://github.com/yandex/ClickHouse/pull/3505 rel="external nofollow noreferrer">#3505</a></li> <li>Исправлена генерация пустой <code>WHERE</code>-части при запросах к внешним базам. <a href=https://github.com/yandex/ClickHouse/pull/3477 rel="external nofollow noreferrer">hotid</a></li> <li>Исправлена ошибка использования неправильной настройки таймаута в ODBC-словарях. <a href=https://github.com/yandex/ClickHouse/pull/3511 rel="external nofollow noreferrer">Marek Vavruša</a></li> </ul> <h2 id=clickhouse-release-18-14-11-2018-10-29>ClickHouse release 18.14.11, 2018-10-29<a class=headerlink href=#clickhouse-release-18-14-11-2018-10-29 title="Permanent link">&para;</a></h2> <h3 id=ispravleniia-oshibok_29>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_29 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка <code>Block structure mismatch in UNION stream: different number of columns</code> в запросах с LIMIT. <a href=https://github.com/yandex/ClickHouse/issues/2156 rel="external nofollow noreferrer">#2156</a></li> <li>Исправлены ошибки при слиянии данных в таблицах, содержащих массивы внутри Nested структур. <a href=https://github.com/yandex/ClickHouse/pull/3397 rel="external nofollow noreferrer">#3397</a></li> <li>Исправлен неправильный результат запросов при выключенной настройке <code>merge_tree_uniform_read_distribution</code> (включена по умолчанию). <a href=https://github.com/yandex/ClickHouse/pull/3429 rel="external nofollow noreferrer">#3429</a></li> <li>Исправлена ошибка при вставке в Distributed таблицу в формате Native. <a href=https://github.com/yandex/ClickHouse/issues/3411 rel="external nofollow noreferrer">#3411</a></li> </ul> <h2 id=clickhouse-release-18-14-10-2018-10-23>ClickHouse release 18.14.10, 2018-10-23<a class=headerlink href=#clickhouse-release-18-14-10-2018-10-23 title="Permanent link">&para;</a></h2> <ul> <li>Настройка <code>compile_expressions</code> (JIT компиляция выражений) выключена по умолчанию. <a href=https://github.com/yandex/ClickHouse/pull/3410 rel="external nofollow noreferrer">#3410</a></li> <li>Настройка <code>enable_optimize_predicate_expression</code> выключена по умолчанию.</li> </ul> <h2 id=clickhouse-release-18-14-9-2018-10-16>ClickHouse release 18.14.9, 2018-10-16<a class=headerlink href=#clickhouse-release-18-14-9-2018-10-16 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_9>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_9 title="Permanent link">&para;</a></h3> <ul> <li>Модификатор <code>WITH CUBE</code> для <code>GROUP BY</code> (также доступен синтаксис: <code>GROUP BY CUBE(...)</code>). <a href=https://github.com/yandex/ClickHouse/pull/3172 rel="external nofollow noreferrer">#3172</a></li> <li>Добавлена функция <code>formatDateTime</code>. <a href=https://github.com/yandex/ClickHouse/pull/2770 rel="external nofollow noreferrer">Alexandr Krasheninnikov</a></li> <li>Добавлен движок таблиц <code>JDBC</code> и табличная функция <code>jdbc</code> (для работы требуется установка clickhouse-jdbc-bridge). <a href=https://github.com/yandex/ClickHouse/pull/3210 rel="external nofollow noreferrer">Alexandr Krasheninnikov</a></li> <li>Добавлены функции для работы с ISO номером недели: <code>toISOWeek</code>, <code>toISOYear</code>, <code>toStartOfISOYear</code>, а также <code>toDayOfYear</code>. <a href=https://github.com/yandex/ClickHouse/pull/3146 rel="external nofollow noreferrer">#3146</a></li> <li>Добавлена возможность использования столбцов типа <code>Nullable</code> для таблиц типа <code>MySQL</code>, <code>ODBC</code>. <a href=https://github.com/yandex/ClickHouse/pull/3362 rel="external nofollow noreferrer">#3362</a></li> <li>Возможность чтения вложенных структур данных как вложенных объектов в формате <code>JSONEachRow</code>. Добавлена настройка <code>input_format_import_nested_json</code>. <a href=https://github.com/yandex/ClickHouse/pull/3144 rel="external nofollow noreferrer">Veloman Yunkan</a></li> <li>Возможность параллельной обработки многих <code>MATERIALIZED VIEW</code> при вставке данных. Настройка <code>parallel_view_processing</code>. <a href=https://github.com/yandex/ClickHouse/pull/3208 rel="external nofollow noreferrer">Marek Vavruša</a></li> <li>Добавлен запрос <code>SYSTEM FLUSH LOGS</code> (форсированный сброс логов в системные таблицы, такие как например, <code>query_log</code>) <a href=https://github.com/yandex/ClickHouse/pull/3321 rel="external nofollow noreferrer">#3321</a></li> <li>Возможность использования предопределённых макросов <code>database</code> и <code>table</code> в объявлении <code>Replicated</code> таблиц. <a href=https://github.com/yandex/ClickHouse/pull/3251 rel="external nofollow noreferrer">#3251</a></li> <li>Добавлена возможность чтения значения типа <code>Decimal</code> в инженерной нотации (с указанием десятичной экспоненты). <a href=https://github.com/yandex/ClickHouse/pull/3153 rel="external nofollow noreferrer">#3153</a></li> </ul> <h3 id=eksperimentalnye-vozmozhnosti_3>Экспериментальные возможности:<a class=headerlink href=#eksperimentalnye-vozmozhnosti_3 title="Permanent link">&para;</a></h3> <ul> <li>Оптимизация GROUP BY для типов данных <code>LowCardinality</code> <a href=https://github.com/yandex/ClickHouse/pull/3138 rel="external nofollow noreferrer">#3138</a></li> <li>Оптимизации вычисления выражений для типов данных <code>LowCardinality</code> <a href=https://github.com/yandex/ClickHouse/pull/3200 rel="external nofollow noreferrer">#3200</a></li> </ul> <h3 id=uluchsheniia_10>Улучшения:<a class=headerlink href=#uluchsheniia_10 title="Permanent link">&para;</a></h3> <ul> <li>Существенно уменьшено потребление памяти для запросов с <code>ORDER BY</code> и <code>LIMIT</code>. Настройка <code>max_bytes_before_remerge_sort</code>. <a href=https://github.com/yandex/ClickHouse/pull/3205 rel="external nofollow noreferrer">#3205</a></li> <li>При отсутствии указания типа <code>JOIN</code> (<code>LEFT</code>, <code>INNER</code>, ...), подразумевается <code>INNER JOIN</code>. <a href=https://github.com/yandex/ClickHouse/pull/3147 rel="external nofollow noreferrer">#3147</a></li> <li>Корректная работа квалифицированных звёздочек в запросах с <code>JOIN</code>. <a href=https://github.com/yandex/ClickHouse/pull/3202 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Движок таблиц <code>ODBC</code> корректно выбирает способ квотирования идентификаторов в SQL диалекте удалённой СУБД. <a href=https://github.com/yandex/ClickHouse/pull/3210 rel="external nofollow noreferrer">Alexandr Krasheninnikov</a></li> <li>Настройка <code>compile_expressions</code> (JIT компиляция выражений) включена по-умолчанию.</li> <li>Исправлено поведение при одновременном DROP DATABASE/TABLE IF EXISTS и CREATE DATABASE/TABLE IF NOT EXISTS. Ранее запрос <code>CREATE DATABASE ... IF NOT EXISTS</code> мог выдавать сообщение об ошибке вида "File ... already exists", а запросы <code>CREATE TABLE ... IF NOT EXISTS</code> и <code>DROP TABLE IF EXISTS</code> могли выдавать сообщение <code>Table ... is creating or attaching right now</code>. <a href=https://github.com/yandex/ClickHouse/pull/3101 rel="external nofollow noreferrer">#3101</a></li> <li>Выражения LIKE и IN с константной правой частью пробрасываются на удалённый сервер при запросах из таблиц типа MySQL и ODBC. <a href=https://github.com/yandex/ClickHouse/pull/3182 rel="external nofollow noreferrer">#3182</a></li> <li>Сравнения с константными выражениями в секции WHERE пробрасываются на удалённый сервер при запросах из таблиц типа MySQL и ODBC. Ранее пробрасывались только сравнения с константами. <a href=https://github.com/yandex/ClickHouse/pull/3182 rel="external nofollow noreferrer">#3182</a></li> <li>Корректное вычисление ширины строк в терминале для <code>Pretty</code> форматов, в том числе для строк с иероглифами. <a href=https://github.com/yandex/ClickHouse/pull/3257 rel="external nofollow noreferrer">Amos Bird</a>.</li> <li>Возможность указания <code>ON CLUSTER</code> для запросов <code>ALTER UPDATE</code>.</li> <li>Увеличена производительность чтения данных в формате <code>JSONEachRow</code>. <a href=https://github.com/yandex/ClickHouse/pull/3332 rel="external nofollow noreferrer">#3332</a></li> <li>Добавлены синонимы функций <code>LENGTH</code>, <code>CHARACTER_LENGTH</code> для совместимости. Функция <code>CONCAT</code> стала регистронезависимой. <a href=https://github.com/yandex/ClickHouse/pull/3306 rel="external nofollow noreferrer">#3306</a></li> <li>Добавлен синоним <code>TIMESTAMP</code> для типа <code>DateTime</code>. <a href=https://github.com/yandex/ClickHouse/pull/3390 rel="external nofollow noreferrer">#3390</a></li> <li>В логах сервера всегда присутствует место для query_id, даже если строчка лога не относится к запросу. Это сделано для более простого парсинга текстовых логов сервера сторонними инструментами.</li> <li>Логгирование потребления памяти запросом при превышении очередной отметки целого числа гигабайт. <a href=https://github.com/yandex/ClickHouse/pull/3205 rel="external nofollow noreferrer">#3205</a></li> <li>Добавлен режим совместимости для случая, когда клиентская библиотека, работающая по Native протоколу, по ошибке отправляет меньшее количество столбцов, чем сервер ожидает для запроса INSERT. Такой сценарий был возможен при использовании библиотеки clickhouse-cpp. Ранее этот сценарий приводил к падению сервера. <a href=https://github.com/yandex/ClickHouse/pull/3171 rel="external nofollow noreferrer">#3171</a></li> <li>В <code>clickhouse-copier</code>, в задаваемом пользователем выражении WHERE, появилась возможность использовать алиас <code>partition_key</code> (для дополнительной фильтрации по партициям исходной таблицы). Это полезно, если схема партиционирования изменяется при копировании, но изменяется незначительно. <a href=https://github.com/yandex/ClickHouse/pull/3166 rel="external nofollow noreferrer">#3166</a></li> <li>Рабочий поток движка <code>Kafka</code> перенесён в фоновый пул потоков для того, чтобы автоматически уменьшать скорость чтения данных при большой нагрузке. <a href=https://github.com/yandex/ClickHouse/pull/3215 rel="external nofollow noreferrer">Marek Vavruša</a>.</li> <li>Поддержка чтения значений типа <code>Tuple</code> и <code>Nested</code> структур как <code>struct</code> в формате <code>Cap'n'Proto</code> <a href=https://github.com/yandex/ClickHouse/pull/3216 rel="external nofollow noreferrer">Marek Vavruša</a>.</li> <li>В список доменов верхнего уровня для функции <code>firstSignificantSubdomain</code> добавлен домен <code>biz</code> <a href=https://github.com/yandex/ClickHouse/pull/3219 rel="external nofollow noreferrer">decaseal</a>.</li> <li>В конфигурации внешних словарей, пустое значение <code>null_value</code> интерпретируется, как значение типа данных по-умоланию. <a href=https://github.com/yandex/ClickHouse/pull/3330 rel="external nofollow noreferrer">#3330</a></li> <li>Поддержка функций <code>intDiv</code>, <code>intDivOrZero</code> для <code>Decimal</code>. <a href=https://github.com/yandex/ClickHouse/commit/b48402e8712e2b9b151e0eef8193811d433a1264 rel="external nofollow noreferrer">b48402e8</a></li> <li>Поддержка типов <code>Date</code>, <code>DateTime</code>, <code>UUID</code>, <code>Decimal</code> в качестве ключа для агрегатной функции <code>sumMap</code>. <a href=https://github.com/yandex/ClickHouse/pull/3281 rel="external nofollow noreferrer">#3281</a></li> <li>Поддержка типа данных <code>Decimal</code> во внешних словарях. <a href=https://github.com/yandex/ClickHouse/pull/3324 rel="external nofollow noreferrer">#3324</a></li> <li>Поддержка типа данных <code>Decimal</code> в таблицах типа <code>SummingMergeTree</code>. <a href=https://github.com/yandex/ClickHouse/pull/3348 rel="external nofollow noreferrer">#3348</a></li> <li>Добавлена специализация для <code>UUID</code> в функции <code>if</code>. <a href=https://github.com/yandex/ClickHouse/pull/3366 rel="external nofollow noreferrer">#3366</a></li> <li>Уменьшено количество системных вызовов <code>open</code>, <code>close</code> при чтении из таблиц семейства <code>MergeTree</code> <a href=https://github.com/yandex/ClickHouse/pull/3283 rel="external nofollow noreferrer">#3283</a>.</li> <li>Возможность выполнения запроса <code>TRUNCATE TABLE</code> на любой реплике (запрос пробрасывается на реплику-лидера). <a href=https://github.com/yandex/ClickHouse/pull/3375 rel="external nofollow noreferrer">Kirill Shvakov</a></li> </ul> <h3 id=ispravlenie-oshibok_4>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_4 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка в работе таблиц типа <code>Dictionary</code> для словарей типа <code>range_hashed</code>. Ошибка возникла в версии 18.12.17. <a href=https://github.com/yandex/ClickHouse/pull/1702 rel="external nofollow noreferrer">#1702</a></li> <li>Исправлена ошибка при загрузке словарей типа <code>range_hashed</code> (сообщение <code>Unsupported type Nullable(...)</code>). Ошибка возникла в версии 18.12.17. <a href=https://github.com/yandex/ClickHouse/pull/3362 rel="external nofollow noreferrer">#3362</a></li> <li>Исправлена некорректная работа функции <code>pointInPolygon</code> из-за накопления погрешности при вычислениях для полигонов с большим количеством близко расположенных вершин. <a href=https://github.com/yandex/ClickHouse/pull/3331 rel="external nofollow noreferrer">#3331</a> <a href=https://github.com/yandex/ClickHouse/pull/3341 rel="external nofollow noreferrer">#3341</a></li> <li>Если после слияния кусков данных, у результирующего куска чексумма отличается от результата того же слияния на другой реплике, то результат слияния удаляется, и вместо этого кусок скачивается с другой реплики (это правильное поведение). Но после скачивания куска, он не мог добавиться в рабочий набор из-за ошибки, что кусок уже существует (так как кусок после слияния удалялся не сразу, а с задержкой). Это приводило к циклическим попыткам скачивания одних и тех же данных. <a href=https://github.com/yandex/ClickHouse/pull/3194 rel="external nofollow noreferrer">#3194</a></li> <li>Исправлен некорректный учёт общего потребления оперативной памяти запросами (что приводило к неправильной работе настройки <code>max_memory_usage_for_all_queries</code> и неправильному значению метрики <code>MemoryTracking</code>). Ошибка возникла в версии 18.12.13. <a href=https://github.com/yandex/ClickHouse/pull/3344 rel="external nofollow noreferrer">Marek Vavruša</a></li> <li>Исправлена работоспособность запросов <code>CREATE TABLE ... ON CLUSTER ... AS SELECT ...</code> Ошибка возникла в версии 18.12.13. <a href=https://github.com/yandex/ClickHouse/pull/3247 rel="external nofollow noreferrer">#3247</a></li> <li>Исправлена лишняя подготовка структуры данных для <code>JOIN</code> на сервере-инициаторе запроса, если <code>JOIN</code> выполняется только на удалённых серверах. <a href=https://github.com/yandex/ClickHouse/pull/3340 rel="external nofollow noreferrer">#3340</a></li> <li>Исправлены ошибки в движке <code>Kafka</code>: неработоспособность после исключения при начале чтения данных; блокировка при завершении <a href=https://github.com/yandex/ClickHouse/pull/3215 rel="external nofollow noreferrer">Marek Vavruša</a>.</li> <li>Для таблиц <code>Kafka</code> не передавался опциональный параметр <code>schema</code> (схема формата <code>Cap'n'Proto</code>). <a href=https://github.com/yandex/ClickHouse/pull/3150 rel="external nofollow noreferrer">Vojtech Splichal</a></li> <li>Если ансамбль серверов ZooKeeper содержит серверы, которые принимают соединение, но сразу же разрывают его вместо ответа на рукопожатие, то ClickHouse выбирает для соединения другой сервер. Ранее в этом случае возникала ошибка <code>Cannot read all data. Bytes read: 0. Bytes expected: 4.</code> и сервер не мог стартовать. <a href=https://github.com/yandex/ClickHouse/commit/8218cf3a5f39a43401953769d6d12a0bb8d29da9 rel="external nofollow noreferrer">8218cf3a</a></li> <li>Если ансамбль серверов ZooKeeper содержит серверы, для которых DNS запрос возвращает ошибку, то такие серверы пропускаются. <a href=https://github.com/yandex/ClickHouse/commit/17b8e209221061325ad7ba0539f03c6e65f87f29 rel="external nofollow noreferrer">17b8e209</a></li> <li>Исправлено преобразование типов между <code>Date</code> и <code>DateTime</code> при вставке данных в формате <code>VALUES</code> (в случае, когда <code>input_format_values_interpret_expressions = 1</code>). Ранее преобразование производилось между числовым значением количества дней с начала unix эпохи и unix timestamp, что приводило к неожиданным результатам. <a href=https://github.com/yandex/ClickHouse/pull/3229 rel="external nofollow noreferrer">#3229</a></li> <li>Исправление преобразования типов между <code>Decimal</code> и целыми числами. <a href=https://github.com/yandex/ClickHouse/pull/3211 rel="external nofollow noreferrer">#3211</a></li> <li>Исправлены ошибки в работе настройки <code>enable_optimize_predicate_expression</code>. <a href=https://github.com/yandex/ClickHouse/pull/3231 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Исправлена ошибка парсинга формата CSV с числами с плавающей запятой, если используется разделитель CSV не по-умолчанию, такой как например, <code>;</code> <a href=https://github.com/yandex/ClickHouse/pull/3155 rel="external nofollow noreferrer">#3155</a>.</li> <li>Исправлена функция <code>arrayCumSumNonNegative</code> (она не накапливает отрицательные значения, если аккумулятор становится меньше нуля). <a href=https://github.com/yandex/ClickHouse/pull/3163 rel="external nofollow noreferrer">Aleksey Studnev</a></li> <li>Исправлена работа <code>Merge</code> таблицы поверх <code>Distributed</code> таблиц при использовании <code>PREWHERE</code>. <a href=https://github.com/yandex/ClickHouse/pull/3165 rel="external nofollow noreferrer">#3165</a></li> <li>Исправления ошибок в запросе <code>ALTER UPDATE</code>.</li> <li>Исправления ошибок в табличной функции <code>odbc</code>, которые возникли в версии 18.12. <a href=https://github.com/yandex/ClickHouse/pull/3197 rel="external nofollow noreferrer">#3197</a></li> <li>Исправлена работа агрегатных функций с комбинаторами <code>StateArray</code>. <a href=https://github.com/yandex/ClickHouse/pull/3188 rel="external nofollow noreferrer">#3188</a></li> <li>Исправлено падение при делении значения типа <code>Decimal</code> на ноль. <a href=https://github.com/yandex/ClickHouse/commit/69dd6609193beb4e7acd3e6ad216eca0ccfb8179 rel="external nofollow noreferrer">69dd6609</a></li> <li>Исправлен вывод типов для операций с использованием аргументов типа <code>Decimal</code> и целых чисел. <a href=https://github.com/yandex/ClickHouse/pull/3224 rel="external nofollow noreferrer">#3224</a></li> <li>Исправлен segfault при <code>GROUP BY</code> по <code>Decimal128</code>. <a href=https://github.com/yandex/ClickHouse/commit/3359ba06c39fcd05bfdb87d6c64154819621e13a rel="external nofollow noreferrer">3359ba06</a></li> <li>Настройка <code>log_query_threads</code> (логгирование информации о каждом потоке исполнения запроса) теперь имеет эффект только если настройка <code>log_queries</code> (логгирование информации о запросах) выставлена в 1. Так как настройка <code>log_query_threads</code> включена по-умолчанию, ранее информация о потоках логгировалась даже если логгирование запросов выключено. <a href=https://github.com/yandex/ClickHouse/pull/3241 rel="external nofollow noreferrer">#3241</a></li> <li>Исправлена ошибка в распределённой работе агрегатной функции quantiles (сообщение об ошибке вида <code>Not found column quantile...</code>). <a href=https://github.com/yandex/ClickHouse/commit/292a885533b8e3b41ce8993867069d14cbd5a664 rel="external nofollow noreferrer">292a8855</a></li> <li>Исправлена проблема совместимости при одновременной работе на кластере серверов версии 18.12.17 и более старых, приводящая к тому, что при распределённых запросах с GROUP BY по ключам одновременно фиксированной и не фиксированной длины, при условии, что количество данных в процессе агрегации большое, могли возвращаться не до конца агрегированные данные (одни и те же ключи агрегации в двух разных строках). <a href=https://github.com/yandex/ClickHouse/pull/3254 rel="external nofollow noreferrer">#3254</a></li> <li>Исправлена обработка подстановок в <code>clickhouse-performance-test</code>, если запрос содержит только часть из объявленных в тесте подстановок. <a href=https://github.com/yandex/ClickHouse/pull/3263 rel="external nofollow noreferrer">#3263</a></li> <li>Исправлена ошибка при использовании <code>FINAL</code> совместно с <code>PREWHERE</code>. <a href=https://github.com/yandex/ClickHouse/pull/3298 rel="external nofollow noreferrer">#3298</a></li> <li>Исправлена ошибка при использовании <code>PREWHERE</code> над столбцами, добавленными при <code>ALTER</code>. <a href=https://github.com/yandex/ClickHouse/pull/3298 rel="external nofollow noreferrer">#3298</a></li> <li>Добавлена проверка отсутствия <code>arrayJoin</code> для <code>DEFAULT</code>, <code>MATERIALIZED</code> выражений. Ранее наличие <code>arrayJoin</code> приводило к ошибке при вставке данных. <a href=https://github.com/yandex/ClickHouse/pull/3337 rel="external nofollow noreferrer">#3337</a></li> <li>Добавлена проверка отсутствия <code>arrayJoin</code> в секции <code>PREWHERE</code>. Ранее это приводило к сообщениям вида <code>Size ... doesn't match</code> или <code>Unknown compression method</code> при выполнении запросов. <a href=https://github.com/yandex/ClickHouse/pull/3357 rel="external nofollow noreferrer">#3357</a></li> <li>Исправлен segfault, который мог возникать в редких случаях после оптимизации - замены цепочек AND из равенства выражения константам на соответствующее выражение IN. <a href=https://github.com/yandex/ClickHouse/pull/3339 rel="external nofollow noreferrer">liuyimin-bytedance</a>.</li> <li>Мелкие исправления <code>clickhouse-benchmark</code>: ранее информация о клиенте не передавалась на сервер; более корректный подсчёт числа выполненных запросов при завершении работы и для ограничения числа итераций. <a href=https://github.com/yandex/ClickHouse/pull/3351 rel="external nofollow noreferrer">#3351</a> <a href=https://github.com/yandex/ClickHouse/pull/3352 rel="external nofollow noreferrer">#3352</a></li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_5>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_5 title="Permanent link">&para;</a></h3> <ul> <li>Удалена настройка <code>allow_experimental_decimal_type</code>. Тип данных <code>Decimal</code> доступен для использования по-умолчанию. <a href=https://github.com/yandex/ClickHouse/pull/3329 rel="external nofollow noreferrer">#3329</a></li> </ul> <h2 id=clickhouse-release-18-12-17-2018-09-16>ClickHouse release 18.12.17, 2018-09-16<a class=headerlink href=#clickhouse-release-18-12-17-2018-09-16 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_10>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_10 title="Permanent link">&para;</a></h3> <ul> <li><code>invalidate_query</code> (возможность задать запрос для проверки необходимости обновления внешнего словаря) реализована для источника <code>clickhouse</code>. <a href=https://github.com/yandex/ClickHouse/pull/3126 rel="external nofollow noreferrer">#3126</a></li> <li>Добавлена возможность использования типов данных <code>UInt*</code>, <code>Int*</code>, <code>DateTime</code> (наравне с типом <code>Date</code>) в качестве ключа внешнего словаря типа <code>range_hashed</code>, определяющего границы диапазонов. Возможность использования <code>NULL</code> в качестве обозначения открытого диапазона. <a href=https://github.com/yandex/ClickHouse/pull/3123 rel="external nofollow noreferrer">Vasily Nemkov</a></li> <li>Для типа <code>Decimal</code> добавлена поддержка агрегатных функций <code>var*</code>, <code>stddev*</code>. <a href=https://github.com/yandex/ClickHouse/pull/3129 rel="external nofollow noreferrer">#3129</a></li> <li>Для типа <code>Decimal</code> добавлена поддержка математических функций (<code>exp</code>, <code>sin</code> и т. п.) <a href=https://github.com/yandex/ClickHouse/pull/3129 rel="external nofollow noreferrer">#3129</a></li> <li>В таблицу <code>system.part_log</code> добавлен столбец <code>partition_id</code>. <a href=https://github.com/yandex/ClickHouse/pull/3089 rel="external nofollow noreferrer">#3089</a></li> </ul> <h3 id=ispravlenie-oshibok_5>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_5 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена работа <code>Merge</code> таблицы поверх <code>Distributed</code> таблиц. <a href=https://github.com/yandex/ClickHouse/pull/3159 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Исправлена несовместимость (лишняя зависимость от версии <code>glibc</code>), приводящая к невозможности запуска ClickHouse на <code>Ubuntu Precise</code> и более старых. Несовместимость возникла в версии 18.12.13. <a href=https://github.com/yandex/ClickHouse/pull/3130 rel="external nofollow noreferrer">#3130</a></li> <li>Исправлены ошибки в работе настройки <code>enable_optimize_predicate_expression</code>. <a href=https://github.com/yandex/ClickHouse/pull/3107 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Исправлено незначительное нарушение обратной совместимости, проявляющееся при одновременной работе на кластере реплик версий до 18.12.13 и создании новой реплики таблицы на сервере более новой версии (выдаётся сообщение <code>Can not clone replica, because the ... updated to new ClickHouse version</code>, что полностью логично, но не должно было происходить). <a href=https://github.com/yandex/ClickHouse/pull/3122 rel="external nofollow noreferrer">#3122</a></li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_6>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_6 title="Permanent link">&para;</a></h3> <ul> <li>Настройка <code>enable_optimize_predicate_expression</code> включена по-умолчанию, что конечно очень оптимистично. При возникновении ошибок анализа запроса, связанных с поиском имён столбцов, следует выставить <code>enable_optimize_predicate_expression</code> в 0. <a href=https://github.com/yandex/ClickHouse/pull/3107 rel="external nofollow noreferrer">Winter Zhang</a></li> </ul> <h2 id=clickhouse-release-18-12-14-2018-09-13>ClickHouse release 18.12.14, 2018-09-13<a class=headerlink href=#clickhouse-release-18-12-14-2018-09-13 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_11>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_11 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена поддержка запросов <code>ALTER UPDATE</code>. <a href=https://github.com/yandex/ClickHouse/pull/3035 rel="external nofollow noreferrer">#3035</a></li> <li>Добавлена настройка <code>allow_ddl</code>, упраляющая доступом пользователя к DDL-запросам. <a href=https://github.com/yandex/ClickHouse/pull/3104 rel="external nofollow noreferrer">#3104</a></li> <li>Добавлена настройка <code>min_merge_bytes_to_use_direct_io</code> для движков семейства <code>MergeTree</code>, позволяющая задать порог на суммарный размер слияния после которого работа с файлами кусков будет происходить с O_DIRECT. <a href=https://github.com/yandex/ClickHouse/pull/3117 rel="external nofollow noreferrer">#3117</a></li> <li>В системную таблицу <code>system.merges</code> добавлен столбец <code>partition_id</code>. <a href=https://github.com/yandex/ClickHouse/pull/3099 rel="external nofollow noreferrer">#3099</a></li> </ul> <h3 id=uluchsheniia_11>Улучшения<a class=headerlink href=#uluchsheniia_11 title="Permanent link">&para;</a></h3> <ul> <li>Если в процессе мутации кусок остался неизменённым, он не будет скачан репликами. <a href=https://github.com/yandex/ClickHouse/pull/3103 rel="external nofollow noreferrer">#3103</a></li> <li>При работе с <code>clickhouse-client</code> добавлено автодополнение для имён настроек. <a href=https://github.com/yandex/ClickHouse/pull/3106 rel="external nofollow noreferrer">#3106</a></li> </ul> <h3 id=ispravlenie-oshibok_6>Исправление ошибок<a class=headerlink href=#ispravlenie-oshibok_6 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена проверка размеров массивов, которые являются элементами полей типа <code>Nested</code>, при вставке. <a href=https://github.com/yandex/ClickHouse/pull/3118 rel="external nofollow noreferrer">#3118</a></li> <li>Исправлена ошибка обновления внешних словарей с источником <code>ODBC</code> и форматом хранения <code>hashed</code>. Ошибка возникла в версии 18.12.13.</li> <li>Исправлено падение при создании временной таблицы таблицы из запроса с условием <code>IN</code>. <a href=https://github.com/yandex/ClickHouse/pull/3098 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Исправлена ошибка в работе агрегатных функций для массивов, элементами которых может быть <code>NULL</code>. <a href=https://github.com/yandex/ClickHouse/pull/3097 rel="external nofollow noreferrer">Winter Zhang</a></li> </ul> <h2 id=clickhouse-release-18-12-13-2018-09-10>ClickHouse release 18.12.13, 2018-09-10<a class=headerlink href=#clickhouse-release-18-12-13-2018-09-10 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_12>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_12 title="Permanent link">&para;</a></h3> <ul> <li>Добавлен тип данных <code>DECIMAL(digits, scale)</code> (<code>Decimal32(scale)</code>, <code>Decimal64(scale)</code>, <code>Decimal128(scale)</code>). Возможность доступна под настройкой <code>allow_experimental_decimal_type</code>. <a href=https://github.com/yandex/ClickHouse/pull/2846 rel="external nofollow noreferrer">#2846</a> <a href=https://github.com/yandex/ClickHouse/pull/2970 rel="external nofollow noreferrer">#2970</a> <a href=https://github.com/yandex/ClickHouse/pull/3008 rel="external nofollow noreferrer">#3008</a> <a href=https://github.com/yandex/ClickHouse/pull/3047 rel="external nofollow noreferrer">#3047</a></li> <li>Модификатор <code>WITH ROLLUP</code> для <code>GROUP BY</code> (также доступен синтаксис: <code>GROUP BY ROLLUP(...)</code>). <a href=https://github.com/yandex/ClickHouse/pull/2948 rel="external nofollow noreferrer">#2948</a></li> <li>В запросах с JOIN, звёздочка раскрывается в список столбцов всех таблиц, в соответствии со стандартом SQL. Вернуть старое поведение можно, выставив настройку (уровня пользователя) <code>asterisk_left_columns_only</code> в значение 1. <a href=https://github.com/yandex/ClickHouse/pull/2787 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Добавлена поддержка JOIN с табличной функцией. <a href=https://github.com/yandex/ClickHouse/pull/2907 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Автодополнение по нажатию Tab в clickhouse-client. <a href=https://github.com/yandex/ClickHouse/pull/2447 rel="external nofollow noreferrer">Sergey Shcherbin</a></li> <li>Нажатие Ctrl+C в clickhouse-client очищает запрос, если он был введён. <a href=https://github.com/yandex/ClickHouse/pull/2877 rel="external nofollow noreferrer">#2877</a></li> <li>Добавлена настройка <code>join_default_strictness</code> (значения <code>''</code>, <code>'any'</code>, <code>'all'</code>). Её использование позволяет не указывать <code>ANY</code> или <code>ALL</code> для <code>JOIN</code>. <a href=https://github.com/yandex/ClickHouse/pull/2982 rel="external nofollow noreferrer">#2982</a></li> <li>В каждой строчке лога сервера, относящейся к обработке запроса, выводится идентификатор запроса. <a href=https://github.com/yandex/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>Возможность получения логов выполнения запроса в clickhouse-client (настройка <code>send_logs_level</code>). При распределённой обработке запроса, логи отправляются каскадно со всех серверов. <a href=https://github.com/yandex/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>В таблицах <code>system.query_log</code> и <code>system.processes</code> (<code>SHOW PROCESSLIST</code>) появилась информация о всех изменённых настройках при выполнении запроса (вложенная структура данных <code>Settings</code>). Добавлена настройка <code>log_query_settings</code>. <a href=https://github.com/yandex/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>В таблицах <code>system.query_log</code> и <code>system.processes</code> появилась информация о номерах потоков, участвующих в исполнении запроса (столбец <code>thread_numbers</code>). <a href=https://github.com/yandex/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>Добавлены счётчики <code>ProfileEvents</code>, измеряющие время, потраченное на чтение и запись по сети; чтение и запись на диск; количество сетевых ошибок; время потраченное на ожидании при ограничении сетевой полосы. <a href=https://github.com/yandex/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>Добавлены счётчики <code>ProfileEvents</code>, содержащие системные метрики из rusage (позволяющие получить информацию об использовании CPU в userspace и ядре, page faults, context switches) а также метрики taskstats (позволяющие получить информацию о времени ожидания IO, CPU, а также количество прочитанных и записанных данных с учётом и без учёта page cache). <a href=https://github.com/yandex/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>Счётчики <code>ProfileEvents</code> учитываются не только глобально, но и на каждый запрос, а также на каждый поток выполнения запроса, что позволяет детально профилировать потребление ресурсов отдельными запросами. <a href=https://github.com/yandex/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>Добавлена таблица <code>system.query_thread_log</code>, содержащая информацию о каждом потоке выполнения запроса. Добавлена настройка <code>log_query_threads</code>. <a href=https://github.com/yandex/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>В таблицах <code>system.metrics</code> и <code>system.events</code> появилась встроенная документация. <a href=https://github.com/yandex/ClickHouse/pull/3016 rel="external nofollow noreferrer">#3016</a></li> <li>Добавлена функция <code>arrayEnumerateDense</code>. <a href=https://github.com/yandex/ClickHouse/pull/2975 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Добавлены функции <code>arrayCumSumNonNegative</code> и <code>arrayDifference</code>. <a href=https://github.com/yandex/ClickHouse/pull/2942 rel="external nofollow noreferrer">Aleksey Studnev</a></li> <li>Добавлена агрегатная функция <code>retention</code>. <a href=https://github.com/yandex/ClickHouse/pull/2887 rel="external nofollow noreferrer">Sundy Li</a></li> <li>Возможность сложения (слияния) состояний агрегатных функций с помощью оператора плюс, а также умножения состояний агрегатных функций на целую неотрицательную константу. <a href=https://github.com/yandex/ClickHouse/pull/3062 rel="external nofollow noreferrer">#3062</a> <a href=https://github.com/yandex/ClickHouse/pull/3034 rel="external nofollow noreferrer">#3034</a></li> <li>В таблицах семейства MergeTree добавлен виртуальный столбец <code>_partition_id</code>. <a href=https://github.com/yandex/ClickHouse/pull/3089 rel="external nofollow noreferrer">#3089</a></li> </ul> <h3 id=eksperimentalnye-vozmozhnosti_4>Экспериментальные возможности:<a class=headerlink href=#eksperimentalnye-vozmozhnosti_4 title="Permanent link">&para;</a></h3> <ul> <li>Добавлен тип данных <code>LowCardinality(T)</code>. Тип данных автоматически создаёт локальный словарь значений и позволяет обрабатывать данные без распаковки словаря. <a href=https://github.com/yandex/ClickHouse/pull/2830 rel="external nofollow noreferrer">#2830</a></li> <li>Добавлен кэш JIT-скомпилированных функций, а также счётчик числа использований перед компиляцией. Возможность JIT-компиляции выражений включается настройкой <code>compile_expressions</code>. <a href=https://github.com/yandex/ClickHouse/pull/2990 rel="external nofollow noreferrer">#2990</a> <a href=https://github.com/yandex/ClickHouse/pull/3077 rel="external nofollow noreferrer">#3077</a></li> </ul> <h3 id=uluchsheniia_12>Улучшения:<a class=headerlink href=#uluchsheniia_12 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена проблема неограниченного накопления лога репликации в случае наличия заброшенных реплик. Добавлен режим эффективного восстановления реплик после длительного отставания.</li> <li>Увеличена производительность при выполнении <code>GROUP BY</code> в случае, если есть несколько полей агрегации, одно из которых строковое, а другие - фиксированной длины.</li> <li>Увеличена производительность при использовании <code>PREWHERE</code> и при неявном переносе выражений в <code>PREWHERE</code>.</li> <li>Увеличена производительность парсинга текстовых форматов (<code>CSV</code>, <code>TSV</code>). <a href=https://github.com/yandex/ClickHouse/pull/2977 rel="external nofollow noreferrer">Amos Bird</a> <a href=https://github.com/yandex/ClickHouse/pull/2980 rel="external nofollow noreferrer">#2980</a></li> <li>Увеличена производительность чтения строк и массивов в бинарных форматах. <a href=https://github.com/yandex/ClickHouse/pull/2955 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Увеличена производительность и уменьшено потребление памяти в запросах к таблицам <code>system.tables</code> и <code>system.columns</code> в случае наличия очень большого количества таблиц на одном сервере. <a href=https://github.com/yandex/ClickHouse/pull/2953 rel="external nofollow noreferrer">#2953</a></li> <li>Исправлена проблема низкой производительности в случае наличия большого потока запросов, для которых возвращается ошибка (в <code>perf top</code> видна функция <code>_dl_addr</code>, при этом сервер использует мало CPU). <a href=https://github.com/yandex/ClickHouse/pull/2938 rel="external nofollow noreferrer">#2938</a></li> <li>Прокидывание условий внутрь View (при включенной настройке <code>enable_optimize_predicate_expression</code>) <a href=https://github.com/yandex/ClickHouse/pull/2907 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Доработки недостающей функциональности для типа данных <code>UUID</code>. <a href=https://github.com/yandex/ClickHouse/pull/3074 rel="external nofollow noreferrer">#3074</a> <a href=https://github.com/yandex/ClickHouse/pull/2985 rel="external nofollow noreferrer">#2985</a></li> <li>Тип данных <code>UUID</code> поддержан в словарях The-Alchemist. <a href=https://github.com/yandex/ClickHouse/pull/2822 rel="external nofollow noreferrer">#2822</a></li> <li>Функция <code>visitParamExtractRaw</code> корректно работает с вложенными структурами. <a href=https://github.com/yandex/ClickHouse/pull/2974 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>При использовании настройки <code>input_format_skip_unknown_fields</code> корректно работает пропуск значений-объектов в формате <code>JSONEachRow</code>. <a href=https://github.com/yandex/ClickHouse/pull/2958 rel="external nofollow noreferrer">BlahGeek</a></li> <li>Для выражения <code>CASE</code> с условиями, появилась возможность не указывать <code>ELSE</code>, что эквивалентно <code>ELSE NULL</code>. <a href=https://github.com/yandex/ClickHouse/pull/2920 rel="external nofollow noreferrer">#2920</a></li> <li>Возможность конфигурирования operation timeout при работе с ZooKeeper. <a href=https://github.com/yandex/ClickHouse/pull/2971 rel="external nofollow noreferrer">urykhy</a></li> <li>Возможность указания смещения для <code>LIMIT n, m</code> в виде <code>LIMIT n OFFSET m</code>. <a href=https://github.com/yandex/ClickHouse/pull/2840 rel="external nofollow noreferrer">#2840</a></li> <li>Возможность использования синтаксиса <code>SELECT TOP n</code> в качестве альтернативы для <code>LIMIT</code>. <a href=https://github.com/yandex/ClickHouse/pull/2840 rel="external nofollow noreferrer">#2840</a></li> <li>Увеличен размер очереди записи в системные таблицы, что позволяет уменьшить количество ситуаций <code>SystemLog queue is full</code>.</li> <li>В агрегатной функции <code>windowFunnel</code> добавлена поддержка событий, подходящих под несколько условий. <a href=https://github.com/yandex/ClickHouse/pull/2801 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Возможность использования дублирующихся столбцов в секции <code>USING</code> для <code>JOIN</code>. <a href=https://github.com/yandex/ClickHouse/pull/3006 rel="external nofollow noreferrer">#3006</a></li> <li>Для форматов <code>Pretty</code> введено ограничение выравнивания столбцов по ширине. Настройка <code>output_format_pretty_max_column_pad_width</code>. В случае более широкого значения, оно всё ещё будет выведено целиком, но остальные ячейки таблицы не будут излишне широкими. <a href=https://github.com/yandex/ClickHouse/pull/3003 rel="external nofollow noreferrer">#3003</a></li> <li>В табличной функции <code>odbc</code> добавлена возможность указания имени базы данных/схемы. <a href=https://github.com/yandex/ClickHouse/pull/2885 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Добавлена возможность использования имени пользователя, заданного в конфигурационном файле <code>clickhouse-client</code>. <a href=https://github.com/yandex/ClickHouse/pull/2909 rel="external nofollow noreferrer">Vladimir Kozbin</a></li> <li>Счётчик <code>ZooKeeperExceptions</code> разделён на три счётчика <code>ZooKeeperUserExceptions</code>, <code>ZooKeeperHardwareExceptions</code>, <code>ZooKeeperOtherExceptions</code>.</li> <li>Запросы <code>ALTER DELETE</code> работают для материализованных представлений.</li> <li>Добавлена рандомизация во времени периодического запуска cleanup thread для таблиц типа <code>ReplicatedMergeTree</code>, чтобы избежать периодических всплесков нагрузки в случае очень большого количества таблиц типа <code>ReplicatedMergeTree</code>.</li> <li>Поддержка запроса <code>ATTACH TABLE ... ON CLUSTER</code>. <a href=https://github.com/yandex/ClickHouse/pull/3025 rel="external nofollow noreferrer">#3025</a></li> </ul> <h3 id=ispravlenie-oshibok_7>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_7 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка в работе таблиц типа <code>Dictionary</code> (кидается исключение <code>Size of offsets doesn't match size of column</code> или <code>Unknown compression method</code>). Ошибка появилась в версии 18.10.3. <a href=https://github.com/yandex/ClickHouse/issues/2913 rel="external nofollow noreferrer">#2913</a></li> <li>Исправлена ошибка при мерже данных таблиц типа <code>CollapsingMergeTree</code>, если один из кусков данных пустой (такие куски, в свою очередь, образуются при слиянии или при <code>ALTER DELETE</code> в случае удаления всех данных), и для слияния был выбран алгоритм <code>vertical</code>. <a href=https://github.com/yandex/ClickHouse/pull/3049 rel="external nofollow noreferrer">#3049</a></li> <li>Исправлен race condition при <code>DROP</code> или <code>TRUNCATE</code> таблиц типа <code>Memory</code> при одновременном <code>SELECT</code>, который мог приводить к падениям сервера. Ошибка появилась в версии 1.1.54388. <a href=https://github.com/yandex/ClickHouse/pull/3038 rel="external nofollow noreferrer">#3038</a></li> <li>Исправлена возможность потери данных при вставке в <code>Replicated</code> таблицы в случае получения ошибки <code>Session expired</code> (потеря данных может быть обнаружена по метрике <code>ReplicatedDataLoss</code>). Ошибка возникла в версии 1.1.54378. <a href=https://github.com/yandex/ClickHouse/pull/2939 rel="external nofollow noreferrer">#2939</a> <a href=https://github.com/yandex/ClickHouse/pull/2949 rel="external nofollow noreferrer">#2949</a> <a href=https://github.com/yandex/ClickHouse/pull/2964 rel="external nofollow noreferrer">#2964</a></li> <li>Исправлен segfault при <code>JOIN ... ON</code>. <a href=https://github.com/yandex/ClickHouse/pull/3000 rel="external nofollow noreferrer">#3000</a></li> <li>Исправлена ошибка поиска имён столбцов в случае, если выражение <code>WHERE</code> состоит целиком из квалифицированного имени столбца, как например <code>WHERE table.column</code>. <a href=https://github.com/yandex/ClickHouse/pull/2994 rel="external nofollow noreferrer">#2994</a></li> <li>Исправлена ошибка вида "Not found column" при выполнении распределённых запросов в случае, если с удалённого сервера запрашивается единственный столбец, представляющий собой выражение IN с подзапросом. <a href=https://github.com/yandex/ClickHouse/pull/3087 rel="external nofollow noreferrer">#3087</a></li> <li>Исправлена ошибка <code>Block structure mismatch in UNION stream: different number of columns</code>, возникающая при распределённых запросах, если один из шардов локальный, а другой - нет, и если при этом срабатывает оптимизация переноса в <code>PREWHERE</code>. <a href=https://github.com/yandex/ClickHouse/pull/2226 rel="external nofollow noreferrer">#2226</a> <a href=https://github.com/yandex/ClickHouse/pull/3037 rel="external nofollow noreferrer">#3037</a> <a href=https://github.com/yandex/ClickHouse/pull/3055 rel="external nofollow noreferrer">#3055</a> <a href=https://github.com/yandex/ClickHouse/pull/3065 rel="external nofollow noreferrer">#3065</a> <a href=https://github.com/yandex/ClickHouse/pull/3073 rel="external nofollow noreferrer">#3073</a> <a href=https://github.com/yandex/ClickHouse/pull/3090 rel="external nofollow noreferrer">#3090</a> <a href=https://github.com/yandex/ClickHouse/pull/3093 rel="external nofollow noreferrer">#3093</a></li> <li>Исправлена работа функции <code>pointInPolygon</code> для некоторого случая невыпуклых полигонов. <a href=https://github.com/yandex/ClickHouse/pull/2910 rel="external nofollow noreferrer">#2910</a></li> <li>Исправлен некорректный результат при сравнении <code>nan</code> с целыми числами. <a href=https://github.com/yandex/ClickHouse/pull/3024 rel="external nofollow noreferrer">#3024</a></li> <li>Исправлена ошибка в библиотеке <code>zlib-ng</code>, которая могла приводить к segfault в редких случаях. <a href=https://github.com/yandex/ClickHouse/pull/2854 rel="external nofollow noreferrer">#2854</a></li> <li>Исправлена утечка памяти при вставке в таблицу со столбцами типа <code>AggregateFunction</code>, если состояние агрегатной функции нетривиальное (выделяет память отдельно), и если в одном запросе на вставку получается несколько маленьких блоков. <a href=https://github.com/yandex/ClickHouse/pull/3084 rel="external nofollow noreferrer">#3084</a></li> <li>Исправлен race condition при одновременном создании и удалении одной и той же таблицы типа <code>Buffer</code> или <code>MergeTree</code>.</li> <li>Исправлена возможность segfault при сравнении кортежей из некоторых нетривиальных типов, таких как, например, кортежей. <a href=https://github.com/yandex/ClickHouse/pull/2989 rel="external nofollow noreferrer">#2989</a></li> <li>Исправлена возможность segfault при выполнении некоторых запросов <code>ON CLUSTER</code>. <a href=https://github.com/yandex/ClickHouse/pull/2960 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Исправлена ошибка в функции <code>arrayDistinct</code> в случае <code>Nullable</code> элементов массивов. <a href=https://github.com/yandex/ClickHouse/pull/2845 rel="external nofollow noreferrer">#2845</a> <a href=https://github.com/yandex/ClickHouse/pull/2937 rel="external nofollow noreferrer">#2937</a></li> <li>Возможность <code>enable_optimize_predicate_expression</code> корректно поддерживает случаи с <code>SELECT *</code>. <a href=https://github.com/yandex/ClickHouse/pull/2929 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Исправлена возможность segfault при переинициализации сессии с ZooKeeper. <a href=https://github.com/yandex/ClickHouse/pull/2917 rel="external nofollow noreferrer">#2917</a></li> <li>Исправлена возможность блокировки при взаимодействии с ZooKeeper.</li> <li>Исправлен некорректный код суммирования вложенных структур данных в <code>SummingMergeTree</code>.</li> <li>При выделении памяти для состояний агрегатных функций, корректно учитывается выравнивание, что позволяет использовать при реализации состояний агрегатных функций операции, для которых выравнивание является необходимым. <a href=https://github.com/yandex/ClickHouse/pull/2808 rel="external nofollow noreferrer">chenxing-xc</a></li> </ul> <h3 id=ispravleniia-bezopasnosti>Исправления безопасности:<a class=headerlink href=#ispravleniia-bezopasnosti title="Permanent link">&para;</a></h3> <ul> <li>Безопасная работа с ODBC источниками данных. Взаимодействие с ODBC драйверами выполняется через отдельный процесс <code>clickhouse-odbc-bridge</code>. Ошибки в сторонних ODBC драйверах теперь не приводят к проблемам со стабильностью сервера или уязвимостям. <a href=https://github.com/yandex/ClickHouse/pull/2828 rel="external nofollow noreferrer">#2828</a> <a href=https://github.com/yandex/ClickHouse/pull/2879 rel="external nofollow noreferrer">#2879</a> <a href=https://github.com/yandex/ClickHouse/pull/2886 rel="external nofollow noreferrer">#2886</a> <a href=https://github.com/yandex/ClickHouse/pull/2893 rel="external nofollow noreferrer">#2893</a> <a href=https://github.com/yandex/ClickHouse/pull/2921 rel="external nofollow noreferrer">#2921</a></li> <li>Исправлена некорректная валидация пути к файлу в табличной функции <code>catBoostPool</code>. <a href=https://github.com/yandex/ClickHouse/pull/2894 rel="external nofollow noreferrer">#2894</a></li> <li>Содержимое системных таблиц (<code>tables</code>, <code>databases</code>, <code>parts</code>, <code>columns</code>, <code>parts_columns</code>, <code>merges</code>, <code>mutations</code>, <code>replicas</code>, <code>replication_queue</code>) фильтруется согласно конфигурации доступа к базам данных для пользователя (<code>allow_databases</code>) <a href=https://github.com/yandex/ClickHouse/pull/2856 rel="external nofollow noreferrer">Winter Zhang</a></li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_7>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_7 title="Permanent link">&para;</a></h3> <ul> <li>В запросах с JOIN, звёздочка раскрывается в список столбцов всех таблиц, в соответствии со стандартом SQL. Вернуть старое поведение можно, выставив настройку (уровня пользователя) <code>asterisk_left_columns_only</code> в значение 1.</li> </ul> <h3 id=izmeneniia-sborki>Изменения сборки:<a class=headerlink href=#izmeneniia-sborki title="Permanent link">&para;</a></h3> <ul> <li>Добавлен покоммитный запуск большинства интеграционных тестов.</li> <li>Добавлен покоммитный запуск проверки стиля кода.</li> <li>Корректный выбор реализации <code>memcpy</code> при сборке на CentOS7 / Fedora. <a href=https://github.com/yandex/ClickHouse/pull/2912 rel="external nofollow noreferrer">Etienne Champetier</a></li> <li>При сборке с помощью clang добавлены некоторые warnings из <code>-Weverything</code> в дополнение к обычным <code>-Wall -Wextra -Werror</code>. <a href=https://github.com/yandex/ClickHouse/pull/2957 rel="external nofollow noreferrer">#2957</a></li> <li>При debug сборке используется debug вариант <code>jemalloc</code>.</li> <li>Абстрагирован интерфейс библиотеки для взаимодействия с ZooKeeper. <a href=https://github.com/yandex/ClickHouse/pull/2950 rel="external nofollow noreferrer">#2950</a></li> </ul> <h2 id=clickhouse-release-18-10-3-2018-08-13>ClickHouse release 18.10.3, 2018-08-13<a class=headerlink href=#clickhouse-release-18-10-3-2018-08-13 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_13>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_13 title="Permanent link">&para;</a></h3> <ul> <li>Возможность использования HTTPS для репликации. <a href=https://github.com/yandex/ClickHouse/pull/2760 rel="external nofollow noreferrer">#2760</a></li> <li>Добавлены функции <code>murmurHash2_64</code>, <code>murmurHash3_32</code>, <code>murmurHash3_64</code>, <code>murmurHash3_128</code> в дополнение к имеющемуся <code>murmurHash2_32</code>. <a href=https://github.com/yandex/ClickHouse/pull/2791 rel="external nofollow noreferrer">#2791</a></li> <li>Поддержка Nullable типов в ODBC драйвере ClickHouse (формат вывода <code>ODBCDriver2</code>) <a href=https://github.com/yandex/ClickHouse/pull/2834 rel="external nofollow noreferrer">#2834</a></li> <li>Поддержка <code>UUID</code> в ключевых столбцах.</li> </ul> <h3 id=uluchsheniia_13>Улучшения:<a class=headerlink href=#uluchsheniia_13 title="Permanent link">&para;</a></h3> <ul> <li>Удаление кластеров без перезагрузки сервера при их удалении из конфигурационных файлов. <a href=https://github.com/yandex/ClickHouse/pull/2777 rel="external nofollow noreferrer">#2777</a></li> <li>Удаление внешних словарей без перезагрузки сервера при их удалении из конфигурационных файлов. <a href=https://github.com/yandex/ClickHouse/pull/2779 rel="external nofollow noreferrer">#2779</a></li> <li>Добавлена поддержка <code>SETTINGS</code> для движка таблиц <code>Kafka</code>. <a href=https://github.com/yandex/ClickHouse/pull/2781 rel="external nofollow noreferrer">Alexander Marshalov</a></li> <li>Доработки для типа данных <code>UUID</code> (не полностью) Šimon Podlipský. <a href=https://github.com/yandex/ClickHouse/pull/2618 rel="external nofollow noreferrer">#2618</a></li> <li>Поддежка пустых кусков после мержей в движках <code>SummingMergeTree</code>, <code>CollapsingMergeTree</code> and <code>VersionedCollapsingMergeTree</code>. <a href=https://github.com/yandex/ClickHouse/pull/2815 rel="external nofollow noreferrer">#2815</a></li> <li>Удаление старых записей о полностью выполнившихся мутациях (<code>ALTER DELETE</code>) <a href=https://github.com/yandex/ClickHouse/pull/2784 rel="external nofollow noreferrer">#2784</a></li> <li>Добавлена таблица <code>system.merge_tree_settings</code>. <a href=https://github.com/yandex/ClickHouse/pull/2841 rel="external nofollow noreferrer">Kirill Shvakov</a></li> <li>В таблицу <code>system.tables</code> добавлены столбцы зависимостей: <code>dependencies_database</code> и <code>dependencies_table</code>. <a href=https://github.com/yandex/ClickHouse/pull/2851 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Добавлена опция конфига <code>max_partition_size_to_drop</code>. <a href=https://github.com/yandex/ClickHouse/pull/2782 rel="external nofollow noreferrer">#2782</a></li> <li>Добавлена настройка <code>output_format_json_escape_forward_slashes</code>. <a href=https://github.com/yandex/ClickHouse/pull/2812 rel="external nofollow noreferrer">Alexander Bocharov</a></li> <li>Добавлена настройка <code>max_fetch_partition_retries_count</code>. <a href=https://github.com/yandex/ClickHouse/pull/2831 rel="external nofollow noreferrer">#2831</a></li> <li>Добавлена настройка <code>prefer_localhost_replica</code>, позволяющая отключить предпочтение локальной реплики и хождение на локальную реплику без межпроцессного взаимодействия. <a href=https://github.com/yandex/ClickHouse/pull/2832 rel="external nofollow noreferrer">#2832</a></li> <li>Агрегатная функция <code>quantileExact</code> возвращает <code>nan</code> в случае агрегации по пустому множеству <code>Float32</code>/<code>Float64</code> типов. <a href=https://github.com/yandex/ClickHouse/pull/2855 rel="external nofollow noreferrer">Sundy Li</a></li> </ul> <h3 id=ispravlenie-oshibok_8>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_8 title="Permanent link">&para;</a></h3> <ul> <li>Убрано излишнее экранирование параметров connection string для ODBC, котрое приводило к невозможности соединения. Ошибка возникла в версии 18.6.0.</li> <li>Исправлена логика обработки команд на <code>REPLACE PARTITION</code> в очереди репликации. Неправильная логика могла приводить к тому, что при наличии двух <code>REPLACE</code> одной и той же партиции, один из них оставался в очереди репликации и не мог выполниться. <a href=https://github.com/yandex/ClickHouse/pull/2814 rel="external nofollow noreferrer">#2814</a></li> <li>Исправлена ошибка при мерже, если все куски были пустыми (такие куски, в свою очередь, образуются при слиянии или при <code>ALTER DELETE</code> в случае удаления всех данных). Ошибка появилась в версии 18.1.0. <a href=https://github.com/yandex/ClickHouse/pull/2930 rel="external nofollow noreferrer">#2930</a></li> <li>Исправлена ошибка при параллельной записи в таблицы типа <code>Set</code> или <code>Join</code>. <a href=https://github.com/yandex/ClickHouse/pull/2823 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Исправлена ошибка <code>Block structure mismatch in UNION stream: different number of columns</code>, возникающая при запросах с <code>UNION ALL</code> внутри подзапроса, в случае, если один из <code>SELECT</code> запросов содержит дублирующиеся имена столбцов. <a href=https://github.com/yandex/ClickHouse/pull/2094 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Исправлена утечка памяти в случае исключения при соединении с MySQL сервером.</li> <li>Исправлен некорректный код возврата clickhouse-client в случае ошибочного запроса</li> <li>Исправлен некорректная работа materialized views, содержащих DISTINCT. <a href=https://github.com/yandex/ClickHouse/issues/2795 rel="external nofollow noreferrer">#2795</a></li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_8>Обратно несовместимые изменения<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_8 title="Permanent link">&para;</a></h3> <ul> <li>Убрана поддержка запросов CHECK TABLE для Distributed таблиц.</li> </ul> <h3 id=izmeneniia-sborki_1>Изменения сборки:<a class=headerlink href=#izmeneniia-sborki_1 title="Permanent link">&para;</a></h3> <ul> <li>Заменен аллокатор, теперь используется <code>jemalloc</code> вместо <code>tcmalloc</code>. На некоторых сценариях ускорение достигает 20%. В то же время, существуют запросы, замедлившиеся до 20%. Потребление памяти на некоторых сценариях примерно на 10% меньше и более стабильно. При высококонкурентной нагрузке, потребление CPU в userspace и в system незначительно вырастает. <a href=https://github.com/yandex/ClickHouse/pull/2773 rel="external nofollow noreferrer">#2773</a></li> <li>Использование libressl из submodule. <a href=https://github.com/yandex/ClickHouse/pull/1983 rel="external nofollow noreferrer">#1983</a> <a href=https://github.com/yandex/ClickHouse/pull/2807 rel="external nofollow noreferrer">#2807</a></li> <li>Использование unixodbc из submodule. <a href=https://github.com/yandex/ClickHouse/pull/2789 rel="external nofollow noreferrer">#2789</a></li> <li>Использование mariadb-connector-c из submodule. <a href=https://github.com/yandex/ClickHouse/pull/2785 rel="external nofollow noreferrer">#2785</a></li> <li>В репозиторий добавлены файлы функциональных тестов, рассчитывающих на наличие тестовых данных (пока без самих тестовых данных).</li> </ul> <h2 id=clickhouse-release-18-6-0-2018-08-02>ClickHouse release 18.6.0, 2018-08-02<a class=headerlink href=#clickhouse-release-18-6-0-2018-08-02 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_14>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_14 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена поддержка ON выражений для JOIN ON синтаксиса:<br> <code>JOIN ON Expr([table.]column, ...) = Expr([table.]column, ...) [AND Expr([table.]column, ...) = Expr([table.]column, ...) ...]</code><br> Выражение должно представлять из себя цепочку равенств, объединенных оператором AND. Каждая часть равенства может являться произвольным выражением над столбцами одной из таблиц. Поддержана возможность использования fully qualified имен столбцов (<code>table.name</code>, <code>database.table.name</code>, <code>table_alias.name</code>, <code>subquery_alias.name</code>) для правой таблицы. <a href=https://github.com/yandex/ClickHouse/pull/2742 rel="external nofollow noreferrer">#2742</a></li> <li>Добавлена возможность включить HTTPS для репликации. <a href=https://github.com/yandex/ClickHouse/pull/2760 rel="external nofollow noreferrer">#2760</a></li> </ul> <h3 id=uluchsheniia_14>Улучшения:<a class=headerlink href=#uluchsheniia_14 title="Permanent link">&para;</a></h3> <ul> <li>Сервер передаёт на клиент также patch-компонент своей версии. Данные о patch компоненте версии добавлены в <code>system.processes</code> и <code>query_log</code>. <a href=https://github.com/yandex/ClickHouse/pull/2646 rel="external nofollow noreferrer">#2646</a></li> </ul> <h2 id=clickhouse-release-18-5-1-2018-07-31>ClickHouse release 18.5.1, 2018-07-31<a class=headerlink href=#clickhouse-release-18-5-1-2018-07-31 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_15>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_15 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена функция хеширования <code>murmurHash2_32</code>. <a href=https://github.com/yandex/ClickHouse/pull/2756 rel="external nofollow noreferrer">#2756</a>.</li> </ul> <h3 id=uluchsheniia_15>Улучшения:<a class=headerlink href=#uluchsheniia_15 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена возможность указывать значения в конфигурационных файлах из переменных окружения с помощью атрибута <code>from_env</code>. <a href=https://github.com/yandex/ClickHouse/pull/2741 rel="external nofollow noreferrer">#2741</a>.</li> <li>Добавлены регистронезависимые версии функций <code>coalesce</code>, <code>ifNull</code>, <code>nullIf</code>. <a href=https://github.com/yandex/ClickHouse/pull/2752 rel="external nofollow noreferrer">#2752</a>.</li> </ul> <h3 id=ispravlenie-oshibok_9>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_9 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена возможная ошибка при старте реплики. <a href=https://github.com/yandex/ClickHouse/pull/2759 rel="external nofollow noreferrer">#2759</a>.</li> </ul> <h2 id=clickhouse-release-18-4-0-2018-07-28>ClickHouse release 18.4.0, 2018-07-28<a class=headerlink href=#clickhouse-release-18-4-0-2018-07-28 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_16>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_16 title="Permanent link">&para;</a></h3> <ul> <li>Добавлены системные таблицы <code>formats</code>, <code>data_type_families</code>, <code>aggregate_function_combinators</code>, <code>table_functions</code>, <code>table_engines</code>, <code>collations</code> <a href=https://github.com/yandex/ClickHouse/pull/2721 rel="external nofollow noreferrer">#2721</a>.</li> <li>Добавлена возможность использования табличной функции вместо таблицы в качестве аргумента табличной функции <code>remote</code> и <code>cluster</code> <a href=https://github.com/yandex/ClickHouse/pull/2708 rel="external nofollow noreferrer">#2708</a>.</li> <li>Поддержка <code>HTTP Basic</code> аутентификации в протоколе репликации <a href=https://github.com/yandex/ClickHouse/pull/2727 rel="external nofollow noreferrer">#2727</a>.</li> <li>В функции <code>has</code> добавлена возможность поиска в массиве значений типа <code>Enum</code> по числовому значению <a href=https://github.com/yandex/ClickHouse/pull/2699 rel="external nofollow noreferrer">Maxim Khrisanfov</a>.</li> <li>Поддержка добавления произвольных разделителей сообщений в процессе чтения из <code>Kafka</code> <a href=https://github.com/yandex/ClickHouse/pull/2701 rel="external nofollow noreferrer">Amos Bird</a>.</li> </ul> <h3 id=uluchsheniia_16>Улучшения:<a class=headerlink href=#uluchsheniia_16 title="Permanent link">&para;</a></h3> <ul> <li>Запрос <code>ALTER TABLE t DELETE WHERE</code> не перезаписывает куски данных, которые не были затронуты условием WHERE <a href=https://github.com/yandex/ClickHouse/pull/2694 rel="external nofollow noreferrer">#2694</a>.</li> <li>Настройка <code>use_minimalistic_checksums_in_zookeeper</code> таблиц семейства <code>ReplicatedMergeTree</code> включена по-умолчанию. Эта настройка была добавлена в версии 1.1.54378, 2018-04-16. Установка версий, более старых, чем 1.1.54378, становится невозможной.</li> <li>Поддерживается запуск запросов <code>KILL</code> и <code>OPTIMIZE</code> с указанием <code>ON CLUSTER</code> <a href=https://github.com/yandex/ClickHouse/pull/2689 rel="external nofollow noreferrer">Winter Zhang</a>.</li> </ul> <h3 id=ispravlenie-oshibok_10>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_10 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка <code>Column ... is not under aggregate function and not in GROUP BY</code> в случае агрегации по выражению с оператором IN. Ошибка появилась в версии 18.1.0. (<a href=https://github.com/yandex/ClickHouse/commit/bbdd780be0be06a0f336775941cdd536878dd2c2 rel="external nofollow noreferrer">bbdd780b</a>)</li> <li>Исправлена ошибка в агрегатной функции <code>windowFunnel</code> <a href=https://github.com/yandex/ClickHouse/pull/2735 rel="external nofollow noreferrer">Winter Zhang</a>.</li> <li>Исправлена ошибка в агрегатной функции <code>anyHeavy</code> (<a href=https://github.com/yandex/ClickHouse/commit/a2101df25a6a0fba99aa71f8793d762af2b801ee rel="external nofollow noreferrer">a2101df2</a>)</li> <li>Исправлено падение сервера при использовании функции <code>countArray()</code>.</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_9>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_9 title="Permanent link">&para;</a></h3> <ul> <li>Список параметров для таблиц <code>Kafka</code> был изменён с <code>Kafka(kafka_broker_list, kafka_topic_list, kafka_group_name, kafka_format[, kafka_schema, kafka_num_consumers])</code> на <code>Kafka(kafka_broker_list, kafka_topic_list, kafka_group_name, kafka_format[, kafka_row_delimiter, kafka_schema, kafka_num_consumers])</code>. Если вы использовали параметры <code>kafka_schema</code> или <code>kafka_num_consumers</code>, вам необходимо вручную отредактировать файлы с метаданными <code>path/metadata/database/table.sql</code>, добавив параметр <code>kafka_row_delimiter</code> со значением <code>''</code> в соответствующее место.</li> </ul> <h2 id=clickhouse-release-18-1-0-2018-07-23>ClickHouse release 18.1.0, 2018-07-23<a class=headerlink href=#clickhouse-release-18-1-0-2018-07-23 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_17>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_17 title="Permanent link">&para;</a></h3> <ul> <li>Поддержка запроса <code>ALTER TABLE t DELETE WHERE</code> для нереплицированных MergeTree-таблиц (<a href=https://github.com/yandex/ClickHouse/pull/2634 rel="external nofollow noreferrer">#2634</a>).</li> <li>Поддержка произвольных типов для семейства агрегатных функций <code>uniq*</code> (<a href=https://github.com/yandex/ClickHouse/issues/2010 rel="external nofollow noreferrer">#2010</a>).</li> <li>Поддержка произвольных типов в операторах сравнения (<a href=https://github.com/yandex/ClickHouse/issues/2026 rel="external nofollow noreferrer">#2026</a>).</li> <li>Возможность в <code>users.xml</code> указывать маску подсети в формате <code>10.0.0.1/255.255.255.0</code>. Это необходимо для использования "дырявых" масок IPv6 сетей (<a href=https://github.com/yandex/ClickHouse/pull/2637 rel="external nofollow noreferrer">#2637</a>).</li> <li>Добавлена функция <code>arrayDistinct</code> (<a href=https://github.com/yandex/ClickHouse/pull/2670 rel="external nofollow noreferrer">#2670</a>).</li> <li>Движок SummingMergeTree теперь может работать со столбцами типа AggregateFunction (<a href=https://github.com/yandex/ClickHouse/pull/2566 rel="external nofollow noreferrer">Constantin S. Pan</a>).</li> </ul> <h3 id=uluchsheniia_17>Улучшения:<a class=headerlink href=#uluchsheniia_17 title="Permanent link">&para;</a></h3> <ul> <li>Изменена схема версионирования релизов. Теперь первый компонент содержит год релиза (A.D.; по московскому времени; из номера вычитается 2000), второй - номер крупных изменений (увеличивается для большинства релизов), третий - патч-версия. Релизы по-прежнему обратно совместимы, если другое не указано в changelog.</li> <li>Ускорено преобразование чисел с плавающей точкой в строку (<a href=https://github.com/yandex/ClickHouse/pull/2664 rel="external nofollow noreferrer">Amos Bird</a>).</li> <li>Теперь, если при вставке из-за ошибок парсинга пропущено некоторое количество строк (такое возможно про включённых настройках <code>input_allow_errors_num</code>, <code>input_allow_errors_ratio</code>), это количество пишется в лог сервера (<a href=https://github.com/yandex/ClickHouse/pull/2669 rel="external nofollow noreferrer">Leonardo Cecchi</a>).</li> </ul> <h3 id=ispravlenie-oshibok_11>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_11 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена работа команды TRUNCATE для временных таблиц (<a href=https://github.com/yandex/ClickHouse/pull/2624 rel="external nofollow noreferrer">Amos Bird</a>).</li> <li>Исправлен редкий deadlock в клиентской библиотеке ZooKeeper, который возникал при сетевой ошибке во время вычитывания ответа (<a href=https://github.com/yandex/ClickHouse/commit/c315200e64b87e44bdf740707fc857d1fdf7e947 rel="external nofollow noreferrer">c315200</a>).</li> <li>Исправлена ошибка при CAST в Nullable типы (<a href=https://github.com/yandex/ClickHouse/issues/1322 rel="external nofollow noreferrer">#1322</a>).</li> <li>Исправлен неправильный результат функции <code>maxIntersection()</code> в случае совпадения границ отрезков (<a href=https://github.com/yandex/ClickHouse/pull/2657 rel="external nofollow noreferrer">Michael Furmur</a>).</li> <li>Исправлено неверное преобразование цепочки OR-выражений в аргументе функции (<a href=https://github.com/yandex/ClickHouse/pull/2663 rel="external nofollow noreferrer">chenxing-xc</a>).</li> <li>Исправлена деградация производительности запросов, содержащих выражение <code>IN (подзапрос)</code> внутри другого подзапроса (<a href=https://github.com/yandex/ClickHouse/issues/2571 rel="external nofollow noreferrer">#2571</a>).</li> <li>Исправлена несовместимость серверов разных версий при распределённых запросах, использующих функцию <code>CAST</code> не в верхнем регистре (<a href=https://github.com/yandex/ClickHouse/commit/fe8c4d64e434cacd4ceef34faa9005129f2190a5 rel="external nofollow noreferrer">fe8c4d6</a>).</li> <li>Добавлено недостающее квотирование идентификаторов при запросах к внешним СУБД (<a href=https://github.com/yandex/ClickHouse/issues/2635 rel="external nofollow noreferrer">#2635</a>).</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_10>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_10 title="Permanent link">&para;</a></h3> <ul> <li>Не работает преобразование строки, содержащей число ноль, в DateTime. Пример: <code>SELECT toDateTime('0')</code>. По той же причине не работает <code>DateTime DEFAULT '0'</code> в таблицах, а также <code>&lt;null_value&gt;0&lt;/null_value&gt;</code> в словарях. Решение: заменить <code>0</code> на <code>0000-00-00 00:00:00</code>.</li> </ul> <h2 id=clickhouse-release-1-1-54394-2018-07-12>ClickHouse release 1.1.54394, 2018-07-12<a class=headerlink href=#clickhouse-release-1-1-54394-2018-07-12 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_18>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_18 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена агрегатная функция <code>histogram</code> (<a href=https://github.com/yandex/ClickHouse/pull/2521 rel="external nofollow noreferrer">Михаил Сурин</a>).</li> <li>Возможность использования <code>OPTIMIZE TABLE ... FINAL</code> без указания партиции для <code>ReplicatedMergeTree</code> (<a href=https://github.com/yandex/ClickHouse/pull/2600 rel="external nofollow noreferrer">Amos Bird</a>).</li> </ul> <h3 id=ispravlenie-oshibok_12>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_12 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка - выставление слишком маленького таймаута у сокетов (одна секунда) для чтения и записи при отправке и скачивании реплицируемых данных, что приводило к невозможности скачать куски достаточно большого размера при наличии некоторой нагрузки на сеть или диск (попытки скачивания кусков циклически повторяются). Ошибка возникла в версии 1.1.54388.</li> <li>Исправлена работа при использовании chroot в ZooKeeper, в случае вставки дублирующихся блоков данных в таблицу.</li> <li>Исправлена работа функции <code>has</code> для случая массива с Nullable элементами (<a href=https://github.com/yandex/ClickHouse/issues/2521 rel="external nofollow noreferrer">#2115</a>).</li> <li>Исправлена работа таблицы <code>system.tables</code> при её использовании в распределённых запросах; столбцы <code>metadata_modification_time</code> и <code>engine_full</code> сделаны невиртуальными; исправлена ошибка в случае, если из таблицы были запрошены только эти столбцы.</li> <li>Исправлена работа пустой таблицы типа <code>TinyLog</code> после вставки в неё пустого блока данных (<a href=https://github.com/yandex/ClickHouse/issues/2563 rel="external nofollow noreferrer">#2563</a>).</li> <li>Таблица <code>system.zookeeper</code> работает в случае, если значение узла в ZooKeeper равно NULL.</li> </ul> <h2 id=clickhouse-release-1-1-54390-2018-07-06>ClickHouse release 1.1.54390, 2018-07-06<a class=headerlink href=#clickhouse-release-1-1-54390-2018-07-06 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_19>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_19 title="Permanent link">&para;</a></h3> <ul> <li>Возможность отправки запроса в формате <code>multipart/form-data</code> (в поле <code>query</code>), что полезно, если при этом также отправляются внешние данные для обработки запроса (<a href=https://github.com/yandex/ClickHouse/pull/2490 rel="external nofollow noreferrer">Ольга Хвостикова</a>).</li> <li>Добавлена возможность включить или отключить обработку одинарных или двойных кавычек при чтении данных в формате CSV. Это задаётся настройками <code>format_csv_allow_single_quotes</code> и <code>format_csv_allow_double_quotes</code> (<a href=https://github.com/yandex/ClickHouse/pull/2574 rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Возможность использования <code>OPTIMIZE TABLE ... FINAL</code> без указания партиции для не реплицированных вариантов<code>MergeTree</code> (<a href=https://github.com/yandex/ClickHouse/pull/2599 rel="external nofollow noreferrer">Amos Bird</a>).</li> </ul> <h3 id=uluchsheniia_18>Улучшения:<a class=headerlink href=#uluchsheniia_18 title="Permanent link">&para;</a></h3> <ul> <li>Увеличена производительность, уменьшено потребление памяти, добавлен корректный учёт потребления памяти, при использовании оператора IN в случае, когда для его работы может использоваться индекс таблицы (<a href=https://github.com/yandex/ClickHouse/pull/2584 rel="external nofollow noreferrer">#2584</a>).</li> <li>Убраны избыточные проверки чексумм при добавлении куска. Это важно в случае большого количества реплик, так как в этом случае суммарное количество проверок было равно N^2.</li> <li>Добавлена поддержка аргументов типа <code>Array(Tuple(...))</code> для функции <code>arrayEnumerateUniq</code> (<a href=https://github.com/yandex/ClickHouse/pull/2573 rel="external nofollow noreferrer">#2573</a>).</li> <li>Добавлена поддержка <code>Nullable</code> для функции <code>runningDifference</code>. (<a href=https://github.com/yandex/ClickHouse/pull/2594 rel="external nofollow noreferrer">#2594</a>)</li> <li>Увеличена производительность анализа запроса в случае очень большого количества выражений (<a href=https://github.com/yandex/ClickHouse/pull/2572 rel="external nofollow noreferrer">#2572</a>).</li> <li>Более быстрый выбор кусков для слияния в таблицах типа <code>ReplicatedMergeTree</code>. Более быстрое восстановление сессии с ZooKeeper. (<a href=https://github.com/yandex/ClickHouse/pull/2597 rel="external nofollow noreferrer">#2597</a>).</li> <li>Файл <code>format_version.txt</code> для таблиц семейства <code>MergeTree</code> создаётся заново при его отсутствии, что имеет смысл в случае запуска ClickHouse после копирования структуры директорий без файлов (<a href=https://github.com/yandex/ClickHouse/pull/2593 rel="external nofollow noreferrer">Ciprian Hacman</a>).</li> </ul> <h3 id=ispravlenie-oshibok_13>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_13 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка при работе с ZooKeeper, которая могла приводить к невозможности восстановления сессии и readonly состояниям таблиц до перезапуска сервера.</li> <li>Исправлена ошибка при работе с ZooKeeper, которая могла приводить к неудалению старых узлов при разрыве сессии.</li> <li>Исправлена ошибка в функции <code>quantileTDigest</code> для Float аргументов (ошибка появилась в версии 1.1.54388) (<a href=https://github.com/yandex/ClickHouse/pull/2553 rel="external nofollow noreferrer">Михаил Сурин</a>).</li> <li>Исправлена ошибка работы индекса таблиц типа MergeTree, если в условии, столбец первичного ключа расположен внутри функции преобразования типов между знаковым и беззнаковым целым одного размера (<a href=https://github.com/yandex/ClickHouse/pull/2603 rel="external nofollow noreferrer">#2603</a>).</li> <li>Исправлен segfault, если в конфигурационном файле нет <code>macros</code>, но они используются (<a href=https://github.com/yandex/ClickHouse/pull/2570 rel="external nofollow noreferrer">#2570</a>).</li> <li>Исправлено переключение на базу данных по-умолчанию при переподключении клиента (<a href=https://github.com/yandex/ClickHouse/pull/2583 rel="external nofollow noreferrer">#2583</a>).</li> <li>Исправлена ошибка в случае отключенной настройки <code>use_index_for_in_with_subqueries</code>.</li> </ul> <h3 id=ispravleniia-bezopasnosti_1>Исправления безопасности:<a class=headerlink href=#ispravleniia-bezopasnosti_1 title="Permanent link">&para;</a></h3> <ul> <li>При соединениях с MySQL удалена возможность отправки файлов (<code>LOAD DATA LOCAL INFILE</code>).</li> </ul> <h2 id=clickhouse-release-1-1-54388-2018-06-28>ClickHouse release 1.1.54388, 2018-06-28<a class=headerlink href=#clickhouse-release-1-1-54388-2018-06-28 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_20>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_20 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена поддержка запроса <code>ALTER TABLE t DELETE WHERE</code> для реплицированных таблиц и таблица <code>system.mutations</code>.</li> <li>Добавлена поддержка запроса <code>ALTER TABLE t [REPLACE|ATTACH] PARTITION</code> для *MergeTree-таблиц.</li> <li>Добавлена поддержка запроса <code>TRUNCATE TABLE</code> (<a href=https://github.com/yandex/ClickHouse/pull/2260 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Добавлено несколько новых <code>SYSTEM</code>-запросов для реплицированных таблиц (<code>RESTART REPLICAS</code>, <code>SYNC REPLICA</code>, <code>[STOP|START] [MERGES|FETCHES|REPLICATED SENDS|REPLICATION QUEUES]</code>).</li> <li>Добавлена возможность записи в таблицу с движком MySQL и соответствующую табличную функцию (<a href=https://github.com/yandex/ClickHouse/pull/2294 rel="external nofollow noreferrer">sundy-li</a>).</li> <li>Добавлена табличная функция <code>url()</code> и движок таблиц <code>URL</code> (<a href=https://github.com/yandex/ClickHouse/pull/2501 rel="external nofollow noreferrer">Александр Сапин</a>).</li> <li>Добавлена агрегатная функция <code>windowFunnel</code> (<a href=https://github.com/yandex/ClickHouse/pull/2352 rel="external nofollow noreferrer">sundy-li</a>).</li> <li>Добавлены функции <code>startsWith</code> и <code>endsWith</code> для строк (<a href=https://github.com/yandex/ClickHouse/pull/2429 rel="external nofollow noreferrer">Вадим Плахтинский</a>).</li> <li>В табличной функции <code>numbers()</code> добавлена возможность указывать offset (<a href=https://github.com/yandex/ClickHouse/pull/2535 rel="external nofollow noreferrer">Winter Zhang</a>).</li> <li>Добавлена возможность интерактивного ввода пароля в <code>clickhouse-client</code>.</li> <li>Добавлена возможность отправки логов сервера в syslog (<a href=https://github.com/yandex/ClickHouse/pull/2459 rel="external nofollow noreferrer">Александр Крашенинников</a>).</li> <li>Добавлена поддержка логирования в словарях с источником shared library (<a href=https://github.com/yandex/ClickHouse/pull/2472 rel="external nofollow noreferrer">Александр Сапин</a>).</li> <li>Добавлена поддержка произвольного разделителя в формате CSV (<a href=https://github.com/yandex/ClickHouse/pull/2263 rel="external nofollow noreferrer">Иван Жуков</a>)</li> <li>Добавлена настройка <code>date_time_input_format</code>. Если переключить эту настройку в значение <code>'best_effort'</code>, значения DateTime будут читаться в широком диапазоне форматов.</li> <li>Добавлена утилита <code>clickhouse-obfuscator</code> для обфускации данных. Пример использования: публикация данных, используемых в тестах производительности.</li> </ul> <h3 id=eksperimentalnye-vozmozhnosti_5>Экспериментальные возможности:<a class=headerlink href=#eksperimentalnye-vozmozhnosti_5 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена возможность вычислять аргументы функции <code>and</code> только там, где они нужны (<a href=https://github.com/yandex/ClickHouse/pull/2272 rel="external nofollow noreferrer">Анастасия Царькова</a>)</li> <li>Добавлена возможность JIT-компиляции в нативный код некоторых выражений (<a href=https://github.com/yandex/ClickHouse/pull/2277 rel="external nofollow noreferrer">pyos</a>).</li> </ul> <h3 id=ispravlenie-oshibok_14>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_14 title="Permanent link">&para;</a></h3> <ul> <li>Исправлено появление дублей в запросе с <code>DISTINCT</code> и <code>ORDER BY</code>.</li> <li>Запросы с <code>ARRAY JOIN</code> и <code>arrayFilter</code> раньше возвращали некорректный результат.</li> <li>Исправлена ошибка при чтении столбца-массива из Nested-структуры (<a href=https://github.com/yandex/ClickHouse/issues/2066 rel="external nofollow noreferrer">#2066</a>).</li> <li>Исправлена ошибка при анализе запросов с секцией HAVING вида <code>HAVING tuple IN (...)</code>.</li> <li>Исправлена ошибка при анализе запросов с рекурсивными алиасами.</li> <li>Исправлена ошибка при чтении из ReplacingMergeTree с условием в PREWHERE, фильтрующим все строки (<a href=https://github.com/yandex/ClickHouse/issues/2525 rel="external nofollow noreferrer">#2525</a>).</li> <li>Настройки профиля пользователя не применялись при использовании сессий в HTTP-интерфейсе.</li> <li>Исправлено применение настроек из параметров командной строки в программе clickhouse-local.</li> <li>Клиентская библиотека ZooKeeper теперь использует таймаут сессии, полученный от сервера.</li> <li>Исправлена ошибка в клиентской библиотеке ZooKeeper, из-за которой ожидание ответа от сервера могло длиться дольше таймаута.</li> <li>Исправлено отсечение ненужных кусков при запросе с условием на столбцы ключа партиционирования (<a href=https://github.com/yandex/ClickHouse/issues/2342 rel="external nofollow noreferrer">#2342</a>).</li> <li>После <code>CLEAR COLUMN IN PARTITION</code> в соответствующей партиции теперь возможны слияния (<a href=https://github.com/yandex/ClickHouse/issues/2315 rel="external nofollow noreferrer">#2315</a>).</li> <li>Исправлено соответствие типов в табличной функции ODBC (<a href=https://github.com/yandex/ClickHouse/pull/2268 rel="external nofollow noreferrer">sundy-li</a>).</li> <li>Исправлено некорректное сравнение типов <code>DateTime</code> с таймзоной и без неё (<a href=https://github.com/yandex/ClickHouse/pull/2400 rel="external nofollow noreferrer">Александр Бочаров</a>).</li> <li>Исправлен синтаксический разбор и форматирование оператора <code>CAST</code>.</li> <li>Исправлена вставка в материализованное представление в случае, если движок таблицы представления - Distributed (<a href=https://github.com/yandex/ClickHouse/pull/2411 rel="external nofollow noreferrer">Babacar Diassé</a>).</li> <li>Исправлен race condition при записи данных из движка <code>Kafka</code> в материализованные представления (<a href=https://github.com/yandex/ClickHouse/pull/2448 rel="external nofollow noreferrer">Yangkuan Liu</a>).</li> <li>Исправлена SSRF в табличной функции remote().</li> <li>Исправлен выход из <code>clickhouse-client</code> в multiline-режиме (<a href=https://github.com/yandex/ClickHouse/issues/2510 rel="external nofollow noreferrer">#2510</a>).</li> </ul> <h3 id=uluchsheniia_19>Улучшения:<a class=headerlink href=#uluchsheniia_19 title="Permanent link">&para;</a></h3> <ul> <li>Фоновые задачи в реплицированных таблицах теперь выполняются не в отдельных потоках, а в пуле потоков (<a href=https://github.com/yandex/ClickHouse/pull/1722 rel="external nofollow noreferrer">Silviu Caragea</a>)</li> <li>Улучшена производительность разжатия LZ4.</li> <li>Ускорен анализ запроса с большим числом JOIN-ов и подзапросов.</li> <li>DNS-кэш теперь автоматически обновляется при большом числе сетевых ошибок.</li> <li>Вставка в таблицу теперь не происходит, если вставка в одно из её материализованных представлений невозможна из-за того, что в нём много кусков.</li> <li>Исправлено несоответствие в значениях счётчиков событий <code>Query</code>, <code>SelectQuery</code>, <code>InsertQuery</code>.</li> <li>Разрешены выражения вида <code>tuple IN (SELECT tuple)</code>, если типы кортежей совпадают.</li> <li>Сервер с реплицированными таблицами теперь может стартовать, даже если не сконфигурирован ZooKeeper.</li> <li>При расчёте количества доступных ядер CPU теперь учитываются ограничения cgroups (<a href=https://github.com/yandex/ClickHouse/pull/2325 rel="external nofollow noreferrer">Atri Sharma</a>).</li> <li>Добавлен chown директорий конфигов в конфигурационном файле systemd (<a href=https://github.com/yandex/ClickHouse/pull/2421 rel="external nofollow noreferrer">Михаил Ширяев</a>).</li> </ul> <h3 id=izmeneniia-sborki_2>Изменения сборки:<a class=headerlink href=#izmeneniia-sborki_2 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена возможность сборки компилятором gcc8.</li> <li>Добавлена возможность сборки llvm из submodule.</li> <li>Используемая версия библиотеки librdkafka обновлена до v0.11.4.</li> <li>Добавлена возможность использования библиотеки libcpuid из системы, используемая версия библиотеки обновлена до 0.4.0.</li> <li>Исправлена сборка с использованием библиотеки vectorclass (<a href=https://github.com/yandex/ClickHouse/pull/2274 rel="external nofollow noreferrer">Babacar Diassé</a>).</li> <li>Cmake теперь по умолчанию генерирует файлы для ninja (как при использовании <code>-G Ninja</code>).</li> <li>Добавлена возможность использования библиотеки libtinfo вместо libtermcap (<a href=https://github.com/yandex/ClickHouse/pull/2519 rel="external nofollow noreferrer">Георгий Кондратьев</a>).</li> <li>Исправлен конфликт заголовочных файлов в Fedora Rawhide (<a href=https://github.com/yandex/ClickHouse/issues/2520 rel="external nofollow noreferrer">#2520</a>).</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_11>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_11 title="Permanent link">&para;</a></h3> <ul> <li>Убран escaping в форматах <code>Vertical</code> и <code>Pretty*</code>, удалён формат <code>VerticalRaw</code>.</li> <li>Если в распределённых запросах одновременно участвуют серверы версии 1.1.54388 или новее и более старые, то при использовании выражения <code>cast(x, 'Type')</code>, записанного без указания <code>AS</code>, если слово <code>cast</code> указано не в верхнем регистре, возникает ошибка вида <code>Not found column cast(0, 'UInt8') in block</code>. Решение: обновить сервер на всём кластере.</li> </ul> <h2 id=clickhouse-release-1-1-54385-2018-06-01>ClickHouse release 1.1.54385, 2018-06-01<a class=headerlink href=#clickhouse-release-1-1-54385-2018-06-01 title="Permanent link">&para;</a></h2> <h3 id=ispravlenie-oshibok_15>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_15 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка, которая в некоторых случаях приводила к блокировке операций с ZooKeeper.</li> </ul> <h2 id=clickhouse-release-1-1-54383-2018-05-22>ClickHouse release 1.1.54383, 2018-05-22<a class=headerlink href=#clickhouse-release-1-1-54383-2018-05-22 title="Permanent link">&para;</a></h2> <h3 id=ispravlenie-oshibok_16>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_16 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена деградация скорости выполнения очереди репликации при большом количестве реплик</li> </ul> <h2 id=clickhouse-release-1-1-54381-2018-05-14>ClickHouse release 1.1.54381, 2018-05-14<a class=headerlink href=#clickhouse-release-1-1-54381-2018-05-14 title="Permanent link">&para;</a></h2> <h3 id=ispravlenie-oshibok_17>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_17 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка, приводящая к "утеканию" метаданных в ZooKeeper при потере соединения с сервером ZooKeeper.</li> </ul> <h2 id=clickhouse-release-1-1-54380-2018-04-21>ClickHouse release 1.1.54380, 2018-04-21<a class=headerlink href=#clickhouse-release-1-1-54380-2018-04-21 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_21>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_21 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена табличная функция <code>file(path, format, structure)</code>. Пример, читающий байты из <code>/dev/urandom</code>: <code>ln -s /dev/urandom /var/lib/clickhouse/user_files/random</code> <code>clickhouse-client -q "SELECT * FROM file('random', 'RowBinary', 'd UInt8') LIMIT 10"</code>.</li> </ul> <h3 id=uluchsheniia_20>Улучшения:<a class=headerlink href=#uluchsheniia_20 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена возможность оборачивать подзапросы скобками <code>()</code> для повышения читаемости запросов. Например: <code>(SELECT 1) UNION ALL (SELECT 1)</code>.</li> <li>Простые запросы <code>SELECT</code> из таблицы <code>system.processes</code> не учитываются в ограничении <code>max_concurrent_queries</code>.</li> </ul> <h3 id=ispravlenie-oshibok_18>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_18 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена неправильная работа оператора <code>IN</code> в <code>MATERIALIZED VIEW</code>.</li> <li>Исправлена неправильная работа индекса по ключу партиционирования в выражениях типа <code>partition_key_column IN (...)</code>.</li> <li>Исправлена невозможность выполнить <code>OPTIMIZE</code> запрос на лидирующей реплике после выполнения <code>RENAME</code> таблицы.</li> <li>Исправлены ошибки авторизации возникающие при выполнении запросов <code>OPTIMIZE</code> и <code>ALTER</code> на нелидирующей реплике.</li> <li>Исправлены зависания запросов <code>KILL QUERY</code>.</li> <li>Исправлена ошибка в клиентской библиотеке ZooKeeper, которая при использовании непустого префикса <code>chroot</code> в конфигурации приводила к потере watch'ей, остановке очереди distributed DDL запросов и замедлению репликации.</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_12>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_12 title="Permanent link">&para;</a></h3> <ul> <li>Убрана поддержка выражений типа <code>(a, b) IN (SELECT (a, b))</code> (можно использовать эквивалентные выражение <code>(a, b) IN (SELECT a, b)</code>). Раньше такие запросы могли приводить к недетерминированной фильтрации в <code>WHERE</code>.</li> </ul> <h2 id=clickhouse-release-1-1-54378-2018-04-16>ClickHouse release 1.1.54378, 2018-04-16<a class=headerlink href=#clickhouse-release-1-1-54378-2018-04-16 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_22>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_22 title="Permanent link">&para;</a></h3> <ul> <li>Возможность изменения уровня логгирования без перезагрузки сервера.</li> <li>Добавлен запрос <code>SHOW CREATE DATABASE</code>.</li> <li>Возможность передать <code>query_id</code> в <code>clickhouse-client</code> (elBroom).</li> <li>Добавлена настройка <code>max_network_bandwidth_for_all_users</code>.</li> <li>Добавлена поддержка <code>ALTER TABLE ... PARTITION ...</code> для <code>MATERIALIZED VIEW</code>.</li> <li>Добавлена информация о размере кусков данных в несжатом виде в системные таблицы.</li> <li>Поддержка межсерверного шифрования для distributed таблиц (<code>&lt;secure&gt;1&lt;/secure&gt;</code> в конфигурации реплики в <code>&lt;remote_servers&gt;</code>).</li> <li>Добавлена настройка уровня таблицы семейства <code>ReplicatedMergeTree</code> для уменьшения объема данных, хранимых в zookeeper: <code>use_minimalistic_checksums_in_zookeeper = 1</code></li> <li>Возможность настройки приглашения <code>clickhouse-client</code>. По-умолчанию добавлен вывод имени сервера в приглашение. Возможность изменить отображаемое имя сервера. Отправка его в HTTP заголовке <code>X-ClickHouse-Display-Name</code> (Kirill Shvakov).</li> <li>Возможность указания нескольких <code>topics</code> через запятую для движка <code>Kafka</code> (Tobias Adamson)</li> <li>При остановке запроса по причине <code>KILL QUERY</code> или <code>replace_running_query</code>, клиент получает исключение <code>Query was cancelled</code> вместо неполного результата.</li> </ul> <h3 id=uluchsheniia_21>Улучшения:<a class=headerlink href=#uluchsheniia_21 title="Permanent link">&para;</a></h3> <ul> <li>Запросы вида <code>ALTER TABLE ... DROP/DETACH PARTITION</code> выполняются впереди очереди репликации.</li> <li>Возможность использовать <code>SELECT ... FINAL</code> и <code>OPTIMIZE ... FINAL</code> даже в случае, если данные в таблице представлены одним куском.</li> <li>Пересоздание таблицы <code>query_log</code> налету в случае если было произведено её удаление вручную (Kirill Shvakov).</li> <li>Ускорение функции <code>lengthUTF8</code> (zhang2014).</li> <li>Улучшена производительность синхронной вставки в <code>Distributed</code> таблицы (<code>insert_distributed_sync = 1</code>) в случае очень большого количества шардов.</li> <li>Сервер принимает настройки <code>send_timeout</code> и <code>receive_timeout</code> от клиента и применяет их на своей стороне для соединения с клиентом (в переставленном порядке: <code>send_timeout</code> у сокета на стороне сервера выставляется в значение <code>receive_timeout</code> принятое от клиента, и наоборот).</li> <li>Более надёжное восстановление после сбоев при асинхронной вставке в <code>Distributed</code> таблицы.</li> <li>Возвращаемый тип функции <code>countEqual</code> изменён с <code>UInt32</code> на <code>UInt64</code> (谢磊)</li> </ul> <h3 id=ispravlenie-oshibok_19>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_19 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка c <code>IN</code> где левая часть выражения <code>Nullable</code>.</li> <li>Исправлен неправильный результат при использовании кортежей с <code>IN</code> в случае, если часть компоненнтов кортежа есть в индексе таблицы.</li> <li>Исправлена работа ограничения <code>max_execution_time</code> с распределенными запросами.</li> <li>Исправлены ошибки при вычислении размеров составных столбцов в таблице <code>system.columns</code>.</li> <li>Исправлена ошибка при создании временной таблицы <code>CREATE TEMPORARY TABLE IF NOT EXISTS</code></li> <li>Исправлены ошибки в <code>StorageKafka</code> (#2075)</li> <li>Исправлены падения сервера от некорректных аргументов некоторых аггрегатных функций.</li> <li>Исправлена ошибка, из-за которой запрос <code>DETACH DATABASE</code> мог не приводить к остановке фоновых задач таблицы типа <code>ReplicatedMergeTree</code>.</li> <li>Исправлена проблема с появлением <code>Too many parts</code> в агрегирующих материализованных представлениях (#2084).</li> <li>Исправлена рекурсивная обработка подстановок в конфиге, если после одной подстановки, требуется другая подстановка на том же уровне.</li> <li>Исправлена ошибка с неправильным синтаксисом в файле с метаданными при создании <code>VIEW</code>, использующих запрос с <code>UNION ALL</code>.</li> <li>Исправлена работа <code>SummingMergeTree</code> в случае суммирования вложенных структур данных с составным ключом.</li> <li>Исправлена возможность возникновения race condition при выборе лидера таблиц <code>ReplicatedMergeTree</code>.</li> </ul> <h3 id=izmeneniia-sborki_3>Изменения сборки:<a class=headerlink href=#izmeneniia-sborki_3 title="Permanent link">&para;</a></h3> <ul> <li>Поддержка <code>ninja</code> вместо <code>make</code> при сборке. <code>ninja</code> используется по-умолчанию при сборке релизов.</li> <li>Переименованы пакеты <code>clickhouse-server-base</code> в <code>clickhouse-common-static</code>; <code>clickhouse-server-common</code> в <code>clickhouse-server</code>; <code>clickhouse-common-dbg</code> в <code>clickhouse-common-static-dbg</code>. Для установки используйте <code>clickhouse-server clickhouse-client</code>. Для совместимости, пакеты со старыми именами продолжают загружаться в репозиторий.</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_13>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_13 title="Permanent link">&para;</a></h3> <ul> <li>Удалена специальная интерпретация выражения IN, если слева указан массив. Ранее выражение вида <code>arr IN (set)</code> воспринималось как "хотя бы один элемент <code>arr</code> принадлежит множеству <code>set</code>". Для получения такого же поведения в новой версии, напишите <code>arrayExists(x -&gt; x IN (set), arr)</code>.</li> <li>Отключено ошибочное использование опции сокета <code>SO_REUSEPORT</code> (которая по ошибке включена по-умолчанию в библиотеке Poco). Стоит обратить внимание, что на Linux системах теперь не имеет смысла указывать одновременно адреса <code>::</code> и <code>0.0.0.0</code> для listen - следует использовать лишь адрес <code>::</code>, который (с настройками ядра по-умолчанию) позволяет слушать соединения как по IPv4 так и по IPv6. Также вы можете вернуть поведение старых версий, указав в конфиге <code>&lt;listen_reuse_port&gt;1&lt;/listen_reuse_port&gt;</code>.</li> </ul> <h2 id=clickhouse-release-1-1-54370-2018-03-16>ClickHouse release 1.1.54370, 2018-03-16<a class=headerlink href=#clickhouse-release-1-1-54370-2018-03-16 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_23>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_23 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена системная таблица <code>system.macros</code> и автоматическое обновление макросов при изменении конфигурационного файла.</li> <li>Добавлен запрос <code>SYSTEM RELOAD CONFIG</code>.</li> <li>Добавлена агрегатная функция <code>maxIntersections(left_col, right_col)</code>, возвращающая максимальное количество одновременно пересекающихся интервалов <code>[left; right]</code>. Функция <code>maxIntersectionsPosition(left, right)</code> возвращает начало такого "максимального" интервала. (<a href=https://github.com/yandex/ClickHouse/pull/2012 rel="external nofollow noreferrer">Michael Furmur</a>).</li> </ul> <h3 id=uluchsheniia_22>Улучшения:<a class=headerlink href=#uluchsheniia_22 title="Permanent link">&para;</a></h3> <ul> <li>При вставке данных в <code>Replicated</code>-таблицу делается меньше обращений к <code>ZooKeeper</code> (также из лога <code>ZooKeeper</code> исчезло большинство user-level ошибок).</li> <li>Добавлена возможность создавать алиасы для множеств. Пример: <code>WITH (1, 2, 3) AS set SELECT number IN set FROM system.numbers LIMIT 10</code>.</li> </ul> <h3 id=ispravlenie-oshibok_20>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_20 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка <code>Illegal PREWHERE</code> при чтении из Merge-таблицы над <code>Distributed</code>-таблицами.</li> <li>Добавлены исправления, позволяющие запускать clickhouse-server в IPv4-only docker-контейнерах.</li> <li>Исправлен race condition при чтении из системной таблицы <code>system.parts_columns</code></li> <li>Убрана двойная буферизация при синхронной вставке в <code>Distributed</code>-таблицу, которая могла приводить к timeout-ам соединений.</li> <li>Исправлена ошибка, вызывающая чрезмерно долгое ожидание недоступной реплики перед началом выполнения <code>SELECT</code>.</li> <li>Исправлено некорректное отображение дат в таблице <code>system.parts</code>.</li> <li>Исправлена ошибка, приводящая к невозможности вставить данные в <code>Replicated</code>-таблицу, если в конфигурации кластера <code>ZooKeeper</code> задан непустой <code>chroot</code>.</li> <li>Исправлен алгоритм вертикального мержа при пустом ключе <code>ORDER BY</code> таблицы.</li> <li>Возвращена возможность использовать словари в запросах к удаленным таблицам, даже если этих словарей нет на сервере-инициаторе. Данная функциональность была потеряна в версии 1.1.54362.</li> <li>Восстановлено поведение, при котором в запросах типа <code>SELECT * FROM remote('server2', default.table) WHERE col IN (SELECT col2 FROM default.table)</code> в правой части <code>IN</code> должна использоваться удаленная таблица <code>default.table</code>, а не локальная. данное поведение было нарушено в версии 1.1.54358.</li> <li>Устранено ненужное Error-level логирование <code>Not found column ... in block</code>.</li> </ul> <h2 id=reliz-clickhouse-1-1-54362-2018-03-11>Релиз ClickHouse 1.1.54362, 2018-03-11<a class=headerlink href=#reliz-clickhouse-1-1-54362-2018-03-11 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_24>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_24 title="Permanent link">&para;</a></h3> <ul> <li>Агрегация без <code>GROUP BY</code> по пустому множеству (как например, <code>SELECT count(*) FROM table WHERE 0</code>) теперь возвращает результат из одной строки с нулевыми значениями агрегатных функций, в соответствии со стандартом SQL. Вы можете вернуть старое поведение (возвращать пустой результат), выставив настройку <code>empty_result_for_aggregation_by_empty_set</code> в значение 1.</li> <li>Добавлено приведение типов при <code>UNION ALL</code>. Допустимо использование столбцов с разными алиасами в соответствующих позициях <code>SELECT</code> в <code>UNION ALL</code>, что соответствует стандарту SQL.</li> <li>Поддержка произвольных выражений в секции <code>LIMIT BY</code>. Ранее было возможно лишь использование столбцов - результата <code>SELECT</code>.</li> <li>Использование индекса таблиц семейства <code>MergeTree</code> при наличии условия <code>IN</code> на кортеж от выражений от столбцов первичного ключа. Пример <code>WHERE (UserID, EventDate) IN ((123, '2000-01-01'), ...)</code> (Anastasiya Tsarkova).</li> <li>Добавлен инструмент <code>clickhouse-copier</code> для межкластерного копирования и перешардирования данных (бета).</li> <li>Добавлены функции консистентного хэширования <code>yandexConsistentHash</code>, <code>jumpConsistentHash</code>, <code>sumburConsistentHash</code>. Их можно использовать в качестве ключа шардирования для того, чтобы уменьшить объём сетевого трафика при последующих перешардированиях.</li> <li>Добавлены функции <code>arrayAny</code>, <code>arrayAll</code>, <code>hasAny</code>, <code>hasAll</code>, <code>arrayIntersect</code>, <code>arrayResize</code>.</li> <li>Добавлена функция <code>arrayCumSum</code> (Javi Santana).</li> <li>Добавлена функция <code>parseDateTimeBestEffort</code>, <code>parseDateTimeBestEffortOrZero</code>, <code>parseDateTimeBestEffortOrNull</code>, позволяющая прочитать DateTime из строки, содержащей текст в широком множестве возможных форматов.</li> <li>Возможность частичной перезагрузки данных внешних словарей при их обновлении (загрузка лишь записей со значением заданного поля большим, чем при предыдущей загрузке) (Arsen Hakobyan).</li> <li>Добавлена табличная функция <code>cluster</code>. Пример: <code>cluster(cluster_name, db, table)</code>. Табличная функция <code>remote</code> может принимать имя кластера в качестве первого аргумента, если оно указано в виде идентификатора.</li> <li>Возможность использования табличных функций <code>remote</code>, <code>cluster</code> в <code>INSERT</code> запросах.</li> <li>Добавлены виртуальные столбцы <code>create_table_query</code>, <code>engine_full</code> в таблице <code>system.tables</code>. Столбец <code>metadata_modification_time</code> сделан виртуальным.</li> <li>Добавлены столбцы <code>data_path</code>, <code>metadata_path</code> в таблицы <code>system.tables</code> и<code>system.databases</code>, а также столбец <code>path</code> в таблицы <code>system.parts</code> и <code>system.parts_columns</code>.</li> <li>Добавлена дополнительная информация о слияниях в таблице <code>system.part_log</code>.</li> <li>Возможность использования произвольного ключа партиционирования для таблицы <code>system.query_log</code> (Kirill Shvakov).</li> <li>Запрос <code>SHOW TABLES</code> теперь показывает также и временные таблицы. Добавлены временные таблицы и столбец <code>is_temporary</code> в таблице <code>system.tables</code> (zhang2014).</li> <li>Добавлен запрос <code>DROP TEMPORARY TABLE</code>, <code>EXISTS TEMPORARY TABLE</code> (zhang2014).</li> <li>Поддержка <code>SHOW CREATE TABLE</code> для временных таблиц (zhang2014).</li> <li>Добавлен конфигурационный параметр <code>system_profile</code> для настроек, используемых внутренними процессами.</li> <li>Поддержка загрузки <code>object_id</code> в качестве атрибута в словарях с источником <code>MongoDB</code> (Павел Литвиненко).</li> <li>Возможность читать <code>null</code> как значение по-умолчанию при загрузке данных для внешнего словаря с источником <code>MongoDB</code> (Павел Литвиненко).</li> <li>Возможность чтения значения типа <code>DateTime</code> в формате <code>Values</code> из unix timestamp без одинарных кавычек.</li> <li>Поддержан failover в табличной функции <code>remote</code> для случая, когда на части реплик отсутствует запрошенная таблица.</li> <li>Возможность переопределять параметры конфигурации в параметрах командной строки при запуске <code>clickhouse-server</code>, пример: <code>clickhouse-server -- --logger.level=information</code>.</li> <li>Реализована функция <code>empty</code> от аргумента типа <code>FixedString</code>: функция возвращает 1, если строка состоит полностью из нулевых байт (zhang2014).</li> <li>Добавлен конфигурационный параметр <code>listen_try</code>, позволяющий слушать хотя бы один из listen адресов и не завершать работу, если некоторые адреса не удаётся слушать (полезно для систем с выключенной поддержкой IPv4 или IPv6).</li> <li>Добавлен движок таблиц <code>VersionedCollapsingMergeTree</code>.</li> <li>Поддержка строк и произвольных числовых типов для источника словарей <code>library</code>.</li> <li>Возможность использования таблиц семейства <code>MergeTree</code> без первичного ключа (для этого необходимо указать <code>ORDER BY tuple()</code>).</li> <li>Добавлена возможность выполнить преобразование (<code>CAST</code>) <code>Nullable</code> типа в не <code>Nullable</code> тип, если аргумент не является <code>NULL</code>.</li> <li>Возможность выполнения <code>RENAME TABLE</code> для <code>VIEW</code>.</li> <li>Добавлена функция <code>throwIf</code>.</li> <li>Добавлена настройка <code>odbc_default_field_size</code>, позволяющая расширить максимальный размер значения, загружаемого из ODBC источника (по-умолчанию - 1024).</li> <li>В таблицу <code>system.processes</code> и в <code>SHOW PROCESSLIST</code> добавлены столбцы <code>is_cancelled</code> и <code>peak_memory_usage</code>.</li> </ul> <h3 id=uluchsheniia_23>Улучшения:<a class=headerlink href=#uluchsheniia_23 title="Permanent link">&para;</a></h3> <ul> <li>Ограничения на результат и квоты на результат теперь не применяются к промежуточным данным для запросов <code>INSERT SELECT</code> и для подзапросов в <code>SELECT</code>.</li> <li>Уменьшено количество ложных срабатываний при проверке состояния <code>Replicated</code> таблиц при запуске сервера, приводивших к необходимости выставления флага <code>force_restore_data</code>.</li> <li>Добавлена настройка <code>allow_distributed_ddl</code>.</li> <li>Запрещено использование недетерминированных функций в выражениях для ключей таблиц семейства <code>MergeTree</code>.</li> <li>Файлы с подстановками из <code>config.d</code> директорий загружаются в алфавитном порядке.</li> <li>Увеличена производительность функции <code>arrayElement</code> в случае константного многомерного массива с пустым массивом в качестве одного из элементов. Пример: <code>[[1], []][x]</code>.</li> <li>Увеличена скорость запуска сервера при использовании конфигурационных файлов с очень большими подстановками (например, очень большими списками IP-сетей).</li> <li>При выполнении запроса, табличные функции выполняются один раз. Ранее табличные функции <code>remote</code>, <code>mysql</code> дважды делали одинаковый запрос на получение структуры таблицы с удалённого сервера.</li> <li>Используется генератор документации <code>MkDocs</code>.</li> <li>При попытке удалить столбец таблицы, от которого зависят <code>DEFAULT</code>/<code>MATERIALIZED</code> выражения других столбцов, кидается исключение (zhang2014).</li> <li>Добавлена возможность парсинга пустой строки в текстовых форматах как числа 0 для <code>Float</code> типов данных. Эта возможность присутствовала раньше, но была потеряна в релизе 1.1.54342.</li> <li>Значения типа <code>Enum</code> можно использовать в функциях <code>min</code>, <code>max</code>, <code>sum</code> и некоторых других - в этих случаях используются соответствующие числовые значения. Эта возможность присутствовала ранее, но была потеряна в релизе 1.1.54337.</li> <li>Добавлено ограничение <code>max_expanded_ast_elements</code> действующее на размер AST после рекурсивного раскрытия алиасов.</li> </ul> <h3 id=ispravlenie-oshibok_21>Исправление ошибок:<a class=headerlink href=#ispravlenie-oshibok_21 title="Permanent link">&para;</a></h3> <ul> <li>Исправлены случаи ошибочного удаления ненужных столбцов из подзапросов, а также отсутствие удаления ненужных столбцов из подзапросов, содержащих <code>UNION ALL</code>.</li> <li>Исправлена ошибка в слияниях для таблиц типа <code>ReplacingMergeTree</code>.</li> <li>Исправлена работа синхронного режима вставки в <code>Distributed</code> таблицы (<code>insert_distributed_sync = 1</code>).</li> <li>Исправлены segfault при некоторых случаях использования <code>FULL</code> и <code>RIGHT JOIN</code> с дублирующимися столбцами в подзапросах.</li> <li>Исправлены segfault, которые могут возникать при использовании функциональности <code>replace_running_query</code> и <code>KILL QUERY</code>.</li> <li>Исправлен порядок столбцов <code>source</code> и <code>last_exception</code> в таблице <code>system.dictionaries</code>.</li> <li>Исправлена ошибка - запрос <code>DROP DATABASE</code> не удалял файл с метаданными.</li> <li>Исправлен запрос <code>DROP DATABASE</code> для базы данных типа <code>Dictionary</code>.</li> <li>Исправлена неоправданно низкая точность работы функций <code>uniqHLL12</code> и <code>uniqCombined</code> для кардинальностей больше 100 млн. элементов (Alex Bocharov).</li> <li>Исправлено вычисление неявных значений по-умолчанию при необходимости одновременного вычисления явных выражений по-умолчанию в запросах <code>INSERT</code> (zhang2014).</li> <li>Исправлен редкий случай, в котором запрос к таблице типа <code>MergeTree</code> мог не завершаться (chenxing-xc).</li> <li>Исправлено падение при выполнении запроса <code>CHECK</code> для <code>Distributed</code> таблиц, если все шарды локальные (chenxing.xc).</li> <li>Исправлена незначительная регрессия производительности при работе функций, использующих регулярные выражения.</li> <li>Исправлена регрессия производительности при создании многомерных массивов от сложных выражений.</li> <li>Исправлена ошибка, из-за которой в <code>.sql</code> файл с метаданными может записываться лишняя секция <code>FORMAT</code>.</li> <li>Исправлена ошибка, приводящая к тому, что ограничение <code>max_table_size_to_drop</code> действует при попытке удаления <code>MATERIALIZED VIEW</code>, смотрящего на явно указанную таблицу.</li> <li>Исправлена несовместимость со старыми клиентами (на старые клиенты могли отправляться данные с типом <code>DateTime('timezone')</code>, который они не понимают).</li> <li>Исправлена ошибка при чтении столбцов-элементов <code>Nested</code> структур, которые были добавлены с помощью <code>ALTER</code>, но являются пустыми для старых партиций, когда условия на такие столбцы переносятся в <code>PREWHERE</code>.</li> <li>Исправлена ошибка при фильтрации таблиц по условию на виртуальных столбец <code>_table</code> в запросах к таблицам типа <code>Merge</code>.</li> <li>Исправлена ошибка при использовании <code>ALIAS</code> столбцов в <code>Distributed</code> таблицах.</li> <li>Исправлена ошибка, приводящая к невозможности динамической компиляции запросов с агрегатными функциями из семейства <code>quantile</code>.</li> <li>Исправлен race condition в конвейере выполнения запроса, который мог проявляться в очень редких случаях при использовании <code>Merge</code> таблиц над большим количеством таблиц, а также при использовании <code>GLOBAL</code> подзапросов.</li> <li>Исправлено падение при передаче массивов разных размеров в функцию <code>arrayReduce</code> при использовании агрегатных функций от нескольких аргументов.</li> <li>Запрещено использование запросов с <code>UNION ALL</code> в <code>MATERIALIZED VIEW</code>.</li> <li>Исправлена ошибка, которая может возникать при инициализации системной таблицы <code>part_log</code> при старте сервера (по-умолчанию <code>part_log</code> выключен).</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_14>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_14 title="Permanent link">&para;</a></h3> <ul> <li>Удалена настройка <code>distributed_ddl_allow_replicated_alter</code>. Соответствующее поведение включено по-умолчанию.</li> <li>Удалена настройка <code>strict_insert_defaults</code>. Если вы использовали эту функциональность, напишите на <code>clickhouse-feedback@yandex-team.com</code>.</li> <li>Удалён движок таблиц <code>UnsortedMergeTree</code>.</li> </ul> <h2 id=reliz-clickhouse-1-1-54343-2018-02-05>Релиз ClickHouse 1.1.54343, 2018-02-05<a class=headerlink href=#reliz-clickhouse-1-1-54343-2018-02-05 title="Permanent link">&para;</a></h2> <ul> <li>Добавлена возможность использовать макросы при задании имени кластера в распределенных DLL запросах и создании Distributed-таблиц: <code>CREATE TABLE distr ON CLUSTER '{cluster}' (...) ENGINE = Distributed('{cluster}', 'db', 'table')</code>.</li> <li>Теперь при вычислении запросов вида <code>SELECT ... FROM table WHERE expr IN (subquery)</code> используется индекс таблицы <code>table</code>.</li> <li>Улучшена обработка дубликатов при вставке в Replicated-таблицы, теперь они не приводят к излишнему замедлению выполнения очереди репликации.</li> </ul> <h2 id=reliz-clickhouse-1-1-54342-2018-01-22>Релиз ClickHouse 1.1.54342, 2018-01-22<a class=headerlink href=#reliz-clickhouse-1-1-54342-2018-01-22 title="Permanent link">&para;</a></h2> <p>Релиз содержит исправление к предыдущему релизу 1.1.54337: * Исправлена регрессия в версии 1.1.54337: если пользователь по-умолчанию имеет readonly доступ, то сервер отказывался стартовать с сообщением <code>Cannot create database in readonly mode</code>. * Исправлена регрессия в версии 1.1.54337: на системах под управлением systemd, логи по ошибке всегда записываются в syslog; watchdog скрипт по ошибке использует init.d. * Исправлена регрессия в версии 1.1.54337: неправильная конфигурация по-умоланию в Docker образе. * Исправлена недетерминированная работа GraphiteMergeTree (в логах видно по сообщениям <code>Data after merge is not byte-identical to data on another replicas</code>). * Исправлена ошибка, в связи с которой запрос OPTIMIZE к Replicated таблицам мог приводить к неконсистентным мержам (в логах видно по сообщениям <code>Part ... intersects previous part</code>). * Таблицы типа Buffer теперь работают при наличии MATERIALIZED столбцов в таблице назначения (by zhang2014). * Исправлена одна из ошибок в реализации NULL.</p> <h2 id=reliz-clickhouse-1-1-54337-2018-01-18>Релиз ClickHouse 1.1.54337, 2018-01-18<a class=headerlink href=#reliz-clickhouse-1-1-54337-2018-01-18 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_25>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_25 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена поддержка хранения многомерных массивов и кортежей (тип данных <code>Tuple</code>) в таблицах.</li> <li>Поддержка табличных функций для запросов <code>DESCRIBE</code> и <code>INSERT</code>. Поддержка подзапроса в запросе <code>DESCRIBE</code>. Примеры: <code>DESC TABLE remote('host', default.hits)</code>; <code>DESC TABLE (SELECT 1)</code>; <code>INSERT INTO TABLE FUNCTION remote('host', default.hits)</code>. Возможность писать <code>INSERT INTO TABLE</code> вместо <code>INSERT INTO</code>.</li> <li>Улучшена поддержка часовых поясов. В типе <code>DateTime</code> может быть указана таймзона, которая используется для парсинга и отображения данных в текстовом виде. Пример: <code>DateTime('Europe/Moscow')</code>. При указании таймзоны в функциях работы с <code>DateTime</code>, тип возвращаемого значения будет запоминать таймзону, для того, чтобы значение отображалось ожидаемым образом.</li> <li>Добавлены функции <code>toTimeZone</code>, <code>timeDiff</code>, <code>toQuarter</code>, <code>toRelativeQuarterNum</code>. В функцию <code>toRelativeHour</code>/<code>Minute</code>/<code>Second</code> можно передать аргумент типа <code>Date</code>. Имя функции <code>now</code> воспринимается без учёта регистра.</li> <li>Добавлена функция <code>toStartOfFifteenMinutes</code> (Kirill Shvakov).</li> <li>Добавлена программа <code>clickhouse format</code> для переформатирования запросов.</li> <li>Добавлен конфигурационный параметр <code>format_schema_path</code> (Marek Vavruša). Он используется для задания схемы для формата <code>Cap'n'Proto</code>. Файлы со схемой могут использоваться только из указанной директории.</li> <li>Добавлена поддержка <code>incl</code> и <code>conf.d</code> подстановок для конфигурации словарей и моделей (Pavel Yakunin).</li> <li>В таблице <code>system.settings</code> появилось описание большинства настроек (Kirill Shvakov).</li> <li>Добавлена таблица <code>system.parts_columns</code>, содержащая информацию о размерах столбцов в каждом куске данных <code>MergeTree</code> таблиц.</li> <li>Добавлена таблица <code>system.models</code>, содержащая информацию о загруженных моделях <code>CatBoost</code>.</li> <li>Добавлены табличные функции <code>mysql</code> и <code>odbc</code> и соответствующие движки таблиц <code>MySQL</code>, <code>ODBC</code> для обращения к удалённым базам данных. Функциональность в состоянии "бета".</li> <li>Для функции <code>groupArray</code> разрешено использование аргументов типа <code>AggregateFunction</code> (можно создать массив из состояний агрегатных функций).</li> <li>Удалены ограничения на использование разных комбинаций комбинаторов агрегатных функций. Для примера, вы можете использовать как функцию <code>avgForEachIf</code>, так и <code>avgIfForEach</code>, которые имеют разный смысл.</li> <li>Комбинатор агрегатных функций <code>-ForEach</code> расширен для случая агрегатных функций с более чем одним аргументом.</li> <li>Добавлена поддержка агрегатных функций от <code>Nullable</code> аргументов, для случаев, когда функция всегда возвращает не <code>Nullable</code> результат (реализовано с участием Silviu Caragea). Пример: <code>groupArray</code>, <code>groupUniqArray</code>, <code>topK</code>.</li> <li>Добавлен параметр командной строки <code>max_client_network_bandwidth</code> для <code>clickhouse-client</code> (Kirill Shvakov).</li> <li>Пользователям с доступом <code>readonly = 2</code> разрешено работать с временными таблицами (CREATE, DROP, INSERT...) (Kirill Shvakov).</li> <li>Добавлена возможность указания количества consumers для <code>Kafka</code>. Расширена возможность конфигурации движка <code>Kafka</code> (Marek Vavruša).</li> <li>Добавлены функции <code>intExp2</code>, <code>intExp10</code>.</li> <li>Добавлена агрегатная функция <code>sumKahan</code>.</li> <li>Добавлены функции to<em>Number</em>OrNull, где <em>Number</em> - числовой тип.</li> <li>Добавлена поддержка секции <code>WITH</code> для запроса <code>INSERT SELECT</code> (автор: zhang2014).</li> <li>Добавлены настройки <code>http_connection_timeout</code>, <code>http_send_timeout</code>, <code>http_receive_timeout</code>. Настройки используются, в том числе, при скачивании кусков для репликации. Изменение этих настроек позволяет сделать более быстрый failover в случае перегруженной сети.</li> <li>Добавлена поддержка <code>ALTER</code> для таблиц типа <code>Null</code> (Anastasiya Tsarkova).</li> <li>Функция <code>reinterpretAsString</code> расширена на все типы данных, значения которых хранятся в памяти непрерывно.</li> <li>Для программы <code>clickhouse-local</code> добавлена опция <code>--silent</code> для подавления вывода информации о выполнении запроса в stderr.</li> <li>Добавлена поддержка чтения <code>Date</code> в текстовом виде в формате, где месяц и день месяца могут быть указаны одной цифрой вместо двух (Amos Bird).</li> </ul> <h3 id=uvelichenie-proizvoditelnosti>Увеличение производительности:<a class=headerlink href=#uvelichenie-proizvoditelnosti title="Permanent link">&para;</a></h3> <ul> <li>Увеличена производительность агрегатных функций <code>min</code>, <code>max</code>, <code>any</code>, <code>anyLast</code>, <code>anyHeavy</code>, <code>argMin</code>, <code>argMax</code> от строковых аргументов.</li> <li>Увеличена производительность функций <code>isInfinite</code>, <code>isFinite</code>, <code>isNaN</code>, <code>roundToExp2</code>.</li> <li>Увеличена производительность форматирования в текстовом виде и парсинга из текста значений типа <code>Date</code> и <code>DateTime</code>.</li> <li>Увеличена производительность и точность парсинга чисел с плавающей запятой.</li> <li>Уменьшено потребление памяти при <code>JOIN</code>, если левая и правая часть содержали столбцы с одинаковым именем, не входящие в <code>USING</code>.</li> <li>Увеличена производительность агрегатных функций <code>varSamp</code>, <code>varPop</code>, <code>stddevSamp</code>, <code>stddevPop</code>, <code>covarSamp</code>, <code>covarPop</code>, <code>corr</code> за счёт уменьшения стойкости к вычислительной погрешности. Старые версии функций добавлены под именами <code>varSampStable</code>, <code>varPopStable</code>, <code>stddevSampStable</code>, <code>stddevPopStable</code>, <code>covarSampStable</code>, <code>covarPopStable</code>, <code>corrStable</code>.</li> </ul> <h3 id=ispravleniia-oshibok_30>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_30 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена работа дедупликации блоков после <code>DROP</code> или <code>DETATH PARTITION</code>. Раньше удаление партиции и вставка тех же самых данных заново не работала, так как вставленные заново блоки считались дубликатами.</li> <li>Исправлена ошибка, в связи с которой может неправильно обрабатываться <code>WHERE</code> для запросов на создание <code>MATERIALIZED VIEW</code> с указанием <code>POPULATE</code>.</li> <li>Исправлена ошибка в работе параметра <code>root_path</code> в конфигурации <code>zookeeper_servers</code>.</li> <li>Исправлен неожиданный результат при передаче аргумента типа <code>Date</code> в функцию <code>toStartOfDay</code>.</li> <li>Исправлена работа функции <code>addMonths</code>, <code>subtractMonths</code>, арифметика с <code>INTERVAL n MONTH</code>, если в результате получается предыдущий год.</li> <li>Добавлена недостающая поддержка типа данных <code>UUID</code> для <code>DISTINCT</code>, <code>JOIN</code>, в агрегатных функциях <code>uniq</code> и во внешних словарях (Иванов Евгений). Поддержка <code>UUID</code> всё ещё остаётся не полной.</li> <li>Исправлено поведение <code>SummingMergeTree</code> для строк, в которых все значения после суммирования равны нулю.</li> <li>Многочисленные доработки для движка таблиц <code>Kafka</code> (Marek Vavruša).</li> <li>Исправлена некорректная работа движка таблиц <code>Join</code> (Amos Bird).</li> <li>Исправлена работа аллокатора под FreeBSD и OS X.</li> <li>Функция <code>extractAll</code> теперь может доставать пустые вхождения.</li> <li>Исправлена ошибка, не позволяющая подключить при сборке <code>libressl</code> вместо <code>openssl</code>.</li> <li>Исправлена работа <code>CREATE TABLE AS SELECT</code> из временной таблицы.</li> <li>Исправлена неатомарность обновления очереди репликации. Эта проблема могла приводить к рассинхронизации реплик и чинилась при перезапуске.</li> <li>Исправлено переполнение в функциях <code>gcd</code>, <code>lcm</code>, <code>modulo</code> (оператор <code>%</code>) (Maks Skorokhod).</li> <li>Файлы <code>-preprocessed</code> теперь создаются после изменения <code>umask</code> (<code>umask</code> может быть задан в конфигурационном файле).</li> <li>Исправлена ошибка фоновой проверки кусков (<code>MergeTreePartChecker</code>) при использовании партиционирования по произвольному ключу.</li> <li>Исправлен парсинг кортежей (значений типа <code>Tuple</code>) в текстовых форматах.</li> <li>Исправлены сообщения о неподходящих типах аргументов для функций <code>multiIf</code>, <code>array</code> и некоторых других.</li> <li>Переработана поддержка <code>Nullable</code> типов. Исправлены ошибки, которые могут приводить к падению сервера. Исправлено подавляющее большинство других ошибок, связанных с поддержкой <code>NULL</code>: неправильное приведение типов при INSERT SELECT, недостаточная поддержка Nullable в HAVING и в PREWHERE, режим <code>join_use_nulls</code>, Nullable типы в операторе <code>OR</code> и т. п.</li> <li>Исправлена работа с внутренними свойствами типов данных, что позволило исправить проблемы следующего вида: ошибочное суммирование полей типа <code>Enum</code> в <code>SummingMergeTree</code>; значения типа <code>Enum</code> ошибочно выводятся с выравниванием по правому краю в таблицах в <code>Pretty</code> форматах, и т. п.</li> <li>Более строгие проверки для допустимых комбинаций составных столбцов - это позволило исправить ошибок, которые могли приводить к падениям.</li> <li>Исправлено переполнение при задании очень большого значения параметра для типа <code>FixedString</code>.</li> <li>Исправлена работа агрегатной функции <code>topK</code> для generic случая.</li> <li>Добавлена отсутствующая проверка на совпадение размеров массивов для n-арных вариантов агрегатных функций с комбинатором <code>-Array</code>.</li> <li>Исправлена работа <code>--pager</code> для <code>clickhouse-client</code> (автор: ks1322).</li> <li>Исправлена точность работы функции <code>exp10</code>.</li> <li>Исправлено поведение функции <code>visitParamExtract</code> согласно документации.</li> <li>Исправлено падение при объявлении некорректных типов данных.</li> <li>Исправлена работа <code>DISTINCT</code> при условии, что все столбцы константные.</li> <li>Исправлено форматирование запроса в случае наличия функции <code>tupleElement</code> со сложным константным выражением в качестве номера элемента.</li> <li>Исправлена работа <code>Dictionary</code> таблиц для словарей типа <code>range_hashed</code>.</li> <li>Исправлена ошибка, приводящая к появлению лишних строк при <code>FULL</code> и <code>RIGHT JOIN</code> (Amos Bird).</li> <li>Исправлено падение сервера в случае создания и удаления временных файлов в <code>config.d</code> директориях в момент перечитывания конфигурации.</li> <li>Исправлена работа запроса <code>SYSTEM DROP DNS CACHE</code>: ранее сброс DNS кэша не приводил к повторному резолвингу имён хостов кластера.</li> <li>Исправлено поведение <code>MATERIALIZED VIEW</code> после <code>DETACH TABLE</code> таблицы, на которую он смотрит (Marek Vavruša).</li> </ul> <h3 id=uluchsheniia-sborki_2>Улучшения сборки:<a class=headerlink href=#uluchsheniia-sborki_2 title="Permanent link">&para;</a></h3> <ul> <li>Для сборки используется <code>pbuilder</code>. Сборка максимально независима от окружения на сборочной машине.</li> <li>Для разных версий систем выкладывается один и тот же пакет, который совместим с широким диапазоном Linux систем.</li> <li>Добавлен пакет <code>clickhouse-test</code>, который может быть использован для запуска функциональных тестов.</li> <li>Добавлена выкладка в репозиторий архива с исходниками. Этот архив может быть использован для воспроизведения сборки без использования GitHub.</li> <li>Добавлена частичная интеграция с Travis CI. В связи с ограничениями на время сборки в Travis, запускается только ограниченный набор тестов на Debug сборке.</li> <li>Добавлена поддержка <code>Cap'n'Proto</code> в сборку по-умолчанию.</li> <li>Документация переведена с <code>Restructured Text</code> на <code>Markdown</code>.</li> <li>Добавлена поддержка <code>systemd</code> (Vladimir Smirnov). В связи с несовместимостью с некоторыми образами, она выключена по-умолчанию и может быть включена вручную.</li> <li>Для динамической компиляции запросов, <code>clang</code> и <code>lld</code> встроены внутрь <code>clickhouse</code>. Они также могут быть вызваны с помощью <code>clickhouse clang</code> и <code>clickhouse lld</code>.</li> <li>Удалено использование расширений GNU из кода и включена опция <code>-Wextra</code>. При сборке с помощью <code>clang</code> по-умолчанию используется <code>libc++</code> вместо <code>libstdc++</code>.</li> <li>Выделены библиотеки <code>clickhouse_parsers</code> и <code>clickhouse_common_io</code> для более быстрой сборки утилит.</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_15>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_15 title="Permanent link">&para;</a></h3> <ul> <li>Формат засечек (marks) для таблиц типа <code>Log</code>, содержащих <code>Nullable</code> столбцы, изменён обратно-несовместимым образом. В случае наличия таких таблиц, вы можете преобразовать их в <code>TinyLog</code> до запуска новой версии сервера. Для этого в соответствующем таблице файле <code>.sql</code> в директории <code>metadata</code>, замените <code>ENGINE = Log</code> на <code>ENGINE = TinyLog</code>. Если в таблице нет <code>Nullable</code> столбцов или тип таблицы не <code>Log</code>, то ничего делать не нужно.</li> <li>Удалена настройка <code>experimental_allow_extended_storage_definition_syntax</code>. Соответствующая функциональность включена по-умолчанию.</li> <li>Функция <code>runningIncome</code> переименована в <code>runningDifferenceStartingWithFirstValue</code> во избежание путаницы.</li> <li>Удалена возможность написания <code>FROM ARRAY JOIN arr</code> без указания таблицы после FROM (Amos Bird).</li> <li>Удалён формат <code>BlockTabSeparated</code>, использовавшийся лишь для демонстрационных целей.</li> <li>Изменён формат состояния агрегатных функций <code>varSamp</code>, <code>varPop</code>, <code>stddevSamp</code>, <code>stddevPop</code>, <code>covarSamp</code>, <code>covarPop</code>, <code>corr</code>. Если вы использовали эти состояния для хранения в таблицах (тип данных <code>AggregateFunction</code> от этих функций или материализованные представления, хранящие эти состояния), напишите на <a href=mailto:clickhouse-feedback@yandex-team.com>&#99;&#108;&#105;&#99;&#107;&#104;&#111;&#117;&#115;&#101;&#45;&#102;&#101;&#101;&#100;&#98;&#97;&#99;&#107;&#64;&#121;&#97;&#110;&#100;&#101;&#120;&#45;&#116;&#101;&#97;&#109;&#46;&#99;&#111;&#109;</a>.</li> <li>В предыдущих версиях существовала недокументированная возможность: в типе данных AggregateFunction можно было не указывать параметры для агрегатной функции, которая зависит от параметров. Пример: <code>AggregateFunction(quantiles, UInt64)</code> вместо <code>AggregateFunction(quantiles(0.5, 0.9), UInt64)</code>. Эта возможность потеряна. Не смотря на то, что возможность не документирована, мы собираемся вернуть её в ближайших релизах.</li> <li>Значения типа данных Enum не могут быть переданы в агрегатные функции min/max. Возможность будет возвращена обратно в следующем релизе.</li> </ul> <h3 id=na-chto-obratit-vnimanie-pri-obnovlenii>На что обратить внимание при обновлении:<a class=headerlink href=#na-chto-obratit-vnimanie-pri-obnovlenii title="Permanent link">&para;</a></h3> <ul> <li>При обновлении кластера, на время, когда на одних репликах работает новая версия сервера, а на других - старая, репликация будет приостановлена и в логе появятся сообщения вида <code>unknown parameter 'shard'</code>. Репликация продолжится после обновления всех реплик кластера.</li> <li>Если на серверах кластера работают разные версии ClickHouse, то возможен неправильный результат распределённых запросов, использующих функции <code>varSamp</code>, <code>varPop</code>, <code>stddevSamp</code>, <code>stddevPop</code>, <code>covarSamp</code>, <code>covarPop</code>, <code>corr</code>. Необходимо обновить все серверы кластера.</li> </ul> <h2 id=reliz-clickhouse-1-1-54327-2017-12-21>Релиз ClickHouse 1.1.54327, 2017-12-21<a class=headerlink href=#reliz-clickhouse-1-1-54327-2017-12-21 title="Permanent link">&para;</a></h2> <p>Релиз содержит исправление к предыдущему релизу 1.1.54318: * Исправлена проблема с возможным race condition при репликации, которая может приводить к потере данных. Проблеме подвержены версии 1.1.54310 и 1.1.54318. Если вы их используете и у вас есть Replicated таблицы, то обновление обязательно. Понять, что эта проблема существует, можно по сообщениям в логе Warning вида <code>Part ... from own log doesn't exist.</code> Даже если таких сообщений нет, проблема всё-равно актуальна.</p> <h2 id=reliz-clickhouse-1-1-54318-2017-11-30>Релиз ClickHouse 1.1.54318, 2017-11-30<a class=headerlink href=#reliz-clickhouse-1-1-54318-2017-11-30 title="Permanent link">&para;</a></h2> <p>Релиз содержит изменения к предыдущему релизу 1.1.54310 с исправлением следующих багов: * Исправлено некорректное удаление строк при слияниях в движке SummingMergeTree * Исправлена утечка памяти в нереплицированных MergeTree-движках * Исправлена деградация производительности при частых вставках в MergeTree-движках * Исправлена проблема, приводящая к остановке выполнения очереди репликации * Исправлено ротирование и архивация логов сервера</p> <h2 id=reliz-clickhouse-1-1-54310-2017-11-01>Релиз ClickHouse 1.1.54310, 2017-11-01<a class=headerlink href=#reliz-clickhouse-1-1-54310-2017-11-01 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_26>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_26 title="Permanent link">&para;</a></h3> <ul> <li>Произвольный ключ партиционирования для таблиц семейства MergeTree.</li> <li>Движок таблиц <a href=https://clickhouse.yandex/docs/en/operations/table_engines/kafka/ rel="external nofollow noreferrer">Kafka</a>.</li> <li>Возможность загружать модели <a href=https://catboost.yandex/ rel="external nofollow noreferrer">CatBoost</a> и применять их к данным, хранящимся в ClickHouse.</li> <li>Поддержка часовых поясов с нецелым смещением от UTC.</li> <li>Поддержка операций с временными интервалами.</li> <li>Диапазон значений типов Date и DateTime расширен до 2105 года.</li> <li>Запрос <code>CREATE MATERIALIZED VIEW x TO y</code> (позволяет указать существующую таблицу для хранения данных материализованного представления).</li> <li>Запрос <code>ATTACH TABLE</code> без аргументов.</li> <li>Логика обработки Nested-столбцов в SummingMergeTree, заканчивающихся на -Map, вынесена в агрегатную функцию sumMap. Такие столбцы теперь можно задавать явно.</li> <li>Максимальный размер IP trie-словаря увеличен до 128М записей.</li> <li>Функция getSizeOfEnumType.</li> <li>Агрегатная функция sumWithOverflow.</li> <li>Поддержка входного формата Cap’n Proto.</li> <li>Возможность задавать уровень сжатия при использовании алгоритма zstd.</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_16>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_16 title="Permanent link">&para;</a></h3> <ul> <li>Запрещено создание временных таблиц с движком, отличным от Memory.</li> <li>Запрещено явное создание таблиц с движком View и MaterializedView.</li> <li>При создании таблицы теперь проверяется, что ключ сэмплирования входит в первичный ключ.</li> </ul> <h3 id=ispravleniia-oshibok_31>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_31 title="Permanent link">&para;</a></h3> <ul> <li>Исправлено зависание при синхронной вставке в Distributed таблицу.</li> <li>Исправлена неатомарность при добавлении/удалении кусков в реплицированных таблицах.</li> <li>Данные, вставляемые в материализованное представление, теперь не подвергаются излишней дедупликации.</li> <li>Запрос в Distributed таблицу, для которого локальная реплика отстаёт, а удалённые недоступны, теперь не падает.</li> <li>Для создания временных таблиц теперь не требуется прав доступа к БД <code>default</code>.</li> <li>Исправлено падение при указании типа Array без аргументов.</li> <li>Исправлено зависание при недостатке места на диске в разделе с логами.</li> <li>Исправлено переполнение в функции toRelativeWeekNum для первой недели Unix-эпохи.</li> </ul> <h3 id=uluchsheniia-sborki_3>Улучшения сборки:<a class=headerlink href=#uluchsheniia-sborki_3 title="Permanent link">&para;</a></h3> <ul> <li>Несколько сторонних библиотек (в частности, Poco) обновлены и переведены на git submodules.</li> </ul> <h2 id=reliz-clickhouse-1-1-54304-2017-10-19>Релиз ClickHouse 1.1.54304, 2017-10-19<a class=headerlink href=#reliz-clickhouse-1-1-54304-2017-10-19 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_27>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_27 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена поддержка TLS в нативном протоколе (включается заданием <code>tcp_ssl_port</code> в <code>config.xml</code>)</li> </ul> <h3 id=ispravleniia-oshibok_32>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_32 title="Permanent link">&para;</a></h3> <ul> <li><code>ALTER</code> для реплицированных таблиц теперь пытается начать выполнение как можно быстрее</li> <li>Исправлены падения при чтении данных с настройкой <code>preferred_block_size_bytes=0</code></li> <li>Исправлено падение <code>clickhouse-client</code> при нажатии <code>Page Down</code></li> <li>Корректная интепретация некоторых сложных запросов с <code>GLOBAL IN</code> и <code>UNION ALL</code></li> <li>Операция <code>FREEZE PARTITION</code> теперь работает всегда атомарно</li> <li>Исправлено зависание пустых POST-запросов (теперь возвращается код 411)</li> <li>Исправлены ошибки при интепретации выражений типа <code>CAST(1 AS Nullable(UInt8))</code></li> <li>Исправлена ошибка при чтении колонок типа <code>Array(Nullable(String))</code> из <code>MergeTree</code> таблиц</li> <li>Исправлено падение при парсинге запросов типа <code>SELECT dummy AS dummy, dummy AS b</code></li> <li>Корректное обновление пользователей при невалидном <code>users.xml</code></li> <li>Корректная обработка случаев, когда executable-словарь возвращает ненулевой код ответа</li> </ul> <h2 id=reliz-clickhouse-1-1-54292-2017-09-20>Релиз ClickHouse 1.1.54292, 2017-09-20<a class=headerlink href=#reliz-clickhouse-1-1-54292-2017-09-20 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_28>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_28 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена функция <code>pointInPolygon</code> для работы с координатами на плоскости.</li> <li>Добавлена агрегатная функция <code>sumMap</code>, обеспечивающая суммирование массивов аналогично <code>SummingMergeTree</code>.</li> <li>Добавлена функция <code>trunc</code>. Увеличена производительность функций округления <code>round</code>, <code>floor</code>, <code>ceil</code>, <code>roundToExp2</code>. Исправлена логика работы функций округления. Изменена логика работы функции <code>roundToExp2</code> для дробных и отрицательных чисел.</li> <li>Ослаблена зависимость исполняемого файла ClickHouse от версии libc. Один и тот же исполняемый файл ClickHouse может запускаться и работать на широком множестве Linux систем. Замечание: зависимость всё ещё присутствует при использовании скомпилированных запросов (настройка <code>compile = 1</code>, по-умолчанию не используется).</li> <li>Уменьшено время динамической компиляции запросов.</li> </ul> <h3 id=ispravleniia-oshibok_33>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_33 title="Permanent link">&para;</a></h3> <ul> <li>Исправлена ошибка, которая могла приводить к сообщениям <code>part ... intersects previous part</code> и нарушению консистентности реплик.</li> <li>Исправлена ошибка, приводящая к блокировке при завершении работы сервера, если в это время ZooKeeper недоступен.</li> <li>Удалено избыточное логгирование при восстановлении реплик.</li> <li>Исправлена ошибка в реализации UNION ALL.</li> <li>Исправлена ошибка в функции concat, возникающая в случае, если первый столбец блока имеет тип Array.</li> <li>Исправлено отображение прогресса в таблице system.merges.</li> </ul> <h2 id=reliz-clickhouse-1-1-54289-2017-09-13>Релиз ClickHouse 1.1.54289, 2017-09-13<a class=headerlink href=#reliz-clickhouse-1-1-54289-2017-09-13 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_29>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_29 title="Permanent link">&para;</a></h3> <ul> <li>Запросы <code>SYSTEM</code> для административных действий с сервером: <code>SYSTEM RELOAD DICTIONARY</code>, <code>SYSTEM RELOAD DICTIONARIES</code>, <code>SYSTEM DROP DNS CACHE</code>, <code>SYSTEM SHUTDOWN</code>, <code>SYSTEM KILL</code>.</li> <li>Добавлены функции для работы с массивами: <code>concat</code>, <code>arraySlice</code>, <code>arrayPushBack</code>, <code>arrayPushFront</code>, <code>arrayPopBack</code>, <code>arrayPopFront</code>.</li> <li>Добавлены параметры <code>root</code> и <code>identity</code> для конфигурации ZooKeeper. Это позволяет изолировать разных пользователей одного ZooKeeper кластера.</li> <li>Добавлены агрегатные функции <code>groupBitAnd</code>, <code>groupBitOr</code>, <code>groupBitXor</code> (для совместимости доступны также под именами <code>BIT_AND</code>, <code>BIT_OR</code>, <code>BIT_XOR</code>).</li> <li>Возможность загрузки внешних словарей из MySQL с указанием сокета на файловой системе.</li> <li>Возможность загрузки внешних словарей из MySQL через SSL соединение (параметры <code>ssl_cert</code>, <code>ssl_key</code>, <code>ssl_ca</code>).</li> <li>Добавлена настройка <code>max_network_bandwidth_for_user</code> для ограничения общего потребления сети для всех запросов одного пользователя.</li> <li>Поддержка <code>DROP TABLE</code> для временных таблиц.</li> <li>Поддержка чтения значений типа <code>DateTime</code> в формате unix timestamp из форматов <code>CSV</code> и <code>JSONEachRow</code>.</li> <li>Включено по-умолчанию отключение отстающих реплик при распределённых запросах (по-умолчанию порог равен 5 минутам).</li> <li>Используются FIFO блокировки при ALTER: выполнение ALTER не будет неограниченно блокироваться при непрерывно выполняющихся запросах.</li> <li>Возможность задать <code>umask</code> в конфигурационном файле.</li> <li>Увеличена производительность запросов с <code>DISTINCT</code>.</li> </ul> <h3 id=ispravleniia-oshibok_34>Исправления ошибок:<a class=headerlink href=#ispravleniia-oshibok_34 title="Permanent link">&para;</a></h3> <ul> <li>Более оптимальная процедура удаления старых нод в ZooKeeper. Ранее в случае очень частых вставок, старые ноды могли не успевать удаляться, что приводило, в том числе, к очень долгому завершению сервера.</li> <li>Исправлена рандомизация при выборе хостов для соединения с ZooKeeper.</li> <li>Исправлено отключение отстающей реплики при распределённых запросах, если реплика является localhost.</li> <li>Исправлена ошибка, в связи с которой кусок данных таблицы типа <code>ReplicatedMergeTree</code> мог становиться битым после выполнения <code>ALTER MODIFY</code> элемента <code>Nested</code> структуры.</li> <li>Исправлена ошибка приводящая к возможному зависанию SELECT запросов.</li> <li>Доработки распределённых DDL запросов.</li> <li>Исправлен запрос <code>CREATE TABLE ... AS &lt;materialized view&gt;</code>.</li> <li>Исправлен дедлок при запросе <code>ALTER ... CLEAR COLUMN IN PARTITION</code> для <code>Buffer</code> таблиц.</li> <li>Исправлено использование неправильного значения по-умолчанию для <code>Enum</code>-ов (0 вместо минимального) при использовании форматов <code>JSONEachRow</code> и <code>TSKV</code>.</li> <li>Исправлено появление zombie процессов при работе со словарём с источником <code>executable</code>.</li> <li>Исправлен segfault при запросе HEAD.</li> </ul> <h3 id=uluchsheniia-protsessa-razrabotki-i-sborki-clickhouse>Улучшения процесса разработки и сборки ClickHouse:<a class=headerlink href=#uluchsheniia-protsessa-razrabotki-i-sborki-clickhouse title="Permanent link">&para;</a></h3> <ul> <li>Возможность сборки с помощью <code>pbuilder</code>.</li> <li>Возможность сборки с использованием <code>libc++</code> вместо <code>libstdc++</code> под Linux.</li> <li>Добавлены инструкции для использования статических анализаторов кода <code>Coverity</code>, <code>clang-tidy</code>, <code>cppcheck</code>.</li> </ul> <h3 id=na-chto-obratit-vnimanie-pri-obnovlenii_1>На что обратить внимание при обновлении:<a class=headerlink href=#na-chto-obratit-vnimanie-pri-obnovlenii_1 title="Permanent link">&para;</a></h3> <ul> <li>Увеличено значение по-умолчанию для настройки MergeTree <code>max_bytes_to_merge_at_max_space_in_pool</code> (максимальный суммарный размер кусков в байтах для мержа) со 100 GiB до 150 GiB. Это может привести к запуску больших мержей после обновления сервера, что может вызвать повышенную нагрузку на дисковую подсистему. Если же на серверах, где это происходит, количество свободного места менее чем в два раза больше суммарного объёма выполняющихся мержей, то в связи с этим перестанут выполняться какие-либо другие мержи, включая мержи мелких кусков. Это приведёт к тому, что INSERT-ы будут отклоняться с сообщением "Merges are processing significantly slower than inserts". Для наблюдения, используйте запрос <code>SELECT * FROM system.merges</code>. Вы также можете смотреть на метрику <code>DiskSpaceReservedForMerge</code> в таблице <code>system.metrics</code> или в Graphite. Для исправления этой ситуации можно ничего не делать, так как она нормализуется сама после завершения больших мержей. Если же вас это не устраивает, вы можете вернуть настройку <code>max_bytes_to_merge_at_max_space_in_pool</code> в старое значение, прописав в config.xml в секции <code>&lt;merge_tree&gt;</code> <code>&lt;max_bytes_to_merge_at_max_space_in_pool&gt;107374182400&lt;/max_bytes_to_merge_at_max_space_in_pool&gt;</code> и перезапустить сервер.</li> </ul> <h2 id=reliz-clickhouse-1-1-54284-2017-08-29>Релиз ClickHouse 1.1.54284, 2017-08-29<a class=headerlink href=#reliz-clickhouse-1-1-54284-2017-08-29 title="Permanent link">&para;</a></h2> <ul> <li>Релиз содержит изменения к предыдущему релизу 1.1.54282, которые исправляют утечку записей о кусках в ZooKeeper</li> </ul> <h2 id=reliz-clickhouse-1-1-54282-2017-08-23>Релиз ClickHouse 1.1.54282, 2017-08-23<a class=headerlink href=#reliz-clickhouse-1-1-54282-2017-08-23 title="Permanent link">&para;</a></h2> <p>Релиз содержит исправления к предыдущему релизу 1.1.54276: * Исправлена ошибка <code>DB::Exception: Assertion violation: !_path.empty()</code> при вставке в Distributed таблицу. * Исправлен парсинг при вставке в формате RowBinary, если входные данные начинаются с ';'. * Исправлена ошибка при рантайм-компиляции некоторых агрегатных функций (например, <code>groupArray()</code>).</p> <h2 id=reliz-clickhouse-1-1-54276-2017-08-16>Релиз ClickHouse 1.1.54276, 2017-08-16<a class=headerlink href=#reliz-clickhouse-1-1-54276-2017-08-16 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_30>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_30 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена опциональная секция WITH запроса SELECT. Пример запроса: <code>WITH 1+1 AS a SELECT a, a*a</code></li> <li>Добавлена возможность синхронной вставки в Distributed таблицу: выдается Ok только после того как все данные записались на все шарды. Активируется настройкой insert_distributed_sync=1</li> <li>Добавлен тип данных UUID для работы с 16-байтовыми идентификаторами</li> <li>Добавлены алиасы типов CHAR, FLOAT и т.д. для совместимости с Tableau</li> <li>Добавлены функции toYYYYMM, toYYYYMMDD, toYYYYMMDDhhmmss для перевода времени в числа</li> <li>Добавлена возможность использовать IP адреса (совместно с hostname) для идентификации сервера при работе с кластерными DDL запросами</li> <li>Добавлена поддержка неконстантных аргументов и отрицательных смещений в функции <code>substring(str, pos, len)</code></li> <li>Добавлен параметр max_size для агрегатной функции <code>groupArray(max_size)(column)</code>, и оптимизирована её производительность</li> </ul> <h3 id=osnovnye-izmeneniia>Основные изменения:<a class=headerlink href=#osnovnye-izmeneniia title="Permanent link">&para;</a></h3> <ul> <li>Улучшение безопасности: все файлы сервера создаются с правами 0640 (можно поменять, через параметр <umask> в конфиге).</li> <li>Улучшены сообщения об ошибках в случае синтаксически неверных запросов</li> <li>Значительно уменьшен расход оперативной памяти и улучшена производительность слияний больших MergeTree-кусков данных</li> <li>Значительно увеличена производительность слияний данных для движка ReplacingMergeTree</li> <li>Улучшена производительность асинхронных вставок из Distributed таблицы за счет объединения нескольких исходных вставок. Функциональность включается настройкой distributed_directory_monitor_batch_inserts=1.</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_17>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_17 title="Permanent link">&para;</a></h3> <ul> <li>Изменился бинарный формат агрегатных состояний функции <code>groupArray(array_column)</code> для массивов</li> </ul> <h3 id=polnyi-spisok-izmenenii>Полный список изменений:<a class=headerlink href=#polnyi-spisok-izmenenii title="Permanent link">&para;</a></h3> <ul> <li>Добавлена настройка <code>output_format_json_quote_denormals</code>, включающая вывод nan и inf значений в формате JSON</li> <li>Более оптимальное выделение потоков при чтении из Distributed таблиц</li> <li>Разрешено задавать настройки в режиме readonly, если их значение не изменяется</li> <li>Добавлена возможность считывать нецелые гранулы движка MergeTree для выполнения ограничений на размер блока, задаваемый настройкой preferred_block_size_bytes - для уменьшения потребления оперативной памяти и увеличения кэш-локальности при обработке запросов из таблиц со столбцами большого размера</li> <li>Эффективное использование индекса, содержащего выражения типа <code>toStartOfHour(x)</code>, для условий вида <code>toStartOfHour(x) op сonstexpr</code></li> <li>Добавлены новые настройки для MergeTree движков (секция merge_tree в config.xml):</li> <li>replicated_deduplication_window_seconds позволяет задать интервал дедупликации вставок в Replicated-таблицы в секундах</li> <li>cleanup_delay_period - периодичность запуска очистки неактуальных данных</li> <li>replicated_can_become_leader - запретить реплике становиться лидером (и назначать мержи)</li> <li>Ускорена очистка неактуальных данных из ZooKeeper</li> <li>Множественные улучшения и исправления работы кластерных DDL запросов. В частности, добавлена настройка distributed_ddl_task_timeout, ограничивающая время ожидания ответов серверов кластера. Если запрос не успел выполниться на всех нодах в установленное время, ответ будет содержать timeout ошибку и дальнейшее выполнение этого запроса будет происходить в асинхронном режиме</li> <li>Улучшено отображение стэктрейсов в логах сервера</li> <li>Добавлен метод сжатия none</li> <li>Возможность использования нескольких секций dictionaries_config в config.xml</li> <li>Возможность подключения к MySQL через сокет на файловой системе</li> <li>В таблицу system.parts добавлен столбец с информацией о размере marks в байтах</li> </ul> <h3 id=ispravleniia-bagov>Исправления багов:<a class=headerlink href=#ispravleniia-bagov title="Permanent link">&para;</a></h3> <ul> <li>Исправлена некорректная работа Distributed таблиц, использующих Merge таблицы, при SELECT с условием на поле _table</li> <li>Исправлен редкий race condition в ReplicatedMergeTree при проверке кусков данных</li> <li>Исправлено возможное зависание процедуры leader election при старте сервера</li> <li>Исправлено игнорирование настройки max_replica_delay_for_distributed_queries при использовании локальной реплики в качестве источника данных</li> <li>Исправлено некорректное поведение <code>ALTER TABLE CLEAR COLUMN IN PARTITION</code> при попытке очистить несуществующую колонку</li> <li>Исправлено исключение в функции multiIf при использовании пустых массивов или строк</li> <li>Исправлено чрезмерное выделение памяти при десериализации формата Native</li> <li>Исправлено некорректное автообновление Trie словарей</li> <li>Исправлено исключение при выполнении запросов с GROUP BY из Merge-таблицы при использовании SAMPLE</li> <li>Исправлено падение GROUP BY при использовании настройки distributed_aggregation_memory_efficient=1</li> <li>Добавлена возможность указывать database.table в правой части IN и JOIN</li> <li>Исправлено использование слишком большого количества потоков при параллельной агрегации</li> <li>Исправлена работа функции if с аргументами FixedString</li> <li>Исправлена некорректная работа SELECT из Distributed-таблицы для шардов с весом 0</li> <li>Исправлено падение запроса <code>CREATE VIEW IF EXISTS</code></li> <li>Исправлено некорректное поведение при input_format_skip_unknown_fields=1 в случае отрицательных чисел</li> <li>Исправлен бесконечный цикл в функции <code>dictGetHierarchy()</code> в случае некоторых некорректных данных словаря</li> <li>Исправлены ошибки типа <code>Syntax error: unexpected (...)</code> при выполнении распределенных запросов с подзапросами в секции IN или JOIN, в случае использования совместно с Merge таблицами</li> <li>Исправлена неправильная интерпретация SELECT запроса из таблиц типа Dictionary</li> <li>Исправлена ошибка "Cannot mremap" при использовании множеств в секциях IN, JOIN, содержащих более 2 млрд. элементов</li> <li>Исправлен failover для словарей с источником MySQL</li> </ul> <h3 id=uluchsheniia-protsessa-razrabotki-i-sborki-clickhouse_1>Улучшения процесса разработки и сборки ClickHouse:<a class=headerlink href=#uluchsheniia-protsessa-razrabotki-i-sborki-clickhouse_1 title="Permanent link">&para;</a></h3> <ul> <li>Добавлена возмозможность сборки в Arcadia</li> <li>Добавлена возможность сборки с помощью gcc 7</li> <li>Ускорена параллельная сборка с помощью ccache+distcc</li> </ul> <h2 id=reliz-clickhouse-1-1-54245-2017-07-04>Релиз ClickHouse 1.1.54245, 2017-07-04<a class=headerlink href=#reliz-clickhouse-1-1-54245-2017-07-04 title="Permanent link">&para;</a></h2> <h3 id=novye-vozmozhnosti_31>Новые возможности:<a class=headerlink href=#novye-vozmozhnosti_31 title="Permanent link">&para;</a></h3> <ul> <li>Распределённые DDL (например, <code>CREATE TABLE ON CLUSTER</code>)</li> <li>Реплицируемый запрос <code>ALTER TABLE CLEAR COLUMN IN PARTITION</code></li> <li>Движок таблиц Dictionary (доступ к данным словаря в виде таблицы)</li> <li>Движок баз данных Dictionary (в такой базе автоматически доступны Dictionary-таблицы для всех подключённых внешних словарей)</li> <li>Возможность проверки необходимости обновления словаря путём отправки запроса в источник</li> <li>Qualified имена столбцов</li> <li>Квотирование идентификаторов двойными кавычками</li> <li>Сессии в HTTP интерфейсе</li> <li>Запрос OPTIMIZE для Replicated таблицы теперь можно выполнять не только на лидере</li> </ul> <h3 id=obratno-nesovmestimye-izmeneniia_18>Обратно несовместимые изменения:<a class=headerlink href=#obratno-nesovmestimye-izmeneniia_18 title="Permanent link">&para;</a></h3> <ul> <li>Убрана команда SET GLOBAL</li> </ul> <h3 id=melkie-izmeneniia>Мелкие изменения:<a class=headerlink href=#melkie-izmeneniia title="Permanent link">&para;</a></h3> <ul> <li>Теперь после получения сигнала в лог печатается полный стектрейс</li> <li>Ослаблена проверка на количество повреждённых/лишних кусков при старте (было слишком много ложных срабатываний)</li> </ul> <h3 id=ispravleniia-bagov_1>Исправления багов:<a class=headerlink href=#ispravleniia-bagov_1 title="Permanent link">&para;</a></h3> <ul> <li>Исправлено залипание плохого соединения при вставке в Distributed таблицу</li> <li>GLOBAL IN теперь работает при запросе из таблицы Merge, смотрящей в Distributed</li> <li>Теперь правильно определяется количество ядер на виртуалках Google Compute Engine</li> <li>Исправления в работе executable источника кэшируемых внешних словарей</li> <li>Исправлены сравнения строк, содержащих нулевые символы</li> <li>Исправлено сравнение полей первичного ключа типа Float32 с константами</li> <li>Раньше неправильная оценка размера поля могла приводить к слишком большим аллокациям</li> <li>Исправлено падение при запросе Nullable столбца, добавленного в таблицу ALTER-ом</li> <li>Исправлено падение при сортировке по Nullable столбцу, если количество строк меньше LIMIT</li> <li>Исправлен ORDER BY подзапроса, состоящего только из константных значений</li> <li>Раньше Replicated таблица могла остаться в невалидном состоянии после неудавшегося DROP TABLE</li> <li>Алиасы для скалярных подзапросов с пустым результатом теперь не теряются</li> <li>Теперь запрос, в котором использовалась компиляция, не завершается ошибкой, если .so файл повреждается</li> </ul> </div> <div id=content-footer class="text-muted pt-5"> <div class=float-right>©2016–2020 Yandex LLC</div> <div>ساخته شده از <a href=https://github.com/ClickHouse/ClickHouse/commit/d6653f1fdcabbf1f588ee132a5044c31df63261a rel="external nofollow noreferrer" target=_blank class=text-reset>d6653f1fdc</a></div> </div> </div> <div id=toc class="col-xl-2 d-none d-xl-block d-print-none p-3 overflow-auto toc-right mb-5"> <nav class="nav flex-column text-wrap"> <label for=toc>جدول محتویات</label> <a href=#clickhouse-release-19-9-4-1-2019-07-05 title="ClickHouse release 19.9.4.1, 2019-07-05" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.9.4.1, 2019-07-05 </a> <nav id=toc-toc-1 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> </nav> <a href=#clickhouse-release-19-7-6-1-2019-07-05 title="ClickHouse release 19.7.6.1, 2019-07-05" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.7.6.1, 2019-07-05 </a> <nav id=toc-toc-2 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_1 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> </nav> <a href=#clickhouse-release-19-8-3-8-2019-06-11 title="ClickHouse release 19.8.3.8, 2019-06-11" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.8.3.8, 2019-06-11 </a> <nav id=toc-toc-3 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti title="Новые возможности" class="nav-link text-wrap d-inline-block w-100"> Новые возможности </a> <a href=#uluchsheniia title=Улучшения class="nav-link text-wrap d-inline-block w-100"> Улучшения </a> <a href=#uluchsheniia-proizvoditelnosti title="Улучшения производительности" class="nav-link text-wrap d-inline-block w-100"> Улучшения производительности </a> <a href=#ispravleniia-oshibok_2 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> <a href=#uluchsheniia-sborki-testirovaniia-i-paketirovaniia title="Улучшения сборки, тестирования и пакетирования" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки, тестирования и пакетирования </a> </nav> <a href=#clickhouse-release-19-7-5-27-2019-06-09 title="ClickHouse release 19.7.5.27, 2019-06-09" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.7.5.27, 2019-06-09 </a> <nav id=toc-toc-4 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_1 title="Новые возможности" class="nav-link text-wrap d-inline-block w-100"> Новые возможности </a> <a href=#ispravleniia-oshibok_3 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> </nav> <a href=#clickhouse-release-19-7-3-9-2019-05-30 title="ClickHouse release 19.7.3.9, 2019-05-30" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.7.3.9, 2019-05-30 </a> <nav id=toc-toc-5 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_2 title="Новые возможности" class="nav-link text-wrap d-inline-block w-100"> Новые возможности </a> <a href=#ispravleniia-oshibok_4 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> <a href=#uluchsheniia-proizvoditelnosti_1 title="Улучшения производительности" class="nav-link text-wrap d-inline-block w-100"> Улучшения производительности </a> <a href=#dokumentatsiia title=Документация class="nav-link text-wrap d-inline-block w-100"> Документация </a> <a href=#uluchsheniia-sborki-testirovaniia-i-paketirovaniia_1 title="Улучшения сборки, тестирования и пакетирования" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки, тестирования и пакетирования </a> </nav> <a href=#clickhouse-release-19-6-3-18-2019-06-13 title="ClickHouse release 19.6.3.18, 2019-06-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.6.3.18, 2019-06-13 </a> <nav id=toc-toc-6 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_5 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> </nav> <a href=#clickhouse-release-19-6-2-11-2019-05-13 title="ClickHouse release 19.6.2.11, 2019-05-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.6.2.11, 2019-05-13 </a> <nav id=toc-toc-7 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_3 title="Новые возможности" class="nav-link text-wrap d-inline-block w-100"> Новые возможности </a> <a href=#eksperimentalnye-vozmozhnosti title="Экспериментальные возможности" class="nav-link text-wrap d-inline-block w-100"> Экспериментальные возможности </a> <a href=#uluchsheniia_1 title=Улучшения class="nav-link text-wrap d-inline-block w-100"> Улучшения </a> <a href=#uluchshenie-proizvoditelnosti title="Улучшение производительности" class="nav-link text-wrap d-inline-block w-100"> Улучшение производительности </a> <a href=#obratno-nesovmestimye-izmeneniia title="Обратно несовместимые изменения" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения </a> <a href=#ispravleniia-oshibok_6 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> <a href=#uluchsheniia-sborki-testirovaniia-paketirovaniia title="Улучшения сборки/тестирования/пакетирования" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки/тестирования/пакетирования </a> </nav> <a href=#clickhouse-release-19-5-4-22-2019-05-13 title="ClickHouse release 19.5.4.22, 2019-05-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.5.4.22, 2019-05-13 </a> <nav id=toc-toc-8 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_7 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> </nav> <a href=#clickhouse-release-19-5-3-8-2019-04-18 title="ClickHouse release 19.5.3.8, 2019-04-18" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.5.3.8, 2019-04-18 </a> <nav id=toc-toc-9 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_8 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> </nav> <a href=#clickhouse-release-19-5-2-6-2019-04-15 title="ClickHouse release 19.5.2.6, 2019-04-15" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.5.2.6, 2019-04-15 </a> <nav id=toc-toc-10 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_4 title="Новые возможности" class="nav-link text-wrap d-inline-block w-100"> Новые возможности </a> <a href=#uluchsheniia_2 title=Улучшения class="nav-link text-wrap d-inline-block w-100"> Улучшения </a> <a href=#ispravleniia-oshibok_9 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> <a href=#obratno-nesovmestimye-izmeneniia_1 title="Обратно несовместимые изменения" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения </a> <a href=#uluchshenie-proizvoditelnosti_1 title="Улучшение производительности" class="nav-link text-wrap d-inline-block w-100"> Улучшение производительности </a> <a href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_1 title="Улучшения сборки/тестирования/пакетирования" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки/тестирования/пакетирования </a> </nav> <a href=#clickhouse-release-19-4-4-33-2019-04-17 title="ClickHouse release 19.4.4.33, 2019-04-17" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.4.4.33, 2019-04-17 </a> <nav id=toc-toc-11 class="nav flex-column pl-2"> <a href=#ispravlenie-oshibok title="Исправление ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок </a> <a href=#uluchsheniia_3 title=Улучшения class="nav-link text-wrap d-inline-block w-100"> Улучшения </a> </nav> <a href=#clickhouse-release-19-4-3-11-2019-04-02 title="ClickHouse release 19.4.3.11, 2019-04-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.4.3.11, 2019-04-02 </a> <nav id=toc-toc-12 class="nav flex-column pl-2"> <a href=#ispravlenie-oshibok_1 title="Исправление ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок </a> <a href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_2 title="Улучшения сборки/тестирования/пакетирования" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки/тестирования/пакетирования </a> </nav> <a href=#clickhouse-release-19-4-2-7-2019-03-30 title="ClickHouse release 19.4.2.7, 2019-03-30" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.4.2.7, 2019-03-30 </a> <nav id=toc-toc-13 class="nav flex-column pl-2"> <a href=#ispravlenie-oshibok_2 title="Исправление ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок </a> </nav> <a href=#clickhouse-release-19-4-1-3-2019-03-19 title="ClickHouse release 19.4.1.3, 2019-03-19" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.4.1.3, 2019-03-19 </a> <nav id=toc-toc-14 class="nav flex-column pl-2"> <a href=#ispravlenie-oshibok_3 title="Исправление ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок </a> </nav> <a href=#clickhouse-release-19-4-0-49-2019-03-09 title="ClickHouse release 19.4.0.49, 2019-03-09" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.4.0.49, 2019-03-09 </a> <nav id=toc-toc-15 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_5 title="Новые возможности" class="nav-link text-wrap d-inline-block w-100"> Новые возможности </a> <a href=#ispravleniia-oshibok_10 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> <a href=#uluchsheniia_4 title=Улучшения class="nav-link text-wrap d-inline-block w-100"> Улучшения </a> <a href=#uluchsheniia-proizvoditelnosti_2 title="Улучшения производительности" class="nav-link text-wrap d-inline-block w-100"> Улучшения производительности </a> <a href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_3 title="Улучшения сборки/тестирования/пакетирования" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки/тестирования/пакетирования </a> </nav> <a href=#clickhouse-release-19-3-7-2019-03-12 title="ClickHouse release 19.3.7, 2019-03-12" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.7, 2019-03-12 </a> <nav id=toc-toc-16 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_11 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> </nav> <a href=#clickhouse-release-19-3-6-2019-03-02 title="ClickHouse release 19.3.6, 2019-03-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.6, 2019-03-02 </a> <nav id=toc-toc-17 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_12 title="Исправления ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок </a> <a href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_4 title="Улучшения сборки/тестирования/пакетирования" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки/тестирования/пакетирования </a> </nav> <a href=#clickhouse-release-19-3-5-2019-02-21 title="ClickHouse release 19.3.5, 2019-02-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.5, 2019-02-21 </a> <nav id=toc-toc-18 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_13 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> </nav> <a href=#clickhouse-release-19-3-4-2019-02-16 title="ClickHouse release 19.3.4, 2019-02-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.4, 2019-02-16 </a> <nav id=toc-toc-19 class="nav flex-column pl-2"> <a href=#uluchsheniia_5 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravleniia-oshibok_14 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_5 title="Улучшения сборки/тестирования/пакетирования:" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки/тестирования/пакетирования: </a> </nav> <a href=#clickhouse-release-19-3-3-2019-02-13 title="ClickHouse release 19.3.3, 2019-02-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.3, 2019-02-13 </a> <nav id=toc-toc-20 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_6 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#eksperimentalnye-vozmozhnosti_1 title="Экспериментальные возможности:" class="nav-link text-wrap d-inline-block w-100"> Экспериментальные возможности: </a> <a href=#ispravleniia-oshibok_15 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_6 title="Улучшения сборки/тестирования/пакетирования:" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки/тестирования/пакетирования: </a> <a href=#obratno-nesovmestimye-izmeneniia_2 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> <a href=#uluchsheniia-proizvoditelnosti_3 title="Улучшения производительности:" class="nav-link text-wrap d-inline-block w-100"> Улучшения производительности: </a> <a href=#uluchsheniia_6 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> </nav> <a href=#clickhouse-release-19-1-14-2019-03-14 title="ClickHouse release 19.1.14, 2019-03-14" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.14, 2019-03-14 </a> <a href=#clickhouse-release-19-1-13-2019-03-12 title="ClickHouse release 19.1.13, 2019-03-12" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.13, 2019-03-12 </a> <a href=#clickhouse-release-19-1-10-2019-03-03 title="ClickHouse release 19.1.10, 2019-03-03" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.10, 2019-03-03 </a> <a href=#clickhouse-release-19-1-9-2019-02-21 title="ClickHouse release 19.1.9, 2019-02-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.9, 2019-02-21 </a> <nav id=toc-toc-24 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_16 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> </nav> <a href=#clickhouse-release-19-1-8-2019-02-16 title="ClickHouse release 19.1.8, 2019-02-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.8, 2019-02-16 </a> <nav id=toc-toc-25 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_17 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> </nav> <a href=#clickhouse-release-19-1-7-2019-02-15 title="ClickHouse release 19.1.7, 2019-02-15" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.7, 2019-02-15 </a> <nav id=toc-toc-26 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_18 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> </nav> <a href=#clickhouse-release-19-1-6-2019-01-24 title="ClickHouse release 19.1.6, 2019-01-24" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.6, 2019-01-24 </a> <nav id=toc-toc-27 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_7 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#eksperimentalnye-vozmozhnosti_2 title="Экспериментальные возможности:" class="nav-link text-wrap d-inline-block w-100"> Экспериментальные возможности: </a> <a href=#ispravleniia-oshibok_19 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia_7 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#uluchsheniia-proizvoditelnosti_4 title="Улучшения производительности:" class="nav-link text-wrap d-inline-block w-100"> Улучшения производительности: </a> <a href=#obratno-nesovmestimye-izmeneniia_3 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> <a href=#uluchsheniia-sborki-testirovaniia-paketirovaniia_7 title="Улучшения сборки/тестирования/пакетирования:" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки/тестирования/пакетирования: </a> </nav> <a href=#clickhouse-release-18-16-1-2018-12-21 title="ClickHouse release 18.16.1, 2018-12-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.16.1, 2018-12-21 </a> <nav id=toc-toc-28 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_20 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia_8 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#uluchsheniia-sborki title="Улучшения сборки:" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки: </a> </nav> <a href=#clickhouse-release-18-16-0-2018-12-14 title="ClickHouse release 18.16.0, 2018-12-14" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.16.0, 2018-12-14 </a> <nav id=toc-toc-29 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_8 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#ispravleniia-oshibok_21 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia_9 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#uluchshenie-sborki title="Улучшение сборки:" class="nav-link text-wrap d-inline-block w-100"> Улучшение сборки: </a> <a href=#obratno-nesovmestimye-izmeneniia_4 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> </nav> <a href=#clickhouse-release-18-14-19-2018-12-19 title="ClickHouse release 18.14.19, 2018-12-19" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.19, 2018-12-19 </a> <nav id=toc-toc-30 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_22 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia-sborki_1 title="Улучшения сборки:" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки: </a> </nav> <a href=#clickhouse-release-18-14-18-2018-12-04 title="ClickHouse release 18.14.18, 2018-12-04" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.18, 2018-12-04 </a> <nav id=toc-toc-31 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_23 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia-protsessa-sborki-clickhouse title="Улучшения процесса сборки ClickHouse:" class="nav-link text-wrap d-inline-block w-100"> Улучшения процесса сборки ClickHouse: </a> </nav> <a href=#clickhouse-release-18-14-17-2018-11-30 title="ClickHouse release 18.14.17, 2018-11-30" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.17, 2018-11-30 </a> <nav id=toc-toc-32 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_24 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> </nav> <a href=#clickhouse-release-18-14-15-2018-11-21 title="ClickHouse release 18.14.15, 2018-11-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.15, 2018-11-21 </a> <nav id=toc-toc-33 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_25 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> </nav> <a href=#clickhouse-release-18-14-14-2018-11-20 title="ClickHouse release 18.14.14, 2018-11-20" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.14, 2018-11-20 </a> <nav id=toc-toc-34 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_26 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia-protsessa-sborki-clickhouse_1 title="Улучшения процесса сборки ClickHouse:" class="nav-link text-wrap d-inline-block w-100"> Улучшения процесса сборки ClickHouse: </a> </nav> <a href=#clickhouse-release-18-14-13-2018-11-08 title="ClickHouse release 18.14.13, 2018-11-08" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.13, 2018-11-08 </a> <nav id=toc-toc-35 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_27 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia-proizvoditelnosti_5 title="Улучшения производительности:" class="nav-link text-wrap d-inline-block w-100"> Улучшения производительности: </a> <a href=#uluchsheniia-protsessa-sborki-clickhouse_2 title="Улучшения процесса сборки ClickHouse:" class="nav-link text-wrap d-inline-block w-100"> Улучшения процесса сборки ClickHouse: </a> </nav> <a href=#clickhouse-release-18-14-12-2018-11-02 title="ClickHouse release 18.14.12, 2018-11-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.12, 2018-11-02 </a> <nav id=toc-toc-36 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_28 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> </nav> <a href=#clickhouse-release-18-14-11-2018-10-29 title="ClickHouse release 18.14.11, 2018-10-29" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.11, 2018-10-29 </a> <nav id=toc-toc-37 class="nav flex-column pl-2"> <a href=#ispravleniia-oshibok_29 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> </nav> <a href=#clickhouse-release-18-14-10-2018-10-23 title="ClickHouse release 18.14.10, 2018-10-23" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.10, 2018-10-23 </a> <a href=#clickhouse-release-18-14-9-2018-10-16 title="ClickHouse release 18.14.9, 2018-10-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.9, 2018-10-16 </a> <nav id=toc-toc-39 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_9 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#eksperimentalnye-vozmozhnosti_3 title="Экспериментальные возможности:" class="nav-link text-wrap d-inline-block w-100"> Экспериментальные возможности: </a> <a href=#uluchsheniia_10 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_4 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#obratno-nesovmestimye-izmeneniia_5 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> </nav> <a href=#clickhouse-release-18-12-17-2018-09-16 title="ClickHouse release 18.12.17, 2018-09-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.12.17, 2018-09-16 </a> <nav id=toc-toc-40 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_10 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#ispravlenie-oshibok_5 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#obratno-nesovmestimye-izmeneniia_6 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> </nav> <a href=#clickhouse-release-18-12-14-2018-09-13 title="ClickHouse release 18.12.14, 2018-09-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.12.14, 2018-09-13 </a> <nav id=toc-toc-41 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_11 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_11 title=Улучшения class="nav-link text-wrap d-inline-block w-100"> Улучшения </a> <a href=#ispravlenie-oshibok_6 title="Исправление ошибок" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок </a> </nav> <a href=#clickhouse-release-18-12-13-2018-09-10 title="ClickHouse release 18.12.13, 2018-09-10" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.12.13, 2018-09-10 </a> <nav id=toc-toc-42 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_12 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#eksperimentalnye-vozmozhnosti_4 title="Экспериментальные возможности:" class="nav-link text-wrap d-inline-block w-100"> Экспериментальные возможности: </a> <a href=#uluchsheniia_12 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_7 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#ispravleniia-bezopasnosti title="Исправления безопасности:" class="nav-link text-wrap d-inline-block w-100"> Исправления безопасности: </a> <a href=#obratno-nesovmestimye-izmeneniia_7 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> <a href=#izmeneniia-sborki title="Изменения сборки:" class="nav-link text-wrap d-inline-block w-100"> Изменения сборки: </a> </nav> <a href=#clickhouse-release-18-10-3-2018-08-13 title="ClickHouse release 18.10.3, 2018-08-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.10.3, 2018-08-13 </a> <nav id=toc-toc-43 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_13 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_13 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_8 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#obratno-nesovmestimye-izmeneniia_8 title="Обратно несовместимые изменения" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения </a> <a href=#izmeneniia-sborki_1 title="Изменения сборки:" class="nav-link text-wrap d-inline-block w-100"> Изменения сборки: </a> </nav> <a href=#clickhouse-release-18-6-0-2018-08-02 title="ClickHouse release 18.6.0, 2018-08-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.6.0, 2018-08-02 </a> <nav id=toc-toc-44 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_14 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_14 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> </nav> <a href=#clickhouse-release-18-5-1-2018-07-31 title="ClickHouse release 18.5.1, 2018-07-31" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.5.1, 2018-07-31 </a> <nav id=toc-toc-45 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_15 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_15 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_9 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> </nav> <a href=#clickhouse-release-18-4-0-2018-07-28 title="ClickHouse release 18.4.0, 2018-07-28" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.4.0, 2018-07-28 </a> <nav id=toc-toc-46 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_16 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_16 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_10 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#obratno-nesovmestimye-izmeneniia_9 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> </nav> <a href=#clickhouse-release-18-1-0-2018-07-23 title="ClickHouse release 18.1.0, 2018-07-23" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.1.0, 2018-07-23 </a> <nav id=toc-toc-47 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_17 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_17 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_11 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#obratno-nesovmestimye-izmeneniia_10 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> </nav> <a href=#clickhouse-release-1-1-54394-2018-07-12 title="ClickHouse release 1.1.54394, 2018-07-12" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54394, 2018-07-12 </a> <nav id=toc-toc-48 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_18 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#ispravlenie-oshibok_12 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> </nav> <a href=#clickhouse-release-1-1-54390-2018-07-06 title="ClickHouse release 1.1.54390, 2018-07-06" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54390, 2018-07-06 </a> <nav id=toc-toc-49 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_19 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_18 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_13 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#ispravleniia-bezopasnosti_1 title="Исправления безопасности:" class="nav-link text-wrap d-inline-block w-100"> Исправления безопасности: </a> </nav> <a href=#clickhouse-release-1-1-54388-2018-06-28 title="ClickHouse release 1.1.54388, 2018-06-28" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54388, 2018-06-28 </a> <nav id=toc-toc-50 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_20 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#eksperimentalnye-vozmozhnosti_5 title="Экспериментальные возможности:" class="nav-link text-wrap d-inline-block w-100"> Экспериментальные возможности: </a> <a href=#ispravlenie-oshibok_14 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#uluchsheniia_19 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#izmeneniia-sborki_2 title="Изменения сборки:" class="nav-link text-wrap d-inline-block w-100"> Изменения сборки: </a> <a href=#obratno-nesovmestimye-izmeneniia_11 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> </nav> <a href=#clickhouse-release-1-1-54385-2018-06-01 title="ClickHouse release 1.1.54385, 2018-06-01" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54385, 2018-06-01 </a> <nav id=toc-toc-51 class="nav flex-column pl-2"> <a href=#ispravlenie-oshibok_15 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> </nav> <a href=#clickhouse-release-1-1-54383-2018-05-22 title="ClickHouse release 1.1.54383, 2018-05-22" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54383, 2018-05-22 </a> <nav id=toc-toc-52 class="nav flex-column pl-2"> <a href=#ispravlenie-oshibok_16 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> </nav> <a href=#clickhouse-release-1-1-54381-2018-05-14 title="ClickHouse release 1.1.54381, 2018-05-14" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54381, 2018-05-14 </a> <nav id=toc-toc-53 class="nav flex-column pl-2"> <a href=#ispravlenie-oshibok_17 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> </nav> <a href=#clickhouse-release-1-1-54380-2018-04-21 title="ClickHouse release 1.1.54380, 2018-04-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54380, 2018-04-21 </a> <nav id=toc-toc-54 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_21 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_20 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_18 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#obratno-nesovmestimye-izmeneniia_12 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> </nav> <a href=#clickhouse-release-1-1-54378-2018-04-16 title="ClickHouse release 1.1.54378, 2018-04-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54378, 2018-04-16 </a> <nav id=toc-toc-55 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_22 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_21 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_19 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#izmeneniia-sborki_3 title="Изменения сборки:" class="nav-link text-wrap d-inline-block w-100"> Изменения сборки: </a> <a href=#obratno-nesovmestimye-izmeneniia_13 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> </nav> <a href=#clickhouse-release-1-1-54370-2018-03-16 title="ClickHouse release 1.1.54370, 2018-03-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54370, 2018-03-16 </a> <nav id=toc-toc-56 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_23 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_22 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_20 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> </nav> <a href=#reliz-clickhouse-1-1-54362-2018-03-11 title="Релиз ClickHouse 1.1.54362, 2018-03-11" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54362, 2018-03-11 </a> <nav id=toc-toc-57 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_24 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uluchsheniia_23 title=Улучшения: class="nav-link text-wrap d-inline-block w-100"> Улучшения: </a> <a href=#ispravlenie-oshibok_21 title="Исправление ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправление ошибок: </a> <a href=#obratno-nesovmestimye-izmeneniia_14 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> </nav> <a href=#reliz-clickhouse-1-1-54343-2018-02-05 title="Релиз ClickHouse 1.1.54343, 2018-02-05" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54343, 2018-02-05 </a> <a href=#reliz-clickhouse-1-1-54342-2018-01-22 title="Релиз ClickHouse 1.1.54342, 2018-01-22" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54342, 2018-01-22 </a> <a href=#reliz-clickhouse-1-1-54337-2018-01-18 title="Релиз ClickHouse 1.1.54337, 2018-01-18" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54337, 2018-01-18 </a> <nav id=toc-toc-60 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_25 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#uvelichenie-proizvoditelnosti title="Увеличение производительности:" class="nav-link text-wrap d-inline-block w-100"> Увеличение производительности: </a> <a href=#ispravleniia-oshibok_30 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia-sborki_2 title="Улучшения сборки:" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки: </a> <a href=#obratno-nesovmestimye-izmeneniia_15 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> <a href=#na-chto-obratit-vnimanie-pri-obnovlenii title="На что обратить внимание при обновлении:" class="nav-link text-wrap d-inline-block w-100"> На что обратить внимание при обновлении: </a> </nav> <a href=#reliz-clickhouse-1-1-54327-2017-12-21 title="Релиз ClickHouse 1.1.54327, 2017-12-21" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54327, 2017-12-21 </a> <a href=#reliz-clickhouse-1-1-54318-2017-11-30 title="Релиз ClickHouse 1.1.54318, 2017-11-30" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54318, 2017-11-30 </a> <a href=#reliz-clickhouse-1-1-54310-2017-11-01 title="Релиз ClickHouse 1.1.54310, 2017-11-01" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54310, 2017-11-01 </a> <nav id=toc-toc-63 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_26 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#obratno-nesovmestimye-izmeneniia_16 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> <a href=#ispravleniia-oshibok_31 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia-sborki_3 title="Улучшения сборки:" class="nav-link text-wrap d-inline-block w-100"> Улучшения сборки: </a> </nav> <a href=#reliz-clickhouse-1-1-54304-2017-10-19 title="Релиз ClickHouse 1.1.54304, 2017-10-19" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54304, 2017-10-19 </a> <nav id=toc-toc-64 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_27 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#ispravleniia-oshibok_32 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> </nav> <a href=#reliz-clickhouse-1-1-54292-2017-09-20 title="Релиз ClickHouse 1.1.54292, 2017-09-20" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54292, 2017-09-20 </a> <nav id=toc-toc-65 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_28 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#ispravleniia-oshibok_33 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> </nav> <a href=#reliz-clickhouse-1-1-54289-2017-09-13 title="Релиз ClickHouse 1.1.54289, 2017-09-13" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54289, 2017-09-13 </a> <nav id=toc-toc-66 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_29 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#ispravleniia-oshibok_34 title="Исправления ошибок:" class="nav-link text-wrap d-inline-block w-100"> Исправления ошибок: </a> <a href=#uluchsheniia-protsessa-razrabotki-i-sborki-clickhouse title="Улучшения процесса разработки и сборки ClickHouse:" class="nav-link text-wrap d-inline-block w-100"> Улучшения процесса разработки и сборки ClickHouse: </a> <a href=#na-chto-obratit-vnimanie-pri-obnovlenii_1 title="На что обратить внимание при обновлении:" class="nav-link text-wrap d-inline-block w-100"> На что обратить внимание при обновлении: </a> </nav> <a href=#reliz-clickhouse-1-1-54284-2017-08-29 title="Релиз ClickHouse 1.1.54284, 2017-08-29" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54284, 2017-08-29 </a> <a href=#reliz-clickhouse-1-1-54282-2017-08-23 title="Релиз ClickHouse 1.1.54282, 2017-08-23" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54282, 2017-08-23 </a> <a href=#reliz-clickhouse-1-1-54276-2017-08-16 title="Релиз ClickHouse 1.1.54276, 2017-08-16" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54276, 2017-08-16 </a> <nav id=toc-toc-69 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_30 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#osnovnye-izmeneniia title="Основные изменения:" class="nav-link text-wrap d-inline-block w-100"> Основные изменения: </a> <a href=#obratno-nesovmestimye-izmeneniia_17 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> <a href=#polnyi-spisok-izmenenii title="Полный список изменений:" class="nav-link text-wrap d-inline-block w-100"> Полный список изменений: </a> <a href=#ispravleniia-bagov title="Исправления багов:" class="nav-link text-wrap d-inline-block w-100"> Исправления багов: </a> <a href=#uluchsheniia-protsessa-razrabotki-i-sborki-clickhouse_1 title="Улучшения процесса разработки и сборки ClickHouse:" class="nav-link text-wrap d-inline-block w-100"> Улучшения процесса разработки и сборки ClickHouse: </a> </nav> <a href=#reliz-clickhouse-1-1-54245-2017-07-04 title="Релиз ClickHouse 1.1.54245, 2017-07-04" class="nav-link text-wrap d-inline-block w-100"> Релиз ClickHouse 1.1.54245, 2017-07-04 </a> <nav id=toc-toc-70 class="nav flex-column pl-2"> <a href=#novye-vozmozhnosti_31 title="Новые возможности:" class="nav-link text-wrap d-inline-block w-100"> Новые возможности: </a> <a href=#obratno-nesovmestimye-izmeneniia_18 title="Обратно несовместимые изменения:" class="nav-link text-wrap d-inline-block w-100"> Обратно несовместимые изменения: </a> <a href=#melkie-izmeneniia title="Мелкие изменения:" class="nav-link text-wrap d-inline-block w-100"> Мелкие изменения: </a> <a href=#ispravleniia-bagov_1 title="Исправления багов:" class="nav-link text-wrap d-inline-block w-100"> Исправления багов: </a> </nav> </nav> </div> </div> </div> <script async type=text/javascript src=/js/base.js?7bd05efd></script> <noscript> <div><img src=https://mc.yandex.ru/watch/18343495 alt=Yandex></div> </noscript> </body> </html>