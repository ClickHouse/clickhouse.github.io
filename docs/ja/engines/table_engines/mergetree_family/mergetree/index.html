<!DOCTYPE html><html lang=ja data-version=master data-single-page=false> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>MergeTree - ClickHouseドキュメント</title><link rel="shortcut icon" href=/favicon.ico><meta property=og:title content="MergeTree - ClickHouseドキュメント "><meta property=og:description content="Mergetree その MergeTree この家族 (*MergeTree）最も堅牢なクリックハウステーブルエンジンです。 のエンジン MergeTree ファミリは、非常に大量のデータをテーブルに挿入するために設計されています。 のデ"><meta property=og:type content=website><meta property=og:image content=https://clickhouse.tech/images/logo.png><meta property=twitter:title content="MergeTree - ClickHouseドキュメント "><meta name=description content="Mergetree その MergeTree この家族 (*MergeTree）最も堅牢なクリックハウステーブルエンジンです。 のエンジン MergeTree ファミリは、非常に大量のデータをテーブルに挿入するために設計されています。 のデ"><meta name=keywords content="ClickHouse, DBMS, OLAP, relational, analytics, analytical, big data, open-source, SQL, web-analytics"><link href=/css/base.css?1d858e50 media=all rel=stylesheet></head> <body dir=ltr data-spy=scroll data-target=#toc data-offset=80> <nav id=top-nav class="navbar navbar-dark navbar-expand-md bg-dark-alt text-white sticky-top"> <div class="container-fluid justify-content-between"> <a href=/ class="d-block navbar-brand mr-3"> <img id=docs-logo-icon src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"> </a> <div class="w-100 navbar-text text-left d-none d-md-block"> <h1 class="h3 m-0 p-0 d-inline"> <a href=# class="text-white text-decoration-none"> MergeTree </a> </h1> </div> <div class="d-none d-md-block"> <ul class="navbar-nav ml-auto mt-2 mt-lg-0 justify-content-end"> <li class=nav-item> <a href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/ja/engines/table_engines/mergetree_family/mergetree.md title="Edit this article" class=nav-link rel="external nofollow noreferrer" target=_blank><img src=/images/mkdocs/edit.svg alt="Edit this article" class=mt-1 height=22></a> </li> <li class=nav-item> <a class=nav-link href=https://github.com/ClickHouse/ClickHouse rel="external nofollow noreferrer"> <img src=/images/index/github.svg alt="GitHub repository" title="Go to GitHub" height=32> </a> </li> <li id=languages-wrapper class="nav-item dropdown"> <div id=languages-dropdown> <a class="nav-link dropdown-toggle d-inline-block mt-1 text-muted" href=# id=lang-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false> <img src=/images/flags/ja.svg alt=日本語 title=日本語 width=32 class="d-inline-block mt-n1"> </a> <div class="dropdown-menu bg-dark" aria-labelledby=lang-dropdown> <a href=/docs/en/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/en.svg alt title width=32 class="d-inline-block mr-2">English </a> <a href=/docs/zh/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/zh.svg alt title width=32 class="d-inline-block mr-2">中文 </a> <a href=/docs/es/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/es.svg alt title width=32 class="d-inline-block mr-2">Español </a> <a href=/docs/fr/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/fr.svg alt title width=32 class="d-inline-block mr-2">Français </a> <a href=/docs/ru/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/ru.svg alt title width=32 class="d-inline-block mr-2">Русский </a> <a href=/docs/ja/engines/table_engines/mergetree_family/mergetree/ class="dropdown-item disabled"> <img src=/images/flags/ja.svg alt title width=32 class="d-inline-block mr-2">日本語 </a> <a href=/docs/fa/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/fa.svg alt title width=32 class="d-inline-block mr-2">فارسی </a> </div> </div> </li> </ul> </div> <form id=search-form class="form-inline m-0"> <div class=input-group> <div class="input-group-prepend w-100"> <span class="input-group-text bg-secondary-alt text-muted border-0 mr-n1" id=search-icon> <img src=/images/mkdocs/search.svg> </span> <input id=docsearch-input class="form-control bg-secondary-alt text-muted border-0 pl-1" type=search placeholder=Search aria-label=Search> </div> </div> </form> <button id=navbar-toggler class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#sidebar aria-controls=sidebar aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> </nav> <div class=container-fluid> <div class="row justify-content-end justify-content-xl-center"> <div id=sidebar class="col-xl-2 col-md-4 bg-secondary-alt p-3 d-print-none min-vh-100 overflow-auto"> <div class=overflow-auto> <div id=single-page-switch class="btn-group mb-2 float-right" role=group aria-label=複数ページまたは単一ページ> <a href=../../../.. role=button class="btn btn-dark active" aria-pressed=true> <img src=/images/mkdocs/multi.svg alt=複数ページバージョン title=複数ページバージョン> </a> <a href=../../../../single/ role=button class="btn btn-dark-alt active" aria-pressed=true> <img src=/images/mkdocs/single.svg alt=単一ページ版 title=単一ページ版> </a> </div> <div class="dropdown mb-3"> <a class="btn btn-dark dropdown-toggle text-muted" href=# role=button id=select-version data-toggle=dropdown aria-haspopup=true aria-expanded=false> バージョン: <span class=text-light>最新の</span> </a> <div class="dropdown-menu bg-dark text-muted p-1" aria-labelledby=select-version> <a href=/docs/ja/ class="dropdown-item disable"> <span class=text-light>最新の</span> </a> <a href=/docs/v20.3/ja/ class=dropdown-item>v20.3</a> <a href=/docs/v20.1/ja/ class=dropdown-item>v20.1</a> <a href=/docs/v19.17/ja/ class=dropdown-item>v19.17</a> <a href=/docs/v19.16/ja/ class=dropdown-item>v19.16</a> <a href=/docs/v19.15/ja/ class=dropdown-item>v19.15</a> <a href=/docs/v19.14/ja/ class=dropdown-item>v19.14</a> <a href=/docs/v19.13/ja/ class=dropdown-item>v19.13</a> <a href=/docs/v19.11/ja/ class=dropdown-item>v19.11</a> <a href=/docs/v19.10/ja/ class=dropdown-item>v19.10</a> <a href=/docs/v19.9/ja/ class=dropdown-item>v19.9</a> <a href=/docs/v19.8/ja/ class=dropdown-item>v19.8</a> </div> </div> <nav id=sidebar-nav class="nav flex-column mb-5"> <a href=#sidebar-sidebar-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-1 title=Introduction class="nav-link text-light text-wrap dropdown-toggle px-0">Introduction</a> <div id=sidebar-sidebar-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../introduction/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../introduction/distinctive_features/ title=特徴的な機能 class="nav-link text-light text-wrap d-inline-block w-100 px-0">特徴的な機能</a> <a href=../../../../introduction/features_considered_disadvantages/ title=欠点と見なすことができるClickHouseの機能 class="nav-link text-light text-wrap d-inline-block w-100 px-0">欠点と見なすことができるClickHouseの機能</a> <a href=../../../../introduction/performance/ title=パフォーマンス class="nav-link text-light text-wrap d-inline-block w-100 px-0">パフォーマンス</a> <a href=../../../../introduction/history/ title=歴史 class="nav-link text-light text-wrap d-inline-block w-100 px-0">歴史</a> <a href=../../../../introduction/adopters/ title=アーリーアダプター class="nav-link text-light text-wrap d-inline-block w-100 px-0">アーリーアダプター</a> </nav> </div> <a href=../../../../ title=概観 class="nav-link text-light text-wrap d-inline-block w-100 px-0">概観</a> <a href=#sidebar-sidebar-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3 title="Getting Started" class="nav-link text-light text-wrap dropdown-toggle px-0">Getting Started</a> <div id=sidebar-sidebar-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../getting_started/ title=隠された class="nav-link text-light text-wrap d-inline-block w-100 px-0">隠された</a> <a href=../../../../getting_started/install/ title=設置 class="nav-link text-light text-wrap d-inline-block w-100 px-0">設置</a> <a href=#sidebar-sidebar-3-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-3 title="Example Datasets" class="nav-link text-light text-wrap dropdown-toggle px-0">Example Datasets</a> <div id=sidebar-sidebar-3-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../getting_started/example_datasets/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../getting_started/example_datasets/ontime/ title=オンタイム class="nav-link text-light text-wrap d-inline-block w-100 px-0">オンタイム</a> <a href=../../../../getting_started/example_datasets/nyc_taxi/ title=ニューヨーク class="nav-link text-light text-wrap d-inline-block w-100 px-0">ニューヨーク</a> <a href=../../../../getting_started/example_datasets/amplab_benchmark/ title="AMPLab Big Dataベンチマーク" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AMPLab Big Dataベンチマーク</a> <a href=../../../../getting_started/example_datasets/wikistat/ title=WikiStat class="nav-link text-light text-wrap d-inline-block w-100 px-0">WikiStat</a> <a href=../../../../getting_started/example_datasets/criteo/ title=CriteoからのTerabyteクリックログ class="nav-link text-light text-wrap d-inline-block w-100 px-0">CriteoからのTerabyteクリックログ</a> <a href=../../../../getting_started/example_datasets/star_schema/ title=スタースキーマのベンチマーク class="nav-link text-light text-wrap d-inline-block w-100 px-0">スタースキーマのベンチマーク</a> <a href=../../../../getting_started/example_datasets/metrica/ title=Yandexの。Metricaデータ class="nav-link text-light text-wrap d-inline-block w-100 px-0">Yandexの。Metricaデータ</a> </nav> </div> <a href=../../../../getting_started/tutorial/ title=Tutorial class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tutorial</a> <a href=../../../../getting_started/playground/ title=遊び場 class="nav-link text-light text-wrap d-inline-block w-100 px-0">遊び場</a> </nav> </div> <a href=#sidebar-sidebar-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4 title=Interfaces class="nav-link text-light text-wrap dropdown-toggle px-0">Interfaces</a> <div id=sidebar-sidebar-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../interfaces/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../interfaces/cli/ title=コマンドライン class="nav-link text-light text-wrap d-inline-block w-100 px-0">コマンドライン</a> <a href=../../../../interfaces/tcp/ title=ネイティブインタフェース(TCP) class="nav-link text-light text-wrap d-inline-block w-100 px-0">ネイティブインタフェース(TCP)</a> <a href=../../../../interfaces/http/ title=HTTPインター class="nav-link text-light text-wrap d-inline-block w-100 px-0">HTTPインター</a> <a href=../../../../interfaces/mysql/ title=MySQLイン class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQLイン</a> <a href=../../../../interfaces/formats/ title=入力および出力形式 class="nav-link text-light text-wrap d-inline-block w-100 px-0">入力および出力形式</a> <a href=../../../../interfaces/jdbc/ title=JDBCドライバ class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBCドライバ</a> <a href=../../../../interfaces/odbc/ title=ODBCドライバ class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBCドライバ</a> <a href=../../../../interfaces/cpp/ title=C++クライアント class="nav-link text-light text-wrap d-inline-block w-100 px-0">C++クライアント</a> <a href=#sidebar-sidebar-4-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-10 title=Third-Party class="nav-link text-light text-wrap dropdown-toggle px-0">Third-Party</a> <div id=sidebar-sidebar-4-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../interfaces/third-party/ title=Third-Party class="nav-link text-light text-wrap d-inline-block w-100 px-0">Third-Party</a> <a href=../../../../interfaces/third-party/client_libraries/ title=クライアント class="nav-link text-light text-wrap d-inline-block w-100 px-0">クライアント</a> <a href=../../../../interfaces/third-party/integrations/ title=統合 class="nav-link text-light text-wrap d-inline-block w-100 px-0">統合</a> <a href=../../../../interfaces/third-party/gui/ title=ビジュアル class="nav-link text-light text-wrap d-inline-block w-100 px-0">ビジュアル</a> <a href=../../../../interfaces/third-party/proxy/ title=プロキシ class="nav-link text-light text-wrap d-inline-block w-100 px-0">プロキシ</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5 title=Engines class="nav-link text-light text-wrap dropdown-toggle px-0">Engines</a> <div id=sidebar-sidebar-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/ title=Engines class="nav-link text-light text-wrap d-inline-block w-100 px-0">Engines</a> <a href=#sidebar-sidebar-5-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2 title="Table Engines" class="nav-link text-light text-wrap dropdown-toggle px-0">Table Engines</a> <div id=sidebar-sidebar-5-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=#sidebar-sidebar-5-2-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-2 title="MergeTree Family" class="nav-link text-light text-wrap dropdown-toggle px-0">MergeTree Family</a> <div id=sidebar-sidebar-5-2-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/mergetree_family/ title="MergeTree Family" class="nav-link text-light text-wrap d-inline-block w-100 px-0">MergeTree Family</a> <a href=../../../../engines/table_engines/mergetree_family/mergetree/ title=MergeTree class="nav-link text-white active text-wrap d-inline-block w-100 px-0">MergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/replication/ title=データ複製 class="nav-link text-light text-wrap d-inline-block w-100 px-0">データ複製</a> <a href=../../../../engines/table_engines/mergetree_family/custom_partitioning_key/ title=カスタム分割キー class="nav-link text-light text-wrap d-inline-block w-100 px-0">カスタム分割キー</a> <a href=../../../../engines/table_engines/mergetree_family/replacingmergetree/ title=ﾂつｨﾂ姪 ﾂつ&quot;ﾂ債ﾂつｹ&quot; class="nav-link text-light text-wrap d-inline-block w-100 px-0">ﾂつｨﾂ姪"ﾂつ"ﾂ債ﾂつｹ</a> <a href=../../../../engines/table_engines/mergetree_family/summingmergetree/ title=SummingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">SummingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/aggregatingmergetree/ title=ﾂつｨﾂ姪 ﾂつ&quot;ﾂ債ﾂづｭﾂつｹ&quot; class="nav-link text-light text-wrap d-inline-block w-100 px-0">ﾂつｨﾂ姪"ﾂつ"ﾂ債ﾂづｭﾂつｹ</a> <a href=../../../../engines/table_engines/mergetree_family/collapsingmergetree/ title=CollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">CollapsingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/versionedcollapsingmergetree/ title=VersionedCollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">VersionedCollapsingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/graphitemergetree/ title=グラフィットメールグツリー class="nav-link text-light text-wrap d-inline-block w-100 px-0">グラフィットメールグツリー</a> </nav> </div> <a href=#sidebar-sidebar-5-2-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-3 title="Log Family" class="nav-link text-light text-wrap dropdown-toggle px-0">Log Family</a> <div id=sidebar-sidebar-5-2-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/log_family/ title="Log Family" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Log Family</a> <a href=../../../../engines/table_engines/log_family/log_family/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../engines/table_engines/log_family/stripelog/ title=ストリップログ class="nav-link text-light text-wrap d-inline-block w-100 px-0">ストリップログ</a> <a href=../../../../engines/table_engines/log_family/log/ title=ログ class="nav-link text-light text-wrap d-inline-block w-100 px-0">ログ</a> <a href=../../../../engines/table_engines/log_family/tinylog/ title=TinyLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">TinyLog</a> </nav> </div> <a href=#sidebar-sidebar-5-2-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-4 title=Integrations class="nav-link text-light text-wrap dropdown-toggle px-0">Integrations</a> <div id=sidebar-sidebar-5-2-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/integrations/ title=Integrations class="nav-link text-light text-wrap d-inline-block w-100 px-0">Integrations</a> <a href=../../../../engines/table_engines/integrations/kafka/ title=カフカname class="nav-link text-light text-wrap d-inline-block w-100 px-0">カフカname</a> <a href=../../../../engines/table_engines/integrations/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../../../engines/table_engines/integrations/jdbc/ title=JDBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC</a> <a href=../../../../engines/table_engines/integrations/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> <a href=../../../../engines/table_engines/integrations/hdfs/ title=HDFS class="nav-link text-light text-wrap d-inline-block w-100 px-0">HDFS</a> </nav> </div> <a href=#sidebar-sidebar-5-2-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-5 title=Special class="nav-link text-light text-wrap dropdown-toggle px-0">Special</a> <div id=sidebar-sidebar-5-2-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/special/ title=Special class="nav-link text-light text-wrap d-inline-block w-100 px-0">Special</a> <a href=../../../../engines/table_engines/special/distributed/ title=分散 class="nav-link text-light text-wrap d-inline-block w-100 px-0">分散</a> <a href=../../../../engines/table_engines/special/external_data/ title=外部データ class="nav-link text-light text-wrap d-inline-block w-100 px-0">外部データ</a> <a href=../../../../engines/table_engines/special/dictionary/ title=辞書 class="nav-link text-light text-wrap d-inline-block w-100 px-0">辞書</a> <a href=../../../../engines/table_engines/special/merge/ title=マージ class="nav-link text-light text-wrap d-inline-block w-100 px-0">マージ</a> <a href=../../../../engines/table_engines/special/file/ title=ファイル class="nav-link text-light text-wrap d-inline-block w-100 px-0">ファイル</a> <a href=../../../../engines/table_engines/special/null/ title=ヌル class="nav-link text-light text-wrap d-inline-block w-100 px-0">ヌル</a> <a href=../../../../engines/table_engines/special/set/ title=セット class="nav-link text-light text-wrap d-inline-block w-100 px-0">セット</a> <a href=../../../../engines/table_engines/special/join/ title=参加 class="nav-link text-light text-wrap d-inline-block w-100 px-0">参加</a> <a href=../../../../engines/table_engines/special/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../../../../engines/table_engines/special/view/ title=ビュー class="nav-link text-light text-wrap d-inline-block w-100 px-0">ビュー</a> <a href=../../../../engines/table_engines/special/materializedview/ title=MaterializedView class="nav-link text-light text-wrap d-inline-block w-100 px-0">MaterializedView</a> <a href=../../../../engines/table_engines/special/memory/ title=メモリ class="nav-link text-light text-wrap d-inline-block w-100 px-0">メモリ</a> <a href=../../../../engines/table_engines/special/buffer/ title=バッファ class="nav-link text-light text-wrap d-inline-block w-100 px-0">バッファ</a> <a href=../../../../engines/table_engines/special/generate/ title=GenerateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">GenerateRandom</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-3 title="Database Engines" class="nav-link text-light text-wrap dropdown-toggle px-0">Database Engines</a> <div id=sidebar-sidebar-5-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/database_engines/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../engines/database_engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../../../engines/database_engines/lazy/ title=怠け者 class="nav-link text-light text-wrap d-inline-block w-100 px-0">怠け者</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6 title="SQL Reference" class="nav-link text-light text-wrap dropdown-toggle px-0">SQL Reference</a> <div id=sidebar-sidebar-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/ title=隠された class="nav-link text-light text-wrap d-inline-block w-100 px-0">隠された</a> <a href=#sidebar-sidebar-6-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-2 title=Statements class="nav-link text-light text-wrap dropdown-toggle px-0">Statements</a> <div id=sidebar-sidebar-6-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/statements/ title=Statements class="nav-link text-light text-wrap d-inline-block w-100 px-0">Statements</a> <a href=../../../../sql_reference/statements/select/ title=SELECT class="nav-link text-light text-wrap d-inline-block w-100 px-0">SELECT</a> <a href=../../../../sql_reference/statements/insert_into/ title="INSERT INTO" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INSERT INTO</a> <a href=../../../../sql_reference/statements/create/ title=CREATE class="nav-link text-light text-wrap d-inline-block w-100 px-0">CREATE</a> <a href=../../../../sql_reference/statements/alter/ title=ALTER class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALTER</a> <a href=../../../../sql_reference/statements/system/ title=SYSTEM class="nav-link text-light text-wrap d-inline-block w-100 px-0">SYSTEM</a> <a href=../../../../sql_reference/statements/show/ title=SHOW class="nav-link text-light text-wrap d-inline-block w-100 px-0">SHOW</a> <a href=../../../../sql_reference/statements/misc/ title=その他 class="nav-link text-light text-wrap d-inline-block w-100 px-0">その他</a> </nav> </div> <a href=../../../../sql_reference/syntax/ title=構文 class="nav-link text-light text-wrap d-inline-block w-100 px-0">構文</a> <a href=#sidebar-sidebar-6-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-4 title=Functions class="nav-link text-light text-wrap dropdown-toggle px-0">Functions</a> <div id=sidebar-sidebar-6-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/functions/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../sql_reference/functions/arithmetic_functions/ title=算数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">算数</a> <a href=../../../../sql_reference/functions/comparison_functions/ title=比較 class="nav-link text-light text-wrap d-inline-block w-100 px-0">比較</a> <a href=../../../../sql_reference/functions/logical_functions/ title=論理 class="nav-link text-light text-wrap d-inline-block w-100 px-0">論理</a> <a href=../../../../sql_reference/functions/type_conversion_functions/ title=タイプ変換 class="nav-link text-light text-wrap d-inline-block w-100 px-0">タイプ変換</a> <a href=../../../../sql_reference/functions/date_time_functions/ title=日付と時刻の操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">日付と時刻の操作</a> <a href=../../../../sql_reference/functions/string_functions/ title=文字列の操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">文字列の操作</a> <a href=../../../../sql_reference/functions/string_search_functions/ title=文字列を検索する場合 class="nav-link text-light text-wrap d-inline-block w-100 px-0">文字列を検索する場合</a> <a href=../../../../sql_reference/functions/string_replace_functions/ title=文字列で置換する場合 class="nav-link text-light text-wrap d-inline-block w-100 px-0">文字列で置換する場合</a> <a href=../../../../sql_reference/functions/conditional_functions/ title=条件付き class="nav-link text-light text-wrap d-inline-block w-100 px-0">条件付き</a> <a href=../../../../sql_reference/functions/math_functions/ title=数学 class="nav-link text-light text-wrap d-inline-block w-100 px-0">数学</a> <a href=../../../../sql_reference/functions/rounding_functions/ title=丸め class="nav-link text-light text-wrap d-inline-block w-100 px-0">丸め</a> <a href=../../../../sql_reference/functions/array_functions/ title=配列の操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">配列の操作</a> <a href=../../../../sql_reference/functions/splitting_merging_functions/ title=文字列と配列の分割とマージ class="nav-link text-light text-wrap d-inline-block w-100 px-0">文字列と配列の分割とマージ</a> <a href=../../../../sql_reference/functions/bit_functions/ title=ビット class="nav-link text-light text-wrap d-inline-block w-100 px-0">ビット</a> <a href=../../../../sql_reference/functions/bitmap_functions/ title=Bitmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bitmap</a> <a href=../../../../sql_reference/functions/hash_functions/ title=ハッシュ class="nav-link text-light text-wrap d-inline-block w-100 px-0">ハッシュ</a> <a href=../../../../sql_reference/functions/random_functions/ title=擬似乱数の生成 class="nav-link text-light text-wrap d-inline-block w-100 px-0">擬似乱数の生成</a> <a href=../../../../sql_reference/functions/encoding_functions/ title=エンコード class="nav-link text-light text-wrap d-inline-block w-100 px-0">エンコード</a> <a href=../../../../sql_reference/functions/uuid_functions/ title=UUIDの操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUIDの操作</a> <a href=../../../../sql_reference/functions/url_functions/ title=Urlの操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">Urlの操作</a> <a href=../../../../sql_reference/functions/ip_address_functions/ title=IPアドレスの操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPアドレスの操作</a> <a href=../../../../sql_reference/functions/json_functions/ title=JSONでの作業 class="nav-link text-light text-wrap d-inline-block w-100 px-0">JSONでの作業</a> <a href=../../../../sql_reference/functions/higher_order_functions/ title=より高い次数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">より高い次数</a> <a href=../../../../sql_reference/functions/ext_dict_functions/ title=外部辞書の操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">外部辞書の操作</a> <a href=../../../../sql_reference/functions/ym_dict_functions/ title=Yandexのでの作業。メトリカ辞書 class="nav-link text-light text-wrap d-inline-block w-100 px-0">Yandexのでの作業。メトリカ辞書</a> <a href=../../../../sql_reference/functions/in_functions/ title=IN演算子の実装 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IN演算子の実装</a> <a href=../../../../sql_reference/functions/array_join/ title=arrayJoin class="nav-link text-light text-wrap d-inline-block w-100 px-0">arrayJoin</a> <a href=../../../../sql_reference/functions/geo/ title=地理座標の操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">地理座標の操作</a> <a href=../../../../sql_reference/functions/functions_for_nulls/ title=ヌル可能な引数の操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">ヌル可能な引数の操作</a> <a href=../../../../sql_reference/functions/machine_learning_functions/ title=機械学習の機能 class="nav-link text-light text-wrap d-inline-block w-100 px-0">機械学習の機能</a> <a href=../../../../sql_reference/functions/introspection/ title=イントロスペクション class="nav-link text-light text-wrap d-inline-block w-100 px-0">イントロスペクション</a> <a href=../../../../sql_reference/functions/other_functions/ title=その他 class="nav-link text-light text-wrap d-inline-block w-100 px-0">その他</a> </nav> </div> <a href=#sidebar-sidebar-6-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-5 title="Aggregate Functions" class="nav-link text-light text-wrap dropdown-toggle px-0">Aggregate Functions</a> <div id=sidebar-sidebar-6-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/aggregate_functions/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../sql_reference/aggregate_functions/reference/ title=参照 class="nav-link text-light text-wrap d-inline-block w-100 px-0">参照</a> <a href=../../../../sql_reference/aggregate_functions/combinators/ title=集計関数のコンビネータ class="nav-link text-light text-wrap d-inline-block w-100 px-0">集計関数のコンビネータ</a> <a href=../../../../sql_reference/aggregate_functions/parametric_functions/ title=パラメトリック集計関数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">パラメトリック集計関数</a> </nav> </div> <a href=#sidebar-sidebar-6-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-6 title="Table Functions" class="nav-link text-light text-wrap dropdown-toggle px-0">Table Functions</a> <div id=sidebar-sidebar-6-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/table_functions/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../sql_reference/table_functions/file/ title=ファイル class="nav-link text-light text-wrap d-inline-block w-100 px-0">ファイル</a> <a href=../../../../sql_reference/table_functions/merge/ title=マージ class="nav-link text-light text-wrap d-inline-block w-100 px-0">マージ</a> <a href=../../../../sql_reference/table_functions/numbers/ title=数字 class="nav-link text-light text-wrap d-inline-block w-100 px-0">数字</a> <a href=../../../../sql_reference/table_functions/remote/ title=リモート class="nav-link text-light text-wrap d-inline-block w-100 px-0">リモート</a> <a href=../../../../sql_reference/table_functions/url/ title=url class="nav-link text-light text-wrap d-inline-block w-100 px-0">url</a> <a href=../../../../sql_reference/table_functions/mysql/ title=mysql class="nav-link text-light text-wrap d-inline-block w-100 px-0">mysql</a> <a href=../../../../sql_reference/table_functions/jdbc/ title=jdbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">jdbc</a> <a href=../../../../sql_reference/table_functions/odbc/ title=odbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">odbc</a> <a href=../../../../sql_reference/table_functions/hdfs/ title=hdfs class="nav-link text-light text-wrap d-inline-block w-100 px-0">hdfs</a> <a href=../../../../sql_reference/table_functions/input/ title=入力 class="nav-link text-light text-wrap d-inline-block w-100 px-0">入力</a> <a href=../../../../sql_reference/table_functions/generate/ title=generateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">generateRandom</a> </nav> </div> <a href=#sidebar-sidebar-6-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-7 title=Dictionaries class="nav-link text-light text-wrap dropdown-toggle px-0">Dictionaries</a> <div id=sidebar-sidebar-6-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/dictionaries/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=#sidebar-sidebar-6-7-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-7-2 title="External Dictionaries" class="nav-link text-light text-wrap dropdown-toggle px-0">External Dictionaries</a> <div id=sidebar-sidebar-6-7-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/dictionaries/external_dictionaries/ title="External Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">External Dictionaries</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts/ title=一般的な説明 class="nav-link text-light text-wrap d-inline-block w-100 px-0">一般的な説明</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict/ title=外部ディクショナリの設定 class="nav-link text-light text-wrap d-inline-block w-100 px-0">外部ディクショナリの設定</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_layout/ title=辞書をメモリに保存する class="nav-link text-light text-wrap d-inline-block w-100 px-0">辞書をメモリに保存する</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_lifetime/ title=辞書の更新 class="nav-link text-light text-wrap d-inline-block w-100 px-0">辞書の更新</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_sources/ title=外部辞書のソース class="nav-link text-light text-wrap d-inline-block w-100 px-0">外部辞書のソース</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_structure/ title=辞書のキーとフィールド class="nav-link text-light text-wrap d-inline-block w-100 px-0">辞書のキーとフィールド</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_hierarchical/ title=階層辞書 class="nav-link text-light text-wrap d-inline-block w-100 px-0">階層辞書</a> </nav> </div> <a href=../../../../sql_reference/dictionaries/internal_dicts/ title=内部辞書 class="nav-link text-light text-wrap d-inline-block w-100 px-0">内部辞書</a> </nav> </div> <a href=#sidebar-sidebar-6-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8 title="Data Types" class="nav-link text-light text-wrap dropdown-toggle px-0">Data Types</a> <div id=sidebar-sidebar-6-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../sql_reference/data_types/int_uint/ title=UInt8、UInt16、UInt32、UInt64、Int8、Int16、Int32、Int64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">UInt8、UInt16、UInt32、UInt64、Int8、Int16、Int32、Int64</a> <a href=../../../../sql_reference/data_types/float/ title=Float32,Float64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">Float32,Float64</a> <a href=../../../../sql_reference/data_types/decimal/ title=小数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">小数</a> <a href=../../../../sql_reference/data_types/boolean/ title=ブール値 class="nav-link text-light text-wrap d-inline-block w-100 px-0">ブール値</a> <a href=../../../../sql_reference/data_types/string/ title=文字列 class="nav-link text-light text-wrap d-inline-block w-100 px-0">文字列</a> <a href=../../../../sql_reference/data_types/fixedstring/ title=FixedString(N) class="nav-link text-light text-wrap d-inline-block w-100 px-0">FixedString(N)</a> <a href=../../../../sql_reference/data_types/uuid/ title=UUID class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUID</a> <a href=../../../../sql_reference/data_types/date/ title=日付 class="nav-link text-light text-wrap d-inline-block w-100 px-0">日付</a> <a href=../../../../sql_reference/data_types/datetime/ title=DateTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime</a> <a href=../../../../sql_reference/data_types/datetime64/ title=DateTime64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime64</a> <a href=../../../../sql_reference/data_types/enum/ title=列挙型 class="nav-link text-light text-wrap d-inline-block w-100 px-0">列挙型</a> <a href=../../../../sql_reference/data_types/array/ title=配列(T) class="nav-link text-light text-wrap d-inline-block w-100 px-0">配列(T)</a> <a href=../../../../sql_reference/data_types/aggregatefunction/ title=AggregateFunction(name,types_of_arguments)...) class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregateFunction(name,types_of_arguments)...)</a> <a href=../../../../sql_reference/data_types/tuple/ title=タプル(T1,T2,...) class="nav-link text-light text-wrap d-inline-block w-100 px-0">タプル(T1,T2,...)</a> <a href=#sidebar-sidebar-6-8-16 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8-16 title="Nested Data Structures" class="nav-link text-light text-wrap dropdown-toggle px-0">Nested Data Structures</a> <div id=sidebar-sidebar-6-8-16 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/nested_data_structures/ title=隠された class="nav-link text-light text-wrap d-inline-block w-100 px-0">隠された</a> <a href=../../../../sql_reference/data_types/nested_data_structures/nested/ title=ネスト(Name1タイプ1,Name2タイプ2,...) class="nav-link text-light text-wrap d-inline-block w-100 px-0">ネスト(Name1タイプ1,Name2タイプ2,...)</a> </nav> </div> <a href=../../../../sql_reference/data_types/nullable/ title=Nullable class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nullable</a> <a href=#sidebar-sidebar-6-8-18 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8-18 title="Special Data Types" class="nav-link text-light text-wrap dropdown-toggle px-0">Special Data Types</a> <div id=sidebar-sidebar-6-8-18 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/special_data_types/ title=隠された class="nav-link text-light text-wrap d-inline-block w-100 px-0">隠された</a> <a href=../../../../sql_reference/data_types/special_data_types/expression/ title=式 class="nav-link text-light text-wrap d-inline-block w-100 px-0">式</a> <a href=../../../../sql_reference/data_types/special_data_types/set/ title=セット class="nav-link text-light text-wrap d-inline-block w-100 px-0">セット</a> <a href=../../../../sql_reference/data_types/special_data_types/nothing/ title=何もない class="nav-link text-light text-wrap d-inline-block w-100 px-0">何もない</a> <a href=../../../../sql_reference/data_types/special_data_types/interval/ title=間隔 class="nav-link text-light text-wrap d-inline-block w-100 px-0">間隔</a> </nav> </div> <a href=#sidebar-sidebar-6-8-19 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8-19 title=Domains class="nav-link text-light text-wrap dropdown-toggle px-0">Domains</a> <div id=sidebar-sidebar-6-8-19 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/domains/ title=Domains class="nav-link text-light text-wrap d-inline-block w-100 px-0">Domains</a> <a href=../../../../sql_reference/data_types/domains/overview/ title=概要 class="nav-link text-light text-wrap d-inline-block w-100 px-0">概要</a> <a href=../../../../sql_reference/data_types/domains/ipv4/ title=IPv4 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv4</a> <a href=../../../../sql_reference/data_types/domains/ipv6/ title=IPv6 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv6</a> </nav> </div> </nav> </div> <a href=../../../../sql_reference/operators/ title=演算子 class="nav-link text-light text-wrap d-inline-block w-100 px-0">演算子</a> </nav> </div> <a href=#sidebar-sidebar-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7 title=Guides class="nav-link text-light text-wrap dropdown-toggle px-0">Guides</a> <div id=sidebar-sidebar-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../guides/ title=概要 class="nav-link text-light text-wrap d-inline-block w-100 px-0">概要</a> <a href=../../../../guides/apply_catboost_model/ title=CatBoostモデルの適用 class="nav-link text-light text-wrap d-inline-block w-100 px-0">CatBoostモデルの適用</a> </nav> </div> <a href=#sidebar-sidebar-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8 title=Operations class="nav-link text-light text-wrap dropdown-toggle px-0">Operations</a> <div id=sidebar-sidebar-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../operations/requirements/ title=要件 class="nav-link text-light text-wrap d-inline-block w-100 px-0">要件</a> <a href=../../../../operations/monitoring/ title=監視 class="nav-link text-light text-wrap d-inline-block w-100 px-0">監視</a> <a href=../../../../operations/troubleshooting/ title=トラブル class="nav-link text-light text-wrap d-inline-block w-100 px-0">トラブル</a> <a href=../../../../operations/update/ title=クリックハウス更新 class="nav-link text-light text-wrap d-inline-block w-100 px-0">クリックハウス更新</a> <a href=../../../../operations/access_rights/ title=アクセス権 class="nav-link text-light text-wrap d-inline-block w-100 px-0">アクセス権</a> <a href=../../../../operations/backup/ title=データバック class="nav-link text-light text-wrap d-inline-block w-100 px-0">データバック</a> <a href=../../../../operations/configuration_files/ title=設定ファイル class="nav-link text-light text-wrap d-inline-block w-100 px-0">設定ファイル</a> <a href=../../../../operations/quotas/ title=クォータ class="nav-link text-light text-wrap d-inline-block w-100 px-0">クォータ</a> <a href=#sidebar-sidebar-8-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-10 title="Optimizing Performance" class="nav-link text-light text-wrap dropdown-toggle px-0">Optimizing Performance</a> <div id=sidebar-sidebar-8-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/optimizing_performance/ title="Optimizing Performance" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Optimizing Performance</a> <a href=../../../../operations/optimizing_performance/sampling_query_profiler/ title=Queryプロファイリング class="nav-link text-light text-wrap d-inline-block w-100 px-0">Queryプロファイリング</a> </nav> </div> <a href=../../../../operations/system_tables/ title=システム表 class="nav-link text-light text-wrap d-inline-block w-100 px-0">システム表</a> <a href=#sidebar-sidebar-8-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-12 title="Server Configuration Parameters" class="nav-link text-light text-wrap dropdown-toggle px-0">Server Configuration Parameters</a> <div id=sidebar-sidebar-8-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/server_configuration_parameters/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../operations/server_configuration_parameters/settings/ title=サーバー設定 class="nav-link text-light text-wrap d-inline-block w-100 px-0">サーバー設定</a> </nav> </div> <a href=../../../../operations/performance_test/ title=ハードウェア試験 class="nav-link text-light text-wrap d-inline-block w-100 px-0">ハードウェア試験</a> <a href=#sidebar-sidebar-8-14 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-14 title=Settings class="nav-link text-light text-wrap dropdown-toggle px-0">Settings</a> <div id=sidebar-sidebar-8-14 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/settings/ title=導入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">導入</a> <a href=../../../../operations/settings/permissions_for_queries/ title=クエリの権限 class="nav-link text-light text-wrap d-inline-block w-100 px-0">クエリの権限</a> <a href=../../../../operations/settings/query_complexity/ title=クエリの複雑さの制限 class="nav-link text-light text-wrap d-inline-block w-100 px-0">クエリの複雑さの制限</a> <a href=../../../../operations/settings/settings/ title=設定 class="nav-link text-light text-wrap d-inline-block w-100 px-0">設定</a> <a href=../../../../operations/settings/settings_profiles/ title=設定プロファイル class="nav-link text-light text-wrap d-inline-block w-100 px-0">設定プロファイル</a> <a href=../../../../operations/settings/constraints_on_settings/ title=設定の制約 class="nav-link text-light text-wrap d-inline-block w-100 px-0">設定の制約</a> <a href=../../../../operations/settings/settings_users/ title=ユーザー設定 class="nav-link text-light text-wrap d-inline-block w-100 px-0">ユーザー設定</a> </nav> </div> <a href=#sidebar-sidebar-8-15 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-15 title=Utilities class="nav-link text-light text-wrap dropdown-toggle px-0">Utilities</a> <div id=sidebar-sidebar-8-15 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/utilities/ title=概要 class="nav-link text-light text-wrap d-inline-block w-100 px-0">概要</a> <a href=../../../../operations/utilities/clickhouse-copier/ title=クリックハウスコピー機 class="nav-link text-light text-wrap d-inline-block w-100 px-0">クリックハウスコピー機</a> <a href=../../../../operations/utilities/clickhouse-local/ title=ﾂつ ﾂづ按つｵﾂ！&quot; class="nav-link text-light text-wrap d-inline-block w-100 px-0">ﾂつ"ﾂづ按つｵﾂ！</a> <a href=../../../../operations/utilities/clickhouse-benchmark/ title=clickhouse-ベンチマーク class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-ベンチマーク</a> </nav> </div> <a href=../../../../operations/tips/ title=使用の推奨事項 class="nav-link text-light text-wrap d-inline-block w-100 px-0">使用の推奨事項</a> </nav> </div> <a href=#sidebar-sidebar-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-9 title=Development class="nav-link text-light text-wrap dropdown-toggle px-0">Development</a> <div id=sidebar-sidebar-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../development/ title=隠された class="nav-link text-light text-wrap d-inline-block w-100 px-0">隠された</a> <a href=../../../../development/developer_instruction/ title=初心者の方ClickHouse開発者の指示 class="nav-link text-light text-wrap d-inline-block w-100 px-0">初心者の方ClickHouse開発者の指示</a> <a href=../../../../development/architecture/ title=クリックハウスの概要 class="nav-link text-light text-wrap d-inline-block w-100 px-0">クリックハウスの概要</a> <a href=../../../../development/browse_code/ title=ClickHouseのソースコードを参照 class="nav-link text-light text-wrap d-inline-block w-100 px-0">ClickHouseのソースコードを参照</a> <a href=../../../../development/build/ title=LinuxでClickHouseを構築する方法 class="nav-link text-light text-wrap d-inline-block w-100 px-0">LinuxでClickHouseを構築する方法</a> <a href=../../../../development/build_osx/ title="Mac OS XでClickHouseを構築する方法" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mac OS XでClickHouseを構築する方法</a> <a href=../../../../development/build_cross_osx/ title="Mac OS X用のLinuxでClickHouseを構築する方法" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mac OS X用のLinuxでClickHouseを構築する方法</a> <a href=../../../../development/build_cross_arm/ title=AARCH64用LinuxでClickHouseをビルドする方法（ARM64) class="nav-link text-light text-wrap d-inline-block w-100 px-0">AARCH64用LinuxでClickHouseをビルドする方法（ARM64)</a> <a href=../../../../development/style/ title=C++コードの書き方 class="nav-link text-light text-wrap d-inline-block w-100 px-0">C++コードの書き方</a> <a href=../../../../development/tests/ title=ClickHouseテストを実行する方法 class="nav-link text-light text-wrap d-inline-block w-100 px-0">ClickHouseテストを実行する方法</a> <a href=../../../../development/contrib/ title=サードパーティ製ライブラリ class="nav-link text-light text-wrap d-inline-block w-100 px-0">サードパーティ製ライブラリ</a> </nav> </div> <a href=#sidebar-sidebar-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-10 title=Commercial class="nav-link text-light text-wrap dropdown-toggle px-0">Commercial</a> <div id=sidebar-sidebar-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../commercial/ title=Commercial class="nav-link text-light text-wrap d-inline-block w-100 px-0">Commercial</a> <a href=../../../../commercial/cloud/ title=ClickHouseしてクラウドサービスプロバイダ class="nav-link text-light text-wrap d-inline-block w-100 px-0">ClickHouseしてクラウドサービスプロバイダ</a> </nav> </div> <a href=#sidebar-sidebar-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11 title="What's New" class="nav-link text-light text-wrap dropdown-toggle px-0">What's New</a> <div id=sidebar-sidebar-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../whats_new/ title="What's New" class="nav-link text-light text-wrap d-inline-block w-100 px-0">What's New</a> <a href=#sidebar-sidebar-11-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11-2 title=Changelog class="nav-link text-light text-wrap dropdown-toggle px-0">Changelog</a> <div id=sidebar-sidebar-11-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../whats_new/changelog/ title=2020 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2020</a> <a href=../../../../whats_new/changelog/2019/ title=2019 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2019</a> <a href=../../../../whats_new/changelog/2018/ title=2018 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2018</a> <a href=../../../../whats_new/changelog/2017/ title=2017 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2017</a> </nav> </div> <a href=../../../../whats_new/roadmap/ title=ロードマップ class="nav-link text-light text-wrap d-inline-block w-100 px-0">ロードマップ</a> <a href=../../../../whats_new/security_changelog/ title=セキュリティの変更履歴 class="nav-link text-light text-wrap d-inline-block w-100 px-0">セキュリティの変更履歴</a> </nav> </div> <a href=#sidebar-sidebar-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-12 title=F.A.Q. class="nav-link text-light text-wrap dropdown-toggle px-0">F.A.Q.</a> <div id=sidebar-sidebar-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../faq/ title=F.A.Q. class="nav-link text-light text-wrap d-inline-block w-100 px-0">F.A.Q.</a> <a href=../../../../faq/general/ title=一般的な質問 class="nav-link text-light text-wrap d-inline-block w-100 px-0">一般的な質問</a> </nav> </div> <a href=../../../../single/clickhouse_ja.pdf class="nav-link border-top border-secondary mt-3 px-0 pt-3 text-light"> <img src=/images/mkdocs/pdf.svg alt=PDFバージョン title=PDFバージョン height=24 class="d-block mr-1 float-left"><div>PDFバージョン</div> </a> </nav> </div> </div> <div id=content-wrapper class="col-md-8 p-2 p-md-5"> <div id=content> <div class="alert alert-primary" role=alert> <p class="display-5 mb-2">助けが欲しかった！</p> <p class=lead>このドキュメントページの以下の内容は機械翻訳されています。 異な他のウェブサイトで行われませんができます。 この翻訳テキスト生活をGitHubリポジトリとClickHouseコードベース、待ち員ネイティブスピーカーで人間が読む.</p> <p class=lead> <a class="btn btn-lg btn-primary text-white" href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/ja/engines/table_engines/mergetree_family/mergetree.md target=_blank rel="external nofollow noreferrer"> このページを編集してClickHouseの文書を編集する </a> </p> </div> <h1 id=table_engines-mergetree>Mergetree<a class=headerlink href=#table_engines-mergetree title="Permanent link">&para;</a></h1> <p>その <code>MergeTree</code> この家族 (<code>*MergeTree</code>）最も堅牢なクリックハウステーブルエンジンです。</p> <p>のエンジン <code>MergeTree</code> ファミリは、非常に大量のデータをテーブルに挿入するために設計されています。 のデータが書き込まれ、テーブル部、そのルール適用のための統合のパーツです。 この方法は、挿入時にストレージ内のデータを継続的に書き換えるよりはるかに効率的です。</p> <p>主な特長:</p> <ul> <li> <p>店舗データを整理によりその有効なタイプを利用します。</p> <p>これにより、データの検索を高速化する小さなスパース索引を作成できます。</p> </li> <li> <p>パーティションは、 <a href=../custom_partitioning_key/ >分割キー</a> が指定される。</p> <p>ClickHouseは、同じ結果を持つ同じデータに対する一般的な操作よりも効果的なパーティションを持つ特定の操作をサポートします。 ClickHouseも自動的に遮断すると、パーティションデータのパーティショニングキーで指定されたクエリ。 この改善するためのクエリ。</p> </li> <li> <p>データ複製サポート。</p> <p>の家族 <code>ReplicatedMergeTree</code> 表はデータ複製を提供します。 詳細については、 <a href=../replication/ >データ複製</a>.</p> </li> <li> <p>データ抜取りサポート。</p> <p>必要に応じて、テーブル内のデータサンプリング方法を設定できます。</p> </li> </ul> <div class="admonition info"> <p class=admonition-title>情報</p> <p>その <a href=../../special/merge/ >マージ</a> エンジンはに属しません <code>*MergeTree</code> 家族</p> </div> <h2 id=table_engine-mergetree-creating-a-table>テーブルの作成<a class=headerlink href=#table_engine-mergetree-creating-a-table title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=p>[</span><span class=k>IF</span> <span class=k>NOT</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=k>cluster</span><span class=p>]</span>
<span class=p>(</span>
    <span class=n>name1</span> <span class=p>[</span><span class=n>type1</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr1</span><span class=p>]</span> <span class=p>[</span><span class=n>TTL</span> <span class=n>expr1</span><span class=p>],</span>
    <span class=n>name2</span> <span class=p>[</span><span class=n>type2</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr2</span><span class=p>]</span> <span class=p>[</span><span class=n>TTL</span> <span class=n>expr2</span><span class=p>],</span>
    <span class=p>...</span>
    <span class=k>INDEX</span> <span class=n>index_name1</span> <span class=n>expr1</span> <span class=k>TYPE</span> <span class=n>type1</span><span class=p>(...)</span> <span class=n>GRANULARITY</span> <span class=n>value1</span><span class=p>,</span>
    <span class=k>INDEX</span> <span class=n>index_name2</span> <span class=n>expr2</span> <span class=k>TYPE</span> <span class=n>type2</span><span class=p>(...)</span> <span class=n>GRANULARITY</span> <span class=n>value2</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span><span class=p>()</span>
<span class=p>[</span><span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=k>ORDER</span> <span class=k>BY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=k>PRIMARY</span> <span class=k>KEY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=n>SAMPLE</span> <span class=k>BY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=n>TTL</span> <span class=n>expr</span> <span class=p>[</span><span class=k>DELETE</span><span class=o>|</span><span class=k>TO</span> <span class=n>DISK</span> <span class=s1>&#39;xxx&#39;</span><span class=o>|</span><span class=k>TO</span> <span class=n>VOLUME</span> <span class=s1>&#39;xxx&#39;</span><span class=p>],</span> <span class=p>...]</span>
<span class=p>[</span><span class=n>SETTINGS</span> <span class=n>name</span><span class=o>=</span><span class=n>value</span><span class=p>,</span> <span class=p>...]</span>
</code></pre></div> <p>パラメータの詳細については、 <a href=../../../../sql_reference/statements/create/ >クエリの説明の作成</a>.</p> <div class="admonition note"> <p class=admonition-title>メモ</p> <p><code>INDEX</code> は、実験的な機能です <a href=#table_engine-mergetree-data_skipping-indexes>データスキップ索引</a>.</p> </div> <h3 id=mergetree-query-clauses>クエリ句<a class=headerlink href=#mergetree-query-clauses title="Permanent link">&para;</a></h3> <ul> <li> <p><code>ENGINE</code> — Name and parameters of the engine. <code>ENGINE = MergeTree()</code>. その <code>MergeTree</code> engineにはパラメータがありません。</p> </li> <li> <p><code>PARTITION BY</code> — The <a href=../custom_partitioning_key/ >分割キー</a>.</p> <p>月単位でパーティション分割するには、 <code>toYYYYMM(date_column)</code> 式、どこ <code>date_column</code> 型の日付を持つ列を指定します <a href=../../../../sql_reference/data_types/date/ >日付</a>. ここでのパーティション名には、 <code>"YYYYMM"</code> フォーマット。</p> </li> <li> <p><code>ORDER BY</code> — The sorting key.</p> <p>列または任意の式のタプル。 例えば: <code>ORDER BY (CounterID, EventDate)</code>.</p> </li> <li> <p><code>PRIMARY KEY</code> — The primary key if it <a href=./ >ソートキーとは異なります</a>.</p> <p>デフォルトでは、プライマリキーはソートキー(プライマリキーで指定)と同じです。 <code>ORDER BY</code> 句）。 したがって、ほとんどの場合、別の <code>PRIMARY KEY</code> 句。</p> </li> <li> <p><code>SAMPLE BY</code> — An expression for sampling.</p> <p>サンプリング式を使用する場合は、主キーに含める必要があります。 例えば: <code>SAMPLE BY intHash32(UserID) ORDER BY (CounterID, EventDate, intHash32(UserID))</code>.</p> </li> <li> <p><code>TTL</code> — A list of rules specifying storage duration of rows and defining logic of automatic parts movement <a href=#table_engine-mergetree-multiple-volumes>ディスクとボリューム間</a>.</p> <p>式には次のものが必要です <code>Date</code> または <code>DateTime</code> 結果としての列。 例えば:<br> <code>TTL date + INTERVAL 1 DAY</code></p> <p>ルールのタイプ <code>DELETE|TO DISK 'xxx'|TO VOLUME 'xxx'</code> 式が満たされている場合(現在の時間に達した場合)、その部分を使用して実行するアクションを指定します。 (<code>TO DISK 'xxx'</code>)またはボリュームに (<code>TO VOLUME 'xxx'</code>). ルールのデフォルトの種類は削除です (<code>DELETE</code>). 複数のルールのリストは指定できますが、複数のルールが存在しないはずです <code>DELETE</code> ルール。</p> <p>詳細については、 <a href=#table_engine-mergetree-ttl>列とテーブルのttl</a></p> </li> <li> <p><code>SETTINGS</code> — Additional parameters that control the behavior of the <code>MergeTree</code>:</p> <ul> <li><code>index_granularity</code> — Maximum number of data rows between the marks of an index. Default value: 8192. See <a href=#mergetree-data-storage>データ記憶</a>.</li> <li><code>index_granularity_bytes</code> — Maximum size of data granules in bytes. Default value: 10Mb. To restrict the granule size only by number of rows, set to 0 (not recommended). See <a href=#mergetree-data-storage>データ記憶</a>.</li> <li><code>enable_mixed_granularity_parts</code> — Enables or disables transitioning to control the granule size with the <code>index_granularity_bytes</code> 設定。 バージョン19.11以前は、 <code>index_granularity</code> 制限の微粒のサイズのための設定。 その <code>index_granularity_bytes</code> 設定の改善ClickHouse性能の選定からデータをテーブルの大きな行(数十、数百人のメガバイト). 大きな行を持つテーブルがある場合は、この設定を有効にしてテーブルの効率を向上させることができます <code>SELECT</code> クエリ。</li> <li><code>use_minimalistic_part_header_in_zookeeper</code> — Storage method of the data parts headers in ZooKeeper. If <code>use_minimalistic_part_header_in_zookeeper=1</code>、その後ZooKeeperは以下のデータを格納します。 詳細については、 <a href=../../../../operations/server_configuration_parameters/settings/#server-settings-use_minimalistic_part_header_in_zookeeper>設定の説明</a> で “Server configuration parameters”.</li> <li><code>min_merge_bytes_to_use_direct_io</code> — The minimum data volume for merge operation that is required for using direct I/O access to the storage disk. When merging data parts, ClickHouse calculates the total storage volume of all the data to be merged. If the volume exceeds <code>min_merge_bytes_to_use_direct_io</code> バイトClickHouseを読み込みおよび書き込み、データの保存ディスクの直接のI/Oインターフェース (<code>O_DIRECT</code> オプション）。 もし <code>min_merge_bytes_to_use_direct_io = 0</code> その後、直接I/Oが無効になります。 デフォルト値: <code>10 * 1024 * 1024 * 1024</code> バイト。<br> <a name=mergetree_setting-merge_with_ttl_timeout></a></li> <li><code>merge_with_ttl_timeout</code> — Minimum delay in seconds before repeating a merge with TTL. Default value: 86400 (1 day).</li> <li><code>write_final_mark</code> — Enables or disables writing the final index mark at the end of data part (after the last byte). Default value: 1. Don't turn it off.</li> <li><code>merge_max_block_size</code> — Maximum number of rows in block for merge operations. Default value: 8192.</li> <li><code>storage_policy</code> — Storage policy. See <a href=#table_engine-mergetree-multiple-volumes>複数ブロックデバイスを使用したデータ保存</a>.</li> </ul> </li> </ul> <p><strong>セクション設定例</strong></p> <div class=codehilite><pre><span></span><code><span class=n>ENGINE</span> <span class=n>MergeTree</span><span class=p>()</span> <span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>EventDate</span><span class=p>)</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=p>(</span><span class=n>CounterID</span><span class=p>,</span> <span class=n>EventDate</span><span class=p>,</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>))</span> <span class=n>SAMPLE</span> <span class=k>BY</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>)</span> <span class=n>SETTINGS</span> <span class=n>index_granularity</span><span class=o>=</span><span class=mi>8192</span>
</code></pre></div> <p>この例では、月単位でパーティション分割を設定します。</p> <p>また、ユーザーidによるハッシュとしてサンプリング用の式を設定します。 これにより、それぞれのテーブルのデータを擬似乱数化することができます <code>CounterID</code> と <code>EventDate</code>. を定義した場合 <a href=../../../../sql_reference/statements/select/#select-sample-clause>SAMPLE</a> 句データを選択すると、ClickHouseはユーザーのサブセットに対して均等に擬似乱数データサンプルを返します。</p> <p>その <code>index_granularity</code> 8192がデフォルト値であるため、設定は省略できます。</p> <details> <p><summary>テーブルを作成する非推奨の方法</summary></p> <div class="admonition attention"> <p class=admonition-title>注意</p> <p>用途では使用しないでください方法で新規プロジェクト. 可能であれば、古いプロジェクトを上記の方法に切り替えます。</p> </div> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=p>[</span><span class=k>IF</span> <span class=k>NOT</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=k>cluster</span><span class=p>]</span>
<span class=p>(</span>
    <span class=n>name1</span> <span class=p>[</span><span class=n>type1</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr1</span><span class=p>],</span>
    <span class=n>name2</span> <span class=p>[</span><span class=n>type2</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr2</span><span class=p>],</span>
    <span class=p>...</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=p>[</span><span class=o>=</span><span class=p>]</span> <span class=n>MergeTree</span><span class=p>(</span><span class=nb>date</span><span class=o>-</span><span class=k>column</span> <span class=p>[,</span> <span class=n>sampling_expression</span><span class=p>],</span> <span class=p>(</span><span class=k>primary</span><span class=p>,</span> <span class=k>key</span><span class=p>),</span> <span class=n>index_granularity</span><span class=p>)</span>
</code></pre></div> <p><strong>MergeTree()パラメータ</strong></p> <ul> <li><code>date-column</code> — The name of a column of the <a href=../../../../sql_reference/data_types/date/ >日付</a> タイプ。 ClickHouseを自動でパーティション月に基づきます。 パーティション名は <code>"YYYYMM"</code> フォーマット。</li> <li><code>sampling_expression</code> — An expression for sampling.</li> <li><code>(primary, key)</code> — Primary key. Type: <a href=../../../../sql_reference/data_types/tuple/ >タプル()</a></li> <li><code>index_granularity</code> — The granularity of an index. The number of data rows between the “marks” インデックスの。 値8192は、ほとんどのタスクに適しています。</li> </ul> <p><strong>例えば</strong></p> <div class=codehilite><pre><span></span><code><span class=n>MergeTree</span><span class=p>(</span><span class=n>EventDate</span><span class=p>,</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>),</span> <span class=p>(</span><span class=n>CounterID</span><span class=p>,</span> <span class=n>EventDate</span><span class=p>,</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>)),</span> <span class=mi>8192</span><span class=p>)</span>
</code></pre></div> <p>その <code>MergeTree</code> エンジンは、メインエンジン構成方法について上記の例と同様に構成される。</p> </details> <h2 id=mergetree-data-storage>データ記憶<a class=headerlink href=#mergetree-data-storage title="Permanent link">&para;</a></h2> <p>テーブルのデータ部品の分別によりその有効なタイプを利用します。</p> <p>データがテーブルに挿入されると、別々のデータパーツが作成され、それぞれが主キーで辞書式に並べ替えられます。 たとえば、プライマリキーが次の場合 <code>(CounterID, Date)</code> パーツ内のデータは <code>CounterID</code>、およびそれぞれの中で <code>CounterID</code>、それは順序付けられます <code>Date</code>.</p> <p>データに属する別のパーティションが分離の異なる部品です。 その背景にclickhouse合併しデータのパーツを効率的に保管します。 パーツに属する別のパーティションがないます。 マージメカニズムは、同じ主キーを持つすべての行が同じデータ部分にあることを保証しません。</p> <p>各データ部分は、論理的に顆粒に分割されます。 顆粒は、データを選択するときにclickhouseが読み取る最小の不可分のデータセットです。 clickhouseは行または値を分割しないため、各granule粒には常に整数の行が含まれます。 顆粒の最初の行は、行の主キーの値でマークされます。 各データ、clickhouseを作成しインデックスファイルを格納するのです。 各列について、主キーにあるかどうかにかかわらず、clickhouseには同じマークも格納されます。 これらのマークまたはデータを見つの直列のファイルです。</p> <p>微粒のサイズはによって制限されます <code>index_granularity</code> と <code>index_granularity_bytes</code> テーブルエンジンの設定。 微粒の列の数はで置きます <code>[1, index_granularity]</code> 行のサイズに応じた範囲。 顆粒のサイズは超えることができます <code>index_granularity_bytes</code> 単一行のサイズが設定の値より大きい場合。 この場合、顆粒のサイズは行のサイズに等しくなります。</p> <h2 id=primary-keys-and-indexes-in-queries>クエリの主キーとインデックス<a class=headerlink href=#primary-keys-and-indexes-in-queries title="Permanent link">&para;</a></h2> <p>を取る <code>(CounterID, Date)</code> 例として主キー。 この場合、並べ替えとインデックスは次のように示されます:</p> <div class=codehilite><pre><span></span><code><span class=w>  </span><span class=n>Whole</span><span class=w> </span><span class=k>data</span><span class=err>:</span><span class=w>     </span><span class=o>[</span><span class=n>---------------------------------------------</span><span class=o>]</span><span class=w></span>
<span class=w>  </span><span class=nl>CounterID</span><span class=p>:</span><span class=w>      </span><span class=o>[</span><span class=n>aaaaaaaaaaaaaaaaaabbbbcdeeeeeeeeeeeeefgggggggghhhhhhhhhiiiiiiiiikllllllll</span><span class=o>]</span><span class=w></span>
<span class=w>  </span><span class=nc>Date</span><span class=err>:</span><span class=w>           </span><span class=o>[</span><span class=n>1111111222222233331233211111222222333211111112122222223111112223311122333</span><span class=o>]</span><span class=w></span>
<span class=w>  </span><span class=nl>Marks</span><span class=p>:</span><span class=w>           </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w></span>
<span class=w>                  </span><span class=n>a</span><span class=p>,</span><span class=mi>1</span><span class=w>    </span><span class=n>a</span><span class=p>,</span><span class=mi>2</span><span class=w>    </span><span class=n>a</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>b</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>e</span><span class=p>,</span><span class=mi>2</span><span class=w>    </span><span class=n>e</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>g</span><span class=p>,</span><span class=mi>1</span><span class=w>    </span><span class=n>h</span><span class=p>,</span><span class=mi>2</span><span class=w>    </span><span class=n>i</span><span class=p>,</span><span class=mi>1</span><span class=w>    </span><span class=n>i</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>l</span><span class=p>,</span><span class=mi>3</span><span class=w></span>
<span class=w>  </span><span class=n>Marks</span><span class=w> </span><span class=nl>numbers</span><span class=p>:</span><span class=w>   </span><span class=mi>0</span><span class=w>      </span><span class=mi>1</span><span class=w>      </span><span class=mi>2</span><span class=w>      </span><span class=mi>3</span><span class=w>      </span><span class=mi>4</span><span class=w>      </span><span class=mi>5</span><span class=w>      </span><span class=mi>6</span><span class=w>      </span><span class=mi>7</span><span class=w>      </span><span class=mi>8</span><span class=w>      </span><span class=mi>9</span><span class=w>      </span><span class=mi>10</span><span class=w></span>
</code></pre></div> <p>デー:</p> <ul> <li><code>CounterID in ('a', 'h')</code>、サーバーはマークの範囲のデータを読み取ります <code>[0, 3)</code> と <code>[6, 8)</code>.</li> <li><code>CounterID IN ('a', 'h') AND Date = 3</code>、サーバーはマークの範囲のデータを読み取ります <code>[1, 3)</code> と <code>[7, 8)</code>.</li> <li><code>Date = 3</code>、サーバーは、マークの範囲内のデータを読み取ります <code>[1, 10]</code>.</li> </ul> <p>上記の例としては常に使用するのがより効果的指標により、フルスキャン！</p> <p>に乏指数で追加するデータを読み込みます。 主キーの単一の範囲を読み取るとき <code>index_granularity * 2</code> 余分な列の各データブロック読み取ることができます。</p> <p>疎指標できる作業は非常に多くのテーブル行において、多くの場合、指数はコンピュータのアプリです。</p> <p>ClickHouseは一意の主キーを必要としません。 同じ主キーで複数の行を挿入できます。</p> <h3 id=selecting-the-primary-key>主キーの選択<a class=headerlink href=#selecting-the-primary-key title="Permanent link">&para;</a></h3> <p>主キーの列数は明示的に制限されていません。 データ構造によっては、主キーに多かれ少なかれ列を含めることができます。 この:</p> <ul> <li> <p>インデックスのパフォーマン</p> <p>プライマリキーが <code>(a, b)</code> 次に、別の列を追加します <code>c</code> 次の条件が満たされるとパフォーマンスが向上します:</p> <ul> <li>列に条件があるクエリがあります <code>c</code>.</li> <li>長いデータ範囲(数倍長い <code>index_granularity</code>)の値が同じである場合 <code>(a, b)</code> 一般的です。 言い換えれば、別の列を追加すると、非常に長いデータ範囲をスキップできます。</li> </ul> </li> <li> <p>データ圧縮を改善する。</p> <p>ClickHouseは主キーでデータをソートするので、一貫性が高いほど圧縮率が高くなります。</p> </li> <li> <p>追加的なロジックが統合データ部分の <a href=../collapsingmergetree/#table_engine-collapsingmergetree>CollapsingMergeTree</a> と <a href=../summingmergetree/ >SummingMergeTree</a> エンジン</p> <p>この場合、それは指定することは理にかなって <em>ソートキー</em> これは主キーとは異なります。</p> </li> </ul> <p>長いprimary keyに悪影響を及ぼす可能性は、挿入性能やメモリ消費が別の列に主キーに影響を与えないclickhouse性能 <code>SELECT</code> クエリ。</p> <h3 id=choosing-a-primary-key-that-differs-from-the-sorting-key>ソートキーとは異なる主キーの選択<a class=headerlink href=#choosing-a-primary-key-that-differs-from-the-sorting-key title="Permanent link">&para;</a></h3> <p>ソートキー（データ部分の行をソートする式）とは異なる主キー（各マークのインデックスファイルに書き込まれる値を持つ式）を指定することができます。 この場合、主キー式タプルは、並べ替えキー式タプルのプレフィックスである必要があります。</p> <p>この機能は、 <a href=../summingmergetree/ >SummingMergeTree</a> と<br> <a href=../aggregatingmergetree/ >ﾂつｨﾂ姪"ﾂつ"ﾂ債ﾂづｭﾂつｹ</a> テーブルエンジン。 これらのエンジンを使用する一般的なケースでは、テーブルには二種類の列があります: <em>寸法</em> と <em>対策</em>. 典型的なクエリは、任意のメジャー列の値を集計します <code>GROUP BY</code> そして次元によるろ過。 SummingMergeTreeとAggregatingMergeTreeは、並べ替えキーの同じ値を持つ行を集計するので、すべての次元を追加するのが自然です。 その結果、キー式は長い列のリストで構成され、このリストは新しく追加されたディメンションで頻繁に更新される必要があります。</p> <p>この場合、主キーにいくつかの列だけを残して、効率的な範囲スキャンを提供し、残りのディメンション列を並べ替えキータプルに追加することが理に</p> <p><a href=../../../../sql_reference/statements/alter/ >ALTER</a> 新しい列がテーブルとソートキーに同時に追加されると、既存のデータパーツを変更する必要がないため、ソートキーの操作は軽量です。 古いソートキーは新しいソートキーの接頭辞であり、新しく追加された列にデータがないため、データはテーブル変更の時点で古いソートキーと新しいソートキーの両方</p> <h3 id=use-of-indexes-and-partitions-in-queries>クエリでの索引とパーティションの使用<a class=headerlink href=#use-of-indexes-and-partitions-in-queries title="Permanent link">&para;</a></h3> <p>のために <code>SELECT</code> ClickHouseは、インデックスを使用できるかどうかを分析します。 インデックスが使用できるのは、 <code>WHERE/PREWHERE</code> 句には、等式または不等式の比較演算を表す式（連結要素のいずれかとして、または完全に）があります。 <code>IN</code> または <code>LIKE</code> 主キーまたはパーティショニングキーに含まれる列または式、またはこれらの列の特定の部分反復関数、またはこれらの式の論理関係に固定プレフィッ</p> <p>したがって、主キーの一つまたは複数の範囲でクエリをすばやく実行することができます。 この例では、特定のトラッキングタグ、特定のタグおよび日付範囲、特定のタグおよび日付、日付範囲を持つ複数のタグなどに対して実行すると、クエ</p> <p>次のように構成されたエンジンを見てみましょう:</p> <div class=codehilite><pre><span></span><code><span class=err>  ENGINE MergeTree() PARTITION BY toYYYYMM(EventDate) ORDER BY (CounterID, EventDate) SETTINGS index_granularity=8192</span>
</code></pre></div> <p>この場合、クエリで:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>EventDate</span> <span class=o>=</span> <span class=n>toDate</span><span class=p>(</span><span class=n>now</span><span class=p>())</span> <span class=k>AND</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>34</span>
<span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>EventDate</span> <span class=o>=</span> <span class=n>toDate</span><span class=p>(</span><span class=n>now</span><span class=p>())</span> <span class=k>AND</span> <span class=p>(</span><span class=n>CounterID</span> <span class=o>=</span> <span class=mi>34</span> <span class=k>OR</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>42</span><span class=p>)</span>
<span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=p>((</span><span class=n>EventDate</span> <span class=o>&gt;=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-01-01&#39;</span><span class=p>)</span> <span class=k>AND</span> <span class=n>EventDate</span> <span class=o>&lt;=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-01-31&#39;</span><span class=p>))</span> <span class=k>OR</span> <span class=n>EventDate</span> <span class=o>=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-05-01&#39;</span><span class=p>))</span> <span class=k>AND</span> <span class=n>CounterID</span> <span class=k>IN</span> <span class=p>(</span><span class=mi>101500</span><span class=p>,</span> <span class=mi>731962</span><span class=p>,</span> <span class=mi>160656</span><span class=p>)</span> <span class=k>AND</span> <span class=p>(</span><span class=n>CounterID</span> <span class=o>=</span> <span class=mi>101500</span> <span class=k>OR</span> <span class=n>EventDate</span> <span class=o>!=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-05-01&#39;</span><span class=p>))</span>
</code></pre></div> <p>ClickHouseの主キー指標のトリムで不正なデータを毎月パーティショニングキーパンフレット、ホームページの間仕切りする不適切な日。</p> <p>上記のクエリのインデックスが使用されるときにも複雑な表現です。 テーブルからの読み取りがいを使用した指標できないっぱいたします。</p> <p>以下の例では、インデックスは使用できません。</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>34</span> <span class=k>OR</span> <span class=n>URL</span> <span class=k>LIKE</span> <span class=s1>&#39;%upyachka%&#39;</span>
</code></pre></div> <p>確認clickhouseできるとの利用時の走行クエリに対して、使用の設定 <a href=../../../../operations/settings/settings/#settings-force_index_by_date>force_index_by_date</a> と <a href=../../../../operations/settings/settings/ >force_primary_key</a>.</p> <p>の分割による月で読み込みのみこれらのデータブロックを含むからスピーチへのマークの範囲内で適切に取扱います。 この場合、データブロックには多くの日付（月全体まで）のデータが含まれることがあります。 ブロック内では、データは主キーによってソートされます。 このため、主キープレフィックスを指定しない日付条件のみを持つクエリを使用すると、単一の日付よりも多くのデータが読み取られます。</p> <h3 id=use-of-index-for-partially-monotonic-primary-keys>部分的に単調な主キーに対するインデックスの使用<a class=headerlink href=#use-of-index-for-partially-monotonic-primary-keys title="Permanent link">&para;</a></h3> <p>たとえば、月の日数を考えてみましょう。 彼らは形成する <a href=https://en.wikipedia.org/wiki/Monotonic_function rel="external nofollow noreferrer">単調系列</a> 一ヶ月のために、しかし、より長期間単調ではありません。 これは部分的に単調なシーケンスです。 ユーザーが部分的に単調な主キーを持つテーブルを作成する場合、ClickHouseは通常どおりスパースインデックスを作成します。 ユーザーがこの種類のテーブルからデータを選択すると、ClickHouseはクエリ条件を分析します。 ユーザーは、インデックスの二つのマークの間のデータを取得したいと、これらのマークの両方が一ヶ月以内に落ちる場合、それはクエリとインデックスマーク</p> <p>クエリパラメーターの範囲内の主キーの値が単調順序を表さない場合、clickhouseはインデックスを使用できません。 この場合、clickhouseはフルスキャン方式を使用します。</p> <p>ClickHouseは、月シーケンスの日数だけでなく、部分的に単調なシーケンスを表すプライマリキーについても、このロジックを使用します。</p> <h3 id=table_engine-mergetree-data_skipping-indexes>データスキップインデックス(実験)<a class=headerlink href=#table_engine-mergetree-data_skipping-indexes title="Permanent link">&para;</a></h3> <p>インデックス宣言は、次の列セクションにあります <code>CREATE</code> クエリ。</p> <div class=codehilite><pre><span></span><code><span class=k>INDEX</span> <span class=n>index_name</span> <span class=n>expr</span> <span class=k>TYPE</span> <span class=k>type</span><span class=p>(...)</span> <span class=n>GRANULARITY</span> <span class=n>granularity_value</span>
</code></pre></div> <p>からのテーブルの場合 <code>*MergeTree</code> 家族データの飛び指標を指定できます。</p> <p>これらのインデックスは、ブロックの指定された式に関する情報を集約します。 <code>granularity_value</code> 微粒（微粒のサイズはを使用して指定されます <code>index_granularity</code> テーブルエンジンの設定）。 次に、これらの集約は <code>SELECT</code> ディスクから読み取るデータの量を減らすためのクエリ <code>where</code> クエリは満たされません。</p> <p><strong>例えば</strong></p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=k>table_name</span>
<span class=p>(</span>
    <span class=n>u64</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>i32</span> <span class=n>Int32</span><span class=p>,</span>
    <span class=n>s</span> <span class=n>String</span><span class=p>,</span>
    <span class=p>...</span>
    <span class=k>INDEX</span> <span class=n>a</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=n>i32</span><span class=p>,</span> <span class=n>s</span><span class=p>)</span> <span class=k>TYPE</span> <span class=n>minmax</span> <span class=n>GRANULARITY</span> <span class=mi>3</span><span class=p>,</span>
    <span class=k>INDEX</span> <span class=n>b</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>s</span><span class=p>))</span> <span class=k>TYPE</span> <span class=k>set</span><span class=p>(</span><span class=mi>1000</span><span class=p>)</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span><span class=p>()</span>
<span class=p>...</span>
</code></pre></div> <p>この例のインデックスをclickhouseで使用すると、次のクエリでディスクから読み取るデータの量を減らすことができます:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>s</span> <span class=o>&lt;</span> <span class=s1>&#39;z&#39;</span>
<span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>u64</span> <span class=o>*</span> <span class=n>i32</span> <span class=o>==</span> <span class=mi>10</span> <span class=k>AND</span> <span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>1234</span>
</code></pre></div> <h4 id=available-types-of-indices>使用可能なインデックスの種類<a class=headerlink href=#available-types-of-indices title="Permanent link">&para;</a></h4> <ul> <li> <p><code>minmax</code></p> <p>指定された式の極値を格納します(式が指定されている場合 <code>tuple</code> そして、それは各要素のための極端をの貯えます <code>tuple</code>)を使用して保存情報の飛びブロックのようなデータは、その有効なタイプを利用します。</p> </li> <li> <p><code>set(max_rows)</code></p> <p>指定された式の一意の値を格納します。 <code>max_rows</code> 行, <code>max_rows=0</code> 意味 “no limits”). この値を使用して、 <code>WHERE</code> 式はデータブロックでは充足可能ではありません。</p> </li> <li> <p><code>ngrambf_v1(n, size_of_bloom_filter_in_bytes, number_of_hash_functions, random_seed)</code></p> <p>店a <a href=https://en.wikipedia.org/wiki/Bloom_filter rel="external nofollow noreferrer">Bloom filter</a> これには、データブロックのすべてのngramsが含まれます。 文字列でのみ動作します。 の最適化に使用することができます <code>equals</code>, <code>like</code> と <code>in</code> 式。</p> <ul> <li><code>n</code> — ngram size,</li> <li><code>size_of_bloom_filter_in_bytes</code> — Bloom filter size in bytes (you can use large values here, for example, 256 or 512, because it can be compressed well).</li> <li><code>number_of_hash_functions</code> — The number of hash functions used in the Bloom filter.</li> <li><code>random_seed</code> — The seed for Bloom filter hash functions.</li> </ul> </li> <li> <p><code>tokenbf_v1(size_of_bloom_filter_in_bytes, number_of_hash_functions, random_seed)</code></p> <p>同じように <code>ngrambf_v1</code> しかし、ngramsの代わりにトークンを格納します。 トークンは、英数字以外の文字で区切られた順序です。</p> </li> <li> <p><code>bloom_filter([false_positive])</code> — Stores a <a href=https://en.wikipedia.org/wiki/Bloom_filter rel="external nofollow noreferrer">Bloom filter</a> 指定された列の場合。</p> <p>任意 <code>false_positive</code> パラメーターは、フィルターから偽陽性の応答を受信する確率です。 可能な値:(0,1)。 デフォルト値:0.025.</p> <p>対応データ型: <code>Int*</code>, <code>UInt*</code>, <code>Float*</code>, <code>Enum</code>, <code>Date</code>, <code>DateTime</code>, <code>String</code>, <code>FixedString</code>, <code>Array</code>, <code>LowCardinality</code>, <code>Nullable</code>.</p> <p>次の関数はそれを使用できます: <a href=../../../../sql_reference/functions/comparison_functions/ >等しい</a>, <a href=../../../../sql_reference/functions/comparison_functions/ >notEquals</a>, <a href=../../../../sql_reference/functions/in_functions/ >で</a>, <a href=../../../../sql_reference/functions/in_functions/ >notIn</a>, <a href=../../../../sql_reference/functions/array_functions/ >持っている</a>.</p> </li> </ul> <!-- --> <div class=codehilite><pre><span></span><code><span class=k>INDEX</span> <span class=n>sample_index</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>s</span><span class=p>))</span> <span class=k>TYPE</span> <span class=n>minmax</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
<span class=k>INDEX</span> <span class=n>sample_index2</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>str</span><span class=p>),</span> <span class=n>i32</span> <span class=o>+</span> <span class=n>f64</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=nb>date</span><span class=p>,</span> <span class=n>str</span><span class=p>)</span> <span class=k>TYPE</span> <span class=k>set</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
<span class=k>INDEX</span> <span class=n>sample_index3</span> <span class=p>(</span><span class=k>lower</span><span class=p>(</span><span class=n>str</span><span class=p>),</span> <span class=n>str</span><span class=p>)</span> <span class=k>TYPE</span> <span class=n>ngrambf_v1</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>256</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
</code></pre></div> <h4 id=functions-support>機能サポート<a class=headerlink href=#functions-support title="Permanent link">&para;</a></h4> <p>の条件 <code>WHERE</code> clauseには、列で操作する関数の呼び出しが含まれます。 列がインデックスの一部である場合、ClickHouseは関数の実行時にこのインデックスを使用しようとします。 ClickHouse支援の異なるサブセットの機能を使用。</p> <p>その <code>set</code> indexは、すべての関数で使用できます。 他のインデックスの関数サブセットを以下の表に示します。</p> <table> <thead> <tr> <th>関数(演算子)/インデックス</th> <th>主キー</th> <th>minmax</th> <th>ngrambf_v1</th> <th>tokenbf_v1</th> <th>bloom_filter</th> </tr> </thead> <tbody> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-equals>equals(=,==))</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-notequals>notEquals(!=, \&lt;>)</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_search_functions/#function-like>のように</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_search_functions/#function-notlike>notLike</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_functions/#startswith>startsWith</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_functions/#endswith>エンドスウィス</a></td> <td>✗</td> <td>✗</td> <td>✔</td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_search_functions/#function-multisearchany>マルチセアチャンネル</a></td> <td>✗</td> <td>✗</td> <td>✔</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/in_functions/#in-functions>で</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/in_functions/#in-functions>notIn</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-less>less(\&lt;)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-greater>グレーター(>)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-lessorequals>lessOrEquals(\&lt;=)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-greaterorequals>greaterOrEquals(>=)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/array_functions/#function-empty>空</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/array_functions/#function-notempty>notEmpty</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td>ハストケンcity in germany</td> <td>✗</td> <td>✗</td> <td>✗</td> <td>✔</td> <td>✗</td> </tr> </tbody> </table> <p>Ngramサイズより小さい定数引数を持つ関数は、 <code>ngrambf_v1</code> クエリの最適化のため。</p> <p>ブルでは偽陽性一致すので、 <code>ngrambf_v1</code>, <code>tokenbf_v1</code>、と <code>bloom_filter</code> インデックスは、関数の結果がfalseであると予想されるクエリの最適化には使用できません。:</p> <ul> <li>最適化することができる:<ul> <li><code>s LIKE '%test%'</code></li> <li><code>NOT s NOT LIKE '%test%'</code></li> <li><code>s = 1</code></li> <li><code>NOT s != 1</code></li> <li><code>startsWith(s, 'test')</code></li> </ul> </li> <li>最適化できません:<ul> <li><code>NOT s LIKE '%test%'</code></li> <li><code>s NOT LIKE '%test%'</code></li> <li><code>NOT s = 1</code></li> <li><code>s != 1</code></li> <li><code>NOT startsWith(s, 'test')</code></li> </ul> </li> </ul> <h2 id=concurrent-data-access>同時データアクセス<a class=headerlink href=#concurrent-data-access title="Permanent link">&para;</a></h2> <p>同時テーブルアクセスでは、マルチバージョンを使用します。 つまり、テーブルが同時に読み取られて更新されると、クエリ時に現在のパーツのセットからデータが読み取られます。 長いロックはありません。 挿入は読み取り操作の方法では得られません。</p> <p>テーブルからの読み取りは自動的に並列化されます。</p> <h2 id=table_engine-mergetree-ttl>列とテーブルのttl<a class=headerlink href=#table_engine-mergetree-ttl title="Permanent link">&para;</a></h2> <p>値の存続期間を決定します。</p> <p>その <code>TTL</code> 句は、テーブル全体と個々の列ごとに設定することができます。 テーブルレベルのTTLで指定した論理の自動移動のデータディスクの間とします。</p> <p>式は評価する必要があります <a href=../../../../sql_reference/data_types/date/ >日付</a> または <a href=../../../../sql_reference/data_types/datetime/ >DateTime</a> データ型。</p> <p>例えば:</p> <div class=codehilite><pre><span></span><code><span class=n>TTL</span> <span class=n>time_column</span>
<span class=n>TTL</span> <span class=n>time_column</span> <span class=o>+</span> <span class=nb>interval</span>
</code></pre></div> <p>定義する <code>interval</code>、使用 <a href=../../../../sql_reference/operators/#operators-datetime>時間間隔</a> 演算子。</p> <div class=codehilite><pre><span></span><code><span class=n>TTL</span> <span class=n>date_time</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span>
<span class=n>TTL</span> <span class=n>date_time</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>15</span> <span class=n>HOUR</span>
</code></pre></div> <h3 id=mergetree-column-ttl>列ttl<a class=headerlink href=#mergetree-column-ttl title="Permanent link">&para;</a></h3> <p>列の値が期限切れになると、clickhouseは列のデータ型の既定値に置き換えます。 すべてのカラム値のデータ部分を切clickhouse削除するこのカラムからのデータにファイルシステム.</p> <p>その <code>TTL</code> キー列には句を使用できません。</p> <p>例:</p> <p>TTLを使用したテーブルの作成</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>example_table</span>
<span class=p>(</span>
    <span class=n>d</span> <span class=n>DateTime</span><span class=p>,</span>
    <span class=n>a</span> <span class=nb>Int</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span><span class=p>,</span>
    <span class=n>b</span> <span class=nb>Int</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span><span class=p>,</span>
    <span class=k>c</span> <span class=n>String</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>d</span><span class=p>;</span>
</code></pre></div> <p>既存のテーブルの列にttlを追加する</p> <div class=codehilite><pre><span></span><code><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>example_table</span>
    <span class=k>MODIFY</span> <span class=k>COLUMN</span>
    <span class=k>c</span> <span class=n>String</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>DAY</span><span class=p>;</span>
</code></pre></div> <p>列のttlの変更</p> <div class=codehilite><pre><span></span><code><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>example_table</span>
    <span class=k>MODIFY</span> <span class=k>COLUMN</span>
    <span class=k>c</span> <span class=n>String</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span><span class=p>;</span>
</code></pre></div> <h3 id=mergetree-table-ttl>テーブルttl<a class=headerlink href=#mergetree-table-ttl title="Permanent link">&para;</a></h3> <p>テーブルでの表現の除去に終了しました列、複数の表現を自動で部品の移動と <a href=#table_engine-mergetree-multiple-volumes>ディスク</a>. 時テーブルの行の有効期間ClickHouseをすべて削除して対応さい。 部品移動フィーチャの場合、部品のすべての行が移動式の基準を満たしている必要があります。</p> <div class=codehilite><pre><span></span><code><span class=n>TTL</span> <span class=n>expr</span> <span class=p>[</span><span class=k>DELETE</span><span class=o>|</span><span class=k>TO</span> <span class=n>DISK</span> <span class=s1>&#39;aaa&#39;</span><span class=o>|</span><span class=k>TO</span> <span class=n>VOLUME</span> <span class=s1>&#39;bbb&#39;</span><span class=p>],</span> <span class=p>...</span>
</code></pre></div> <p>TTLルールのタイプは、各TTL式に従います。 これは、式が満たされると実行されるアクションに影響します（現在の時間に達します):</p> <ul> <li><code>DELETE</code> 削除行を終了しました(デフォルトアクション);</li> <li><code>TO DISK 'aaa'</code> -ディスクに部品を移動 <code>aaa</code>;</li> <li><code>TO VOLUME 'bbb'</code> -ディスクに部品を移動 <code>bbb</code>.</li> </ul> <p>例:</p> <p>TTLを使用したテーブルの作成</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>example_table</span>
<span class=p>(</span>
    <span class=n>d</span> <span class=n>DateTime</span><span class=p>,</span>
    <span class=n>a</span> <span class=nb>Int</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>d</span>
<span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span> <span class=p>[</span><span class=k>DELETE</span><span class=p>],</span>
    <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=n>WEEK</span> <span class=k>TO</span> <span class=n>VOLUME</span> <span class=s1>&#39;aaa&#39;</span><span class=p>,</span>
    <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>2</span> <span class=n>WEEK</span> <span class=k>TO</span> <span class=n>DISK</span> <span class=s1>&#39;bbb&#39;</span><span class=p>;</span>
</code></pre></div> <p>テーブルのttlの変更</p> <div class=codehilite><pre><span></span><code><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>example_table</span>
    <span class=k>MODIFY</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>DAY</span><span class=p>;</span>
</code></pre></div> <p><strong>データの削除</strong></p> <p>データ切れのttlを取り除きclickhouse合併しデータの部品です。</p> <p>時clickhouseるデータの期間は終了しましたので、行offスケジュール内スケジュールする必要がありません。 このようなマージの頻度を制御するには、次のように設定します <a href=#mergetree_setting-merge_with_ttl_timeout>merge_with_ttl_timeout</a>. 値が低すぎる場合は、多くのリソースを消費する可能性のある多くのオフスケジュールマージを実行します。</p> <p>あなたが実行する場合 <code>SELECT</code> 期限切れのデータを取得できます。 それを避けるために、を使用 <a href=../../../../sql_reference/statements/misc/#misc_operations-optimize>OPTIMIZE</a> 前にクエリ <code>SELECT</code>.</p> <h2 id=table_engine-mergetree-multiple-volumes>複数ブロックデバイスを使用したデータ保存<a class=headerlink href=#table_engine-mergetree-multiple-volumes title="Permanent link">&para;</a></h2> <h3 id=introduction>導入<a class=headerlink href=#introduction title="Permanent link">&para;</a></h3> <p><code>MergeTree</code> 家族のテーブルエンジンでデータを複数のブロックデバイス たとえば、特定のテーブルのデータが暗黙的に分割されている場合に便利です “hot” と “cold”. 最新のデータは定期的に要求されますが、必要な領域はわずかです。 それどころか、fat-tailed履歴データはまれに要求される。 複数のディスクが使用可能な場合は、 “hot” データは高速ディスク(たとえば、NVMe Ssdまたはメモリ内)にあります。 “cold” データ-比較的遅いもの（例えば、HDD）。</p> <p>データ部分は最低の移動可能な単位のためのです <code>MergeTree</code>-エンジンテーブル。 ある部分に属するデータは、あるディスクに格納されます。 データ部分は背景のディスクの間で（ユーザーの設定に従って）、またによって動かすことができます <a href=../../../../sql_reference/statements/alter/#alter_move-partition>ALTER</a> クエリ。</p> <h3 id=terms>条件<a class=headerlink href=#terms title="Permanent link">&para;</a></h3> <ul> <li>Disk — Block device mounted to the filesystem.</li> <li>Default disk — Disk that stores the path specified in the <a href=../../../../operations/server_configuration_parameters/settings/#server_configuration_parameters-path>パス</a> サーバー設定。</li> <li>Volume — Ordered set of equal disks (similar to <a href=https://en.wikipedia.org/wiki/Non-RAID_drive_architectures rel="external nofollow noreferrer">JBOD</a>).</li> <li>Storage policy — Set of volumes and the rules for moving data between them.</li> </ul> <p>の名称を記載することから、システムテーブル, <a href=../../../../operations/system_tables/#system_tables-storage_policies>システム。ストレージ_policies</a> と <a href=../../../../operations/system_tables/#system_tables-disks>システム。ディスク</a>. テーブ <code>storage_policy</code> の設定 <code>MergeTree</code>-エンジン家族のテーブル。</p> <h3 id=table_engine-mergetree-multiple-volumes-configure>設定<a class=headerlink href=#table_engine-mergetree-multiple-volumes-configure title="Permanent link">&para;</a></h3> <p>ディスク、ボリューム、およびストレージポリシーは、 <code>&lt;storage_configuration&gt;</code> メインファイルのいずれかのタグ <code>config.xml</code> または、 <code>config.d</code> ディレクトリ。</p> <p>構成の構造:</p> <div class=codehilite><pre><span></span><code><span class=nt>&lt;storage_configuration&gt;</span>
    <span class=nt>&lt;disks&gt;</span>
        <span class=nt>&lt;disk_name_1&gt;</span> <span class=c>&lt;!-- disk name --&gt;</span>
            <span class=nt>&lt;path&gt;</span>/mnt/fast_ssd/clickhouse<span class=nt>&lt;/path&gt;</span>
        <span class=nt>&lt;/disk_name_1&gt;</span>
        <span class=nt>&lt;disk_name_2&gt;</span>
            <span class=nt>&lt;path&gt;</span>/mnt/hdd1/clickhouse<span class=nt>&lt;/path&gt;</span>
            <span class=nt>&lt;keep_free_space_bytes&gt;</span>10485760<span class=nt>&lt;/keep_free_space_bytes&gt;</span>
        <span class=nt>&lt;/disk_name_2&gt;</span>
        <span class=nt>&lt;disk_name_3&gt;</span>
            <span class=nt>&lt;path&gt;</span>/mnt/hdd2/clickhouse<span class=nt>&lt;/path&gt;</span>
            <span class=nt>&lt;keep_free_space_bytes&gt;</span>10485760<span class=nt>&lt;/keep_free_space_bytes&gt;</span>
        <span class=nt>&lt;/disk_name_3&gt;</span>

        ...
    <span class=nt>&lt;/disks&gt;</span>

    ...
<span class=nt>&lt;/storage_configuration&gt;</span>
</code></pre></div> <p>タグ:</p> <ul> <li><code>&lt;disk_name_N&gt;</code> — Disk name. Names must be different for all disks.</li> <li><code>path</code> — path under which a server will store data (<code>data</code> と <code>shadow</code> フォルダ）で終了する必要があります。 ‘/’.</li> <li><code>keep_free_space_bytes</code> — the amount of free disk space to be reserved.</li> </ul> <p>ディスク定義の順序は重要ではありません。</p> <p>ストレージポリシ:</p> <div class=codehilite><pre><span></span><code><span class=nt>&lt;storage_configuration&gt;</span>
    ...
    <span class=nt>&lt;policies&gt;</span>
        <span class=nt>&lt;policy_name_1&gt;</span>
            <span class=nt>&lt;volumes&gt;</span>
                <span class=nt>&lt;volume_name_1&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk_name_from_disks_configuration<span class=nt>&lt;/disk&gt;</span>
                    <span class=nt>&lt;max_data_part_size_bytes&gt;</span>1073741824<span class=nt>&lt;/max_data_part_size_bytes&gt;</span>
                <span class=nt>&lt;/volume_name_1&gt;</span>
                <span class=nt>&lt;volume_name_2&gt;</span>
                    <span class=c>&lt;!-- configuration --&gt;</span>
                <span class=nt>&lt;/volume_name_2&gt;</span>
                <span class=c>&lt;!-- more volumes --&gt;</span>
            <span class=nt>&lt;/volumes&gt;</span>
            <span class=nt>&lt;move_factor&gt;</span>0.2<span class=nt>&lt;/move_factor&gt;</span>
        <span class=nt>&lt;/policy_name_1&gt;</span>
        <span class=nt>&lt;policy_name_2&gt;</span>
            <span class=c>&lt;!-- configuration --&gt;</span>
        <span class=nt>&lt;/policy_name_2&gt;</span>

        <span class=c>&lt;!-- more policies --&gt;</span>
    <span class=nt>&lt;/policies&gt;</span>
    ...
<span class=nt>&lt;/storage_configuration&gt;</span>
</code></pre></div> <p>タグ:</p> <ul> <li><code>policy_name_N</code> — Policy name. Policy names must be unique.</li> <li><code>volume_name_N</code> — Volume name. Volume names must be unique.</li> <li><code>disk</code> — a disk within a volume.</li> <li><code>max_data_part_size_bytes</code> — the maximum size of a part that can be stored on any of the volume's disks.</li> <li><code>move_factor</code> — when the amount of available space gets lower than this factor, data automatically start to move on the next volume if any (by default, 0.1).</li> </ul> <p>Cofigurationの例:</p> <div class=codehilite><pre><span></span><code><span class=nt>&lt;storage_configuration&gt;</span>
    ...
    <span class=nt>&lt;policies&gt;</span>
        <span class=nt>&lt;hdd_in_order&gt;</span> <span class=c>&lt;!-- policy name --&gt;</span>
            <span class=nt>&lt;volumes&gt;</span>
                <span class=nt>&lt;single&gt;</span> <span class=c>&lt;!-- volume name --&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk1<span class=nt>&lt;/disk&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk2<span class=nt>&lt;/disk&gt;</span>
                <span class=nt>&lt;/single&gt;</span>
            <span class=nt>&lt;/volumes&gt;</span>
        <span class=nt>&lt;/hdd_in_order&gt;</span>

        <span class=nt>&lt;moving_from_ssd_to_hdd&gt;</span>
            <span class=nt>&lt;volumes&gt;</span>
                <span class=nt>&lt;hot&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>fast_ssd<span class=nt>&lt;/disk&gt;</span>
                    <span class=nt>&lt;max_data_part_size_bytes&gt;</span>1073741824<span class=nt>&lt;/max_data_part_size_bytes&gt;</span>
                <span class=nt>&lt;/hot&gt;</span>
                <span class=nt>&lt;cold&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk1<span class=nt>&lt;/disk&gt;</span>
                <span class=nt>&lt;/cold&gt;</span>
            <span class=nt>&lt;/volumes&gt;</span>
            <span class=nt>&lt;move_factor&gt;</span>0.2<span class=nt>&lt;/move_factor&gt;</span>
        <span class=nt>&lt;/moving_from_ssd_to_hdd&gt;</span>
    <span class=nt>&lt;/policies&gt;</span>
    ...
<span class=nt>&lt;/storage_configuration&gt;</span>
</code></pre></div> <p>与えられた例では、 <code>hdd_in_order</code> ポリシーの実装 <a href=https://en.wikipedia.org/wiki/Round-robin_scheduling rel="external nofollow noreferrer">ラウンドロビン</a> アプローチ。 したがって、このポリシ (<code>single</code>)データパーツは、すべてのディスクに循環順序で格納されます。 こうした政策れぞれの知見について学ぶとともに有が複数ある場合は同様のディスク搭載のシステムがRAIDな設定を行います。 個々のディスクドライブはそれぞれ信頼できないため、複製係数が3以上になるように補正する必要があることに注意してください。</p> <p>システムで使用可能なディスクの種類が異なる場合, <code>moving_from_ssd_to_hdd</code> ポリシーは代わりに使用できます。 ボリューム <code>hot</code> SSDディスクで構成されています (<code>fast_ssd</code>このボリュームに格納できるパーツの最大サイズは1GBです。 サイズが1GBより大きいすべての部品はで直接貯えられます <code>cold</code> HDDディスクを含むボリューム <code>disk1</code>.<br> また、一度ディスク <code>fast_ssd</code> 80%以上によって満たされて得ます、データはに移ります <code>disk1</code> 背景プロセ</p> <p>ストレージポリシー内のボリューム列挙の順序は重要です。 ボリュームがオーバーフィルされると、データは次のものに移動されます。 ディスク列挙の順序は、データが順番に格納されるため、重要です。</p> <p>作成時にテーブルは、適用の設定を保存方針で:</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>table_with_non_default_policy</span> <span class=p>(</span>
    <span class=n>EventDate</span> <span class=nb>Date</span><span class=p>,</span>
    <span class=n>OrderID</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>BannerID</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>SearchPhrase</span> <span class=n>String</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=p>(</span><span class=n>OrderID</span><span class=p>,</span> <span class=n>BannerID</span><span class=p>)</span>
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>EventDate</span><span class=p>)</span>
<span class=n>SETTINGS</span> <span class=n>storage_policy</span> <span class=o>=</span> <span class=s1>&#39;moving_from_ssd_to_hdd&#39;</span>
</code></pre></div> <p>その <code>default</code> ストレージポリシーは、ボリュームを一つだけ使用することを意味します。 <code>&lt;path&gt;</code>. テーブルを作成すると、そのストレージポリシーは変更できません。</p> <h3 id=details>詳細<a class=headerlink href=#details title="Permanent link">&para;</a></h3> <p>の場合 <code>MergeTree</code> テーブル、データがあるディスクには、異なる方法:</p> <ul> <li>挿入の結果として (<code>INSERT</code> クエリ）。</li> <li>バックグラウンドマージ時 <a href=../../../../sql_reference/statements/alter/#alter-mutations>突然変異</a>.</li> <li>別のレプリカか</li> <li>仕切りの凍結の結果として <a href=../../../../sql_reference/statements/alter/#alter_freeze-partition>ALTER TABLE … FREEZE PARTITION</a>.</li> </ul> <p>すべてのこれらの場合を除き、突然変異とパーティションの凍結は、一部が保存され、大量のディスクに保存政策:</p> <ol> <li>パートを格納するのに十分なディスク領域を持つ最初のボリューム(定義の順序で) (<code>unreserved_space &gt; current_part_size</code>)特定のサイズの部品を格納することができます (<code>max_data_part_size_bytes &gt; current_part_size</code>)が選択されます。</li> <li>このボリューム内では、前のデータチャンクを格納するために使用されたディスクに続くディスクが選択され、パーツサイズよりも空き領域が多くなり (<code>unreserved_space - keep_free_space_bytes &gt; current_part_size</code>).</li> </ol> <p>フードの下で、突然変異および仕切りの凍結は利用します <a href=https://en.wikipedia.org/wiki/Hard_link rel="external nofollow noreferrer">ハードリンク</a>. ハードリンクとディスクには対応していないため、この場合、パーツの保管と同じディスクの初期ます。</p> <p>バックグラウンドでは、空き領域の量に基づいて部品がボリューム間で移動されます (<code>move_factor</code> パラメータ)順序に従って、設定ファイルでボリュームが宣言されます。<br> データは最後のものから最初のものに転送されません。 システムテーブルを使用できる <a href=../../../../operations/system_tables/#system_tables-part-log>システム。part_log</a> (フィールド <code>type = MOVE_PART</code>） <a href=../../../../operations/system_tables/#system_tables-parts>システム。パーツ</a> (フィールド <code>path</code> と <code>disk</code>）背景の動きを監視する。 また、詳細な情報はサーバーログに記載されています。</p> <p>ユーザーの力で移動中の一部またはパーティションから量別のクエリ <a href=../../../../sql_reference/statements/alter/#alter_move-partition>ALTER TABLE … MOVE PART|PARTITION … TO VOLUME|DISK …</a>、バックグラウンド操作のすべての制限が考慮されます。 クエリは単独で移動を開始し、バックグラウンド操作が完了するのを待機しません。 十分な空き領域がない場合、または必要な条件のいずれかが満たされない場合、ユーザーはエラーメッセージが表示されます。</p> <p>データの移動はデータの複製を妨げません。 そのため、異なる保管方針を指定することができ、同じテーブルの異なるレプリカ.</p> <p>バックグラウンドマージと突然変異の完了後、古い部分は一定時間後にのみ削除されます (<code>old_parts_lifetime</code>).<br> この間、他のボリュームやディスクに移動されることはありません。 したがって、部品が最終的に取り外されるまで、それらはまだ占有ディスクスペースの評価のために考慮される。</p> </div> <div id=content-footer class="text-muted pt-5"> <div class=float-right>©2016–2020 Yandex LLC</div> <div>から構築 <a href=https://github.com/ClickHouse/ClickHouse/commit/25eae6abe035bda78634f17d15c9f05348d97aad rel="external nofollow noreferrer" target=_blank class=text-reset>25eae6abe0</a></div> </div> </div> <div id=toc class="col-xl-2 d-none d-xl-block d-print-none p-3 overflow-auto toc-right mb-5"> <nav class="nav flex-column text-wrap"> <label for=toc>テーブルの内容</label> <a href=#table_engine-mergetree-creating-a-table title=テーブルの作成 class="nav-link text-wrap d-inline-block w-100"> テーブルの作成 </a> <nav id=toc-toc-1 class="nav flex-column pl-2"> <a href=#mergetree-query-clauses title=クエリ句 class="nav-link text-wrap d-inline-block w-100"> クエリ句 </a> </nav> <a href=#mergetree-data-storage title=データ記憶 class="nav-link text-wrap d-inline-block w-100"> データ記憶 </a> <a href=#primary-keys-and-indexes-in-queries title=クエリの主キーとインデックス class="nav-link text-wrap d-inline-block w-100"> クエリの主キーとインデックス </a> <nav id=toc-toc-3 class="nav flex-column pl-2"> <a href=#selecting-the-primary-key title=主キーの選択 class="nav-link text-wrap d-inline-block w-100"> 主キーの選択 </a> <a href=#choosing-a-primary-key-that-differs-from-the-sorting-key title=ソートキーとは異なる主キーの選択 class="nav-link text-wrap d-inline-block w-100"> ソートキーとは異なる主キーの選択 </a> <a href=#use-of-indexes-and-partitions-in-queries title=クエリでの索引とパーティションの使用 class="nav-link text-wrap d-inline-block w-100"> クエリでの索引とパーティションの使用 </a> <a href=#use-of-index-for-partially-monotonic-primary-keys title=部分的に単調な主キーに対するインデックスの使用 class="nav-link text-wrap d-inline-block w-100"> 部分的に単調な主キーに対するインデックスの使用 </a> <a href=#table_engine-mergetree-data_skipping-indexes title=データスキップインデックス(実験) class="nav-link text-wrap d-inline-block w-100"> データスキップインデックス(実験) </a> <nav id=toc-toc-3-5 class="nav flex-column pl-2"> <a href=#available-types-of-indices title=使用可能なインデックスの種類 class="nav-link text-wrap d-inline-block w-100"> 使用可能なインデックスの種類 </a> <a href=#functions-support title=機能サポート class="nav-link text-wrap d-inline-block w-100"> 機能サポート </a> </nav> </nav> <a href=#concurrent-data-access title=同時データアクセス class="nav-link text-wrap d-inline-block w-100"> 同時データアクセス </a> <a href=#table_engine-mergetree-ttl title=列とテーブルのttl class="nav-link text-wrap d-inline-block w-100"> 列とテーブルのttl </a> <nav id=toc-toc-5 class="nav flex-column pl-2"> <a href=#mergetree-column-ttl title=列ttl class="nav-link text-wrap d-inline-block w-100"> 列ttl </a> <a href=#mergetree-table-ttl title=テーブルttl class="nav-link text-wrap d-inline-block w-100"> テーブルttl </a> </nav> <a href=#table_engine-mergetree-multiple-volumes title=複数ブロックデバイスを使用したデータ保存 class="nav-link text-wrap d-inline-block w-100"> 複数ブロックデバイスを使用したデータ保存 </a> <nav id=toc-toc-6 class="nav flex-column pl-2"> <a href=#introduction title=導入 class="nav-link text-wrap d-inline-block w-100"> 導入 </a> <a href=#terms title=条件 class="nav-link text-wrap d-inline-block w-100"> 条件 </a> <a href=#table_engine-mergetree-multiple-volumes-configure title=設定 class="nav-link text-wrap d-inline-block w-100"> 設定 </a> <a href=#details title=詳細 class="nav-link text-wrap d-inline-block w-100"> 詳細 </a> </nav> </nav> </div> </div> </div> <script async type=text/javascript src=/js/base.js?7bd05efd></script> <noscript> <div><img src=https://mc.yandex.ru/watch/18343495 alt=Yandex></div> </noscript> </body> </html>