<!DOCTYPE html><html lang=es data-version=master data-single-page=false> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Método de codificación de datos: - Documentación de ClickHouse</title><link rel="shortcut icon" href=/favicon.ico><meta property=og:title content="Método de codificación de datos: - Documentación de ClickHouse "><meta property=og:description content="Mergetree El MergeTree motor y otros motores de esta familia (*MergeTree) son los motores de mesa ClickHouse más robusto"><meta property=og:type content=website><meta property=og:image content=https://clickhouse.tech/images/logo.png><meta property=twitter:title content="Método de codificación de datos: - Documentación de ClickHouse "><meta name=description content="Mergetree El MergeTree motor y otros motores de esta familia (*MergeTree) son los motores de mesa ClickHouse más robusto"><meta name=keywords content="ClickHouse, DBMS, OLAP, relational, analytics, analytical, big data, open-source, SQL, web-analytics"><link href=/css/base.css?1d858e50 media=all rel=stylesheet></head> <body dir=ltr data-spy=scroll data-target=#toc data-offset=80> <nav id=top-nav class="navbar navbar-dark navbar-expand-md bg-dark-alt text-white sticky-top"> <div class="container-fluid justify-content-between"> <a href=/ class="d-block navbar-brand mr-3"> <img id=docs-logo-icon src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"> </a> <div class="w-100 navbar-text text-left d-none d-md-block"> <h1 class="h3 m-0 p-0 d-inline"> <a href=# class="text-white text-decoration-none"> Método de codificación de datos: </a> </h1> </div> <div class="d-none d-md-block"> <ul class="navbar-nav ml-auto mt-2 mt-lg-0 justify-content-end"> <li class=nav-item> <a href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/es/engines/table_engines/mergetree_family/mergetree.md title="Edit this article" class=nav-link rel="external nofollow noreferrer" target=_blank><img src=/images/mkdocs/edit.svg alt="Edit this article" class=mt-1 height=22></a> </li> <li class=nav-item> <a class=nav-link href=https://github.com/ClickHouse/ClickHouse rel="external nofollow noreferrer"> <img src=/images/index/github.svg alt="GitHub repository" title="Go to GitHub" height=32> </a> </li> <li id=languages-wrapper class="nav-item dropdown"> <div id=languages-dropdown> <a class="nav-link dropdown-toggle d-inline-block mt-1 text-muted" href=# id=lang-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false> <img src=/images/flags/es.svg alt=Español title=Español width=32 class="d-inline-block mt-n1"> </a> <div class="dropdown-menu bg-dark" aria-labelledby=lang-dropdown> <a href=/docs/en/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/en.svg alt title width=32 class="d-inline-block mr-2">English </a> <a href=/docs/zh/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/zh.svg alt title width=32 class="d-inline-block mr-2">中文 </a> <a href=/docs/es/engines/table_engines/mergetree_family/mergetree/ class="dropdown-item disabled"> <img src=/images/flags/es.svg alt title width=32 class="d-inline-block mr-2">Español </a> <a href=/docs/fr/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/fr.svg alt title width=32 class="d-inline-block mr-2">Français </a> <a href=/docs/ru/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/ru.svg alt title width=32 class="d-inline-block mr-2">Русский </a> <a href=/docs/ja/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/ja.svg alt title width=32 class="d-inline-block mr-2">日本語 </a> <a href=/docs/fa/engines/table_engines/mergetree_family/mergetree/ class=dropdown-item> <img src=/images/flags/fa.svg alt title width=32 class="d-inline-block mr-2">فارسی </a> </div> </div> </li> </ul> </div> <form id=search-form class="form-inline m-0"> <div class=input-group> <div class="input-group-prepend w-100"> <span class="input-group-text bg-secondary-alt text-muted border-0 mr-n1" id=search-icon> <img src=/images/mkdocs/search.svg> </span> <input id=docsearch-input class="form-control bg-secondary-alt text-muted border-0 pl-1" type=search placeholder=Search aria-label=Search> </div> </div> </form> <button id=navbar-toggler class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#sidebar aria-controls=sidebar aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> </nav> <div class=container-fluid> <div class="row justify-content-end justify-content-xl-center"> <div id=sidebar class="col-xl-2 col-md-4 bg-secondary-alt p-3 d-print-none min-vh-100 overflow-auto"> <div class=overflow-auto> <div id=single-page-switch class="btn-group mb-2 float-right" role=group aria-label="Multi-página o de una sola página"> <a href=../../../.. role=button class="btn btn-dark active" aria-pressed=true> <img src=/images/mkdocs/multi.svg alt="Versión de varias páginas" title="Versión de varias páginas"> </a> <a href=../../../../single/ role=button class="btn btn-dark-alt active" aria-pressed=true> <img src=/images/mkdocs/single.svg alt="Versión de una sola página" title="Versión de una sola página"> </a> </div> <div class="dropdown mb-3"> <a class="btn btn-dark dropdown-toggle text-muted" href=# role=button id=select-version data-toggle=dropdown aria-haspopup=true aria-expanded=false> Versión: <span class=text-light>reciente</span> </a> <div class="dropdown-menu bg-dark text-muted p-1" aria-labelledby=select-version> <a href=/docs/es/ class="dropdown-item disable"> <span class=text-light>reciente</span> </a> <a href=/docs/v20.3/es/ class=dropdown-item>v20.3</a> <a href=/docs/v20.1/es/ class=dropdown-item>v20.1</a> <a href=/docs/v19.17/es/ class=dropdown-item>v19.17</a> <a href=/docs/v19.16/es/ class=dropdown-item>v19.16</a> <a href=/docs/v19.15/es/ class=dropdown-item>v19.15</a> <a href=/docs/v19.14/es/ class=dropdown-item>v19.14</a> <a href=/docs/v19.13/es/ class=dropdown-item>v19.13</a> <a href=/docs/v19.11/es/ class=dropdown-item>v19.11</a> <a href=/docs/v19.10/es/ class=dropdown-item>v19.10</a> <a href=/docs/v19.9/es/ class=dropdown-item>v19.9</a> <a href=/docs/v19.8/es/ class=dropdown-item>v19.8</a> </div> </div> <nav id=sidebar-nav class="nav flex-column mb-5"> <a href=#sidebar-sidebar-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-1 title=Introduction class="nav-link text-light text-wrap dropdown-toggle px-0">Introduction</a> <div id=sidebar-sidebar-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../introduction/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../../introduction/distinctive_features/ title="Características distintivas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Características distintivas</a> <a href=../../../../introduction/features_considered_disadvantages/ title="Características de ClickHouse que pueden considerarse desventajas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Características de ClickHouse que pueden considerarse desventajas</a> <a href=../../../../introduction/performance/ title=Rendimiento class="nav-link text-light text-wrap d-inline-block w-100 px-0">Rendimiento</a> <a href=../../../../introduction/history/ title=Historia class="nav-link text-light text-wrap d-inline-block w-100 px-0">Historia</a> <a href=../../../../introduction/adopters/ title=Adoptante class="nav-link text-light text-wrap d-inline-block w-100 px-0">Adoptante</a> </nav> </div> <a href=../../../../ title=Descripción class="nav-link text-light text-wrap d-inline-block w-100 px-0">Descripción</a> <a href=#sidebar-sidebar-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3 title="Getting Started" class="nav-link text-light text-wrap dropdown-toggle px-0">Getting Started</a> <div id=sidebar-sidebar-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../getting_started/ title=oculto class="nav-link text-light text-wrap d-inline-block w-100 px-0">oculto</a> <a href=../../../../getting_started/install/ title=Instalación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Instalación</a> <a href=#sidebar-sidebar-3-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-3 title="Example Datasets" class="nav-link text-light text-wrap dropdown-toggle px-0">Example Datasets</a> <div id=sidebar-sidebar-3-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../getting_started/example_datasets/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../getting_started/example_datasets/ontime/ title="A tiempo" class="nav-link text-light text-wrap d-inline-block w-100 px-0">A tiempo</a> <a href=../../../../getting_started/example_datasets/nyc_taxi/ title="Datos de taxis de Nueva York" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Datos de taxis de Nueva York</a> <a href=../../../../getting_started/example_datasets/amplab_benchmark/ title="Referencia de Big Data de AMPLab" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Referencia de Big Data de AMPLab</a> <a href=../../../../getting_started/example_datasets/wikistat/ title="Nombre de la red inalámbrica (SSID):" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nombre de la red inalámbrica (SSID):</a> <a href=../../../../getting_started/example_datasets/criteo/ title="Registros de clics de Terabyte de Criteo" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Registros de clics de Terabyte de Criteo</a> <a href=../../../../getting_started/example_datasets/star_schema/ title="Estrella Schema Benchmark" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Estrella Schema Benchmark</a> <a href=../../../../getting_started/example_datasets/metrica/ title="El Yandex.Metrica Datos" class="nav-link text-light text-wrap d-inline-block w-100 px-0">El Yandex.Metrica Datos</a> </nav> </div> <a href=../../../../getting_started/tutorial/ title=Tutorial class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tutorial</a> <a href=../../../../getting_started/playground/ title=Infantil class="nav-link text-light text-wrap d-inline-block w-100 px-0">Infantil</a> </nav> </div> <a href=#sidebar-sidebar-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4 title=Interfaces class="nav-link text-light text-wrap dropdown-toggle px-0">Interfaces</a> <div id=sidebar-sidebar-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../interfaces/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../interfaces/cli/ title="Cliente de línea de comandos" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cliente de línea de comandos</a> <a href=../../../../interfaces/tcp/ title="Interfaz nativa (TCP)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interfaz nativa (TCP)</a> <a href=../../../../interfaces/http/ title="Interfaz HTTP" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interfaz HTTP</a> <a href=../../../../interfaces/mysql/ title="Interfaz MySQL" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interfaz MySQL</a> <a href=../../../../interfaces/formats/ title="Formatos de entrada y salida" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Formatos de entrada y salida</a> <a href=../../../../interfaces/jdbc/ title="Controlador JDBC" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Controlador JDBC</a> <a href=../../../../interfaces/odbc/ title="Conductor ODBC" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Conductor ODBC</a> <a href=../../../../interfaces/cpp/ title="Biblioteca de clientes de C++" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Biblioteca de clientes de C++</a> <a href=#sidebar-sidebar-4-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-10 title=Third-Party class="nav-link text-light text-wrap dropdown-toggle px-0">Third-Party</a> <div id=sidebar-sidebar-4-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../interfaces/third-party/ title=Third-Party class="nav-link text-light text-wrap d-inline-block w-100 px-0">Third-Party</a> <a href=../../../../interfaces/third-party/client_libraries/ title="Bibliotecas de clientes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bibliotecas de clientes</a> <a href=../../../../interfaces/third-party/integrations/ title=Integración class="nav-link text-light text-wrap d-inline-block w-100 px-0">Integración</a> <a href=../../../../interfaces/third-party/gui/ title="Interfaces Visuales" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interfaces Visuales</a> <a href=../../../../interfaces/third-party/proxy/ title=Proxy class="nav-link text-light text-wrap d-inline-block w-100 px-0">Proxy</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5 title=Engines class="nav-link text-light text-wrap dropdown-toggle px-0">Engines</a> <div id=sidebar-sidebar-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/ title=Engines class="nav-link text-light text-wrap d-inline-block w-100 px-0">Engines</a> <a href=#sidebar-sidebar-5-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2 title="Table Engines" class="nav-link text-light text-wrap dropdown-toggle px-0">Table Engines</a> <div id=sidebar-sidebar-5-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=#sidebar-sidebar-5-2-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-2 title="MergeTree Family" class="nav-link text-light text-wrap dropdown-toggle px-0">MergeTree Family</a> <div id=sidebar-sidebar-5-2-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/mergetree_family/ title="MergeTree Family" class="nav-link text-light text-wrap d-inline-block w-100 px-0">MergeTree Family</a> <a href=../../../../engines/table_engines/mergetree_family/mergetree/ title="Método de codificación de datos:" class="nav-link text-white active text-wrap d-inline-block w-100 px-0">Método de codificación de datos:</a> <a href=../../../../engines/table_engines/mergetree_family/replication/ title="Replicación de datos" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Replicación de datos</a> <a href=../../../../engines/table_engines/mergetree_family/custom_partitioning_key/ title="Clave de partición personalizada" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clave de partición personalizada</a> <a href=../../../../engines/table_engines/mergetree_family/replacingmergetree/ title=ReplacingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">ReplacingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/summingmergetree/ title=SummingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">SummingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/aggregatingmergetree/ title=AgregaciónMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">AgregaciónMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/collapsingmergetree/ title=ColapsarMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">ColapsarMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/versionedcollapsingmergetree/ title=VersionedCollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">VersionedCollapsingMergeTree</a> <a href=../../../../engines/table_engines/mergetree_family/graphitemergetree/ title=GraphiteMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">GraphiteMergeTree</a> </nav> </div> <a href=#sidebar-sidebar-5-2-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-3 title="Log Family" class="nav-link text-light text-wrap dropdown-toggle px-0">Log Family</a> <div id=sidebar-sidebar-5-2-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/log_family/ title="Log Family" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Log Family</a> <a href=../../../../engines/table_engines/log_family/log_family/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../engines/table_engines/log_family/stripelog/ title=StripeLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">StripeLog</a> <a href=../../../../engines/table_engines/log_family/log/ title=Registro class="nav-link text-light text-wrap d-inline-block w-100 px-0">Registro</a> <a href=../../../../engines/table_engines/log_family/tinylog/ title=TinyLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">TinyLog</a> </nav> </div> <a href=#sidebar-sidebar-5-2-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-4 title=Integrations class="nav-link text-light text-wrap dropdown-toggle px-0">Integrations</a> <div id=sidebar-sidebar-5-2-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/integrations/ title=Integrations class="nav-link text-light text-wrap d-inline-block w-100 px-0">Integrations</a> <a href=../../../../engines/table_engines/integrations/kafka/ title=Kafka class="nav-link text-light text-wrap d-inline-block w-100 px-0">Kafka</a> <a href=../../../../engines/table_engines/integrations/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../../../engines/table_engines/integrations/jdbc/ title=JDBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC</a> <a href=../../../../engines/table_engines/integrations/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> <a href=../../../../engines/table_engines/integrations/hdfs/ title=HDFS class="nav-link text-light text-wrap d-inline-block w-100 px-0">HDFS</a> </nav> </div> <a href=#sidebar-sidebar-5-2-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-5 title=Special class="nav-link text-light text-wrap dropdown-toggle px-0">Special</a> <div id=sidebar-sidebar-5-2-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/table_engines/special/ title=Special class="nav-link text-light text-wrap d-inline-block w-100 px-0">Special</a> <a href=../../../../engines/table_engines/special/distributed/ title=Distribuido class="nav-link text-light text-wrap d-inline-block w-100 px-0">Distribuido</a> <a href=../../../../engines/table_engines/special/external_data/ title="Datos externos" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Datos externos</a> <a href=../../../../engines/table_engines/special/dictionary/ title=Diccionario class="nav-link text-light text-wrap d-inline-block w-100 px-0">Diccionario</a> <a href=../../../../engines/table_engines/special/merge/ title=Fusionar class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fusionar</a> <a href=../../../../engines/table_engines/special/file/ title=File class="nav-link text-light text-wrap d-inline-block w-100 px-0">File</a> <a href=../../../../engines/table_engines/special/null/ title=Nulo class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nulo</a> <a href=../../../../engines/table_engines/special/set/ title=Establecer class="nav-link text-light text-wrap d-inline-block w-100 px-0">Establecer</a> <a href=../../../../engines/table_engines/special/join/ title=Unir class="nav-link text-light text-wrap d-inline-block w-100 px-0">Unir</a> <a href=../../../../engines/table_engines/special/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../../../../engines/table_engines/special/view/ title=Vista class="nav-link text-light text-wrap d-inline-block w-100 px-0">Vista</a> <a href=../../../../engines/table_engines/special/materializedview/ title="Método de codificación de datos:" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Método de codificación de datos:</a> <a href=../../../../engines/table_engines/special/memory/ title=Memoria class="nav-link text-light text-wrap d-inline-block w-100 px-0">Memoria</a> <a href=../../../../engines/table_engines/special/buffer/ title=Búfer class="nav-link text-light text-wrap d-inline-block w-100 px-0">Búfer</a> <a href=../../../../engines/table_engines/special/generate/ title=GenerateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">GenerateRandom</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-3 title="Database Engines" class="nav-link text-light text-wrap dropdown-toggle px-0">Database Engines</a> <div id=sidebar-sidebar-5-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../engines/database_engines/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../engines/database_engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../../../engines/database_engines/lazy/ title=Perezoso class="nav-link text-light text-wrap d-inline-block w-100 px-0">Perezoso</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6 title="SQL Reference" class="nav-link text-light text-wrap dropdown-toggle px-0">SQL Reference</a> <div id=sidebar-sidebar-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/ title=oculto class="nav-link text-light text-wrap d-inline-block w-100 px-0">oculto</a> <a href=../../../../sql_reference/syntax/ title=Sintaxis class="nav-link text-light text-wrap d-inline-block w-100 px-0">Sintaxis</a> <a href=#sidebar-sidebar-6-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-3 title=Statements class="nav-link text-light text-wrap dropdown-toggle px-0">Statements</a> <div id=sidebar-sidebar-6-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/statements/ title=Statements class="nav-link text-light text-wrap d-inline-block w-100 px-0">Statements</a> <a href=../../../../sql_reference/statements/select/ title=SELECT class="nav-link text-light text-wrap d-inline-block w-100 px-0">SELECT</a> <a href=../../../../sql_reference/statements/insert_into/ title="INSERT INTO" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INSERT INTO</a> <a href=../../../../sql_reference/statements/create/ title=CREATE class="nav-link text-light text-wrap d-inline-block w-100 px-0">CREATE</a> <a href=../../../../sql_reference/statements/alter/ title=ALTER class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALTER</a> <a href=../../../../sql_reference/statements/system/ title=SYSTEM class="nav-link text-light text-wrap d-inline-block w-100 px-0">SYSTEM</a> <a href=../../../../sql_reference/statements/show/ title=SHOW class="nav-link text-light text-wrap d-inline-block w-100 px-0">SHOW</a> <a href=../../../../sql_reference/statements/misc/ title=Otro class="nav-link text-light text-wrap d-inline-block w-100 px-0">Otro</a> </nav> </div> <a href=#sidebar-sidebar-6-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-4 title=Functions class="nav-link text-light text-wrap dropdown-toggle px-0">Functions</a> <div id=sidebar-sidebar-6-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/functions/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../sql_reference/functions/arithmetic_functions/ title=Aritmética class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aritmética</a> <a href=../../../../sql_reference/functions/comparison_functions/ title=Comparación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comparación</a> <a href=../../../../sql_reference/functions/logical_functions/ title=Lógico class="nav-link text-light text-wrap d-inline-block w-100 px-0">Lógico</a> <a href=../../../../sql_reference/functions/type_conversion_functions/ title="Conversión de tipo" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Conversión de tipo</a> <a href=../../../../sql_reference/functions/date_time_functions/ title="Trabajar con fechas y horas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajar con fechas y horas</a> <a href=../../../../sql_reference/functions/string_functions/ title="Trabajar con cadenas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajar con cadenas</a> <a href=../../../../sql_reference/functions/string_search_functions/ title="Para buscar cadenas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Para buscar cadenas</a> <a href=../../../../sql_reference/functions/string_replace_functions/ title="Para reemplazar en cadenas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Para reemplazar en cadenas</a> <a href=../../../../sql_reference/functions/conditional_functions/ title=Condicional class="nav-link text-light text-wrap d-inline-block w-100 px-0">Condicional</a> <a href=../../../../sql_reference/functions/math_functions/ title=Matemática class="nav-link text-light text-wrap d-inline-block w-100 px-0">Matemática</a> <a href=../../../../sql_reference/functions/rounding_functions/ title=Redondeo class="nav-link text-light text-wrap d-inline-block w-100 px-0">Redondeo</a> <a href=../../../../sql_reference/functions/array_functions/ title="Trabajar con matrices" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajar con matrices</a> <a href=../../../../sql_reference/functions/splitting_merging_functions/ title="División y fusión de cuerdas y matrices" class="nav-link text-light text-wrap d-inline-block w-100 px-0">División y fusión de cuerdas y matrices</a> <a href=../../../../sql_reference/functions/bit_functions/ title=Trozo class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trozo</a> <a href=../../../../sql_reference/functions/bitmap_functions/ title=Bits class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bits</a> <a href=../../../../sql_reference/functions/hash_functions/ title=Hash class="nav-link text-light text-wrap d-inline-block w-100 px-0">Hash</a> <a href=../../../../sql_reference/functions/random_functions/ title="Generación de números pseudo-aleatorios" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Generación de números pseudo-aleatorios</a> <a href=../../../../sql_reference/functions/encoding_functions/ title=Codificación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Codificación</a> <a href=../../../../sql_reference/functions/uuid_functions/ title="Trabajando con UUID" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajando con UUID</a> <a href=../../../../sql_reference/functions/url_functions/ title="Trabajar con URL" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajar con URL</a> <a href=../../../../sql_reference/functions/ip_address_functions/ title="Trabajar con direcciones IP" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajar con direcciones IP</a> <a href=../../../../sql_reference/functions/json_functions/ title="Trabajando con JSON" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajando con JSON</a> <a href=../../../../sql_reference/functions/higher_order_functions/ title="Orden superior" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Orden superior</a> <a href=../../../../sql_reference/functions/ext_dict_functions/ title="Trabajar con diccionarios externos" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajar con diccionarios externos</a> <a href=../../../../sql_reference/functions/ym_dict_functions/ title="Trabajando con Yandex.Diccionarios de Metrica" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajando con Yandex.Diccionarios de Metrica</a> <a href=../../../../sql_reference/functions/in_functions/ title="Implementación del operador IN" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implementación del operador IN</a> <a href=../../../../sql_reference/functions/array_join/ title=arrayJoin class="nav-link text-light text-wrap d-inline-block w-100 px-0">arrayJoin</a> <a href=../../../../sql_reference/functions/geo/ title="Trabajar con coordenadas geográficas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajar con coordenadas geográficas</a> <a href=../../../../sql_reference/functions/functions_for_nulls/ title="Trabajar con argumentos Nullable" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Trabajar con argumentos Nullable</a> <a href=../../../../sql_reference/functions/machine_learning_functions/ title="Funciones de aprendizaje automático" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Funciones de aprendizaje automático</a> <a href=../../../../sql_reference/functions/introspection/ title=Introspección class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introspección</a> <a href=../../../../sql_reference/functions/other_functions/ title=Otro class="nav-link text-light text-wrap d-inline-block w-100 px-0">Otro</a> </nav> </div> <a href=#sidebar-sidebar-6-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-5 title="Aggregate Functions" class="nav-link text-light text-wrap dropdown-toggle px-0">Aggregate Functions</a> <div id=sidebar-sidebar-6-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/aggregate_functions/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../sql_reference/aggregate_functions/reference/ title=Referencia class="nav-link text-light text-wrap d-inline-block w-100 px-0">Referencia</a> <a href=../../../../sql_reference/aggregate_functions/combinators/ title="Combinadores de funciones agregadas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Combinadores de funciones agregadas</a> <a href=../../../../sql_reference/aggregate_functions/parametric_functions/ title="Funciones agregadas paramétricas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Funciones agregadas paramétricas</a> </nav> </div> <a href=#sidebar-sidebar-6-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-6 title="Table Functions" class="nav-link text-light text-wrap dropdown-toggle px-0">Table Functions</a> <div id=sidebar-sidebar-6-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/table_functions/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../sql_reference/table_functions/file/ title=file class="nav-link text-light text-wrap d-inline-block w-100 px-0">file</a> <a href=../../../../sql_reference/table_functions/merge/ title=fusionar class="nav-link text-light text-wrap d-inline-block w-100 px-0">fusionar</a> <a href=../../../../sql_reference/table_functions/numbers/ title=numero class="nav-link text-light text-wrap d-inline-block w-100 px-0">numero</a> <a href=../../../../sql_reference/table_functions/remote/ title=remoto class="nav-link text-light text-wrap d-inline-block w-100 px-0">remoto</a> <a href=../../../../sql_reference/table_functions/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../../../../sql_reference/table_functions/mysql/ title=mysql class="nav-link text-light text-wrap d-inline-block w-100 px-0">mysql</a> <a href=../../../../sql_reference/table_functions/jdbc/ title=jdbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">jdbc</a> <a href=../../../../sql_reference/table_functions/odbc/ title=Nosotros class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nosotros</a> <a href=../../../../sql_reference/table_functions/hdfs/ title=Hdfs class="nav-link text-light text-wrap d-inline-block w-100 px-0">Hdfs</a> <a href=../../../../sql_reference/table_functions/input/ title=entrada class="nav-link text-light text-wrap d-inline-block w-100 px-0">entrada</a> <a href=../../../../sql_reference/table_functions/generate/ title=generateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">generateRandom</a> </nav> </div> <a href=#sidebar-sidebar-6-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-7 title=Dictionaries class="nav-link text-light text-wrap dropdown-toggle px-0">Dictionaries</a> <div id=sidebar-sidebar-6-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/dictionaries/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=#sidebar-sidebar-6-7-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-7-2 title="External Dictionaries" class="nav-link text-light text-wrap dropdown-toggle px-0">External Dictionaries</a> <div id=sidebar-sidebar-6-7-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/dictionaries/external_dictionaries/ title="External Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">External Dictionaries</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts/ title="Descripción General" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Descripción General</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict/ title="Configuración de un diccionario externo" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Configuración de un diccionario externo</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_layout/ title="Almacenamiento de diccionarios en la memoria" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Almacenamiento de diccionarios en la memoria</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_lifetime/ title="Actualizaciones del diccionario" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Actualizaciones del diccionario</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_sources/ title="Fuentes de diccionarios externos" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fuentes de diccionarios externos</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_structure/ title="Clave y campos del diccionario" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clave y campos del diccionario</a> <a href=../../../../sql_reference/dictionaries/external_dictionaries/external_dicts_dict_hierarchical/ title="Diccionarios jerárquicos" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Diccionarios jerárquicos</a> </nav> </div> <a href=../../../../sql_reference/dictionaries/internal_dicts/ title="Diccionarios internos" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Diccionarios internos</a> </nav> </div> <a href=#sidebar-sidebar-6-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8 title="Data Types" class="nav-link text-light text-wrap dropdown-toggle px-0">Data Types</a> <div id=sidebar-sidebar-6-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../sql_reference/data_types/int_uint/ title="UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64</a> <a href=../../../../sql_reference/data_types/float/ title="Descripción del producto" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Descripción del producto</a> <a href=../../../../sql_reference/data_types/decimal/ title=Decimal class="nav-link text-light text-wrap d-inline-block w-100 px-0">Decimal</a> <a href=../../../../sql_reference/data_types/boolean/ title=Booleana class="nav-link text-light text-wrap d-inline-block w-100 px-0">Booleana</a> <a href=../../../../sql_reference/data_types/string/ title=Cadena class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cadena</a> <a href=../../../../sql_reference/data_types/fixedstring/ title="Cadena fija (N)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cadena fija (N)</a> <a href=../../../../sql_reference/data_types/uuid/ title=UUID class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUID</a> <a href=../../../../sql_reference/data_types/date/ title=Fecha class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fecha</a> <a href=../../../../sql_reference/data_types/datetime/ title=FechaHora class="nav-link text-light text-wrap d-inline-block w-100 px-0">FechaHora</a> <a href=../../../../sql_reference/data_types/datetime64/ title=DateTime64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime64</a> <a href=../../../../sql_reference/data_types/enum/ title=Enum class="nav-link text-light text-wrap d-inline-block w-100 px-0">Enum</a> <a href=../../../../sql_reference/data_types/array/ title="Matriz (T)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Matriz (T)</a> <a href=../../../../sql_reference/data_types/aggregatefunction/ title="Agregar función (nombre, types_of_arguments)...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Agregar función (nombre, types_of_arguments)...)</a> <a href=../../../../sql_reference/data_types/tuple/ title="Tuple (T1, T2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tuple (T1, T2, ...)</a> <a href=../../../../sql_reference/data_types/nullable/ title=NULL class="nav-link text-light text-wrap d-inline-block w-100 px-0">NULL</a> <a href=#sidebar-sidebar-6-8-17 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8-17 title="Nested Data Structures" class="nav-link text-light text-wrap dropdown-toggle px-0">Nested Data Structures</a> <div id=sidebar-sidebar-6-8-17 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/nested_data_structures/ title=oculto class="nav-link text-light text-wrap d-inline-block w-100 px-0">oculto</a> <a href=../../../../sql_reference/data_types/nested_data_structures/nested/ title="Anidado (Nombre1 Tipo1, Nombre2 Tipo2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Anidado (Nombre1 Tipo1, Nombre2 Tipo2, ...)</a> </nav> </div> <a href=#sidebar-sidebar-6-8-18 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8-18 title="Special Data Types" class="nav-link text-light text-wrap dropdown-toggle px-0">Special Data Types</a> <div id=sidebar-sidebar-6-8-18 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/special_data_types/ title=oculto class="nav-link text-light text-wrap d-inline-block w-100 px-0">oculto</a> <a href=../../../../sql_reference/data_types/special_data_types/expression/ title=Expresion class="nav-link text-light text-wrap d-inline-block w-100 px-0">Expresion</a> <a href=../../../../sql_reference/data_types/special_data_types/set/ title=Establecer class="nav-link text-light text-wrap d-inline-block w-100 px-0">Establecer</a> <a href=../../../../sql_reference/data_types/special_data_types/nothing/ title=Nada class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nada</a> <a href=../../../../sql_reference/data_types/special_data_types/interval/ title=Intervalo class="nav-link text-light text-wrap d-inline-block w-100 px-0">Intervalo</a> </nav> </div> <a href=#sidebar-sidebar-6-8-19 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8-19 title=Domains class="nav-link text-light text-wrap dropdown-toggle px-0">Domains</a> <div id=sidebar-sidebar-6-8-19 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../sql_reference/data_types/domains/ title=Domains class="nav-link text-light text-wrap d-inline-block w-100 px-0">Domains</a> <a href=../../../../sql_reference/data_types/domains/overview/ title=Descripción class="nav-link text-light text-wrap d-inline-block w-100 px-0">Descripción</a> <a href=../../../../sql_reference/data_types/domains/ipv4/ title=IPv4 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv4</a> <a href=../../../../sql_reference/data_types/domains/ipv6/ title=IPv6 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv6</a> </nav> </div> </nav> </div> <a href=../../../../sql_reference/operators/ title=Operador class="nav-link text-light text-wrap d-inline-block w-100 px-0">Operador</a> </nav> </div> <a href=#sidebar-sidebar-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7 title=Guides class="nav-link text-light text-wrap dropdown-toggle px-0">Guides</a> <div id=sidebar-sidebar-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../guides/ title=Descripción class="nav-link text-light text-wrap d-inline-block w-100 px-0">Descripción</a> <a href=../../../../guides/apply_catboost_model/ title="Aplicación de modelos CatBoost" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aplicación de modelos CatBoost</a> </nav> </div> <a href=#sidebar-sidebar-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8 title=Operations class="nav-link text-light text-wrap dropdown-toggle px-0">Operations</a> <div id=sidebar-sidebar-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../operations/requirements/ title=Requisito class="nav-link text-light text-wrap d-inline-block w-100 px-0">Requisito</a> <a href=../../../../operations/monitoring/ title=Monitoreo class="nav-link text-light text-wrap d-inline-block w-100 px-0">Monitoreo</a> <a href=../../../../operations/troubleshooting/ title="Solución de problemas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Solución de problemas</a> <a href=../../../../operations/update/ title="Actualización de ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Actualización de ClickHouse</a> <a href=../../../../operations/access_rights/ title="Derechos de acceso" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Derechos de acceso</a> <a href=../../../../operations/backup/ title="Copia de seguridad de datos" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Copia de seguridad de datos</a> <a href=../../../../operations/configuration_files/ title="Archivos de configuración" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Archivos de configuración</a> <a href=../../../../operations/quotas/ title=Cuota class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cuota</a> <a href=#sidebar-sidebar-8-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-10 title="Optimizing Performance" class="nav-link text-light text-wrap dropdown-toggle px-0">Optimizing Performance</a> <div id=sidebar-sidebar-8-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/optimizing_performance/ title="Optimizing Performance" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Optimizing Performance</a> <a href=../../../../operations/optimizing_performance/sampling_query_profiler/ title="Generación de perfiles de consultas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Generación de perfiles de consultas</a> </nav> </div> <a href=../../../../operations/system_tables/ title="Tablas del sistema" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tablas del sistema</a> <a href=../../../../operations/performance_test/ title="Prueba de hardware" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Prueba de hardware</a> <a href=#sidebar-sidebar-8-13 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-13 title="Server Configuration Parameters" class="nav-link text-light text-wrap dropdown-toggle px-0">Server Configuration Parameters</a> <div id=sidebar-sidebar-8-13 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/server_configuration_parameters/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../operations/server_configuration_parameters/settings/ title="Configuración del servidor" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Configuración del servidor</a> </nav> </div> <a href=#sidebar-sidebar-8-14 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-14 title=Settings class="nav-link text-light text-wrap dropdown-toggle px-0">Settings</a> <div id=sidebar-sidebar-8-14 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/settings/ title=Implantación class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implantación</a> <a href=../../../../operations/settings/permissions_for_queries/ title="Permisos para consultas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Permisos para consultas</a> <a href=../../../../operations/settings/query_complexity/ title="Restricciones en la complejidad de consultas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Restricciones en la complejidad de consultas</a> <a href=../../../../operations/settings/settings/ title=Configuración class="nav-link text-light text-wrap d-inline-block w-100 px-0">Configuración</a> <a href=../../../../operations/settings/settings_profiles/ title="Perfiles de configuración" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Perfiles de configuración</a> <a href=../../../../operations/settings/constraints_on_settings/ title="Restricciones en la configuración" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Restricciones en la configuración</a> <a href=../../../../operations/settings/settings_users/ title="Configuración del usuario" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Configuración del usuario</a> </nav> </div> <a href=#sidebar-sidebar-8-15 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-15 title=Utilities class="nav-link text-light text-wrap dropdown-toggle px-0">Utilities</a> <div id=sidebar-sidebar-8-15 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../operations/utilities/ title=Descripción class="nav-link text-light text-wrap d-inline-block w-100 px-0">Descripción</a> <a href=../../../../operations/utilities/clickhouse-copier/ title="Método de codificación de datos:" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Método de codificación de datos:</a> <a href=../../../../operations/utilities/clickhouse-benchmark/ title="Sistema abierto" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Sistema abierto</a> </nav> </div> <a href=../../../../operations/tips/ title="Recomendaciones de uso" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Recomendaciones de uso</a> </nav> </div> <a href=#sidebar-sidebar-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-9 title=Development class="nav-link text-light text-wrap dropdown-toggle px-0">Development</a> <div id=sidebar-sidebar-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../development/ title=oculto class="nav-link text-light text-wrap d-inline-block w-100 px-0">oculto</a> <a href=../../../../development/developer_instruction/ title="La instrucción para desarrolladores de ClickHouse para principiantes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">La instrucción para desarrolladores de ClickHouse para principiantes</a> <a href=../../../../development/architecture/ title="Descripción general de la arquitectura ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Descripción general de la arquitectura ClickHouse</a> <a href=../../../../development/browse_code/ title="Examinar el código fuente de ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Examinar el código fuente de ClickHouse</a> <a href=../../../../development/build/ title="Cómo crear ClickHouse en Linux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cómo crear ClickHouse en Linux</a> <a href=../../../../development/build_osx/ title="Cómo crear ClickHouse en Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cómo crear ClickHouse en Mac OS X</a> <a href=../../../../development/build_cross_osx/ title="Cómo construir ClickHouse en Linux para Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cómo construir ClickHouse en Linux para Mac OS X</a> <a href=../../../../development/build_cross_arm/ title="Cómo construir ClickHouse en Linux para AARCH64 (ARM64)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cómo construir ClickHouse en Linux para AARCH64 (ARM64)</a> <a href=../../../../development/style/ title="Cómo escribir código C ++" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cómo escribir código C ++</a> <a href=../../../../development/tests/ title="Cómo ejecutar pruebas de ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cómo ejecutar pruebas de ClickHouse</a> <a href=../../../../development/contrib/ title="Bibliotecas de terceros utilizadas" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bibliotecas de terceros utilizadas</a> </nav> </div> <a href=#sidebar-sidebar-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-10 title=Commercial class="nav-link text-light text-wrap dropdown-toggle px-0">Commercial</a> <div id=sidebar-sidebar-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../commercial/ title=Commercial class="nav-link text-light text-wrap d-inline-block w-100 px-0">Commercial</a> <a href=../../../../commercial/cloud/ title="Proveedores de servicios en la nube de ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Proveedores de servicios en la nube de ClickHouse</a> </nav> </div> <a href=#sidebar-sidebar-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11 title="What's New" class="nav-link text-light text-wrap dropdown-toggle px-0">What's New</a> <div id=sidebar-sidebar-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../whats_new/ title="What's New" class="nav-link text-light text-wrap d-inline-block w-100 px-0">What's New</a> <a href=#sidebar-sidebar-11-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11-2 title=Changelog class="nav-link text-light text-wrap dropdown-toggle px-0">Changelog</a> <div id=sidebar-sidebar-11-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../whats_new/changelog/ title=2020 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2020</a> <a href=../../../../whats_new/changelog/2019/ title=2019 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2019</a> <a href=../../../../whats_new/changelog/2018/ title=2018 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2018</a> <a href=../../../../whats_new/changelog/2017/ title=2017 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2017</a> </nav> </div> <a href=../../../../whats_new/roadmap/ title="Hoja de ruta" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Hoja de ruta</a> <a href=../../../../whats_new/security_changelog/ title="Seguridad Changelog" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Seguridad Changelog</a> </nav> </div> <a href=#sidebar-sidebar-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-12 title=F.A.Q. class="nav-link text-light text-wrap dropdown-toggle px-0">F.A.Q.</a> <div id=sidebar-sidebar-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../../faq/ title=F.A.Q. class="nav-link text-light text-wrap d-inline-block w-100 px-0">F.A.Q.</a> <a href=../../../../faq/general/ title="Preguntas generales" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Preguntas generales</a> </nav> </div> <a href=../../../../roadmap/ title="Hoja de ruta" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Hoja de ruta</a> <a href=../../../../single/clickhouse_es.pdf class="nav-link border-top border-secondary mt-3 px-0 pt-3 text-light"> <img src=/images/mkdocs/pdf.svg alt="Versión PDF" title="Versión PDF" height=24 class="d-block mr-1 float-left"><div>Versión PDF</div> </a> </nav> </div> </div> <div id=content-wrapper class="col-md-8 p-2 p-md-5"> <div id=content> <div class="alert alert-primary" role=alert> <p class="display-5 mb-2">Ayuda quería!</p> <p class=lead>El siguiente contenido de esta página de documentación ha sido traducido por máquina. Pero a diferencia de otros sitios web, no se hace sobre la marcha. Este texto traducido vive en el repositorio de GitHub junto con la base de código principal de ClickHouse y espera a que otros hablantes nativos lo hagan más legible por humanos.</p> <p class=lead> <a class="btn btn-lg btn-primary text-white" href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/es/engines/table_engines/mergetree_family/mergetree.md target=_blank rel="external nofollow noreferrer"> Ayuda a la documentación de ClickHouse editando esta página </a> </p> </div> <h1 id=table_engines-mergetree>Mergetree<a class=headerlink href=#table_engines-mergetree title="Permanent link">&para;</a></h1> <p>El <code>MergeTree</code> motor y otros motores de esta familia (<code>*MergeTree</code>) son los motores de mesa ClickHouse más robustos.</p> <p>Motores en el <code>MergeTree</code> familia están diseñados para insertar una gran cantidad de datos en una tabla. Los datos se escriben rápidamente en la tabla parte por parte, luego se aplican reglas para fusionar las partes en segundo plano. Este método es mucho más eficiente que reescribir continuamente los datos en almacenamiento durante la inserción.</p> <p>Principales características:</p> <ul> <li> <p>Almacena datos ordenados por clave principal.</p> <p>Esto le permite crear un pequeño índice disperso que ayuda a encontrar datos más rápido.</p> </li> <li> <p>Las particiones se pueden utilizar si <a href=../custom_partitioning_key/ >clave de partición</a> se especifica.</p> <p>ClickHouse admite ciertas operaciones con particiones que son más efectivas que las operaciones generales en los mismos datos con el mismo resultado. ClickHouse también corta automáticamente los datos de partición donde se especifica la clave de partición en la consulta. Esto también mejora el rendimiento de las consultas.</p> </li> <li> <p>Soporte de replicación de datos.</p> <p>La familia de <code>ReplicatedMergeTree</code> proporciona la replicación de datos. Para obtener más información, consulte <a href=../replication/ >Replicación de datos</a>.</p> </li> <li> <p>Soporte de muestreo de datos.</p> <p>Si es necesario, puede establecer el método de muestreo de datos en la tabla.</p> </li> </ul> <div class="admonition info"> <p class=admonition-title>INFO</p> <p>El <a href=../../special/merge/ >Fusionar</a> el motor no pertenece al <code>*MergeTree</code> familia.</p> </div> <h2 id=table_engine-mergetree-creating-a-table>Creación de una tabla<a class=headerlink href=#table_engine-mergetree-creating-a-table title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=p>[</span><span class=k>IF</span> <span class=k>NOT</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=k>cluster</span><span class=p>]</span>
<span class=p>(</span>
    <span class=n>name1</span> <span class=p>[</span><span class=n>type1</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr1</span><span class=p>]</span> <span class=p>[</span><span class=n>TTL</span> <span class=n>expr1</span><span class=p>],</span>
    <span class=n>name2</span> <span class=p>[</span><span class=n>type2</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr2</span><span class=p>]</span> <span class=p>[</span><span class=n>TTL</span> <span class=n>expr2</span><span class=p>],</span>
    <span class=p>...</span>
    <span class=k>INDEX</span> <span class=n>index_name1</span> <span class=n>expr1</span> <span class=k>TYPE</span> <span class=n>type1</span><span class=p>(...)</span> <span class=n>GRANULARITY</span> <span class=n>value1</span><span class=p>,</span>
    <span class=k>INDEX</span> <span class=n>index_name2</span> <span class=n>expr2</span> <span class=k>TYPE</span> <span class=n>type2</span><span class=p>(...)</span> <span class=n>GRANULARITY</span> <span class=n>value2</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span><span class=p>()</span>
<span class=p>[</span><span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=k>ORDER</span> <span class=k>BY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=k>PRIMARY</span> <span class=k>KEY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=n>SAMPLE</span> <span class=k>BY</span> <span class=n>expr</span><span class=p>]</span>
<span class=p>[</span><span class=n>TTL</span> <span class=n>expr</span> <span class=p>[</span><span class=k>DELETE</span><span class=o>|</span><span class=k>TO</span> <span class=n>DISK</span> <span class=s1>&#39;xxx&#39;</span><span class=o>|</span><span class=k>TO</span> <span class=n>VOLUME</span> <span class=s1>&#39;xxx&#39;</span><span class=p>],</span> <span class=p>...]</span>
<span class=p>[</span><span class=n>SETTINGS</span> <span class=n>name</span><span class=o>=</span><span class=n>value</span><span class=p>,</span> <span class=p>...]</span>
</code></pre></div> <p>Para obtener una descripción de los parámetros, consulte <a href=../../../../sql_reference/statements/create/ >Descripción de la consulta CREATE</a>.</p> <div class="admonition note"> <p class=admonition-title>Nota</p> <p><code>INDEX</code> es una característica experimental, ver <a href=#table_engine-mergetree-data_skipping-indexes>Índices de saltos de datos</a>.</p> </div> <h3 id=mergetree-query-clauses>Cláusulas de consulta<a class=headerlink href=#mergetree-query-clauses title="Permanent link">&para;</a></h3> <ul> <li> <p><code>ENGINE</code> — Name and parameters of the engine. <code>ENGINE = MergeTree()</code>. El <code>MergeTree</code> el motor no tiene parámetros.</p> </li> <li> <p><code>PARTITION BY</code> — The <a href=../custom_partitioning_key/ >clave de partición</a>.</p> <p>Para particionar por mes, utilice el <code>toYYYYMM(date_column)</code> expresión, donde <code>date_column</code> es una columna con una fecha del tipo <a href=../../../../sql_reference/data_types/date/ >Fecha</a>. Los nombres de partición aquí tienen el <code>"YYYYMM"</code> formato.</p> </li> <li> <p><code>ORDER BY</code> — The sorting key.</p> <p>Una tupla de columnas o expresiones arbitrarias. Ejemplo: <code>ORDER BY (CounterID, EventDate)</code>.</p> </li> <li> <p><code>PRIMARY KEY</code> — The primary key if it <a href=./ >difiere de la clave de clasificación</a>.</p> <p>De forma predeterminada, la clave principal es la misma que la clave de ordenación (que se especifica <code>ORDER BY</code> clausula). Por lo tanto, en la mayoría de los casos no es necesario especificar un <code>PRIMARY KEY</code> clausula.</p> </li> <li> <p><code>SAMPLE BY</code> — An expression for sampling.</p> <p>Si se utiliza una expresión de muestreo, la clave principal debe contenerla. Ejemplo: <code>SAMPLE BY intHash32(UserID) ORDER BY (CounterID, EventDate, intHash32(UserID))</code>.</p> </li> <li> <p><code>TTL</code> — A list of rules specifying storage duration of rows and defining logic of automatic parts movement <a href=#table_engine-mergetree-multiple-volumes>entre discos y volúmenes</a>.</p> <p>La expresión debe tener una <code>Date</code> o <code>DateTime</code> columna como resultado. Ejemplo:<br> <code>TTL date + INTERVAL 1 DAY</code></p> <p>Tipo de regla <code>DELETE|TO DISK 'xxx'|TO VOLUME 'xxx'</code> especifica una acción que debe realizarse con la pieza si la expresión está satisfecha (alcanza la hora actual): eliminación de filas caducadas, mover una pieza (si la expresión está satisfecha para todas las filas de una pieza) al disco especificado (<code>TO DISK 'xxx'</code>) o al volumen (<code>TO VOLUME 'xxx'</code>). El tipo predeterminado de la regla es la eliminación (<code>DELETE</code>). Se puede especificar una lista de varias reglas, pero no debe haber más de una <code>DELETE</code> regla.</p> <p>Para obtener más información, consulte <a href=#table_engine-mergetree-ttl>TTL para columnas y tablas</a></p> </li> <li> <p><code>SETTINGS</code> — Additional parameters that control the behavior of the <code>MergeTree</code>:</p> <ul> <li><code>index_granularity</code> — Maximum number of data rows between the marks of an index. Default value: 8192. See <a href=#mergetree-data-storage>Almacenamiento de datos</a>.</li> <li><code>index_granularity_bytes</code> — Maximum size of data granules in bytes. Default value: 10Mb. To restrict the granule size only by number of rows, set to 0 (not recommended). See <a href=#mergetree-data-storage>Almacenamiento de datos</a>.</li> <li><code>enable_mixed_granularity_parts</code> — Enables or disables transitioning to control the granule size with the <code>index_granularity_bytes</code> configuración. Antes de la versión 19.11, sólo existía el <code>index_granularity</code> ajuste para restringir el tamaño del gránulo. El <code>index_granularity_bytes</code> mejora el rendimiento de ClickHouse al seleccionar datos de tablas con filas grandes (decenas y cientos de megabytes). Si tiene tablas con filas grandes, puede habilitar esta configuración para que las tablas mejoren la eficiencia de <code>SELECT</code> consulta.</li> <li><code>use_minimalistic_part_header_in_zookeeper</code> — Storage method of the data parts headers in ZooKeeper. If <code>use_minimalistic_part_header_in_zookeeper=1</code>, entonces ZooKeeper almacena menos datos. Para obtener más información, consulte <a href=../../../../operations/server_configuration_parameters/settings/#server-settings-use_minimalistic_part_header_in_zookeeper>descripción del ajuste</a> en “Server configuration parameters”.</li> <li><code>min_merge_bytes_to_use_direct_io</code> — The minimum data volume for merge operation that is required for using direct I/O access to the storage disk. When merging data parts, ClickHouse calculates the total storage volume of all the data to be merged. If the volume exceeds <code>min_merge_bytes_to_use_direct_io</code> bytes, ClickHouse lee y escribe los datos en el disco de almacenamiento utilizando la interfaz de E / S directa (<code>O_DIRECT</code> opcion). Si <code>min_merge_bytes_to_use_direct_io = 0</code>, entonces la E/S directa está deshabilitada. Valor predeterminado: <code>10 * 1024 * 1024 * 1024</code> byte.<br> <a name=mergetree_setting-merge_with_ttl_timeout></a></li> <li><code>merge_with_ttl_timeout</code> — Minimum delay in seconds before repeating a merge with TTL. Default value: 86400 (1 day).</li> <li><code>write_final_mark</code> — Enables or disables writing the final index mark at the end of data part (after the last byte). Default value: 1. Don't turn it off.</li> <li><code>merge_max_block_size</code> — Maximum number of rows in block for merge operations. Default value: 8192.</li> <li><code>storage_policy</code> — Storage policy. See <a href=#table_engine-mergetree-multiple-volumes>Uso de varios dispositivos de bloque para el almacenamiento de datos</a>.</li> </ul> </li> </ul> <p><strong>Ejemplo de configuración de secciones</strong></p> <div class=codehilite><pre><span></span><code><span class=n>ENGINE</span> <span class=n>MergeTree</span><span class=p>()</span> <span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>EventDate</span><span class=p>)</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=p>(</span><span class=n>CounterID</span><span class=p>,</span> <span class=n>EventDate</span><span class=p>,</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>))</span> <span class=n>SAMPLE</span> <span class=k>BY</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>)</span> <span class=n>SETTINGS</span> <span class=n>index_granularity</span><span class=o>=</span><span class=mi>8192</span>
</code></pre></div> <p>En el ejemplo, configuramos la partición por mes.</p> <p>También establecemos una expresión para el muestreo como un hash por el ID de usuario. Esto le permite pseudoaleatorizar los datos en la tabla para cada <code>CounterID</code> y <code>EventDate</code>. Si define un <a href=../../../../sql_reference/statements/select/#select-sample-clause>SAMPLE</a> cláusula al seleccionar los datos, ClickHouse devolverá una muestra de datos pseudoaleatoria uniforme para un subconjunto de usuarios.</p> <p>El <code>index_granularity</code> se puede omitir porque 8192 es el valor predeterminado.</p> <details> <p><summary>Método obsoleto para crear una tabla</summary></p> <div class="admonition attention"> <p class=admonition-title>Atención</p> <p>No utilice este método en nuevos proyectos. Si es posible, cambie los proyectos antiguos al método descrito anteriormente.</p> </div> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=p>[</span><span class=k>IF</span> <span class=k>NOT</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=k>cluster</span><span class=p>]</span>
<span class=p>(</span>
    <span class=n>name1</span> <span class=p>[</span><span class=n>type1</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr1</span><span class=p>],</span>
    <span class=n>name2</span> <span class=p>[</span><span class=n>type2</span><span class=p>]</span> <span class=p>[</span><span class=k>DEFAULT</span><span class=o>|</span><span class=n>MATERIALIZED</span><span class=o>|</span><span class=k>ALIAS</span> <span class=n>expr2</span><span class=p>],</span>
    <span class=p>...</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=p>[</span><span class=o>=</span><span class=p>]</span> <span class=n>MergeTree</span><span class=p>(</span><span class=nb>date</span><span class=o>-</span><span class=k>column</span> <span class=p>[,</span> <span class=n>sampling_expression</span><span class=p>],</span> <span class=p>(</span><span class=k>primary</span><span class=p>,</span> <span class=k>key</span><span class=p>),</span> <span class=n>index_granularity</span><span class=p>)</span>
</code></pre></div> <p><strong>Parámetros MergeTree()</strong></p> <ul> <li><code>date-column</code> — The name of a column of the <a href=../../../../sql_reference/data_types/date/ >Fecha</a> tipo. ClickHouse crea automáticamente particiones por mes en función de esta columna. Los nombres de partición están en el <code>"YYYYMM"</code> formato.</li> <li><code>sampling_expression</code> — An expression for sampling.</li> <li><code>(primary, key)</code> — Primary key. Type: <a href=../../../../sql_reference/data_types/tuple/ >Tupla()</a></li> <li><code>index_granularity</code> — The granularity of an index. The number of data rows between the “marks” de un índice. El valor 8192 es apropiado para la mayoría de las tareas.</li> </ul> <p><strong>Ejemplo</strong></p> <div class=codehilite><pre><span></span><code><span class=n>MergeTree</span><span class=p>(</span><span class=n>EventDate</span><span class=p>,</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>),</span> <span class=p>(</span><span class=n>CounterID</span><span class=p>,</span> <span class=n>EventDate</span><span class=p>,</span> <span class=n>intHash32</span><span class=p>(</span><span class=n>UserID</span><span class=p>)),</span> <span class=mi>8192</span><span class=p>)</span>
</code></pre></div> <p>El <code>MergeTree</code> engine se configura de la misma manera que en el ejemplo anterior para el método de configuración del motor principal.</p> </details> <h2 id=mergetree-data-storage>Almacenamiento de datos<a class=headerlink href=#mergetree-data-storage title="Permanent link">&para;</a></h2> <p>Una tabla consta de partes de datos ordenadas por clave principal.</p> <p>Cuando se insertan datos en una tabla, se crean partes de datos separadas y cada una de ellas se ordena lexicográficamente por clave principal. Por ejemplo, si la clave principal es <code>(CounterID, Date)</code>, los datos en la parte se ordenan por <code>CounterID</code>, y dentro de cada <code>CounterID</code> es ordenado por <code>Date</code>.</p> <p>Los datos que pertenecen a diferentes particiones se separan en diferentes partes. En el fondo, ClickHouse combina partes de datos para un almacenamiento más eficiente. Las piezas que pertenecen a particiones diferentes no se fusionan. El mecanismo de combinación no garantiza que todas las filas con la misma clave principal estén en la misma parte de datos.</p> <p>Cada parte de datos se divide lógicamente en gránulos. Un gránulo es el conjunto de datos indivisibles más pequeño que ClickHouse lee al seleccionar datos. ClickHouse no divide filas o valores, por lo que cada gránulo siempre contiene un número entero de filas. La primera fila de un gránulo está marcada con el valor de la clave principal de la fila. Para cada parte de datos, ClickHouse crea un archivo de índice que almacena las marcas. Para cada columna, ya sea en la clave principal o no, ClickHouse también almacena las mismas marcas. Estas marcas le permiten encontrar datos directamente en archivos de columnas.</p> <p>El tamaño del gránulo es restringido por <code>index_granularity</code> y <code>index_granularity_bytes</code> configuración del motor de tabla. El número de filas en un gránulo se encuentra en el <code>[1, index_granularity]</code> rango, dependiendo del tamaño de las filas. El tamaño de un gránulo puede exceder <code>index_granularity_bytes</code> si el tamaño de una sola fila es mayor que el valor de la configuración. En este caso, el tamaño del gránulo es igual al tamaño de la fila.</p> <h2 id=primary-keys-and-indexes-in-queries>Claves e índices principales en consultas<a class=headerlink href=#primary-keys-and-indexes-in-queries title="Permanent link">&para;</a></h2> <p>Tome el <code>(CounterID, Date)</code> clave primaria como ejemplo. En este caso, la clasificación y el índice se pueden ilustrar de la siguiente manera:</p> <div class=codehilite><pre><span></span><code><span class=w>  </span><span class=n>Whole</span><span class=w> </span><span class=k>data</span><span class=err>:</span><span class=w>     </span><span class=o>[</span><span class=n>---------------------------------------------</span><span class=o>]</span><span class=w></span>
<span class=w>  </span><span class=nl>CounterID</span><span class=p>:</span><span class=w>      </span><span class=o>[</span><span class=n>aaaaaaaaaaaaaaaaaabbbbcdeeeeeeeeeeeeefgggggggghhhhhhhhhiiiiiiiiikllllllll</span><span class=o>]</span><span class=w></span>
<span class=w>  </span><span class=nc>Date</span><span class=err>:</span><span class=w>           </span><span class=o>[</span><span class=n>1111111222222233331233211111222222333211111112122222223111112223311122333</span><span class=o>]</span><span class=w></span>
<span class=w>  </span><span class=nl>Marks</span><span class=p>:</span><span class=w>           </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w>      </span><span class=o>|</span><span class=w></span>
<span class=w>                  </span><span class=n>a</span><span class=p>,</span><span class=mi>1</span><span class=w>    </span><span class=n>a</span><span class=p>,</span><span class=mi>2</span><span class=w>    </span><span class=n>a</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>b</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>e</span><span class=p>,</span><span class=mi>2</span><span class=w>    </span><span class=n>e</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>g</span><span class=p>,</span><span class=mi>1</span><span class=w>    </span><span class=n>h</span><span class=p>,</span><span class=mi>2</span><span class=w>    </span><span class=n>i</span><span class=p>,</span><span class=mi>1</span><span class=w>    </span><span class=n>i</span><span class=p>,</span><span class=mi>3</span><span class=w>    </span><span class=n>l</span><span class=p>,</span><span class=mi>3</span><span class=w></span>
<span class=w>  </span><span class=n>Marks</span><span class=w> </span><span class=nl>numbers</span><span class=p>:</span><span class=w>   </span><span class=mi>0</span><span class=w>      </span><span class=mi>1</span><span class=w>      </span><span class=mi>2</span><span class=w>      </span><span class=mi>3</span><span class=w>      </span><span class=mi>4</span><span class=w>      </span><span class=mi>5</span><span class=w>      </span><span class=mi>6</span><span class=w>      </span><span class=mi>7</span><span class=w>      </span><span class=mi>8</span><span class=w>      </span><span class=mi>9</span><span class=w>      </span><span class=mi>10</span><span class=w></span>
</code></pre></div> <p>Si la consulta de datos especifica:</p> <ul> <li><code>CounterID in ('a', 'h')</code>, el servidor lee los datos en los rangos de marcas <code>[0, 3)</code> y <code>[6, 8)</code>.</li> <li><code>CounterID IN ('a', 'h') AND Date = 3</code>, el servidor lee los datos en los rangos de marcas <code>[1, 3)</code> y <code>[7, 8)</code>.</li> <li><code>Date = 3</code>, el servidor lee los datos en el rango de marcas <code>[1, 10]</code>.</li> </ul> <p>Los ejemplos anteriores muestran que siempre es más efectivo usar un índice que un análisis completo.</p> <p>Un índice disperso permite leer datos adicionales. Al leer un único rango de la clave primaria, hasta <code>index_granularity * 2</code> se pueden leer filas adicionales en cada bloque de datos.</p> <p>Los índices dispersos le permiten trabajar con una gran cantidad de filas de tabla, porque en la mayoría de los casos, dichos índices caben en la RAM de la computadora.</p> <p>ClickHouse no requiere una clave principal única. Puede insertar varias filas con la misma clave principal.</p> <h3 id=selecting-the-primary-key>Selección de la clave principal<a class=headerlink href=#selecting-the-primary-key title="Permanent link">&para;</a></h3> <p>El número de columnas en la clave principal no está explícitamente limitado. Dependiendo de la estructura de datos, puede incluir más o menos columnas en la clave principal. Esto puede:</p> <ul> <li> <p>Mejorar el rendimiento de un índice.</p> <p>Si la clave principal es <code>(a, b)</code>, a continuación, añadir otra columna <code>c</code> mejorará el rendimiento si se cumplen las siguientes condiciones:</p> <ul> <li>Hay consultas con una condición en la columna <code>c</code>.</li> <li>Rangos de datos largos (varias veces más <code>index_granularity</code>) con valores idénticos para <code>(a, b)</code> son comunes. En otras palabras, al agregar otra columna le permite omitir rangos de datos bastante largos.</li> </ul> </li> <li> <p>Mejorar la compresión de datos.</p> <p>ClickHouse ordena los datos por clave principal, por lo que cuanto mayor sea la consistencia, mejor será la compresión.</p> </li> <li> <p>Proporcione una lógica adicional al fusionar partes de datos en el <a href=../collapsingmergetree/#table_engine-collapsingmergetree>ColapsarMergeTree</a> y <a href=../summingmergetree/ >SummingMergeTree</a> motor.</p> <p>En este caso tiene sentido especificar el <em>clave de clasificación</em> que es diferente de la clave principal.</p> </li> </ul> <p>Una clave principal larga afectará negativamente al rendimiento de la inserción y al consumo de memoria, pero las columnas adicionales de la clave principal no afectarán al rendimiento de ClickHouse durante <code>SELECT</code> consulta.</p> <h3 id=choosing-a-primary-key-that-differs-from-the-sorting-key>Elegir una clave principal que difiere de la clave de ordenación<a class=headerlink href=#choosing-a-primary-key-that-differs-from-the-sorting-key title="Permanent link">&para;</a></h3> <p>Es posible especificar una clave principal (una expresión con valores que se escriben en el archivo de índice para cada marca) que es diferente de la clave de ordenación (una expresión para ordenar las filas en partes de datos). En este caso, la tupla de expresión de clave primaria debe ser un prefijo de la tupla de expresión de clave de ordenación.</p> <p>Esta característica es útil cuando se <a href=../summingmergetree/ >SummingMergeTree</a> y<br> <a href=../aggregatingmergetree/ >AgregaciónMergeTree</a> motores de mesa. En un caso común cuando se utilizan estos motores, la tabla tiene dos tipos de columnas: <em>cota</em> y <em>medida</em>. Las consultas típicas agregan valores de columnas de medida con <code>GROUP BY</code> y filtrado por dimensiones. Debido a que SummingMergeTree y AggregatingMergeTree agregan filas con el mismo valor de la clave de ordenación, es natural agregarle todas las dimensiones. Como resultado, la expresión de clave consta de una larga lista de columnas y esta lista debe actualizarse con frecuencia con las dimensiones recién agregadas.</p> <p>En este caso, tiene sentido dejar solo unas pocas columnas en la clave principal que proporcionarán análisis de rango eficientes y agregarán las columnas de dimensión restantes a la tupla de clave de clasificación.</p> <p><a href=../../../../sql_reference/statements/alter/ >ALTER</a> de la clave de ordenación es una operación ligera porque cuando se agrega una nueva columna simultáneamente a la tabla y a la clave de ordenación, las partes de datos existentes no necesitan ser cambiadas. Dado que la clave de ordenación anterior es un prefijo de la nueva clave de ordenación y no hay datos en la columna recién agregada, los datos se ordenan tanto por las claves de ordenación antiguas como por las nuevas en el momento de la modificación de la tabla.</p> <h3 id=use-of-indexes-and-partitions-in-queries>Uso de índices y particiones en consultas<a class=headerlink href=#use-of-indexes-and-partitions-in-queries title="Permanent link">&para;</a></h3> <p>Para <code>SELECT</code> consultas, ClickHouse analiza si se puede usar un índice. Se puede usar un índice si el <code>WHERE/PREWHERE</code> clause tiene una expresión (como uno de los elementos de conjunción, o enteramente) que representa una operación de comparación de igualdad o desigualdad, o si tiene <code>IN</code> o <code>LIKE</code> con un prefijo fijo en columnas o expresiones que están en la clave principal o clave de partición, o en ciertas funciones parcialmente repetitivas de estas columnas, o relaciones lógicas de estas expresiones.</p> <p>Por lo tanto, es posible ejecutar rápidamente consultas en uno o varios rangos de la clave principal. En este ejemplo, las consultas serán rápidas cuando se ejecuten para una etiqueta de seguimiento específica, para una etiqueta y un intervalo de fechas específicos, para una etiqueta y una fecha específicas, para varias etiquetas con un intervalo de fechas, etc.</p> <p>Veamos el motor configurado de la siguiente manera:</p> <div class=codehilite><pre><span></span><code><span class=err>  ENGINE MergeTree() PARTITION BY toYYYYMM(EventDate) ORDER BY (CounterID, EventDate) SETTINGS index_granularity=8192</span>
</code></pre></div> <p>En este caso, en consultas:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>EventDate</span> <span class=o>=</span> <span class=n>toDate</span><span class=p>(</span><span class=n>now</span><span class=p>())</span> <span class=k>AND</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>34</span>
<span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>EventDate</span> <span class=o>=</span> <span class=n>toDate</span><span class=p>(</span><span class=n>now</span><span class=p>())</span> <span class=k>AND</span> <span class=p>(</span><span class=n>CounterID</span> <span class=o>=</span> <span class=mi>34</span> <span class=k>OR</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>42</span><span class=p>)</span>
<span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=p>((</span><span class=n>EventDate</span> <span class=o>&gt;=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-01-01&#39;</span><span class=p>)</span> <span class=k>AND</span> <span class=n>EventDate</span> <span class=o>&lt;=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-01-31&#39;</span><span class=p>))</span> <span class=k>OR</span> <span class=n>EventDate</span> <span class=o>=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-05-01&#39;</span><span class=p>))</span> <span class=k>AND</span> <span class=n>CounterID</span> <span class=k>IN</span> <span class=p>(</span><span class=mi>101500</span><span class=p>,</span> <span class=mi>731962</span><span class=p>,</span> <span class=mi>160656</span><span class=p>)</span> <span class=k>AND</span> <span class=p>(</span><span class=n>CounterID</span> <span class=o>=</span> <span class=mi>101500</span> <span class=k>OR</span> <span class=n>EventDate</span> <span class=o>!=</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>&#39;2014-05-01&#39;</span><span class=p>))</span>
</code></pre></div> <p>ClickHouse utilizará el índice de clave principal para recortar datos incorrectos y la clave de partición mensual para recortar particiones que están en intervalos de fechas incorrectos.</p> <p>Las consultas anteriores muestran que el índice se usa incluso para expresiones complejas. La lectura de la tabla está organizada de modo que el uso del índice no puede ser más lento que un escaneo completo.</p> <p>En el siguiente ejemplo, el índice no se puede usar.</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>34</span> <span class=k>OR</span> <span class=n>URL</span> <span class=k>LIKE</span> <span class=s1>&#39;%upyachka%&#39;</span>
</code></pre></div> <p>Para comprobar si ClickHouse puede usar el índice al ejecutar una consulta, use la configuración <a href=../../../../operations/settings/settings/#settings-force_index_by_date>Fecha de nacimiento</a> y <a href=../../../../operations/settings/settings/ >force_primary_key</a>.</p> <p>La clave para particionar por mes permite leer solo aquellos bloques de datos que contienen fechas del rango adecuado. En este caso, el bloque de datos puede contener datos para muchas fechas (hasta un mes). Dentro de un bloque, los datos se ordenan por clave principal, que puede no contener la fecha como la primera columna. Debido a esto, el uso de una consulta con solo una condición de fecha que no especifica el prefijo de clave principal hará que se lean más datos que para una sola fecha.</p> <h3 id=use-of-index-for-partially-monotonic-primary-keys>Uso del índice para claves primarias parcialmente monotónicas<a class=headerlink href=#use-of-index-for-partially-monotonic-primary-keys title="Permanent link">&para;</a></h3> <p>Considere, por ejemplo, los días del mes. Ellos forman un <a href=https://en.wikipedia.org/wiki/Monotonic_function rel="external nofollow noreferrer">monótona secuencia</a> durante un mes, pero no monótono durante períodos más prolongados. Esta es una secuencia parcialmente monotónica. Si un usuario crea la tabla con clave primaria parcialmente monótona, ClickHouse crea un índice disperso como de costumbre. Cuando un usuario selecciona datos de este tipo de tabla, ClickHouse analiza las condiciones de consulta. Si el usuario desea obtener datos entre dos marcas del índice y ambas marcas caen dentro de un mes, ClickHouse puede usar el índice en este caso particular porque puede calcular la distancia entre los parámetros de una consulta y las marcas de índice.</p> <p>ClickHouse no puede usar un índice si los valores de la clave principal en el rango de parámetros de consulta no representan una secuencia monotónica. En este caso, ClickHouse utiliza el método de análisis completo.</p> <p>ClickHouse usa esta lógica no solo para secuencias de días del mes, sino para cualquier clave principal que represente una secuencia parcialmente monotónica.</p> <h3 id=table_engine-mergetree-data_skipping-indexes>Índices de saltos de datos (experimental)<a class=headerlink href=#table_engine-mergetree-data_skipping-indexes title="Permanent link">&para;</a></h3> <p>La declaración de índice se encuentra en la sección de columnas del <code>CREATE</code> consulta.</p> <div class=codehilite><pre><span></span><code><span class=k>INDEX</span> <span class=n>index_name</span> <span class=n>expr</span> <span class=k>TYPE</span> <span class=k>type</span><span class=p>(...)</span> <span class=n>GRANULARITY</span> <span class=n>granularity_value</span>
</code></pre></div> <p>Para tablas de la <code>*MergeTree</code> familia, se pueden especificar índices de omisión de datos.</p> <p>Estos índices agregan cierta información sobre la expresión especificada en bloques, que consisten en <code>granularity_value</code> gránulos (el tamaño del gránulo se especifica utilizando el <code>index_granularity</code> ajuste en el motor de la tabla). Entonces estos agregados se usan en <code>SELECT</code> consultas para reducir la cantidad de datos a leer desde el disco omitiendo grandes bloques de datos donde el <code>where</code> consulta no puede ser satisfecha.</p> <p><strong>Ejemplo</strong></p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=k>table_name</span>
<span class=p>(</span>
    <span class=n>u64</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>i32</span> <span class=n>Int32</span><span class=p>,</span>
    <span class=n>s</span> <span class=n>String</span><span class=p>,</span>
    <span class=p>...</span>
    <span class=k>INDEX</span> <span class=n>a</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=n>i32</span><span class=p>,</span> <span class=n>s</span><span class=p>)</span> <span class=k>TYPE</span> <span class=n>minmax</span> <span class=n>GRANULARITY</span> <span class=mi>3</span><span class=p>,</span>
    <span class=k>INDEX</span> <span class=n>b</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>s</span><span class=p>))</span> <span class=k>TYPE</span> <span class=k>set</span><span class=p>(</span><span class=mi>1000</span><span class=p>)</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span><span class=p>()</span>
<span class=p>...</span>
</code></pre></div> <p>ClickHouse puede utilizar los índices del ejemplo para reducir la cantidad de datos que se leen desde el disco en las siguientes consultas:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>s</span> <span class=o>&lt;</span> <span class=s1>&#39;z&#39;</span>
<span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=k>table</span> <span class=k>WHERE</span> <span class=n>u64</span> <span class=o>*</span> <span class=n>i32</span> <span class=o>==</span> <span class=mi>10</span> <span class=k>AND</span> <span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>1234</span>
</code></pre></div> <h4 id=available-types-of-indices>Tipos de índices disponibles<a class=headerlink href=#available-types-of-indices title="Permanent link">&para;</a></h4> <ul> <li> <p><code>minmax</code></p> <p>Almacena los extremos de la expresión especificada (si la expresión <code>tuple</code>, entonces almacena extremos para cada elemento de <code>tuple</code>), utiliza información almacenada para omitir bloques de datos como la clave principal.</p> </li> <li> <p><code>set(max_rows)</code></p> <p>Almacena valores únicos de la expresión especificada (no más de <code>max_rows</code> filas, <code>max_rows=0</code> medio “no limits”). Utiliza los valores para comprobar si <code>WHERE</code> expresión no es satisfactorio en un bloque de datos.</p> </li> <li> <p><code>ngrambf_v1(n, size_of_bloom_filter_in_bytes, number_of_hash_functions, random_seed)</code></p> <p>Tiendas a <a href=https://en.wikipedia.org/wiki/Bloom_filter rel="external nofollow noreferrer">Bloom filter</a> que contiene todos los ngrams de un bloque de datos. Funciona solo con cadenas. Puede ser utilizado para la optimización de <code>equals</code>, <code>like</code> y <code>in</code> expresiones.</p> <ul> <li><code>n</code> — ngram size,</li> <li><code>size_of_bloom_filter_in_bytes</code> — Bloom filter size in bytes (you can use large values here, for example, 256 or 512, because it can be compressed well).</li> <li><code>number_of_hash_functions</code> — The number of hash functions used in the Bloom filter.</li> <li><code>random_seed</code> — The seed for Bloom filter hash functions.</li> </ul> </li> <li> <p><code>tokenbf_v1(size_of_bloom_filter_in_bytes, number_of_hash_functions, random_seed)</code></p> <p>Lo mismo que <code>ngrambf_v1</code>, pero almacena tokens en lugar de ngrams. Los tokens son secuencias separadas por caracteres no alfanuméricos.</p> </li> <li> <p><code>bloom_filter([false_positive])</code> — Stores a <a href=https://en.wikipedia.org/wiki/Bloom_filter rel="external nofollow noreferrer">Filtro de floración</a> para las columnas especificadas.</p> <p>Opcional <code>false_positive</code> parámetro es la probabilidad de recibir una respuesta falsa positiva del filtro. Valores posibles: (0, 1). Valor predeterminado: 0.025.</p> <p>Tipos de datos admitidos: <code>Int*</code>, <code>UInt*</code>, <code>Float*</code>, <code>Enum</code>, <code>Date</code>, <code>DateTime</code>, <code>String</code>, <code>FixedString</code>, <code>Array</code>, <code>LowCardinality</code>, <code>Nullable</code>.</p> <p>Las siguientes funciones pueden usarlo: <a href=../../../../sql_reference/functions/comparison_functions/ >igual</a>, <a href=../../../../sql_reference/functions/comparison_functions/ >notEquals</a>, <a href=../../../../sql_reference/functions/in_functions/ >en</a>, <a href=../../../../sql_reference/functions/in_functions/ >noEn</a>, <a href=../../../../sql_reference/functions/array_functions/ >tener</a>.</p> </li> </ul> <!-- --> <div class=codehilite><pre><span></span><code><span class=k>INDEX</span> <span class=n>sample_index</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>s</span><span class=p>))</span> <span class=k>TYPE</span> <span class=n>minmax</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
<span class=k>INDEX</span> <span class=n>sample_index2</span> <span class=p>(</span><span class=n>u64</span> <span class=o>*</span> <span class=k>length</span><span class=p>(</span><span class=n>str</span><span class=p>),</span> <span class=n>i32</span> <span class=o>+</span> <span class=n>f64</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=nb>date</span><span class=p>,</span> <span class=n>str</span><span class=p>)</span> <span class=k>TYPE</span> <span class=k>set</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
<span class=k>INDEX</span> <span class=n>sample_index3</span> <span class=p>(</span><span class=k>lower</span><span class=p>(</span><span class=n>str</span><span class=p>),</span> <span class=n>str</span><span class=p>)</span> <span class=k>TYPE</span> <span class=n>ngrambf_v1</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>256</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=n>GRANULARITY</span> <span class=mi>4</span>
</code></pre></div> <h4 id=functions-support>Funciones de apoyo<a class=headerlink href=#functions-support title="Permanent link">&para;</a></h4> <p>Condiciones en el <code>WHERE</code> cláusula contiene llamadas de las funciones que operan con columnas. Si la columna forma parte de un índice, ClickHouse intenta usar este índice al realizar las funciones. ClickHouse admite diferentes subconjuntos de funciones para usar índices.</p> <p>El <code>set</code> index se puede utilizar con todas las funciones. Subconjuntos de funciones para otros índices se muestran en la siguiente tabla.</p> <table> <thead> <tr> <th>Función (operador) / Índice</th> <th>clave primaria</th> <th>minmax</th> <th>Descripción</th> <th>Sistema abierto.</th> <th>bloom_filter</th> </tr> </thead> <tbody> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-equals>igual (=, ==)</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-notequals>notEquals(!=, \&lt;>)</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_search_functions/#function-like>como</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_search_functions/#function-notlike>No como</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_functions/#startswith>Comienza con</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_functions/#endswith>Finaliza con</a></td> <td>✗</td> <td>✗</td> <td>✔</td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/string_search_functions/#function-multisearchany>multiSearchAny</a></td> <td>✗</td> <td>✗</td> <td>✔</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/in_functions/#in-functions>en</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/in_functions/#in-functions>noEn</a></td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-less>menos (\&lt;)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-greater>mayor (>)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-lessorequals>menosOrEquals (\&lt;=)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/comparison_functions/#function-greaterorequals>mayorOrEquals (>=)</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/array_functions/#function-empty>vaciar</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td><a href=../../../../sql_reference/functions/array_functions/#function-notempty>notEmpty</a></td> <td>✔</td> <td>✔</td> <td>✗</td> <td>✗</td> <td>✗</td> </tr> <tr> <td>hasToken</td> <td>✗</td> <td>✗</td> <td>✗</td> <td>✔</td> <td>✗</td> </tr> </tbody> </table> <p>Las funciones con un argumento constante que es menor que el tamaño de ngram no pueden ser utilizadas por <code>ngrambf_v1</code> para la optimización de consultas.</p> <p>Los filtros Bloom pueden tener coincidencias falsas positivas, por lo que <code>ngrambf_v1</code>, <code>tokenbf_v1</code>, y <code>bloom_filter</code> los índices no se pueden usar para optimizar consultas donde se espera que el resultado de una función sea falso, por ejemplo:</p> <ul> <li>Puede ser optimizado:<ul> <li><code>s LIKE '%test%'</code></li> <li><code>NOT s NOT LIKE '%test%'</code></li> <li><code>s = 1</code></li> <li><code>NOT s != 1</code></li> <li><code>startsWith(s, 'test')</code></li> </ul> </li> <li>No se puede optimizar:<ul> <li><code>NOT s LIKE '%test%'</code></li> <li><code>s NOT LIKE '%test%'</code></li> <li><code>NOT s = 1</code></li> <li><code>s != 1</code></li> <li><code>NOT startsWith(s, 'test')</code></li> </ul> </li> </ul> <h2 id=concurrent-data-access>Acceso a datos simultáneos<a class=headerlink href=#concurrent-data-access title="Permanent link">&para;</a></h2> <p>Para el acceso simultáneo a tablas, usamos versiones múltiples. En otras palabras, cuando una tabla se lee y actualiza simultáneamente, los datos se leen de un conjunto de partes que está actualizado en el momento de la consulta. No hay cerraduras largas. Las inserciones no se interponen en el camino de las operaciones de lectura.</p> <p>La lectura de una tabla se paralela automáticamente.</p> <h2 id=table_engine-mergetree-ttl>TTL para columnas y tablas<a class=headerlink href=#table_engine-mergetree-ttl title="Permanent link">&para;</a></h2> <p>Determina la duración de los valores.</p> <p>El <code>TTL</code> se puede establecer para toda la tabla y para cada columna individual. TTL de nivel de tabla también puede especificar la lógica de movimiento automático de datos entre discos y volúmenes.</p> <p>Las expresiones deben evaluar <a href=../../../../sql_reference/data_types/date/ >Fecha</a> o <a href=../../../../sql_reference/data_types/datetime/ >FechaHora</a> tipo de datos.</p> <p>Ejemplo:</p> <div class=codehilite><pre><span></span><code><span class=n>TTL</span> <span class=n>time_column</span>
<span class=n>TTL</span> <span class=n>time_column</span> <span class=o>+</span> <span class=nb>interval</span>
</code></pre></div> <p>Definir <code>interval</code>, utilizar <a href=../../../../sql_reference/operators/#operators-datetime>intervalo de tiempo</a> operador.</p> <div class=codehilite><pre><span></span><code><span class=n>TTL</span> <span class=n>date_time</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span>
<span class=n>TTL</span> <span class=n>date_time</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>15</span> <span class=n>HOUR</span>
</code></pre></div> <h3 id=mergetree-column-ttl>Columna TTL<a class=headerlink href=#mergetree-column-ttl title="Permanent link">&para;</a></h3> <p>Cuando los valores de la columna caducan, ClickHouse los reemplaza con los valores predeterminados para el tipo de datos de columna. Si todos los valores de columna en la parte de datos caducan, ClickHouse elimina esta columna de la parte de datos en un sistema de archivos.</p> <p>El <code>TTL</code> cláusula no se puede utilizar para columnas clave.</p> <p>Ejemplos:</p> <p>Creación de una tabla con TTL</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>example_table</span>
<span class=p>(</span>
    <span class=n>d</span> <span class=n>DateTime</span><span class=p>,</span>
    <span class=n>a</span> <span class=nb>Int</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span><span class=p>,</span>
    <span class=n>b</span> <span class=nb>Int</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span><span class=p>,</span>
    <span class=k>c</span> <span class=n>String</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>d</span><span class=p>;</span>
</code></pre></div> <p>Adición de TTL a una columna de una tabla existente</p> <div class=codehilite><pre><span></span><code><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>example_table</span>
    <span class=k>MODIFY</span> <span class=k>COLUMN</span>
    <span class=k>c</span> <span class=n>String</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>DAY</span><span class=p>;</span>
</code></pre></div> <p>Modificación de TTL de la columna</p> <div class=codehilite><pre><span></span><code><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>example_table</span>
    <span class=k>MODIFY</span> <span class=k>COLUMN</span>
    <span class=k>c</span> <span class=n>String</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span><span class=p>;</span>
</code></pre></div> <h3 id=mergetree-table-ttl>Tabla TTL<a class=headerlink href=#mergetree-table-ttl title="Permanent link">&para;</a></h3> <p>La tabla puede tener una expresión para la eliminación de filas caducadas y varias expresiones para el movimiento automático de partes entre <a href=#table_engine-mergetree-multiple-volumes>discos o volúmenes</a>. Cuando las filas de la tabla caducan, ClickHouse elimina todas las filas correspondientes. Para la entidad de movimiento de piezas, todas las filas de una pieza deben cumplir los criterios de expresión de movimiento.</p> <div class=codehilite><pre><span></span><code><span class=n>TTL</span> <span class=n>expr</span> <span class=p>[</span><span class=k>DELETE</span><span class=o>|</span><span class=k>TO</span> <span class=n>DISK</span> <span class=s1>&#39;aaa&#39;</span><span class=o>|</span><span class=k>TO</span> <span class=n>VOLUME</span> <span class=s1>&#39;bbb&#39;</span><span class=p>],</span> <span class=p>...</span>
</code></pre></div> <p>El tipo de regla TTL puede seguir cada expresión TTL. Afecta a una acción que debe realizarse una vez que se satisface la expresión (alcanza la hora actual):</p> <ul> <li><code>DELETE</code> - Eliminar filas caducadas (acción predeterminada);</li> <li><code>TO DISK 'aaa'</code> - mover parte al disco <code>aaa</code>;</li> <li><code>TO VOLUME 'bbb'</code> - mover parte al disco <code>bbb</code>.</li> </ul> <p>Ejemplos:</p> <p>Creación de una tabla con TTL</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>example_table</span>
<span class=p>(</span>
    <span class=n>d</span> <span class=n>DateTime</span><span class=p>,</span>
    <span class=n>a</span> <span class=nb>Int</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>d</span><span class=p>)</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>d</span>
<span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>MONTH</span> <span class=p>[</span><span class=k>DELETE</span><span class=p>],</span>
    <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=n>WEEK</span> <span class=k>TO</span> <span class=n>VOLUME</span> <span class=s1>&#39;aaa&#39;</span><span class=p>,</span>
    <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>2</span> <span class=n>WEEK</span> <span class=k>TO</span> <span class=n>DISK</span> <span class=s1>&#39;bbb&#39;</span><span class=p>;</span>
</code></pre></div> <p>Modificación de TTL de la tabla</p> <div class=codehilite><pre><span></span><code><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>example_table</span>
    <span class=k>MODIFY</span> <span class=n>TTL</span> <span class=n>d</span> <span class=o>+</span> <span class=nb>INTERVAL</span> <span class=mi>1</span> <span class=k>DAY</span><span class=p>;</span>
</code></pre></div> <p><strong>Eliminación de datos</strong></p> <p>Los datos con un TTL caducado se eliminan cuando ClickHouse fusiona partes de datos.</p> <p>Cuando ClickHouse ve que los datos han caducado, realiza una combinación fuera de programación. Para controlar la frecuencia de tales fusiones, puede establecer <a href=#mergetree_setting-merge_with_ttl_timeout>Método de codificación de datos:</a>. Si el valor es demasiado bajo, realizará muchas fusiones fuera de horario que pueden consumir muchos recursos.</p> <p>Si realiza el <code>SELECT</code> consulta entre fusiones, puede obtener datos caducados. Para evitarlo, use el <a href=../../../../sql_reference/statements/misc/#misc_operations-optimize>OPTIMIZE</a> consulta antes <code>SELECT</code>.</p> <h2 id=table_engine-mergetree-multiple-volumes>Uso de múltiples dispositivos de bloque para el almacenamiento de datos<a class=headerlink href=#table_engine-mergetree-multiple-volumes title="Permanent link">&para;</a></h2> <h3 id=introduction>Implantación<a class=headerlink href=#introduction title="Permanent link">&para;</a></h3> <p><code>MergeTree</code> Los motores de tablas familiares pueden almacenar datos en múltiples dispositivos de bloque. Por ejemplo, puede ser útil cuando los datos de una determinada tabla se dividen implícitamente en “hot” y “cold”. Los datos más recientes se solicitan regularmente, pero solo requieren una pequeña cantidad de espacio. Por el contrario, los datos históricos de cola gorda se solicitan raramente. Si hay varios discos disponibles, el “hot” los datos pueden estar ubicados en discos rápidos (por ejemplo, SSD NVMe o en memoria), mientras que “cold” datos - en los relativamente lentos (por ejemplo, HDD).</p> <p>La parte de datos es la unidad móvil mínima para <code>MergeTree</code>-mesas de motor. Los datos que pertenecen a una parte se almacenan en un disco. Las partes de datos se pueden mover entre discos en segundo plano (según la configuración del usuario) así como por medio de la <a href=../../../../sql_reference/statements/alter/#alter_move-partition>ALTER</a> consulta.</p> <h3 id=terms>Plazo<a class=headerlink href=#terms title="Permanent link">&para;</a></h3> <ul> <li>Disk — Block device mounted to the filesystem.</li> <li>Default disk — Disk that stores the path specified in the <a href=../../../../operations/server_configuration_parameters/settings/#server_configuration_parameters-path>camino</a> configuración del servidor.</li> <li>Volume — Ordered set of equal disks (similar to <a href=https://en.wikipedia.org/wiki/Non-RAID_drive_architectures rel="external nofollow noreferrer">JBOD</a>).</li> <li>Storage policy — Set of volumes and the rules for moving data between them.</li> </ul> <p>Los nombres dados a las entidades descritas se pueden encontrar en las tablas del sistema, <a href=../../../../operations/system_tables/#system_tables-storage_policies>sistema.almacenamiento_policies</a> y <a href=../../../../operations/system_tables/#system_tables-disks>sistema.disco</a>. Para aplicar una de las directivas de almacenamiento configuradas para una tabla, <code>storage_policy</code> establecimiento de <code>MergeTree</code>-motor de la familia de las tablas.</p> <h3 id=table_engine-mergetree-multiple-volumes-configure>Configuración<a class=headerlink href=#table_engine-mergetree-multiple-volumes-configure title="Permanent link">&para;</a></h3> <p>Discos, volúmenes y políticas de almacenamiento deben ser declaradas dentro de la <code>&lt;storage_configuration&gt;</code> etiqueta ya sea en el archivo principal <code>config.xml</code> o en un archivo distinto en el <code>config.d</code> directorio.</p> <p>Configuración de la estructura:</p> <div class=codehilite><pre><span></span><code><span class=nt>&lt;storage_configuration&gt;</span>
    <span class=nt>&lt;disks&gt;</span>
        <span class=nt>&lt;disk_name_1&gt;</span> <span class=c>&lt;!-- disk name --&gt;</span>
            <span class=nt>&lt;path&gt;</span>/mnt/fast_ssd/clickhouse<span class=nt>&lt;/path&gt;</span>
        <span class=nt>&lt;/disk_name_1&gt;</span>
        <span class=nt>&lt;disk_name_2&gt;</span>
            <span class=nt>&lt;path&gt;</span>/mnt/hdd1/clickhouse<span class=nt>&lt;/path&gt;</span>
            <span class=nt>&lt;keep_free_space_bytes&gt;</span>10485760<span class=nt>&lt;/keep_free_space_bytes&gt;</span>
        <span class=nt>&lt;/disk_name_2&gt;</span>
        <span class=nt>&lt;disk_name_3&gt;</span>
            <span class=nt>&lt;path&gt;</span>/mnt/hdd2/clickhouse<span class=nt>&lt;/path&gt;</span>
            <span class=nt>&lt;keep_free_space_bytes&gt;</span>10485760<span class=nt>&lt;/keep_free_space_bytes&gt;</span>
        <span class=nt>&lt;/disk_name_3&gt;</span>

        ...
    <span class=nt>&lt;/disks&gt;</span>

    ...
<span class=nt>&lt;/storage_configuration&gt;</span>
</code></pre></div> <p>Tags:</p> <ul> <li><code>&lt;disk_name_N&gt;</code> — Disk name. Names must be different for all disks.</li> <li><code>path</code> — path under which a server will store data (<code>data</code> y <code>shadow</code> carpetas), debe terminarse con ‘/’.</li> <li><code>keep_free_space_bytes</code> — the amount of free disk space to be reserved.</li> </ul> <p>El orden de la definición del disco no es importante.</p> <p>Marcado de configuración de directivas de almacenamiento:</p> <div class=codehilite><pre><span></span><code><span class=nt>&lt;storage_configuration&gt;</span>
    ...
    <span class=nt>&lt;policies&gt;</span>
        <span class=nt>&lt;policy_name_1&gt;</span>
            <span class=nt>&lt;volumes&gt;</span>
                <span class=nt>&lt;volume_name_1&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk_name_from_disks_configuration<span class=nt>&lt;/disk&gt;</span>
                    <span class=nt>&lt;max_data_part_size_bytes&gt;</span>1073741824<span class=nt>&lt;/max_data_part_size_bytes&gt;</span>
                <span class=nt>&lt;/volume_name_1&gt;</span>
                <span class=nt>&lt;volume_name_2&gt;</span>
                    <span class=c>&lt;!-- configuration --&gt;</span>
                <span class=nt>&lt;/volume_name_2&gt;</span>
                <span class=c>&lt;!-- more volumes --&gt;</span>
            <span class=nt>&lt;/volumes&gt;</span>
            <span class=nt>&lt;move_factor&gt;</span>0.2<span class=nt>&lt;/move_factor&gt;</span>
        <span class=nt>&lt;/policy_name_1&gt;</span>
        <span class=nt>&lt;policy_name_2&gt;</span>
            <span class=c>&lt;!-- configuration --&gt;</span>
        <span class=nt>&lt;/policy_name_2&gt;</span>

        <span class=c>&lt;!-- more policies --&gt;</span>
    <span class=nt>&lt;/policies&gt;</span>
    ...
<span class=nt>&lt;/storage_configuration&gt;</span>
</code></pre></div> <p>Tags:</p> <ul> <li><code>policy_name_N</code> — Policy name. Policy names must be unique.</li> <li><code>volume_name_N</code> — Volume name. Volume names must be unique.</li> <li><code>disk</code> — a disk within a volume.</li> <li><code>max_data_part_size_bytes</code> — the maximum size of a part that can be stored on any of the volume's disks.</li> <li><code>move_factor</code> — when the amount of available space gets lower than this factor, data automatically start to move on the next volume if any (by default, 0.1).</li> </ul> <p>Cofiguration ejemplos:</p> <div class=codehilite><pre><span></span><code><span class=nt>&lt;storage_configuration&gt;</span>
    ...
    <span class=nt>&lt;policies&gt;</span>
        <span class=nt>&lt;hdd_in_order&gt;</span> <span class=c>&lt;!-- policy name --&gt;</span>
            <span class=nt>&lt;volumes&gt;</span>
                <span class=nt>&lt;single&gt;</span> <span class=c>&lt;!-- volume name --&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk1<span class=nt>&lt;/disk&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk2<span class=nt>&lt;/disk&gt;</span>
                <span class=nt>&lt;/single&gt;</span>
            <span class=nt>&lt;/volumes&gt;</span>
        <span class=nt>&lt;/hdd_in_order&gt;</span>

        <span class=nt>&lt;moving_from_ssd_to_hdd&gt;</span>
            <span class=nt>&lt;volumes&gt;</span>
                <span class=nt>&lt;hot&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>fast_ssd<span class=nt>&lt;/disk&gt;</span>
                    <span class=nt>&lt;max_data_part_size_bytes&gt;</span>1073741824<span class=nt>&lt;/max_data_part_size_bytes&gt;</span>
                <span class=nt>&lt;/hot&gt;</span>
                <span class=nt>&lt;cold&gt;</span>
                    <span class=nt>&lt;disk&gt;</span>disk1<span class=nt>&lt;/disk&gt;</span>
                <span class=nt>&lt;/cold&gt;</span>
            <span class=nt>&lt;/volumes&gt;</span>
            <span class=nt>&lt;move_factor&gt;</span>0.2<span class=nt>&lt;/move_factor&gt;</span>
        <span class=nt>&lt;/moving_from_ssd_to_hdd&gt;</span>
    <span class=nt>&lt;/policies&gt;</span>
    ...
<span class=nt>&lt;/storage_configuration&gt;</span>
</code></pre></div> <p>En un ejemplo dado, el <code>hdd_in_order</code> implementa la política de <a href=https://en.wikipedia.org/wiki/Round-robin_scheduling rel="external nofollow noreferrer">Ronda-robin</a> enfoque. Por lo tanto esta política define un sólo volumen (<code>single</code>), las partes de datos se almacenan en todos sus discos en orden circular. Dicha política puede ser bastante útil si hay varios discos similares montados en el sistema, pero RAID no está configurado. Tenga en cuenta que cada unidad de disco individual no es confiable y es posible que desee compensarlo con un factor de replicación de 3 o más.</p> <p>Si hay diferentes tipos de discos disponibles en el sistema, <code>moving_from_ssd_to_hdd</code> la política puede ser utilizado en su lugar. Volumen <code>hot</code> consta de un disco SSD (<code>fast_ssd</code>), y el tamaño máximo de una parte que puede ser almacenado en este volumen es de 1GB. Todas las piezas con el tamaño de más de 1GB se almacenan directamente en el <code>cold</code> volumen, que contiene un disco duro <code>disk1</code>.<br> Además, una vez que el disco <code>fast_ssd</code> se llena en más del 80%, los datos se transferirán al <code>disk1</code> por un proceso en segundo plano.</p> <p>El orden de enumeración de volúmenes dentro de una directiva de almacenamiento es importante. Una vez que un volumen está sobrellenado, los datos se mueven al siguiente. El orden de la enumeración del disco también es importante porque los datos se almacenan en ellos por turnos.</p> <p>Al crear una tabla, se puede aplicarle una de las directivas de almacenamiento configuradas:</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>table_with_non_default_policy</span> <span class=p>(</span>
    <span class=n>EventDate</span> <span class=nb>Date</span><span class=p>,</span>
    <span class=n>OrderID</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>BannerID</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>SearchPhrase</span> <span class=n>String</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=p>(</span><span class=n>OrderID</span><span class=p>,</span> <span class=n>BannerID</span><span class=p>)</span>
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMM</span><span class=p>(</span><span class=n>EventDate</span><span class=p>)</span>
<span class=n>SETTINGS</span> <span class=n>storage_policy</span> <span class=o>=</span> <span class=s1>&#39;moving_from_ssd_to_hdd&#39;</span>
</code></pre></div> <p>El <code>default</code> política de almacenamiento implica el uso de un solo volumen, que consiste en un solo disco dado en <code>&lt;path&gt;</code>. Una vez que se crea una tabla, no se puede cambiar su política de almacenamiento.</p> <h3 id=details>Detalles<a class=headerlink href=#details title="Permanent link">&para;</a></h3> <p>En el caso de <code>MergeTree</code> tablas, los datos están llegando al disco de diferentes maneras:</p> <ul> <li>Como resultado de un inserto (<code>INSERT</code> consulta).</li> <li>Durante las fusiones de fondo y <a href=../../../../sql_reference/statements/alter/#alter-mutations>mutación</a>.</li> <li>Al descargar desde otra réplica.</li> <li>Como resultado de la congelación de particiones <a href=../../../../sql_reference/statements/alter/#alter_freeze-partition>ALTER TABLE … FREEZE PARTITION</a>.</li> </ul> <p>En todos estos casos, excepto las mutaciones y la congelación de particiones, una pieza se almacena en un volumen y un disco de acuerdo con la política de almacenamiento dada:</p> <ol> <li>El primer volumen (en el orden de definición) que tiene suficiente espacio en disco para almacenar una pieza (<code>unreserved_space &gt; current_part_size</code>) y permite almacenar partes de un tamaño determinado (<code>max_data_part_size_bytes &gt; current_part_size</code>) se elige.</li> <li>Dentro de este volumen, se elige ese disco que sigue al que se utilizó para almacenar el fragmento de datos anterior y que tiene espacio libre más que el tamaño de la pieza (<code>unreserved_space - keep_free_space_bytes &gt; current_part_size</code>).</li> </ol> <p>Bajo el capó, las mutaciones y la congelación de particiones hacen uso de <a href=https://en.wikipedia.org/wiki/Hard_link rel="external nofollow noreferrer">enlaces duros</a>. Los enlaces duros entre diferentes discos no son compatibles, por lo tanto, en tales casos las partes resultantes se almacenan en los mismos discos que los iniciales.</p> <p>En el fondo, las partes se mueven entre volúmenes en función de la cantidad de espacio libre (<code>move_factor</code> parámetro) según el orden en que se declaran los volúmenes en el archivo de configuración.<br> Los datos nunca se transfieren desde el último y al primero. Uno puede usar tablas del sistema <a href=../../../../operations/system_tables/#system_tables-part-log>sistema.part_log</a> (campo <code>type = MOVE_PART</code>) y <a href=../../../../operations/system_tables/#system_tables-parts>sistema.parte</a> (campo <code>path</code> y <code>disk</code>) para monitorear el fondo se mueve. Además, la información detallada se puede encontrar en los registros del servidor.</p> <p>El usuario puede forzar el movimiento de una pieza o una partición de un volumen a otro mediante la consulta <a href=../../../../sql_reference/statements/alter/#alter_move-partition>ALTER TABLE … MOVE PART|PARTITION … TO VOLUME|DISK …</a>, todas las restricciones para las operaciones en segundo plano se tienen en cuenta. La consulta inicia un movimiento por sí misma y no espera a que se completen las operaciones en segundo plano. El usuario recibirá un mensaje de error si no hay suficiente espacio libre disponible o si no se cumple alguna de las condiciones requeridas.</p> <p>Mover datos no interfiere con la replicación de datos. Por lo tanto, se pueden especificar diferentes directivas de almacenamiento para la misma tabla en diferentes réplicas.</p> <p>Después de la finalización de las fusiones y mutaciones de fondo, las partes viejas se eliminan solo después de un cierto período de tiempo (<code>old_parts_lifetime</code>).<br> Durante este tiempo, no se mueven a otros volúmenes o discos. Por lo tanto, hasta que finalmente se retira, se tomará en cuenta para la evaluación de los ocupados de espacio en disco.</p> </div> <div id=content-footer class="text-muted pt-5"> <div class=float-right>©2016–2020 Yandex LLC</div> <div>Construido a partir de <a href=https://github.com/ClickHouse/ClickHouse/commit/3166eab2dfc89323b9d756aeba6866381fd9c186 rel="external nofollow noreferrer" target=_blank class=text-reset>3166eab2df</a></div> </div> </div> <div id=toc class="col-xl-2 d-none d-xl-block d-print-none p-3 overflow-auto toc-right mb-5"> <nav class="nav flex-column text-wrap"> <label for=toc>Tabla de contenido</label> <a href=#table_engine-mergetree-creating-a-table title="Creación de una tabla" class="nav-link text-wrap d-inline-block w-100"> Creación de una tabla </a> <nav id=toc-toc-1 class="nav flex-column pl-2"> <a href=#mergetree-query-clauses title="Cláusulas de consulta" class="nav-link text-wrap d-inline-block w-100"> Cláusulas de consulta </a> </nav> <a href=#mergetree-data-storage title="Almacenamiento de datos" class="nav-link text-wrap d-inline-block w-100"> Almacenamiento de datos </a> <a href=#primary-keys-and-indexes-in-queries title="Claves e índices principales en consultas" class="nav-link text-wrap d-inline-block w-100"> Claves e índices principales en consultas </a> <nav id=toc-toc-3 class="nav flex-column pl-2"> <a href=#selecting-the-primary-key title="Selección de la clave principal" class="nav-link text-wrap d-inline-block w-100"> Selección de la clave principal </a> <a href=#choosing-a-primary-key-that-differs-from-the-sorting-key title="Elegir una clave principal que difiere de la clave de ordenación" class="nav-link text-wrap d-inline-block w-100"> Elegir una clave principal que difiere de la clave de ordenación </a> <a href=#use-of-indexes-and-partitions-in-queries title="Uso de índices y particiones en consultas" class="nav-link text-wrap d-inline-block w-100"> Uso de índices y particiones en consultas </a> <a href=#use-of-index-for-partially-monotonic-primary-keys title="Uso del índice para claves primarias parcialmente monotónicas" class="nav-link text-wrap d-inline-block w-100"> Uso del índice para claves primarias parcialmente monotónicas </a> <a href=#table_engine-mergetree-data_skipping-indexes title="Índices de saltos de datos (experimental)" class="nav-link text-wrap d-inline-block w-100"> Índices de saltos de datos (experimental) </a> <nav id=toc-toc-3-5 class="nav flex-column pl-2"> <a href=#available-types-of-indices title="Tipos de índices disponibles" class="nav-link text-wrap d-inline-block w-100"> Tipos de índices disponibles </a> <a href=#functions-support title="Funciones de apoyo" class="nav-link text-wrap d-inline-block w-100"> Funciones de apoyo </a> </nav> </nav> <a href=#concurrent-data-access title="Acceso a datos simultáneos" class="nav-link text-wrap d-inline-block w-100"> Acceso a datos simultáneos </a> <a href=#table_engine-mergetree-ttl title="TTL para columnas y tablas" class="nav-link text-wrap d-inline-block w-100"> TTL para columnas y tablas </a> <nav id=toc-toc-5 class="nav flex-column pl-2"> <a href=#mergetree-column-ttl title="Columna TTL" class="nav-link text-wrap d-inline-block w-100"> Columna TTL </a> <a href=#mergetree-table-ttl title="Tabla TTL" class="nav-link text-wrap d-inline-block w-100"> Tabla TTL </a> </nav> <a href=#table_engine-mergetree-multiple-volumes title="Uso de múltiples dispositivos de bloque para el almacenamiento de datos" class="nav-link text-wrap d-inline-block w-100"> Uso de múltiples dispositivos de bloque para el almacenamiento de datos </a> <nav id=toc-toc-6 class="nav flex-column pl-2"> <a href=#introduction title=Implantación class="nav-link text-wrap d-inline-block w-100"> Implantación </a> <a href=#terms title=Plazo class="nav-link text-wrap d-inline-block w-100"> Plazo </a> <a href=#table_engine-mergetree-multiple-volumes-configure title=Configuración class="nav-link text-wrap d-inline-block w-100"> Configuración </a> <a href=#details title=Detalles class="nav-link text-wrap d-inline-block w-100"> Detalles </a> </nav> </nav> </div> </div> </div> <script async type=text/javascript src=/js/base.js?7bd05efd></script> <noscript> <div><img src=https://mc.yandex.ru/watch/18343495 alt=Yandex></div> </noscript> </body> </html>