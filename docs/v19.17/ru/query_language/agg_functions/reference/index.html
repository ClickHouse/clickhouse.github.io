<!DOCTYPE html><html lang=ru data-version=v19.17 data-single-page=false> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Справочник функций - Документация ClickHouse v19.17</title><link rel="shortcut icon" href=/favicon.ico><meta property=og:title content="Справочник функций - Документация ClickHouse v19.17"><meta property=og:description content="Справочник функций count Вычисляет количество строк или не NULL значений . ClickHouse поддерживает следующие виды синтак"><meta property=og:type content=website><meta property=og:image content=https://clickhouse.tech/images/logo.png><meta property=twitter:title content="Справочник функций - Документация ClickHouse v19.17"><meta name=description content="Справочник функций count Вычисляет количество строк или не NULL значений . ClickHouse поддерживает следующие виды синтак"><meta name=keywords content="ClickHouse, DBMS, OLAP, relational, analytics, analytical, big data, open-source, SQL, web-analytics"><link href=/css/base.css?1d858e50 media=all rel=stylesheet></head> <body dir=ltr data-spy=scroll data-target=#toc data-offset=80> <nav id=top-nav class="navbar navbar-dark navbar-expand-md bg-dark-alt text-white sticky-top"> <div class="container-fluid justify-content-between"> <a href=/ class="d-block navbar-brand mr-3"> <img id=docs-logo-icon src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"> </a> <div class="w-100 navbar-text text-left d-none d-md-block"> <h1 class="h3 m-0 p-0 d-inline"> <a href=# class="text-white text-decoration-none"> Справочник функций </a> </h1> </div> <div class="d-none d-md-block"> <ul class="navbar-nav ml-auto mt-2 mt-lg-0 justify-content-end"> <li class=nav-item> <a href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/ru/query_language/agg_functions/reference.md title="Edit this article" class=nav-link rel="external nofollow noreferrer" target=_blank><img src=/images/mkdocs/edit.svg alt="Edit this article" class=mt-1 height=22></a> </li> <li class=nav-item> <a class=nav-link href=https://github.com/ClickHouse/ClickHouse rel="external nofollow noreferrer"> <img src=/images/index/github.svg alt="GitHub repository" title="Go to GitHub" height=32> </a> </li> <li id=languages-wrapper class="nav-item dropdown"> <div id=languages-dropdown> <a class="nav-link dropdown-toggle d-inline-block mt-1 text-muted" href=# id=lang-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false> <img src=/images/flags/ru.svg alt=Русский title=Русский width=32 class="d-inline-block mt-n1"> </a> <div class="dropdown-menu bg-dark" aria-labelledby=lang-dropdown> <a href=/docs/v19.17/en/query_language/agg_functions/reference/ class=dropdown-item> <img src=/images/flags/en.svg alt title width=32 class="d-inline-block mr-2">English </a> <a href=/docs/v19.17/zh/query_language/agg_functions/reference/ class=dropdown-item> <img src=/images/flags/zh.svg alt title width=32 class="d-inline-block mr-2">中文 </a> <a href=/docs/v19.17/es/query_language/agg_functions/reference/ class=dropdown-item> <img src=/images/flags/es.svg alt title width=32 class="d-inline-block mr-2">Español </a> <a href=/docs/v19.17/fr/query_language/agg_functions/reference/ class=dropdown-item> <img src=/images/flags/fr.svg alt title width=32 class="d-inline-block mr-2">Français </a> <a href=/docs/v19.17/ru/query_language/agg_functions/reference/ class="dropdown-item disabled"> <img src=/images/flags/ru.svg alt title width=32 class="d-inline-block mr-2">Русский </a> <a href=/docs/v19.17/ja/query_language/agg_functions/reference/ class=dropdown-item> <img src=/images/flags/ja.svg alt title width=32 class="d-inline-block mr-2">日本語 </a> <a href=/docs/v19.17/fa/query_language/agg_functions/reference/ class=dropdown-item> <img src=/images/flags/fa.svg alt title width=32 class="d-inline-block mr-2">فارسی </a> </div> </div> </li> </ul> </div> <form id=search-form class="form-inline m-0"> <div class=input-group> <div class="input-group-prepend w-100"> <span class="input-group-text bg-secondary-alt text-muted border-0 mr-n1" id=search-icon> <img src=/images/mkdocs/search.svg> </span> <input id=docsearch-input class="form-control bg-secondary-alt text-muted border-0 pl-1" type=search placeholder=Search aria-label=Search> </div> </div> </form> <button id=navbar-toggler class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#sidebar aria-controls=sidebar aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> </nav> <div class=container-fluid> <div class="row justify-content-end justify-content-xl-center"> <div id=sidebar class="col-xl-2 col-md-4 bg-secondary-alt p-3 d-print-none min-vh-100 overflow-auto"> <div class=overflow-auto> <div id=single-page-switch class="btn-group mb-2 float-right" role=group aria-label="Многостраничный или одностраничный"> <a href=../../.. role=button class="btn btn-dark active" aria-pressed=true> <img src=/images/mkdocs/multi.svg alt="Многостраничная версия" title="Многостраничная версия"> </a> <a href=../../../single/ role=button class="btn btn-dark-alt active" aria-pressed=true> <img src=/images/mkdocs/single.svg alt="Одностраничная версия" title="Одностраничная версия"> </a> </div> <div class="dropdown mb-3"> <a class="btn btn-dark dropdown-toggle text-muted" href=# role=button id=select-version data-toggle=dropdown aria-haspopup=true aria-expanded=false> Версия: <span class=text-light>v19.17</span> </a> <div class="dropdown-menu bg-dark text-muted p-1" aria-labelledby=select-version> <a href=/docs/ru/ class=dropdown-item> <span class=text-light>последняя</span> </a> <a href=/docs/v20.3/ru/ class=dropdown-item>v20.3</a> <a href=/docs/v20.1/ru/ class=dropdown-item>v20.1</a> <a href=/docs/v19.17/ru/ class="dropdown-item disable">v19.17</a> <a href=/docs/v19.16/ru/ class=dropdown-item>v19.16</a> <a href=/docs/v19.15/ru/ class=dropdown-item>v19.15</a> <a href=/docs/v19.14/ru/ class=dropdown-item>v19.14</a> <a href=/docs/v19.13/ru/ class=dropdown-item>v19.13</a> <a href=/docs/v19.11/ru/ class=dropdown-item>v19.11</a> <a href=/docs/v19.10/ru/ class=dropdown-item>v19.10</a> <a href=/docs/v19.9/ru/ class=dropdown-item>v19.9</a> <a href=/docs/v19.8/ru/ class=dropdown-item>v19.8</a> </div> </div> <nav id=sidebar-nav class="nav flex-column mb-5"> <a href=#sidebar-sidebar-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-1 title=Введение class="nav-link text-light text-wrap dropdown-toggle px-0">Введение</a> <div id=sidebar-sidebar-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../ title=Обзор class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обзор</a> <a href=../../../introduction/distinctive_features/ title="Отличительные возможности ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Отличительные возможности ClickHouse</a> <a href=../../../introduction/features_considered_disadvantages/ title="Особенности ClickHouse, которые могут считаться недостатками" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Особенности ClickHouse, которые могут считаться недостатками</a> <a href=../../../introduction/performance/ title=Производительность class="nav-link text-light text-wrap d-inline-block w-100 px-0">Производительность</a> <a href=../../../introduction/ya_metrika_task/ title="Постановка задачи в Яндекс.Метрике" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Постановка задачи в Яндекс.Метрике</a> <a href=../../../introduction/info/ title="Информационная поддержка" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Информационная поддержка</a> </nav> </div> <a href=#sidebar-sidebar-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2 title="Начало работы" class="nav-link text-light text-wrap dropdown-toggle px-0">Начало работы</a> <div id=sidebar-sidebar-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../getting_started/ title="Установка и запуск" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Установка и запуск</a> <a href=#sidebar-sidebar-2-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2-2 title="Тестовые наборы данных" class="nav-link text-light text-wrap dropdown-toggle px-0">Тестовые наборы данных</a> <div id=sidebar-sidebar-2-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../getting_started/example_datasets/ontime/ title=OnTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">OnTime</a> <a href=../../../getting_started/example_datasets/nyc_taxi/ title="Данные о такси в Нью-Йорке" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Данные о такси в Нью-Йорке</a> <a href=../../../getting_started/example_datasets/amplab_benchmark/ title="AMPLab Big Data Benchmark" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AMPLab Big Data Benchmark</a> <a href=../../../getting_started/example_datasets/wikistat/ title=WikiStat class="nav-link text-light text-wrap d-inline-block w-100 px-0">WikiStat</a> <a href=../../../getting_started/example_datasets/criteo/ title="Терабайт логов кликов от Criteo" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Терабайт логов кликов от Criteo</a> <a href=../../../getting_started/example_datasets/star_schema/ title="Схема «Звезда»" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Схема «Звезда»</a> <a href=../../../getting_started/example_datasets/metrica/ title="Данные Яндекс.Метрики" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Данные Яндекс.Метрики</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3 title=Интерфейсы class="nav-link text-light text-wrap dropdown-toggle px-0">Интерфейсы</a> <div id=sidebar-sidebar-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../interfaces/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../interfaces/cli/ title="Клиент командной строки" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Клиент командной строки</a> <a href=../../../interfaces/tcp/ title="Нативный интерфейс (TCP)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Нативный интерфейс (TCP)</a> <a href=../../../interfaces/http/ title=HTTP-интерфейс class="nav-link text-light text-wrap d-inline-block w-100 px-0">HTTP-интерфейс</a> <a href=../../../interfaces/formats/ title="Форматы входных и выходных данных" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Форматы входных и выходных данных</a> <a href=../../../interfaces/jdbc/ title=JDBC-драйвер class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC-драйвер</a> <a href=../../../interfaces/odbc/ title=ODBC-драйвер class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC-драйвер</a> <a href=../../../interfaces/cpp/ title="C++ клиентская библиотека" class="nav-link text-light text-wrap d-inline-block w-100 px-0">C++ клиентская библиотека</a> <a href=#sidebar-sidebar-3-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-9 title="От сторонних разработчиков" class="nav-link text-light text-wrap dropdown-toggle px-0">От сторонних разработчиков</a> <div id=sidebar-sidebar-3-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../interfaces/third-party/client_libraries/ title="Клиентские библиотеки" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Клиентские библиотеки</a> <a href=../../../interfaces/third-party/integrations/ title=Интеграции class="nav-link text-light text-wrap d-inline-block w-100 px-0">Интеграции</a> <a href=../../../interfaces/third-party/gui/ title="Визуальные интерфейсы" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Визуальные интерфейсы</a> <a href=../../../interfaces/third-party/proxy/ title=Прокси class="nav-link text-light text-wrap d-inline-block w-100 px-0">Прокси</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4 title="Движки баз данных" class="nav-link text-light text-wrap dropdown-toggle px-0">Движки баз данных</a> <div id=sidebar-sidebar-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../database_engines/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../database_engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> </nav> </div> <a href=#sidebar-sidebar-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5 title="Движки таблиц" class="nav-link text-light text-wrap dropdown-toggle px-0">Движки таблиц</a> <div id=sidebar-sidebar-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/table_engines/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=#sidebar-sidebar-5-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2 title="Семейство MergeTree" class="nav-link text-light text-wrap dropdown-toggle px-0">Семейство MergeTree</a> <div id=sidebar-sidebar-5-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/table_engines/mergetree/ title=MergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">MergeTree</a> <a href=../../../operations/table_engines/replication/ title="Репликация данных" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Репликация данных</a> <a href=../../../operations/table_engines/custom_partitioning_key/ title="Произвольный ключ партиционирования" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Произвольный ключ партиционирования</a> <a href=../../../operations/table_engines/replacingmergetree/ title=ReplacingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">ReplacingMergeTree</a> <a href=../../../operations/table_engines/summingmergetree/ title=SummingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">SummingMergeTree</a> <a href=../../../operations/table_engines/aggregatingmergetree/ title=AggregatingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregatingMergeTree</a> <a href=../../../operations/table_engines/collapsingmergetree/ title=CollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">CollapsingMergeTree</a> <a href=../../../operations/table_engines/versionedcollapsingmergetree/ title=VersionedCollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">VersionedCollapsingMergeTree</a> <a href=../../../operations/table_engines/graphitemergetree/ title=GraphiteMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">GraphiteMergeTree</a> </nav> </div> <a href=#sidebar-sidebar-5-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-3 title="Семейство Log" class="nav-link text-light text-wrap dropdown-toggle px-0">Семейство Log</a> <div id=sidebar-sidebar-5-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/table_engines/log_family/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../operations/table_engines/stripelog/ title=StripeLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">StripeLog</a> <a href=../../../operations/table_engines/log/ title=Log class="nav-link text-light text-wrap d-inline-block w-100 px-0">Log</a> <a href=../../../operations/table_engines/tinylog/ title=TinyLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">TinyLog</a> </nav> </div> <a href=#sidebar-sidebar-5-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-4 title=Интеграции class="nav-link text-light text-wrap dropdown-toggle px-0">Интеграции</a> <div id=sidebar-sidebar-5-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/table_engines/kafka/ title=Kafka class="nav-link text-light text-wrap d-inline-block w-100 px-0">Kafka</a> <a href=../../../operations/table_engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../../operations/table_engines/jdbc/ title=JDBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC</a> <a href=../../../operations/table_engines/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> <a href=../../../operations/table_engines/hdfs/ title=HDFS class="nav-link text-light text-wrap d-inline-block w-100 px-0">HDFS</a> </nav> </div> <a href=#sidebar-sidebar-5-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-5 title=Особые class="nav-link text-light text-wrap dropdown-toggle px-0">Особые</a> <div id=sidebar-sidebar-5-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/table_engines/distributed/ title=Distributed class="nav-link text-light text-wrap d-inline-block w-100 px-0">Distributed</a> <a href=../../../operations/table_engines/external_data/ title="Внешние данные" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Внешние данные</a> <a href=../../../operations/table_engines/dictionary/ title=Dictionary class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionary</a> <a href=../../../operations/table_engines/merge/ title=Merge class="nav-link text-light text-wrap d-inline-block w-100 px-0">Merge</a> <a href=../../../operations/table_engines/file/ title=File class="nav-link text-light text-wrap d-inline-block w-100 px-0">File</a> <a href=../../../operations/table_engines/null/ title=Null class="nav-link text-light text-wrap d-inline-block w-100 px-0">Null</a> <a href=../../../operations/table_engines/set/ title=Set class="nav-link text-light text-wrap d-inline-block w-100 px-0">Set</a> <a href=../../../operations/table_engines/join/ title=Join class="nav-link text-light text-wrap d-inline-block w-100 px-0">Join</a> <a href=../../../operations/table_engines/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../../../operations/table_engines/view/ title=View class="nav-link text-light text-wrap d-inline-block w-100 px-0">View</a> <a href=../../../operations/table_engines/materializedview/ title=MaterializedView class="nav-link text-light text-wrap d-inline-block w-100 px-0">MaterializedView</a> <a href=../../../operations/table_engines/memory/ title=Memory class="nav-link text-light text-wrap d-inline-block w-100 px-0">Memory</a> <a href=../../../operations/table_engines/buffer/ title=Buffer class="nav-link text-light text-wrap d-inline-block w-100 px-0">Buffer</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6 title="Справка по SQL" class="nav-link text-light text-wrap dropdown-toggle px-0">Справка по SQL</a> <div id=sidebar-sidebar-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../query_language/syntax/ title="Общий синтаксис" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Общий синтаксис</a> <a href=#sidebar-sidebar-6-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-3 title=Запросы class="nav-link text-light text-wrap dropdown-toggle px-0">Запросы</a> <div id=sidebar-sidebar-6-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../query_language/select/ title=SELECT class="nav-link text-light text-wrap d-inline-block w-100 px-0">SELECT</a> <a href=../../../query_language/insert_into/ title="INSERT INTO" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INSERT INTO</a> <a href=../../../query_language/create/ title=CREATE class="nav-link text-light text-wrap d-inline-block w-100 px-0">CREATE</a> <a href=../../../query_language/alter/ title=ALTER class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALTER</a> <a href=../../../query_language/system/ title=SYSTEM class="nav-link text-light text-wrap d-inline-block w-100 px-0">SYSTEM</a> <a href=../../../query_language/show/ title=SHOW class="nav-link text-light text-wrap d-inline-block w-100 px-0">SHOW</a> <a href=../../../query_language/misc/ title=Прочие class="nav-link text-light text-wrap d-inline-block w-100 px-0">Прочие</a> </nav> </div> <a href=#sidebar-sidebar-6-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-4 title=Функции class="nav-link text-light text-wrap dropdown-toggle px-0">Функции</a> <div id=sidebar-sidebar-6-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../query_language/functions/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../query_language/functions/arithmetic_functions/ title="Арифметические функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Арифметические функции</a> <a href=../../../query_language/functions/comparison_functions/ title="Функции сравнения" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции сравнения</a> <a href=../../../query_language/functions/logical_functions/ title="Логические функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Логические функции</a> <a href=../../../query_language/functions/type_conversion_functions/ title="Функции преобразования типов" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции преобразования типов</a> <a href=../../../query_language/functions/date_time_functions/ title="Функции для работы с датами и временем" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с датами и временем</a> <a href=../../../query_language/functions/string_functions/ title="Функции для работы со строками" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы со строками</a> <a href=../../../query_language/functions/string_search_functions/ title="Функции поиска в строках" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции поиска в строках</a> <a href=../../../query_language/functions/string_replace_functions/ title="Функции поиска и замены в строках" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции поиска и замены в строках</a> <a href=../../../query_language/functions/conditional_functions/ title="Условные функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Условные функции</a> <a href=../../../query_language/functions/math_functions/ title="Математические функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Математические функции</a> <a href=../../../query_language/functions/rounding_functions/ title="Функции округления" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции округления</a> <a href=../../../query_language/functions/array_functions/ title="Функции по работе с массивами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции по работе с массивами</a> <a href=../../../query_language/functions/splitting_merging_functions/ title="Функции разбиения и слияния строк и массивов" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции разбиения и слияния строк и массивов</a> <a href=../../../query_language/functions/bit_functions/ title="Битовые функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Битовые функции</a> <a href=../../../query_language/functions/bitmap_functions/ title="Функции для битмапов" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для битмапов</a> <a href=../../../query_language/functions/hash_functions/ title="Функции хэширования" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции хэширования</a> <a href=../../../query_language/functions/random_functions/ title="Функции генерации псевдослучайных чисел" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции генерации псевдослучайных чисел</a> <a href=../../../query_language/functions/uuid_functions/ title="Функции для работы с UUID" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с UUID</a> <a href=../../../query_language/functions/encoding_functions/ title="Функции кодирования" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции кодирования</a> <a href=../../../query_language/functions/url_functions/ title="Функции для работы с URL" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с URL</a> <a href=../../../query_language/functions/ip_address_functions/ title="Функции для работы с IP-адресами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с IP-адресами</a> <a href=../../../query_language/functions/json_functions/ title="Функции для работы с JSON." class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с JSON.</a> <a href=../../../query_language/functions/higher_order_functions/ title="Функции высшего порядка" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции высшего порядка</a> <a href=../../../query_language/functions/ext_dict_functions/ title="Функции для работы с внешними словарями" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с внешними словарями</a> <a href=../../../query_language/functions/ym_dict_functions/ title="Функции для работы со словарями Яндекс.Метрики" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы со словарями Яндекс.Метрики</a> <a href=../../../query_language/functions/in_functions/ title="Функции для реализации оператора IN." class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для реализации оператора IN.</a> <a href=../../../query_language/functions/array_join/ title="Функция arrayJoin" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функция arrayJoin</a> <a href=../../../query_language/functions/geo/ title="Функции для работы с географическими координатами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с географическими координатами</a> <a href=../../../query_language/functions/functions_for_nulls/ title="Функции c Nullable аргументами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции c Nullable аргументами</a> <a href=../../../query_language/functions/machine_learning_functions/ title="Функции машинного обучения" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции машинного обучения</a> <a href=../../../query_language/functions/other_functions/ title="Прочие функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Прочие функции</a> </nav> </div> <a href=#sidebar-sidebar-6-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-5 title="Агрегатные функции" class="nav-link text-light text-wrap dropdown-toggle px-0">Агрегатные функции</a> <div id=sidebar-sidebar-6-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../query_language/agg_functions/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../query_language/agg_functions/reference/ title="Справочник функций" class="nav-link text-white active text-wrap d-inline-block w-100 px-0">Справочник функций</a> <a href=../../../query_language/agg_functions/combinators/ title="Комбинаторы агрегатных функций" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Комбинаторы агрегатных функций</a> <a href=../../../query_language/agg_functions/parametric_functions/ title="Параметрические агрегатные функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Параметрические агрегатные функции</a> </nav> </div> <a href=#sidebar-sidebar-6-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-6 title="Табличные функции" class="nav-link text-light text-wrap dropdown-toggle px-0">Табличные функции</a> <div id=sidebar-sidebar-6-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../query_language/table_functions/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../query_language/table_functions/file/ title=file class="nav-link text-light text-wrap d-inline-block w-100 px-0">file</a> <a href=../../../query_language/table_functions/merge/ title=merge class="nav-link text-light text-wrap d-inline-block w-100 px-0">merge</a> <a href=../../../query_language/table_functions/numbers/ title=numbers class="nav-link text-light text-wrap d-inline-block w-100 px-0">numbers</a> <a href=../../../query_language/table_functions/remote/ title=remote class="nav-link text-light text-wrap d-inline-block w-100 px-0">remote</a> <a href=../../../query_language/table_functions/url/ title=url class="nav-link text-light text-wrap d-inline-block w-100 px-0">url</a> <a href=../../../query_language/table_functions/mysql/ title=mysql class="nav-link text-light text-wrap d-inline-block w-100 px-0">mysql</a> <a href=../../../query_language/table_functions/jdbc/ title=jdbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">jdbc</a> <a href=../../../query_language/table_functions/odbc/ title=odbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">odbc</a> <a href=../../../query_language/table_functions/hdfs/ title=hdfs class="nav-link text-light text-wrap d-inline-block w-100 px-0">hdfs</a> <a href=../../../query_language/table_functions/input/ title=input class="nav-link text-light text-wrap d-inline-block w-100 px-0">input</a> </nav> </div> <a href=#sidebar-sidebar-6-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-7 title=Словари class="nav-link text-light text-wrap dropdown-toggle px-0">Словари</a> <div id=sidebar-sidebar-6-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../query_language/dicts/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=#sidebar-sidebar-6-7-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-7-2 title="Внешние словари" class="nav-link text-light text-wrap dropdown-toggle px-0">Внешние словари</a> <div id=sidebar-sidebar-6-7-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../query_language/dicts/external_dicts/ title="Общее описание" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Общее описание</a> <a href=../../../query_language/dicts/external_dicts_dict/ title="Настройка внешнего словаря" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Настройка внешнего словаря</a> <a href=../../../query_language/dicts/external_dicts_dict_layout/ title="Хранение словарей в памяти" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Хранение словарей в памяти</a> <a href=../../../query_language/dicts/external_dicts_dict_lifetime/ title="Обновление словарей" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обновление словарей</a> <a href=../../../query_language/dicts/external_dicts_dict_sources/ title="Источники внешних словарей" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Источники внешних словарей</a> <a href=../../../query_language/dicts/external_dicts_dict_structure/ title="Ключ и поля словаря" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Ключ и поля словаря</a> </nav> </div> <a href=../../../query_language/dicts/internal_dicts/ title="Встроенные словари" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Встроенные словари</a> </nav> </div> <a href=../../../query_language/operators/ title=Операторы class="nav-link text-light text-wrap d-inline-block w-100 px-0">Операторы</a> <a href=#sidebar-sidebar-6-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-9 title="Типы данных" class="nav-link text-light text-wrap dropdown-toggle px-0">Типы данных</a> <div id=sidebar-sidebar-6-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../data_types/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../data_types/int_uint/ title="UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64</a> <a href=../../../data_types/float/ title="Float32, Float64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Float32, Float64</a> <a href=../../../data_types/decimal/ title=Decimal class="nav-link text-light text-wrap d-inline-block w-100 px-0">Decimal</a> <a href=../../../data_types/boolean/ title="Булевы значения" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Булевы значения</a> <a href=../../../data_types/string/ title=String class="nav-link text-light text-wrap d-inline-block w-100 px-0">String</a> <a href=../../../data_types/fixedstring/ title=FixedString(N) class="nav-link text-light text-wrap d-inline-block w-100 px-0">FixedString(N)</a> <a href=../../../data_types/uuid/ title=UUID class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUID</a> <a href=../../../data_types/date/ title=Date class="nav-link text-light text-wrap d-inline-block w-100 px-0">Date</a> <a href=../../../data_types/datetime/ title=DateTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime</a> <a href=../../../data_types/enum/ title=Enum class="nav-link text-light text-wrap d-inline-block w-100 px-0">Enum</a> <a href=../../../data_types/array/ title=Array(T) class="nav-link text-light text-wrap d-inline-block w-100 px-0">Array(T)</a> <a href=../../../data_types/nested_data_structures/aggregatefunction/ title="AggregateFunction(name, types_of_arguments...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregateFunction(name, types_of_arguments...)</a> <a href=../../../data_types/tuple/ title="Tuple(T1, T2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tuple(T1, T2, ...)</a> <a href=../../../data_types/nullable/ title=Nullable class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nullable</a> <a href=#sidebar-sidebar-6-9-16 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-9-16 title="Вложенные структуры данных" class="nav-link text-light text-wrap dropdown-toggle px-0">Вложенные структуры данных</a> <div id=sidebar-sidebar-6-9-16 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../data_types/nested_data_structures/nested/ title="Nested(Name1 Type1, Name2 Type2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nested(Name1 Type1, Name2 Type2, ...)</a> </nav> </div> <a href=#sidebar-sidebar-6-9-17 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-9-17 title="Служебные типы данных" class="nav-link text-light text-wrap dropdown-toggle px-0">Служебные типы данных</a> <div id=sidebar-sidebar-6-9-17 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../data_types/special_data_types/expression/ title=Expression class="nav-link text-light text-wrap d-inline-block w-100 px-0">Expression</a> <a href=../../../data_types/special_data_types/set/ title=Set class="nav-link text-light text-wrap d-inline-block w-100 px-0">Set</a> <a href=../../../data_types/special_data_types/nothing/ title=Nothing class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nothing</a> </nav> </div> <a href=#sidebar-sidebar-6-9-18 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-9-18 title=Domains class="nav-link text-light text-wrap dropdown-toggle px-0">Domains</a> <div id=sidebar-sidebar-6-9-18 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../data_types/domains/overview/ title=Overview class="nav-link text-light text-wrap d-inline-block w-100 px-0">Overview</a> <a href=../../../data_types/domains/ipv4/ title=IPv4 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv4</a> <a href=../../../data_types/domains/ipv6/ title=IPv6 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv6</a> </nav> </div> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7 title=Руководства class="nav-link text-light text-wrap dropdown-toggle px-0">Руководства</a> <div id=sidebar-sidebar-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../guides/ title=Обзор class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обзор</a> <a href=../../../guides/apply_catboost_model/ title="Применение CatBoost моделей" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Применение CatBoost моделей</a> </nav> </div> <a href=#sidebar-sidebar-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8 title=Эксплуатация class="nav-link text-light text-wrap dropdown-toggle px-0">Эксплуатация</a> <div id=sidebar-sidebar-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../operations/requirements/ title=Требования class="nav-link text-light text-wrap d-inline-block w-100 px-0">Требования</a> <a href=../../../operations/monitoring/ title=Мониторинг class="nav-link text-light text-wrap d-inline-block w-100 px-0">Мониторинг</a> <a href=../../../operations/troubleshooting/ title="Устранение неисправностей" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Устранение неисправностей</a> <a href=../../../operations/tips/ title="Советы по эксплуатации" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Советы по эксплуатации</a> <a href=../../../operations/update/ title="Обновление ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обновление ClickHouse</a> <a href=../../../operations/access_rights/ title="Права доступа" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Права доступа</a> <a href=../../../operations/backup/ title="Резервное копирование" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Резервное копирование</a> <a href=../../../operations/configuration_files/ title="Конфигурационные файлы" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Конфигурационные файлы</a> <a href=../../../operations/quotas/ title=Квоты class="nav-link text-light text-wrap d-inline-block w-100 px-0">Квоты</a> <a href=../../../operations/system_tables/ title="Системные таблицы" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Системные таблицы</a> <a href=#sidebar-sidebar-8-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-12 title="Конфигурационные параметры сервера" class="nav-link text-light text-wrap dropdown-toggle px-0">Конфигурационные параметры сервера</a> <div id=sidebar-sidebar-8-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/server_settings/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../operations/server_settings/settings/ title="Серверные настройки" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Серверные настройки</a> </nav> </div> <a href=#sidebar-sidebar-8-13 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-13 title=Настройки class="nav-link text-light text-wrap dropdown-toggle px-0">Настройки</a> <div id=sidebar-sidebar-8-13 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/settings/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../operations/settings/permissions_for_queries/ title="Разрешения на выполнение запросов" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Разрешения на выполнение запросов</a> <a href=../../../operations/settings/query_complexity/ title="Ограничения на сложность запроса" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Ограничения на сложность запроса</a> <a href=../../../operations/settings/settings/ title=Настройки class="nav-link text-light text-wrap d-inline-block w-100 px-0">Настройки</a> <a href=../../../operations/settings/constraints_on_settings/ title="Ограничения на изменение настроек" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Ограничения на изменение настроек</a> <a href=../../../operations/settings/settings_profiles/ title="Профили настроек" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Профили настроек</a> <a href=../../../operations/settings/settings_users/ title="Настройки пользователей" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Настройки пользователей</a> </nav> </div> <a href=#sidebar-sidebar-8-14 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-14 title=Утилиты class="nav-link text-light text-wrap dropdown-toggle px-0">Утилиты</a> <div id=sidebar-sidebar-8-14 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/utils/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../operations/utils/clickhouse-copier/ title=clickhouse-copier class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-copier</a> <a href=../../../operations/utils/clickhouse-local/ title=clickhouse-local class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-local</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-9 title=Разработка class="nav-link text-light text-wrap dropdown-toggle px-0">Разработка</a> <div id=sidebar-sidebar-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../development/architecture/ title="Обзор архитектуры ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обзор архитектуры ClickHouse</a> <a href=../../../development/build/ title="Как собрать ClickHouse на Linux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Как собрать ClickHouse на Linux</a> <a href=../../../development/build_osx/ title="Как собрать ClickHouse на Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Как собрать ClickHouse на Mac OS X</a> <a href=../../../development/build_cross/ title="Как собрать ClickHouse на Linux для Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Как собрать ClickHouse на Linux для Mac OS X</a> <a href=../../../development/style/ title="Как писать код на C++" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Как писать код на C++</a> <a href=../../../development/tests/ title="Как запустить тесты" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Как запустить тесты</a> <a href=../../../development/contrib/ title="Сторонние библиотеки" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Сторонние библиотеки</a> </nav> </div> <a href=#sidebar-sidebar-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-10 title="Что нового" class="nav-link text-light text-wrap dropdown-toggle px-0">Что нового</a> <div id=sidebar-sidebar-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../changelog/ title=Changelog class="nav-link text-light text-wrap d-inline-block w-100 px-0">Changelog</a> <a href=../../../security_changelog/ title="Security changelog" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Security changelog</a> <a href=../../../roadmap/ title=Roadmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">Roadmap</a> </nav> </div> <a href=#sidebar-sidebar-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11 title=F.A.Q. class="nav-link text-light text-wrap dropdown-toggle px-0">F.A.Q.</a> <div id=sidebar-sidebar-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../faq/general/ title="Общие вопросы" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Общие вопросы</a> </nav> </div> <a href=../../../single/clickhouse_ru.pdf class="nav-link border-top border-secondary mt-3 px-0 pt-3 text-light"> <img src=/images/mkdocs/pdf.svg alt=PDF-версия title=PDF-версия height=24 class="d-block mr-1 float-left"><div>PDF-версия</div> </a> </nav> </div> </div> <div id=content-wrapper class="col-md-8 p-2 p-md-5"> <div id=content> <h1 id=spravochnik-funktsii>Справочник функций<a class=headerlink href=#spravochnik-funktsii title="Permanent link">&para;</a></h1> <h2 id=agg_function-count>count<a class=headerlink href=#agg_function-count title="Permanent link">&para;</a></h2> <p>Вычисляет количество строк или не NULL значений .</p> <p>ClickHouse поддерживает следующие виды синтаксиса для <code>count</code>:</p> <ul> <li><code>count(expr)</code> или <code>COUNT(DISTINCT expr)</code>.</li> <li><code>count()</code> или <code>COUNT(*)</code>. Синтаксис <code>count()</code> специфичен для ClickHouse.</li> </ul> <p><strong>Параметры</strong></p> <p>Функция может принимать:</p> <ul> <li>Ноль параметров.</li> <li>Одно <a href=../../syntax/#syntax-expressions>выражение</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Если функция вызывается без параметров, она вычисляет количество строк.</li> <li>Если передаётся <a href=../../syntax/#syntax-expressions>выражение</a> , то функция вычисляет количество раз, когда выражение возвращает не NULL. Если выражение возвращает значение типа <a href=../../../data_types/nullable/ >Nullable</a>, то результат <code>count</code> не становится <code>Nullable</code>. Функция возвращает 0, если выражение возвращает <code>NULL</code> для всех строк.</li> </ul> <p>В обоих случаях тип возвращаемого значения <a href=../../../data_types/int_uint/ >UInt64</a>.</p> <p><strong>Подробности</strong></p> <p>ClickHouse поддерживает синтаксис <code>COUNT(DISTINCT ...)</code>. Поведение этой конструкции зависит от настройки <a href=../../../operations/settings/settings/#settings-count_distinct_implementation>count_distinct_implementation</a>. Она определяет, какая из функций <a href=#agg_function-uniq>uniq*</a> используется для выполнения операции. По умолчанию — функция <a href=#agg_function-uniqexact>uniqExact</a>.</p> <p>Запрос <code>SELECT count() FROM table</code> не оптимизирован, поскольку количество записей в таблице не хранится отдельно. Он выбирает небольшой столбец из таблицы и подсчитывает количество значений в нём.</p> <p><strong>Примеры</strong></p> <p>Пример 1:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─count()─┐
│       5 │
└─────────┘
</code></pre></div> <p>Пример 2:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>name</span><span class=p>,</span> <span class=n>value</span> <span class=k>FROM</span> <span class=k>system</span><span class=p>.</span><span class=n>settings</span> <span class=k>WHERE</span> <span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;count_distinct_implementation&#39;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─name──────────────────────────┬─value─────┐
│ count_distinct_implementation │ uniqExact │
└───────────────────────────────┴───────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=k>count</span><span class=p>(</span><span class=k>DISTINCT</span> <span class=n>num</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─uniqExact(num)─┐
│              3 │
└────────────────┘
</code></pre></div> <p>Этот пример показывает, что <code>count(DISTINCT num)</code> выполняется с помощью функции <code>uniqExact</code> в соответствии со значением настройки <code>count_distinct_implementation</code>.</p> <h2 id=agg_function-any>any(x)<a class=headerlink href=#agg_function-any title="Permanent link">&para;</a></h2> <p>Выбирает первое попавшееся значение.<br> Порядок выполнения запроса может быть произвольным и даже каждый раз разным, поэтому результат данной функции недетерминирован.<br> Для получения детерминированного результата, можно использовать функции min или max вместо any.</p> <p>В некоторых случаях, вы всё-таки можете рассчитывать на порядок выполнения запроса. Это - случаи, когда SELECT идёт из подзапроса, в котором используется ORDER BY.</p> <p>При наличии в запросе <code>SELECT</code> секции <code>GROUP BY</code> или хотя бы одной агрегатной функции, ClickHouse (в отличие от, например, MySQL) требует, чтобы все выражения в секциях <code>SELECT</code>, <code>HAVING</code>, <code>ORDER BY</code> вычислялись из ключей или из агрегатных функций. То есть, каждый выбираемый из таблицы столбец, должен использоваться либо в ключах, либо внутри агрегатных функций. Чтобы получить поведение, как в MySQL, вы можете поместить остальные столбцы в агрегатную функцию <code>any</code>.</p> <h2 id=agg_function-anyHeavy>anyHeavy(x)<a class=headerlink href=#agg_function-anyHeavy title="Permanent link">&para;</a></h2> <p>Выбирает часто встречающееся значение с помощью алгоритма "<a href=http://www.cs.umd.edu/~samir/498/karp.pdf rel="external nofollow noreferrer">heavy hitters</a>". Если существует значение, которое встречается чаще, чем в половине случаев, в каждом потоке выполнения запроса, то возвращается данное значение. В общем случае, результат недетерминирован.</p> <div class=codehilite><pre><span></span><code><span class=n>anyHeavy</span><span class=p>(</span><span class=k>column</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code>column</code> — имя столбца.</li> </ul> <p><strong>Пример</strong></p> <p>Возьмём набор данных <a href=../../../getting_started/example_datasets/ontime/ >OnTime</a> и выберем произвольное часто встречающееся значение в столбце <code>AirlineID</code>.</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>anyHeavy</span><span class=p>(</span><span class=n>AirlineID</span><span class=p>)</span> <span class=k>AS</span> <span class=n>res</span>
<span class=k>FROM</span> <span class=n>ontime</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌───res─┐
│ 19690 │
└───────┘
</code></pre></div> <h2 id=agg_function-anyLast>anyLast(x)<a class=headerlink href=#agg_function-anyLast title="Permanent link">&para;</a></h2> <p>Выбирает последнее попавшееся значение.<br> Результат так же недетерминирован, как и для функции <code>any</code>.</p> <h2 id=groupbitand>groupBitAnd<a class=headerlink href=#groupbitand title="Permanent link">&para;</a></h2> <p>Применяет побитовое <code>И</code> для последовательности чисел.</p> <div class=codehilite><pre><span></span><code><span class=n>groupBitAnd</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <p><code>expr</code> – выражение, результат которого имеет тип данных <code>UInt*</code>.</p> <p><strong>Возвращаемое значение</strong></p> <p>Значение типа <code>UInt*</code>.</p> <p><strong>Пример</strong></p> <p>Тестовые данные:</p> <div class=codehilite><pre><span></span><code>binary     decimal
00101100 = 44
00011100 = 28
00001101 = 13
01010101 = 85
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>groupBitAnd</span><span class=p>(</span><span class=n>num</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>Где <code>num</code> — столбец с тестовыми данными.</p> <p>Результат:</p> <div class=codehilite><pre><span></span><code>binary     decimal
00000100 = 4
</code></pre></div> <h2 id=groupbitor>groupBitOr<a class=headerlink href=#groupbitor title="Permanent link">&para;</a></h2> <p>Применяет побитовое <code>ИЛИ</code> для последовательности чисел.</p> <div class=codehilite><pre><span></span><code><span class=n>groupBitOr</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <p><code>expr</code> – выражение, результат которого имеет тип данных <code>UInt*</code>.</p> <p><strong>Возвращаемое значение</strong></p> <p>Значение типа <code>UInt*</code>.</p> <p><strong>Пример</strong></p> <p>Тестовые данные:</p> <div class=codehilite><pre><span></span><code>binary     decimal
00101100 = 44
00011100 = 28
00001101 = 13
01010101 = 85
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>groupBitOr</span><span class=p>(</span><span class=n>num</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>Где <code>num</code> — столбец с тестовыми данными.</p> <p>Результат:</p> <div class=codehilite><pre><span></span><code>binary     decimal
01111101 = 125
</code></pre></div> <h2 id=groupbitxor>groupBitXor<a class=headerlink href=#groupbitxor title="Permanent link">&para;</a></h2> <p>Применяет побитовое <code>ИСКЛЮЧАЮЩЕЕ ИЛИ</code> для последовательности чисел.</p> <div class=codehilite><pre><span></span><code><span class=n>groupBitXor</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <p><code>expr</code> – выражение, результат которого имеет тип данных <code>UInt*</code>.</p> <p><strong>Возвращаемое значение</strong></p> <p>Значение типа <code>UInt*</code>.</p> <p><strong>Пример</strong></p> <p>Тестовые данные:</p> <div class=codehilite><pre><span></span><code>binary     decimal
00101100 = 44
00011100 = 28
00001101 = 13
01010101 = 85
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>groupBitXor</span><span class=p>(</span><span class=n>num</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>Где <code>num</code> — столбец с тестовыми данными.</p> <p>Результат:</p> <div class=codehilite><pre><span></span><code>binary     decimal
01101000 = 104
</code></pre></div> <h2 id=groupbitmap>groupBitmap<a class=headerlink href=#groupbitmap title="Permanent link">&para;</a></h2> <p>Bitmap или агрегатные вычисления для столбца с типом данных <code>UInt*</code>, возвращают кардинальность в виде значения типа UInt64, если добавить суффикс -State, то возвращают <a href=../../functions/bitmap_functions/ >объект bitmap</a>.</p> <div class=codehilite><pre><span></span><code><span class=n>groupBitmap</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <p><code>expr</code> – выражение, результат которого имеет тип данных <code>UInt*</code>.</p> <p><strong>Возвращаемое значение</strong></p> <p>Значение типа <code>UInt64</code>.</p> <p><strong>Пример</strong></p> <p>Тестовые данные:</p> <div class=codehilite><pre><span></span><code>UserID
1
1
2
3
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>groupBitmap</span><span class=p>(</span><span class=n>UserID</span><span class=p>)</span> <span class=k>as</span> <span class=n>num</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code>num
3
</code></pre></div> <h2 id=agg_function-min>min(x)<a class=headerlink href=#agg_function-min title="Permanent link">&para;</a></h2> <p>Вычисляет минимум.</p> <h2 id=agg_function-max>max(x)<a class=headerlink href=#agg_function-max title="Permanent link">&para;</a></h2> <p>Вычисляет максимум.</p> <h2 id=agg_function-argMin>argMin(arg, val)<a class=headerlink href=#agg_function-argMin title="Permanent link">&para;</a></h2> <p>Вычисляет значение arg при минимальном значении val. Если есть несколько разных значений arg для минимальных значений val, то выдаётся первое попавшееся из таких значений.</p> <p><strong>Пример:</strong></p> <div class=codehilite><pre><span></span><code>┌─user─────┬─salary─┐
│ director │   5000 │
│ manager  │   3000 │
│ worker   │   1000 │
└──────────┴────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>argMin</span><span class=p>(</span><span class=k>user</span><span class=p>,</span> <span class=n>salary</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>salary</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─argMin(user, salary)─┐
│ worker               │
└──────────────────────┘
</code></pre></div> <h2 id=agg_function-argMax>argMax(arg, val)<a class=headerlink href=#agg_function-argMax title="Permanent link">&para;</a></h2> <p>Вычисляет значение arg при максимальном значении val. Если есть несколько разных значений arg для максимальных значений val, то выдаётся первое попавшееся из таких значений.</p> <h2 id=agg_function-sum>sum(x)<a class=headerlink href=#agg_function-sum title="Permanent link">&para;</a></h2> <p>Вычисляет сумму.<br> Работает только для чисел.</p> <h2 id=agg_function-sumWithOverflow>sumWithOverflow(x)<a class=headerlink href=#agg_function-sumWithOverflow title="Permanent link">&para;</a></h2> <p>Вычисляет сумму чисел, используя для результата тот же тип данных, что и для входных параметров. Если сумма выйдет за максимальное значение для заданного типа данных, то функция вернёт ошибку.</p> <p>Работает только для чисел.</p> <h2 id=summap-key-value>sumMap(key, value)<a class=headerlink href=#summap-key-value title="Permanent link">&para;</a></h2> <p>Производит суммирование массива 'value' по соответствующим ключам заданным в массиве 'key'.<br> Количество элементов в 'key' и 'value' должно быть одинаковым для каждой строки, для которой происходит суммирование.<br> Возвращает кортеж из двух массивов - ключи в отсортированном порядке и значения, просуммированные по соответствующим ключам.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>sum_map</span><span class=p>(</span>
    <span class=nb>date</span> <span class=nb>Date</span><span class=p>,</span>
    <span class=n>timeslot</span> <span class=n>DateTime</span><span class=p>,</span>
    <span class=n>statusMap</span> <span class=n>Nested</span><span class=p>(</span>
        <span class=n>status</span> <span class=n>UInt16</span><span class=p>,</span>
        <span class=n>requests</span> <span class=n>UInt64</span>
    <span class=p>)</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Log</span><span class=p>;</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>sum_map</span> <span class=k>VALUES</span>
    <span class=p>(</span><span class=s1>&#39;2000-01-01&#39;</span><span class=p>,</span> <span class=s1>&#39;2000-01-01 00:00:00&#39;</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>]),</span>
    <span class=p>(</span><span class=s1>&#39;2000-01-01&#39;</span><span class=p>,</span> <span class=s1>&#39;2000-01-01 00:00:00&#39;</span><span class=p>,</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>]),</span>
    <span class=p>(</span><span class=s1>&#39;2000-01-01&#39;</span><span class=p>,</span> <span class=s1>&#39;2000-01-01 00:01:00&#39;</span><span class=p>,</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>]),</span>
    <span class=p>(</span><span class=s1>&#39;2000-01-01&#39;</span><span class=p>,</span> <span class=s1>&#39;2000-01-01 00:01:00&#39;</span><span class=p>,</span> <span class=p>[</span><span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>]);</span>
<span class=k>SELECT</span>
    <span class=n>timeslot</span><span class=p>,</span>
    <span class=n>sumMap</span><span class=p>(</span><span class=n>statusMap</span><span class=p>.</span><span class=n>status</span><span class=p>,</span> <span class=n>statusMap</span><span class=p>.</span><span class=n>requests</span><span class=p>)</span>
<span class=k>FROM</span> <span class=n>sum_map</span>
<span class=k>GROUP</span> <span class=k>BY</span> <span class=n>timeslot</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌────────────timeslot─┬─sumMap(statusMap.status, statusMap.requests)─┐
│ 2000-01-01 00:00:00 │ ([1,2,3,4,5],[10,10,20,10,10])               │
│ 2000-01-01 00:01:00 │ ([4,5,6,7,8],[10,10,20,10,10])               │
└─────────────────────┴──────────────────────────────────────────────┘
</code></pre></div> <h2 id=skewpop>skewPop<a class=headerlink href=#skewpop title="Permanent link">&para;</a></h2> <p>Вычисляет <a href=https://ru.wikipedia.org/wiki/Коэффициент_асимметрии rel="external nofollow noreferrer">коэффициент асимметрии</a> для последовательности.</p> <div class=codehilite><pre><span></span><code><span class=n>skewPop</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <p><code>expr</code> — <a href=../../syntax/#syntax-expressions>Выражение</a>, возвращающее число.</p> <p><strong>Возвращаемое значение</strong></p> <p>Коэффициент асимметрии заданного распределения. Тип — <a href=../../../data_types/float/ >Float64</a></p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>skewPop</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>series_with_value_column</span>
</code></pre></div> <h2 id=skewsamp>skewSamp<a class=headerlink href=#skewsamp title="Permanent link">&para;</a></h2> <p>Вычисляет <a href=https://ru.wikipedia.org/wiki/Статистика_(функция_выборки) rel="external nofollow noreferrer">выборочный коэффициент асимметрии</a> для последовательности.</p> <p>Он представляет собой несмещенную оценку асимметрии случайной величины, если переданные значения образуют ее выборку.</p> <div class=codehilite><pre><span></span><code><span class=n>skewSamp</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <p><code>expr</code> — <a href=../../syntax/#syntax-expressions>Выражение</a>, возвращающее число.</p> <p><strong>Возвращаемое значение</strong></p> <p>Коэффициент асимметрии заданного распределения. Тип — <a href=../../../data_types/float/ >Float64</a>. Если <code>n &lt;= 1</code> (<code>n</code> — размер выборки), тогда функция возвращает <code>nan</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>skewSamp</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>series_with_value_column</span>
</code></pre></div> <h2 id=kurtpop>kurtPop<a class=headerlink href=#kurtpop title="Permanent link">&para;</a></h2> <p>Вычисляет <a href=https://ru.wikipedia.org/wiki/Коэффициент_эксцесса rel="external nofollow noreferrer">коэффициент эксцесса</a> последовательности.</p> <div class=codehilite><pre><span></span><code><span class=n>kurtPop</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <p><code>expr</code> — <a href=../../syntax/#syntax-expressions>Выражение</a>, возвращающее число.</p> <p><strong>Возвращаемое значение</strong></p> <p>Коэффициент эксцесса заданного распределения. Тип — <a href=../../../data_types/float/ >Float64</a></p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>kurtPop</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>series_with_value_column</span>
</code></pre></div> <h2 id=kurtsamp>kurtSamp<a class=headerlink href=#kurtsamp title="Permanent link">&para;</a></h2> <p>Вычисляет <a href=https://ru.wikipedia.org/wiki/Статистика_(функция_выборки) rel="external nofollow noreferrer">выборочный коэффициент эксцесса</a> для последовательности.</p> <p>Он представляет собой несмещенную оценку эксцесса случайной величины, если переданные значения образуют ее выборку.</p> <div class=codehilite><pre><span></span><code><span class=n>kurtSamp</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <p><code>expr</code> — <a href=../../syntax/#syntax-expressions>Выражение</a>, возвращающее число.</p> <p><strong>Возвращаемое значение</strong></p> <p>Коэффициент эксцесса заданного распределения. Тип — <a href=../../../data_types/float/ >Float64</a>. Если <code>n &lt;= 1</code> (<code>n</code> — размер выборки), тогда функция возвращает <code>nan</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>kurtSamp</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>series_with_value_column</span>
</code></pre></div> <h2 id=agg_function-timeseriesgroupsum>timeSeriesGroupSum(uid, timestamp, value)<a class=headerlink href=#agg_function-timeseriesgroupsum title="Permanent link">&para;</a></h2> <p><code>timeSeriesGroupSum</code> агрегирует временные ряды в которых не совпадают моменты.<br> Функция использует линейную интерполяцию между двумя значениями времени, а затем суммирует значения для одного и того же момента (как измеренные так и интерполированные) по всем рядам.</p> <ul> <li><code>uid</code> уникальный идентификатор временного ряда, <code>UInt64</code>.</li> <li><code>timestamp</code> имеет тип <code>Int64</code> чтобы можно было учитывать милли и микросекунды.</li> <li><code>value</code> представляет собой значение метрики.</li> </ul> <p>Функция возвращает массив кортежей с парами <code>(timestamp, aggregated_value)</code>.</p> <p>Временные ряды должны быть отсортированы по возрастанию <code>timestamp</code>.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code>┌─uid─┬─timestamp─┬─value─┐
│ 1   │     2     │   0.2 │
│ 1   │     7     │   0.7 │
│ 1   │    12     │   1.2 │
│ 1   │    17     │   1.7 │
│ 1   │    25     │   2.5 │
│ 2   │     3     │   0.6 │
│ 2   │     8     │   1.6 │
│ 2   │    12     │   2.4 │
│ 2   │    18     │   3.6 │
│ 2   │    24     │   4.8 │
└─────┴───────────┴───────┘
</code></pre></div> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>time_series</span><span class=p>(</span>
    <span class=n>uid</span>       <span class=n>UInt64</span><span class=p>,</span>
    <span class=k>timestamp</span> <span class=n>Int64</span><span class=p>,</span>
    <span class=n>value</span>     <span class=n>Float64</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span><span class=p>;</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>time_series</span> <span class=k>VALUES</span>
    <span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>0</span><span class=p>.</span><span class=mi>2</span><span class=p>),(</span><span class=mi>1</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>0</span><span class=p>.</span><span class=mi>7</span><span class=p>),(</span><span class=mi>1</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>1</span><span class=p>.</span><span class=mi>2</span><span class=p>),(</span><span class=mi>1</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>1</span><span class=p>.</span><span class=mi>7</span><span class=p>),(</span><span class=mi>1</span><span class=p>,</span><span class=mi>25</span><span class=p>,</span><span class=mi>2</span><span class=p>.</span><span class=mi>5</span><span class=p>),</span>
    <span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>0</span><span class=p>.</span><span class=mi>6</span><span class=p>),(</span><span class=mi>2</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>.</span><span class=mi>6</span><span class=p>),(</span><span class=mi>2</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>2</span><span class=p>.</span><span class=mi>4</span><span class=p>),(</span><span class=mi>2</span><span class=p>,</span><span class=mi>18</span><span class=p>,</span><span class=mi>3</span><span class=p>.</span><span class=mi>6</span><span class=p>),(</span><span class=mi>2</span><span class=p>,</span><span class=mi>24</span><span class=p>,</span><span class=mi>4</span><span class=p>.</span><span class=mi>8</span><span class=p>);</span>

<span class=k>SELECT</span> <span class=n>timeSeriesGroupSum</span><span class=p>(</span><span class=n>uid</span><span class=p>,</span> <span class=k>timestamp</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
<span class=k>FROM</span> <span class=p>(</span>
    <span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>time_series</span> <span class=k>order</span> <span class=k>by</span> <span class=k>timestamp</span> <span class=k>ASC</span>
<span class=p>);</span>
</code></pre></div> <p>И результат будет:</p> <div class=codehilite><pre><span></span><code>[(2,0.2),(3,0.9),(7,2.1),(8,2.4),(12,3.6),(17,5.1),(18,5.4),(24,7.2),(25,2.5)]
</code></pre></div> <h2 id=agg_function-timeseriesgroupratesum>timeSeriesGroupRateSum(uid, ts, val)<a class=headerlink href=#agg_function-timeseriesgroupratesum title="Permanent link">&para;</a></h2> <p>Аналогично timeSeriesGroupRateSum, timeSeriesGroupRateSum будет вычислять производные по timestamp для рядов, а затем суммировать полученные производные для всех рядов для одного значения timestamp.<br> Также ряды должны быть отсортированы по возрастанию timestamp.</p> <p>Для пример из описания timeSeriesGroupRateSum результат будет следующим:</p> <div class=codehilite><pre><span></span><code>[(2,0),(3,0.1),(7,0.3),(8,0.3),(12,0.3),(17,0.3),(18,0.3),(24,0.3),(25,0.1)]
</code></pre></div> <h2 id=agg_function-avg>avg(x)<a class=headerlink href=#agg_function-avg title="Permanent link">&para;</a></h2> <p>Вычисляет среднее.<br> Работает только для чисел.<br> Результат всегда Float64.</p> <h2 id=agg_function-uniq>uniq<a class=headerlink href=#agg_function-uniq title="Permanent link">&para;</a></h2> <p>Приближённо вычисляет количество различных значений аргумента.</p> <div class=codehilite><pre><span></span><code><span class=n>uniq</span><span class=p>(</span><span class=n>x</span><span class=p>[,</span> <span class=p>...])</span>
</code></pre></div> <p><strong>Параметры</strong></p> <p>Функция принимает переменное число входных параметров. Параметры могут быть числовых типов, а также <code>Tuple</code>, <code>Array</code>, <code>Date</code>, <code>DateTime</code>, <code>String</code>.</p> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Значение с типом данных <a href=../../../data_types/int_uint/ >UInt64</a>.</li> </ul> <p><strong>Детали реализации</strong></p> <p>Функция:</p> <ul> <li> <p>Вычисляет хэш для всех параметров агрегации, а затем использует его в вычислениях.</p> </li> <li> <p>Использует адаптивный алгоритм выборки. В качестве состояния вычисления функция использует выборку хэш-значений элементов размером до 65536.</p> <p>Этот алгоритм очень точен и очень эффективен по использованию CPU. Если запрос содержит небольшое количество этих функций, использование <code>uniq</code> почти так же эффективно, как и использование других агрегатных функций.</p> </li> <li> <p>Результат детерминирован (не зависит от порядка выполнения запроса).</p> </li> </ul> <p>Эту функцию рекомендуется использовать практически во всех сценариях.</p> <p><strong>Смотрите также</strong></p> <ul> <li><a href=#agg_function-uniqcombined>uniqCombined</a></li> <li><a href=#agg_function-uniqcombined64>uniqCombined64</a></li> <li><a href=#agg_function-uniqhll12>uniqHLL12</a></li> <li><a href=#agg_function-uniqexact>uniqExact</a></li> </ul> <h2 id=agg_function-uniqcombined>uniqCombined<a class=headerlink href=#agg_function-uniqcombined title="Permanent link">&para;</a></h2> <p>Приближённо вычисляет количество различных значений аргумента.</p> <div class=codehilite><pre><span></span><code><span class=n>uniqCombined</span><span class=p>(</span><span class=n>HLL_precision</span><span class=p>)(</span><span class=n>x</span><span class=p>[,</span> <span class=p>...])</span>
</code></pre></div> <p>Функция <code>uniqCombined</code> — это хороший выбор для вычисления количества различных значений.</p> <p><strong>Параметры</strong></p> <p>Функция принимает переменное число входных параметров. Параметры могут быть числовых типов, а также <code>Tuple</code>, <code>Array</code>, <code>Date</code>, <code>DateTime</code>, <code>String</code>.</p> <p><code>HLL_precision</code> — это логарифм по основанию 2 от числа ячеек в <a href=https://en.wikipedia.org/wiki/HyperLogLog rel="external nofollow noreferrer">HyperLogLog</a>. Необязательный, можно использовать функцию как <code>uniqCombined (x [,...])</code>. Для <code>HLL_precision</code> значение по умолчанию — 17, что фактически составляет 96 КБ пространства (2^17 ячеек, 6 бит каждая).</p> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Число типа <a href=../../../data_types/int_uint/ >UInt64</a>.</li> </ul> <p><strong>Детали реализации</strong></p> <p>Функция:</p> <ul> <li> <p>Вычисляет хэш (64-битный для <code>String</code> и 32-битный для всех остальных типов) для всех параметров агрегации, а затем использует его в вычислениях.</p> </li> <li> <p>Используется комбинация трёх алгоритмов: массив, хэш-таблица и HyperLogLog с таблицей коррекции погрешности.</p> <p>Для небольшого количества различных значений используется массив. Если размер набора больше, используется хэш-таблица. При дальнейшем увеличении количества значений, используется структура HyperLogLog, имеющая фиксированный размер в памяти.</p> </li> <li> <p>Результат детерминирован (не зависит от порядка выполнения запроса).</p> </li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Так как используется 32-битный хэш для не-<code>String</code> типов, результат будет иметь очень очень большую ошибку для количества разичных элементов существенно больше <code>UINT_MAX</code> (ошибка быстро растёт начиная с нескольких десятков миллиардов различных значений), таким образом в этом случае нужно использовать <a href=#agg_function-uniqcombined64>uniqCombined64</a></p> </div> <p>По сравнению с функцией <a href=#agg_function-uniq>uniq</a>, <code>uniqCombined</code>:</p> <ul> <li>Потребляет в несколько раз меньше памяти.</li> <li>Вычисляет с в несколько раз более высокой точностью.</li> <li>Обычно имеет немного более низкую производительность. В некоторых сценариях <code>uniqCombined</code> может показывать более высокую производительность, чем <code>uniq</code>, например, в случае распределенных запросов, при которых по сети передаётся большое количество состояний агрегации.</li> </ul> <p><strong>Смотрите также</strong></p> <ul> <li><a href=#agg_function-uniq>uniq</a></li> <li><a href=#agg_function-uniqcombined64>uniqCombined64</a></li> <li><a href=#agg_function-uniqhll12>uniqHLL12</a></li> <li><a href=#agg_function-uniqexact>uniqExact</a></li> </ul> <h2 id=agg_function-uniqcombined64>uniqCombined64<a class=headerlink href=#agg_function-uniqcombined64 title="Permanent link">&para;</a></h2> <p>Использует 64-битный хэш для всех типов, в отличие от <a href=#agg_function-uniqcombined>uniqCombined</a>.</p> <h2 id=agg_function-uniqhll12>uniqHLL12<a class=headerlink href=#agg_function-uniqhll12 title="Permanent link">&para;</a></h2> <p>Вычисляет приблизительное число различных значений аргументов, используя алгоритм <a href=https://en.wikipedia.org/wiki/HyperLogLog rel="external nofollow noreferrer">HyperLogLog</a>.</p> <div class=codehilite><pre><span></span><code><span class=n>uniqHLL12</span><span class=p>(</span><span class=n>x</span><span class=p>[,</span> <span class=p>...])</span>
</code></pre></div> <p><strong>Параметры</strong></p> <p>Функция принимает переменное число входных параметров. Параметры могут быть числовых типов, а также <code>Tuple</code>, <code>Array</code>, <code>Date</code>, <code>DateTime</code>, <code>String</code>.</p> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Значение хэша с типом данных <a href=../../../data_types/int_uint/ >UInt64</a>.</li> </ul> <p><strong>Детали реализации</strong></p> <p>Функция:</p> <ul> <li> <p>Вычисляет хэш для всех параметров агрегации, а затем использует его в вычислениях.</p> </li> <li> <p>Использует алгоритм HyperLogLog для аппроксимации числа различных значений аргументов.</p> <p>Используется 212 5-битовых ячеек. Размер состояния чуть больше 2.5 КБ. Результат не точный (ошибка до ~10%) для небольших множеств (&lt;10K элементов). Однако для множеств большой кардинальности (10K - 100M) результат довольно точен (ошибка до ~1.6%). Начиная с 100M ошибка оценки будет только расти и для множеств огромной кардинальности (1B+ элементов) функция возвращает результат с очень большой неточностью.</p> </li> <li> <p>Результат детерминирован (не зависит от порядка выполнения запроса).</p> </li> </ul> <p>Мы не рекомендуем использовать эту функцию. В большинстве случаев используйте функцию <a href=#agg_function-uniq>uniq</a> или <a href=#agg_function-uniqcombined>uniqCombined</a>.</p> <p><strong>Смотрите также</strong></p> <ul> <li><a href=#agg_function-uniq>uniq</a></li> <li><a href=#agg_function-uniqcombined>uniqCombined</a></li> <li><a href=#agg_function-uniqexact>uniqExact</a></li> </ul> <h2 id=agg_function-uniqexact>uniqExact<a class=headerlink href=#agg_function-uniqexact title="Permanent link">&para;</a></h2> <p>Вычисляет точное количество различных значений аргументов.</p> <div class=codehilite><pre><span></span><code><span class=n>uniqExact</span><span class=p>(</span><span class=n>x</span><span class=p>[,</span> <span class=p>...])</span>
</code></pre></div> <p>Функцию <code>uniqExact</code> следует использовать, если вам обязательно нужен точный результат. В противном случае используйте функцию <a href=#agg_function-uniq>uniq</a>.</p> <p>Функция <code>uniqExact</code> расходует больше оперативной памяти, чем функция <code>uniq</code>, так как размер состояния неограниченно растёт по мере роста количества различных значений.</p> <p><strong>Параметры</strong></p> <p>Функция принимает переменное число входных параметров. Параметры могут быть числовых типов, а также <code>Tuple</code>, <code>Array</code>, <code>Date</code>, <code>DateTime</code>, <code>String</code>.</p> <p><strong>Смотрите также</strong></p> <ul> <li><a href=#agg_function-uniq>uniq</a></li> <li><a href=#agg_function-uniqcombined>uniqCombined</a></li> <li><a href=#agg_function-uniqhll12>uniqHLL12</a></li> </ul> <h2 id=agg_function-grouparray>groupArray(x), groupArray(max_size)(x)<a class=headerlink href=#agg_function-grouparray title="Permanent link">&para;</a></h2> <p>Составляет массив из значений аргумента.<br> Значения в массив могут быть добавлены в любом (недетерминированном) порядке.</p> <p>Вторая версия (с параметром <code>max_size</code>) ограничивает размер результирующего массива <code>max_size</code> элементами.<br> Например, <code>groupArray(1)(x)</code> эквивалентно <code>[any(x)]</code>.</p> <p>В некоторых случаях, вы всё же можете рассчитывать на порядок выполнения запроса. Это — случаи, когда <code>SELECT</code> идёт из подзапроса, в котором используется <code>ORDER BY</code>.</p> <h2 id=grouparrayinsertat-x>groupArrayInsertAt(x)<a class=headerlink href=#grouparrayinsertat-x title="Permanent link">&para;</a></h2> <p>Вставляет в массив значение в заданную позицию.</p> <p>Принимает на вход значение и позицию. Если на одну и ту же позицию вставляется несколько значений, в результирующем массиве может оказаться любое (первое в случае однопоточного выполнения). Если в позицию не вставляется ни одного значения, то позиции присваивается значение по умолчанию.</p> <p>Опциональные параметры:</p> <ul> <li>Значение по умолчанию для подстановки на пустые позиции.</li> <li>Длина результирующего массива. Например, если вы хотите получать массивы одинакового размера для всех агрегатных ключей. При использовании этого параметра значение по умолчанию задавать обязательно.</li> </ul> <h2 id=agg_function-grouparraymovingsum>groupArrayMovingSum<a class=headerlink href=#agg_function-grouparraymovingsum title="Permanent link">&para;</a></h2> <p>Вычисляет скользящую сумму входных значений.</p> <div class=codehilite><pre><span></span><code><span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=n>numbers_for_summing</span><span class=p>)</span>
<span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=n>window_size</span><span class=p>)(</span><span class=n>numbers_for_summing</span><span class=p>)</span>
</code></pre></div> <p>Функция может принимать размер окна в качестве параметра. Если окно не указано, то функция использует размер окна, равный количеству строк в столбце.</p> <p><strong>Параметры</strong></p> <ul> <li><code>numbers_for_summing</code> — <a href=../../syntax/#syntax-expressions>выражение</a>, возвращающее значение числового типа.</li> <li><code>window_size</code> — размер окна.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li>Массив того же размера и типа, что и входные данные.</li> </ul> <p><strong>Пример</strong></p> <p>Таблица с исходными данными:</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>t</span>
<span class=p>(</span>
    <span class=o>`</span><span class=nb>int</span><span class=o>`</span> <span class=n>UInt8</span><span class=p>,</span>
    <span class=o>`</span><span class=nb>float</span><span class=o>`</span> <span class=n>Float32</span><span class=p>,</span>
    <span class=o>`</span><span class=nb>dec</span><span class=o>`</span> <span class=n>Decimal32</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>TinyLog</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─int─┬─float─┬──dec─┐
│   1 │   1.1 │ 1.10 │
│   2 │   2.2 │ 2.20 │
│   4 │   4.4 │ 4.40 │
│   7 │  7.77 │ 7.77 │
└─────┴───────┴──────┘
</code></pre></div> <p>Запросы:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span> <span class=k>AS</span> <span class=n>I</span><span class=p>,</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span> <span class=k>AS</span> <span class=n>F</span><span class=p>,</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=nb>dec</span><span class=p>)</span> <span class=k>AS</span> <span class=n>D</span>
<span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─I──────────┬─F───────────────────────────────┬─D──────────────────────┐
│ [1,3,7,14] │ [1.1,3.3000002,7.7000003,15.47] │ [1.10,3.30,7.70,15.47] │
└────────────┴─────────────────────────────────┴────────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>int</span><span class=p>)</span> <span class=k>AS</span> <span class=n>I</span><span class=p>,</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>float</span><span class=p>)</span> <span class=k>AS</span> <span class=n>F</span><span class=p>,</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>dec</span><span class=p>)</span> <span class=k>AS</span> <span class=n>D</span>
<span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─I──────────┬─F───────────────────────────────┬─D──────────────────────┐
│ [1,3,6,11] │ [1.1,3.3000002,6.6000004,12.17] │ [1.10,3.30,6.60,12.17] │
└────────────┴─────────────────────────────────┴────────────────────────┘
</code></pre></div> <h2 id=agg_function-grouparraymovingavg>groupArrayMovingAvg<a class=headerlink href=#agg_function-grouparraymovingavg title="Permanent link">&para;</a></h2> <p>Вычисляет скользящее среднее для входных значений.</p> <div class=codehilite><pre><span></span><code><span class=err>groupArrayMovingAvg(numbers_for_summing)</span>
<span class=err>groupArrayMovingAvg(window_size)(numbers_for_summing)</span>
</code></pre></div> <p>Функция может принимать размер окна в качестве параметра. Если окно не указано, то функция использует размер окна, равный количеству строк в столбце.</p> <p><strong>Параметры</strong></p> <ul> <li><code>numbers_for_summing</code> — <a href=../../syntax/#syntax-expressions>выражение</a>, возвращающее значение числового типа.</li> <li><code>window_size</code> — размер окна.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li>Массив того же размера и типа, что и входные данные.</li> </ul> <p>Функция использует <a href=https://ru.wikipedia.org/wiki/Округление#Методы rel="external nofollow noreferrer">округление к меньшему по модулю</a>. Оно усекает десятичные разряды, незначимые для результирующего типа данных.</p> <p><strong>Пример</strong></p> <p>Таблица с исходными данными:</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>t</span>
<span class=p>(</span>
    <span class=o>`</span><span class=nb>int</span><span class=o>`</span> <span class=n>UInt8</span><span class=p>,</span>
    <span class=o>`</span><span class=nb>float</span><span class=o>`</span> <span class=n>Float32</span><span class=p>,</span>
    <span class=o>`</span><span class=nb>dec</span><span class=o>`</span> <span class=n>Decimal32</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>TinyLog</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─int─┬─float─┬──dec─┐
│   1 │   1.1 │ 1.10 │
│   2 │   2.2 │ 2.20 │
│   4 │   4.4 │ 4.40 │
│   7 │  7.77 │ 7.77 │
└─────┴───────┴──────┘
</code></pre></div> <p>Запросы:</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span> <span class=k>AS</span> <span class=n>I</span><span class=p>,</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span> <span class=k>AS</span> <span class=n>F</span><span class=p>,</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=nb>dec</span><span class=p>)</span> <span class=k>AS</span> <span class=n>D</span>
<span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─I─────────┬─F───────────────────────────────────┬─D─────────────────────┐
│ [0,0,1,3] │ [0.275,0.82500005,1.9250001,3.8675] │ [0.27,0.82,1.92,3.86] │
└───────────┴─────────────────────────────────────┴───────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>int</span><span class=p>)</span> <span class=k>AS</span> <span class=n>I</span><span class=p>,</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>float</span><span class=p>)</span> <span class=k>AS</span> <span class=n>F</span><span class=p>,</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>dec</span><span class=p>)</span> <span class=k>AS</span> <span class=n>D</span>
<span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─I─────────┬─F────────────────────────────────┬─D─────────────────────┐
│ [0,1,3,5] │ [0.55,1.6500001,3.3000002,6.085] │ [0.55,1.65,3.30,6.08] │
└───────────┴──────────────────────────────────┴───────────────────────┘
</code></pre></div> <h2 id=groupuniqarray-x-groupuniqarray-max-size-x>groupUniqArray(x), groupUniqArray(max_size)(x)<a class=headerlink href=#groupuniqarray-x-groupuniqarray-max-size-x title="Permanent link">&para;</a></h2> <p>Составляет массив из различных значений аргумента. Расход оперативной памяти такой же, как у функции <code>uniqExact</code>.</p> <p>Функция <code>groupUniqArray(max_size)(x)</code> ограничивает размер результирующего массива до <code>max_size</code> элементов. Например, <code>groupUniqArray(1)(x)</code> равнозначно <code>[any(x)]</code>.</p> <h2 id=agg_function-quantile>quantile(level)(x)<a class=headerlink href=#agg_function-quantile title="Permanent link">&para;</a></h2> <p>Приближённо вычисляет квантиль уровня level. level - константа, число с плавающей запятой от 0 до 1.<br> Рекомендуется использовать значения level в диапазоне <code>[0.01, 0.99]</code>.<br> Не используйте значение 'level' равное 0 или 1 – используйте функции 'min' и 'max' для этих случаев.</p> <p>В этой функции, равно как и во всех функциях для расчёта квантилей, параметр level может быть не указан. В таком случае, он принимается равным 0.5 - то есть, функция будет вычислять медиану.</p> <p>Работает для чисел, дат, дат-с-временем.<br> Для чисел возвращает Float64, для дат - дату, для дат-с-временем - дату-с-временем.</p> <p>Используется <a href=https://en.wikipedia.org/wiki/Reservoir_sampling rel="external nofollow noreferrer">reservoir sampling</a> с размером резервуара до 8192.<br> При необходимости, результат выдаётся с линейной аппроксимацией из двух соседних значений.<br> Этот алгоритм обеспечивает весьма низкую точность расчёта. Смотрите также функции <code>quantileTiming</code>, <code>quantileTDigest</code>, <code>quantileExact</code>.</p> <p>Результат зависит от порядка выполнения запроса, и является недетерминированным.</p> <p>При использовании нескольких функций <code>quantile</code> (и аналогичных) с разными уровнями в запросе, внутренние состояния не объединяются (то есть, запрос работает менее эффективно, чем мог бы). В этом случае, используйте функцию <code>quantiles</code> (и аналогичные).</p> <h2 id=quantiledeterministic-level-x-determinator>quantileDeterministic(level)(x, determinator)<a class=headerlink href=#quantiledeterministic-level-x-determinator title="Permanent link">&para;</a></h2> <p>Работает аналогично функции <code>quantile</code>, но, в отличие от неё, результат является детерминированным и не зависит от порядка выполнения запроса.</p> <p>Для этого, функция принимает второй аргумент - «детерминатор». Это некоторое число, хэш от которого используется вместо генератора случайных чисел в алгоритме reservoir sampling. Для правильной работы функции, одно и то же значение детерминатора не должно встречаться слишком часто. В качестве детерминатора вы можете использовать идентификатор события, идентификатор посетителя и т. п.</p> <p>Не используйте эту функцию для расчёта таймингов. Для этого есть более подходящая функция - <code>quantileTiming</code>.</p> <h2 id=agg_function-quantiletiming>quantileTiming<a class=headerlink href=#agg_function-quantiletiming title="Permanent link">&para;</a></h2> <p>Вычисляет квантиль заданного уровня с детерминированной точностью. Функция предназначена для расчётов квантилей времени загрузки страниц в миллисекундах.</p> <div class=codehilite><pre><span></span><code><span class=err>quantileTiming(level)(expr)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code>level</code> — уровень квантили. Диапазон: [0, 1].</li> <li> <p><code>expr</code> — <a href=../../syntax/#syntax-expressions>выражение</a>, возвращающее число типа <a href=../../../data_types/float/ >Float*</a>. Функция ожидает на вход значения в фомате UNIX-время в миллисекундах, но не проверяет формат входных значений.</p> <ul> <li>Поведение функции не определено для отрицательных входных значений.</li> <li>Если входное значение больше 30,000 (т.е. время загрузки страницы превышает 30 секунд), оно приравнивается к 30,000.</li> </ul> </li> </ul> <p><strong>Точность</strong></p> <p>Вычисления точны если:</p> <ul> <li>Общее количество значений не превышает 5670.</li> <li>Общее количество значений больше 5670, но времена загрузки страниц меньше 1024мс.</li> </ul> <p>В противном случае, результат рассчетов округляется до ближайшего числа, кратного 16мс.</p> <div class="admonition note"> <p class=admonition-title>Примечание</p> <p>Для расчёта квантилей времени загрузки страниц, функция работает эффективней и с более высокой точностью, чем функция <a href=#agg_function-quantile>quantile</a>.</p> </div> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Квантиль заданного уровня.</li> </ul> <p>Тип: <code>Float32</code>.</p> <div class="admonition note"> <p class=admonition-title>Примечание</p> <p>Если в функцию не передано значений (для <code>quantileTimingIf</code>), возвращается <a href=../../../data_types/float/#data_type-float-nan-inf>NaN</a>. Это необходимо для того, что бы отделить такие случаи от случаев, в которых результат 0. Смотрите замечания о сортировке значений <code>NaN</code> в разделе <a href=../../select/#select-order-by>Секция ORDER BY</a>.</p> </div> <p>Результат детерминирован (не зависит от порядка выполнения запроса).</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>quantileTiming</span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>5</span><span class=p>)(</span><span class=nb>number</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─quantileTiming(0.5)(divide(number, 2))─┐
│                                      2 │
└────────────────────────────────────────┘
</code></pre></div> <h2 id=quantiletimingweighted-level-x-weight>quantileTimingWeighted(level)(x, weight)<a class=headerlink href=#quantiletimingweighted-level-x-weight title="Permanent link">&para;</a></h2> <p>Отличается от функции <code>quantileTiming</code> наличием второго аргумента - «веса». Вес - неотрицательное целое число.<br> Результат считается так же, как если бы в функцию <code>quantileTiming</code> значение <code>x</code> было передано <code>weight</code> количество раз.</p> <h2 id=quantileexact-level-x>quantileExact(level)(x)<a class=headerlink href=#quantileexact-level-x title="Permanent link">&para;</a></h2> <p>Вычисляет квантиль уровня level точно. Для этого, все переданные значения складываются в массив, который затем частично сортируется. Поэтому, функция потребляет O(n) памяти, где n - количество переданных значений. Впрочем, для случая маленького количества значений, функция весьма эффективна.</p> <h2 id=quantileexactweighted-level-x-weight>quantileExactWeighted(level)(x, weight)<a class=headerlink href=#quantileexactweighted-level-x-weight title="Permanent link">&para;</a></h2> <p>Вычисляет квантиль уровня level точно. При этом, каждое значение учитывается с весом weight - как будто оно присутствует weight раз. Аргументы функции можно рассматривать как гистограммы, где значению x соответствует «столбик» гистограммы высоты weight, а саму функцию можно рассматривать как суммирование гистограмм.</p> <p>В качестве алгоритма используется хэш-таблица. Из-за этого, в случае, если передаваемые значения часто повторяются, функция потребляет меньше оперативки, чем <code>quantileExact</code>. Вы можете использовать эту функцию вместо <code>quantileExact</code>, указав в качестве веса число 1.</p> <h2 id=quantiletdigest-level-x>quantileTDigest(level)(x)<a class=headerlink href=#quantiletdigest-level-x title="Permanent link">&para;</a></h2> <p>Вычисляет квантиль уровня level приближенно, с использованием алгоритма <a href=https://github.com/tdunning/t-digest/blob/master/docs/t-digest-paper/histo.pdf rel="external nofollow noreferrer">t-digest</a>. Максимальная погрешность составляет 1%. Расход памяти на состояние пропорционален логарифму от количества переданных значений.</p> <p>Производительность функции ниже <code>quantile</code>, <code>quantileTiming</code>. По соотношению размера состояния и точности, функция существенно лучше, чем <code>quantile</code>.</p> <p>Результат зависит от порядка выполнения запроса, и является недетерминированным.</p> <h2 id=median-x>median(x)<a class=headerlink href=#median-x title="Permanent link">&para;</a></h2> <p>Для всех quantile-функций, также присутствуют соответствующие median-функции: <code>median</code>, <code>medianDeterministic</code>, <code>medianTiming</code>, <code>medianTimingWeighted</code>, <code>medianExact</code>, <code>medianExactWeighted</code>, <code>medianTDigest</code>. Они являются синонимами и их поведение ничем не отличается.</p> <h2 id=quantiles-level1-level2-x>quantiles(level1, level2, ...)(x)<a class=headerlink href=#quantiles-level1-level2-x title="Permanent link">&para;</a></h2> <p>Для всех quantile-функций, также присутствуют соответствующие quantiles-функции: <code>quantiles</code>, <code>quantilesDeterministic</code>, <code>quantilesTiming</code>, <code>quantilesTimingWeighted</code>, <code>quantilesExact</code>, <code>quantilesExactWeighted</code>, <code>quantilesTDigest</code>. Эти функции за один проход вычисляют все квантили перечисленных уровней и возвращают массив вычисленных значений.</p> <h2 id=varsamp-x>varSamp(x)<a class=headerlink href=#varsamp-x title="Permanent link">&para;</a></h2> <p>Вычисляет величину <code>Σ((x - x̅)^2) / (n - 1)</code>, где <code>n</code> - размер выборки, <code>x̅</code>- среднее значение <code>x</code>.</p> <p>Она представляет собой несмещённую оценку дисперсии случайной величины, если переданные в функцию значения являются выборкой этой случайной величины.</p> <p>Возвращает <code>Float64</code>. В случае, когда <code>n &lt;= 1</code>, возвращается <code>+∞</code>.</p> <h2 id=varpop-x>varPop(x)<a class=headerlink href=#varpop-x title="Permanent link">&para;</a></h2> <p>Вычисляет величину <code>Σ((x - x̅)^2) / n</code>, где <code>n</code> - размер выборки, <code>x̅</code>- среднее значение <code>x</code>.</p> <p>То есть, дисперсию для множества значений. Возвращает <code>Float64</code>.</p> <h2 id=stddevsamp-x>stddevSamp(x)<a class=headerlink href=#stddevsamp-x title="Permanent link">&para;</a></h2> <p>Результат равен квадратному корню от <code>varSamp(x)</code>.</p> <h2 id=stddevpop-x>stddevPop(x)<a class=headerlink href=#stddevpop-x title="Permanent link">&para;</a></h2> <p>Результат равен квадратному корню от <code>varPop(x)</code>.</p> <h2 id=topk-n-column>topK(N)(column)<a class=headerlink href=#topk-n-column title="Permanent link">&para;</a></h2> <p>Возвращает массив наиболее часто встречающихся значений в указанном столбце. Результирующий массив упорядочен по убыванию частоты значения (не по самим значениям).</p> <p>Реализует <a href=http://www.l2f.inesc-id.pt/~fmmb/wiki/uploads/Work/misnis.ref0a.pdf rel="external nofollow noreferrer">Filtered Space-Saving</a> алгоритм для анализа TopK, на основе reduce-and-combine алгоритма из методики <a href=https://arxiv.org/pdf/1401.0702.pdf rel="external nofollow noreferrer">Parallel Space Saving</a>.</p> <div class=codehilite><pre><span></span><code><span class=n>topK</span><span class=p>(</span><span class=n>N</span><span class=p>)(</span><span class=k>column</span><span class=p>)</span>
</code></pre></div> <p>Функция не дает гарантированного результата. В некоторых ситуациях могут возникать ошибки, и функция возвращает частые, но не наиболее частые значения.</p> <p>Рекомендуем использовать значения <code>N &lt; 10</code>, при больших <code>N</code> снижается производительность. Максимально возможное значение <code>N = 65536</code>.</p> <p><strong>Аргументы</strong></p> <ul> <li>'N' - Количество значений.</li> <li>'x' – Столбец.</li> </ul> <p><strong>Пример</strong></p> <p>Возьмём набор данных <a href=../../../getting_started/example_datasets/ontime/ >OnTime</a> и выберем 3 наиболее часто встречающихся значения в столбце <code>AirlineID</code>.</p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>topK</span><span class=p>(</span><span class=mi>3</span><span class=p>)(</span><span class=n>AirlineID</span><span class=p>)</span> <span class=k>AS</span> <span class=n>res</span>
<span class=k>FROM</span> <span class=n>ontime</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─res─────────────────┐
│ [19393,19790,19805] │
└─────────────────────┘
</code></pre></div> <h2 id=covarsamp-x-y>covarSamp(x, y)<a class=headerlink href=#covarsamp-x-y title="Permanent link">&para;</a></h2> <p>Вычисляет величину <code>Σ((x - x̅)(y - y̅)) / (n - 1)</code>.</p> <p>Возвращает Float64. В случае, когда <code>n &lt;= 1</code>, возвращается +∞.</p> <h2 id=covarpop-x-y>covarPop(x, y)<a class=headerlink href=#covarpop-x-y title="Permanent link">&para;</a></h2> <p>Вычисляет величину <code>Σ((x - x̅)(y - y̅)) / n</code>.</p> <h2 id=corr-x-y>corr(x, y)<a class=headerlink href=#corr-x-y title="Permanent link">&para;</a></h2> <p>Вычисляет коэффициент корреляции Пирсона: <code>Σ((x - x̅)(y - y̅)) / sqrt(Σ((x - x̅)^2) * Σ((y - y̅)^2))</code>.</p> <h2 id=simplelinearregression>simpleLinearRegression<a class=headerlink href=#simplelinearregression title="Permanent link">&para;</a></h2> <p>Выполняет простую (одномерную) линейную регрессию.</p> <div class=codehilite><pre><span></span><code><span class=n>simpleLinearRegression</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</code></pre></div> <p>Параметры:</p> <ul> <li><code>x</code> — столбец со значениями зависимой переменной.</li> <li><code>y</code> — столбец со значениями наблюдаемой переменной.</li> </ul> <p>Возвращаемые значения:</p> <p>Константы <code>(a, b)</code> результирующей прямой <code>y = a*x + b</code>.</p> <p><strong>Примеры</strong></p> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>arrayReduce</span><span class=p>(</span><span class=s1>&#39;simpleLinearRegression&#39;</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─arrayReduce(&#39;simpleLinearRegression&#39;, [0, 1, 2, 3], [0, 1, 2, 3])─┐
│ (1,0)                                                             │
└───────────────────────────────────────────────────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code><span class=k>SELECT</span> <span class=n>arrayReduce</span><span class=p>(</span><span class=s1>&#39;simpleLinearRegression&#39;</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>])</span>
</code></pre></div> <div class=codehilite><pre><span></span><code>┌─arrayReduce(&#39;simpleLinearRegression&#39;, [0, 1, 2, 3], [3, 4, 5, 6])─┐
│ (1,3)                                                             │
└───────────────────────────────────────────────────────────────────┘
</code></pre></div> <h2 id=agg_functions-stochasticlinearregression>stochasticLinearRegression<a class=headerlink href=#agg_functions-stochasticlinearregression title="Permanent link">&para;</a></h2> <p>Функция реализует стохастическую линейную регрессию. Поддерживает пользовательские параметры для скорости обучения, коэффициента регуляризации L2, размера mini-batch и имеет несколько методов обновления весов (<a href=https://en.wikipedia.org/wiki/Stochastic_gradient_descent#Adam rel="external nofollow noreferrer">Adam</a> (по умолчанию), <a href=https://en.wikipedia.org/wiki/Stochastic_gradient_descent rel="external nofollow noreferrer">simple SGD</a>, <a href=https://en.wikipedia.org/wiki/Stochastic_gradient_descent#Momentum rel="external nofollow noreferrer">Momentum</a>, <a href=https://mipt.ru/upload/medialibrary/d7e/41-91.pdf rel="external nofollow noreferrer">Nesterov</a>).</p> <h3 id=agg_functions-stochasticlinearregression-parameters>Параметры<a class=headerlink href=#agg_functions-stochasticlinearregression-parameters title="Permanent link">&para;</a></h3> <p>Есть 4 настраиваемых параметра. Они передаются в функцию последовательно, однако не обязательно указывать все, используются значения по умолчанию, однако хорошая модель требует некоторой настройки параметров.</p> <div class=codehilite><pre><span></span><code>stochasticLinearRegression(1.0, 1.0, 10, &#39;SGD&#39;)
</code></pre></div> <ol> <li>Скорость обучения — коэффициент длины шага, при выполнении градиентного спуска. Слишком большая скорость обучения может привести к бесконечным весам модели. По умолчанию <code>0.00001</code>.</li> <li>Коэффициент регуляризации l2. Помогает предотвратить подгонку. По умолчанию <code>0.1</code>.</li> <li>Размер mini-batch задаёт количество элементов, чьи градиенты будут вычислены и просуммированы при выполнении одного шага градиентного спуска. Чистый стохастический спуск использует один элемент, однако использование mini-batch (около 10 элементов) делает градиентные шаги более стабильными. По умолчанию <code>15</code>.</li> <li>Метод обновления весов, можно выбрать один из следующих: <code>Adam</code> (по умолчанию), <code>SGD</code>, <code>Momentum</code>, <code>Nesterov</code>. <code>Momentum</code> и <code>Nesterov</code> более требовательные к вычислительным ресурсам и памяти, однако они имеют высокую скорость схождения и устойчивости методов стохастического градиента.</li> </ol> <h3 id=agg_functions-stochasticlinearregression-usage>Использование<a class=headerlink href=#agg_functions-stochasticlinearregression-usage title="Permanent link">&para;</a></h3> <p><code>stochasticLinearRegression</code> используется на двух этапах: построение модели и предсказание новых данных. Чтобы построить модель и сохранить её состояние для дальнейшего использования, мы используем комбинатор <code>-State</code>.<br> Для прогнозирования мы используем функцию <a href=../../functions/machine_learning_functions/#machine_learning_methods-evalmlmethod>evalMLMethod</a>, которая принимает в качестве аргументов состояние и свойства для прогнозирования.</p> <p><a name=stochasticlinearregression-usage-fitting></a></p> <p><strong>1.</strong> Построение модели</p> <p>Пример запроса:</p> <div class=codehilite><pre><span></span><code><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=k>IF</span> <span class=k>NOT</span> <span class=k>EXISTS</span> <span class=n>train_data</span>
<span class=p>(</span>
    <span class=n>param1</span> <span class=n>Float64</span><span class=p>,</span>
    <span class=n>param2</span> <span class=n>Float64</span><span class=p>,</span>
    <span class=n>target</span> <span class=n>Float64</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span><span class=p>;</span>

<span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>your_model</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span> <span class=k>AS</span> <span class=k>SELECT</span>
<span class=n>stochasticLinearRegressionState</span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>&#39;SGD&#39;</span><span class=p>)(</span><span class=n>target</span><span class=p>,</span> <span class=n>param1</span><span class=p>,</span> <span class=n>param2</span><span class=p>)</span>
<span class=k>AS</span> <span class=k>state</span> <span class=k>FROM</span> <span class=n>train_data</span><span class=p>;</span>
</code></pre></div> <p>Здесь нам также нужно вставить данные в таблицу <code>train_data</code>. Количество параметров не фиксировано, оно зависит только от количества аргументов, перешедших в <code>linearRegressionState</code>. Все они должны быть числовыми значениями.<br> Обратите внимание, что столбец с целевым значением (которое мы хотели бы научиться предсказывать) вставляется в качестве первого аргумента.</p> <p><strong>2.</strong> Прогнозирование</p> <p>После сохранения состояния в таблице мы можем использовать его несколько раз для прогнозирования или смёржить с другими состояниями и создать новые, улучшенные модели.</p> <div class=codehilite><pre><span></span><code><span class=k>WITH</span> <span class=p>(</span><span class=k>SELECT</span> <span class=k>state</span> <span class=k>FROM</span> <span class=n>your_model</span><span class=p>)</span> <span class=k>AS</span> <span class=n>model</span> <span class=k>SELECT</span>
<span class=n>evalMLMethod</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>param1</span><span class=p>,</span> <span class=n>param2</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_data</span>
</code></pre></div> <p>Запрос возвращает столбец прогнозируемых значений. Обратите внимание, что первый аргумент <code>evalMLMethod</code> это объект <code>AggregateFunctionState</code>, далее идут столбцы свойств.</p> <p><code>test_data</code> — это таблица, подобная <code>train_data</code>, но при этом может не содержать целевое значение.</p> <h3 id=agg_functions-stochasticlinearregression-notes>Примечания<a class=headerlink href=#agg_functions-stochasticlinearregression-notes title="Permanent link">&para;</a></h3> <ol> <li> <p>Объединить две модели можно следующим запросом:</p> <p><code>sql SELECT state1 + state2 FROM your_models</code></p> <p>где таблица <code>your_models</code> содержит обе модели. Запрос вернёт новый объект <code>AggregateFunctionState</code>.</p> </li> <li> <p>Пользователь может получать веса созданной модели для своих целей без сохранения модели, если не использовать комбинатор <code>-State</code>.</p> <p><code>sql SELECT stochasticLinearRegression(0.01)(target, param1, param2) FROM train_data</code></p> <p>Подобный запрос строит модель и возвращает её веса, отвечающие параметрам моделей и смещение. Таким образом, в приведенном выше примере запрос вернет столбец с тремя значениями.</p> </li> </ol> <p><strong>Смотрите также</strong></p> <ul> <li><a href=#agg_functions-stochasticlogisticregression>stochasticLogisticRegression</a></li> <li><a href=https://stackoverflow.com/questions/12146914/what-is-the-difference-between-linear-regression-and-logistic-regression rel="external nofollow noreferrer">Отличие линейной от логистической регрессии.</a></li> </ul> <h2 id=agg_functions-stochasticlogisticregression>stochasticLogisticRegression<a class=headerlink href=#agg_functions-stochasticlogisticregression title="Permanent link">&para;</a></h2> <p>Функция реализует стохастическую логистическую регрессию. Её можно использовать для задачи бинарной классификации, функция поддерживает те же пользовательские параметры, что и stochasticLinearRegression и работает таким же образом.</p> <h3 id=agg_functions-stochasticlogisticregression-parameters>Параметры<a class=headerlink href=#agg_functions-stochasticlogisticregression-parameters title="Permanent link">&para;</a></h3> <p>Параметры те же, что и в stochasticLinearRegression:<br> <code>learning rate</code>, <code>l2 regularization coefficient</code>, <code>mini-batch size</code>, <code>method for updating weights</code>.<br> Смотрите раздел <a href=#agg_functions-stochasticlinearregression-parameters>parameters</a>.</p> <div class=codehilite><pre><span></span><code>stochasticLogisticRegression(1.0, 1.0, 10, &#39;SGD&#39;)
</code></pre></div> <ol> <li> <p>Построение модели</p> <p>Смотрите раздел <code>Построение модели</code> в описании <a href=#stochasticlinearregression-usage-fitting>stochasticLinearRegression</a> .</p> <p>Прогнозируемые метки должны быть в диапазоне [-1, 1].</p> </li> <li> <p>Прогнозирование</p> <p>Используя сохраненное состояние, можно предсказать вероятность наличия у объекта метки <code>1</code>.</p> <p><code>sql WITH (SELECT state FROM your_model) AS model SELECT evalMLMethod(model, param1, param2) FROM test_data</code></p> <p>Запрос возвращает столбец вероятностей. Обратите внимание, что первый аргумент <code>evalMLMethod</code> это объект <code>AggregateFunctionState</code>, далее идут столбцы свойств.</p> <p>Мы также можем установить границу вероятности, которая присваивает элементам различные метки.</p> <p><code>sql SELECT ans &lt; 1.1 AND ans &gt; 0.5 FROM (WITH (SELECT state FROM your_model) AS model SELECT evalMLMethod(model, param1, param2) AS ans FROM test_data)</code></p> <p>Тогда результатом будут метки.</p> <p><code>test_data</code> — это таблица, подобная <code>train_data</code>, но при этом может не содержать целевое значение.</p> </li> </ol> <p><strong>Смотрите также</strong></p> <ul> <li><a href=#agg_functions-stochasticlinearregression>stochasticLinearRegression</a></li> <li><a href=https://moredez.ru/q/51225972/ rel="external nofollow noreferrer">Отличие линейной от логистической регрессии</a></li> </ul> </div> <div id=content-footer class="text-muted pt-5"> <div class=float-right>©2016–2020 Yandex LLC</div> <div>Собрано из <a href=https://github.com/ClickHouse/ClickHouse/commit/25eae6abe035bda78634f17d15c9f05348d97aad rel="external nofollow noreferrer" target=_blank class=text-reset>25eae6abe0</a></div> </div> </div> <div id=toc class="col-xl-2 d-none d-xl-block d-print-none p-3 overflow-auto toc-right mb-5"> <nav class="nav flex-column text-wrap"> <label for=toc>Cодержание</label> <a href=#agg_function-count title=count class="nav-link text-wrap d-inline-block w-100"> count </a> <a href=#agg_function-any title=any(x) class="nav-link text-wrap d-inline-block w-100"> any(x) </a> <a href=#agg_function-anyHeavy title=anyHeavy(x) class="nav-link text-wrap d-inline-block w-100"> anyHeavy(x) </a> <a href=#agg_function-anyLast title=anyLast(x) class="nav-link text-wrap d-inline-block w-100"> anyLast(x) </a> <a href=#groupbitand title=groupBitAnd class="nav-link text-wrap d-inline-block w-100"> groupBitAnd </a> <a href=#groupbitor title=groupBitOr class="nav-link text-wrap d-inline-block w-100"> groupBitOr </a> <a href=#groupbitxor title=groupBitXor class="nav-link text-wrap d-inline-block w-100"> groupBitXor </a> <a href=#groupbitmap title=groupBitmap class="nav-link text-wrap d-inline-block w-100"> groupBitmap </a> <a href=#agg_function-min title=min(x) class="nav-link text-wrap d-inline-block w-100"> min(x) </a> <a href=#agg_function-max title=max(x) class="nav-link text-wrap d-inline-block w-100"> max(x) </a> <a href=#agg_function-argMin title="argMin(arg, val)" class="nav-link text-wrap d-inline-block w-100"> argMin(arg, val) </a> <a href=#agg_function-argMax title="argMax(arg, val)" class="nav-link text-wrap d-inline-block w-100"> argMax(arg, val) </a> <a href=#agg_function-sum title=sum(x) class="nav-link text-wrap d-inline-block w-100"> sum(x) </a> <a href=#agg_function-sumWithOverflow title=sumWithOverflow(x) class="nav-link text-wrap d-inline-block w-100"> sumWithOverflow(x) </a> <a href=#summap-key-value title="sumMap(key, value)" class="nav-link text-wrap d-inline-block w-100"> sumMap(key, value) </a> <a href=#skewpop title=skewPop class="nav-link text-wrap d-inline-block w-100"> skewPop </a> <a href=#skewsamp title=skewSamp class="nav-link text-wrap d-inline-block w-100"> skewSamp </a> <a href=#kurtpop title=kurtPop class="nav-link text-wrap d-inline-block w-100"> kurtPop </a> <a href=#kurtsamp title=kurtSamp class="nav-link text-wrap d-inline-block w-100"> kurtSamp </a> <a href=#agg_function-timeseriesgroupsum title="timeSeriesGroupSum(uid, timestamp, value)" class="nav-link text-wrap d-inline-block w-100"> timeSeriesGroupSum(uid, timestamp, value) </a> <a href=#agg_function-timeseriesgroupratesum title="timeSeriesGroupRateSum(uid, ts, val)" class="nav-link text-wrap d-inline-block w-100"> timeSeriesGroupRateSum(uid, ts, val) </a> <a href=#agg_function-avg title=avg(x) class="nav-link text-wrap d-inline-block w-100"> avg(x) </a> <a href=#agg_function-uniq title=uniq class="nav-link text-wrap d-inline-block w-100"> uniq </a> <a href=#agg_function-uniqcombined title=uniqCombined class="nav-link text-wrap d-inline-block w-100"> uniqCombined </a> <a href=#agg_function-uniqcombined64 title=uniqCombined64 class="nav-link text-wrap d-inline-block w-100"> uniqCombined64 </a> <a href=#agg_function-uniqhll12 title=uniqHLL12 class="nav-link text-wrap d-inline-block w-100"> uniqHLL12 </a> <a href=#agg_function-uniqexact title=uniqExact class="nav-link text-wrap d-inline-block w-100"> uniqExact </a> <a href=#agg_function-grouparray title="groupArray(x), groupArray(max_size)(x)" class="nav-link text-wrap d-inline-block w-100"> groupArray(x), groupArray(max_size)(x) </a> <a href=#grouparrayinsertat-x title=groupArrayInsertAt(x) class="nav-link text-wrap d-inline-block w-100"> groupArrayInsertAt(x) </a> <a href=#agg_function-grouparraymovingsum title=groupArrayMovingSum class="nav-link text-wrap d-inline-block w-100"> groupArrayMovingSum </a> <a href=#agg_function-grouparraymovingavg title=groupArrayMovingAvg class="nav-link text-wrap d-inline-block w-100"> groupArrayMovingAvg </a> <a href=#groupuniqarray-x-groupuniqarray-max-size-x title="groupUniqArray(x), groupUniqArray(max_size)(x)" class="nav-link text-wrap d-inline-block w-100"> groupUniqArray(x), groupUniqArray(max_size)(x) </a> <a href=#agg_function-quantile title=quantile(level)(x) class="nav-link text-wrap d-inline-block w-100"> quantile(level)(x) </a> <a href=#quantiledeterministic-level-x-determinator title="quantileDeterministic(level)(x, determinator)" class="nav-link text-wrap d-inline-block w-100"> quantileDeterministic(level)(x, determinator) </a> <a href=#agg_function-quantiletiming title=quantileTiming class="nav-link text-wrap d-inline-block w-100"> quantileTiming </a> <a href=#quantiletimingweighted-level-x-weight title="quantileTimingWeighted(level)(x, weight)" class="nav-link text-wrap d-inline-block w-100"> quantileTimingWeighted(level)(x, weight) </a> <a href=#quantileexact-level-x title=quantileExact(level)(x) class="nav-link text-wrap d-inline-block w-100"> quantileExact(level)(x) </a> <a href=#quantileexactweighted-level-x-weight title="quantileExactWeighted(level)(x, weight)" class="nav-link text-wrap d-inline-block w-100"> quantileExactWeighted(level)(x, weight) </a> <a href=#quantiletdigest-level-x title=quantileTDigest(level)(x) class="nav-link text-wrap d-inline-block w-100"> quantileTDigest(level)(x) </a> <a href=#median-x title=median(x) class="nav-link text-wrap d-inline-block w-100"> median(x) </a> <a href=#quantiles-level1-level2-x title="quantiles(level1, level2, ...)(x)" class="nav-link text-wrap d-inline-block w-100"> quantiles(level1, level2, ...)(x) </a> <a href=#varsamp-x title=varSamp(x) class="nav-link text-wrap d-inline-block w-100"> varSamp(x) </a> <a href=#varpop-x title=varPop(x) class="nav-link text-wrap d-inline-block w-100"> varPop(x) </a> <a href=#stddevsamp-x title=stddevSamp(x) class="nav-link text-wrap d-inline-block w-100"> stddevSamp(x) </a> <a href=#stddevpop-x title=stddevPop(x) class="nav-link text-wrap d-inline-block w-100"> stddevPop(x) </a> <a href=#topk-n-column title=topK(N)(column) class="nav-link text-wrap d-inline-block w-100"> topK(N)(column) </a> <a href=#covarsamp-x-y title="covarSamp(x, y)" class="nav-link text-wrap d-inline-block w-100"> covarSamp(x, y) </a> <a href=#covarpop-x-y title="covarPop(x, y)" class="nav-link text-wrap d-inline-block w-100"> covarPop(x, y) </a> <a href=#corr-x-y title="corr(x, y)" class="nav-link text-wrap d-inline-block w-100"> corr(x, y) </a> <a href=#simplelinearregression title=simpleLinearRegression class="nav-link text-wrap d-inline-block w-100"> simpleLinearRegression </a> <a href=#agg_functions-stochasticlinearregression title=stochasticLinearRegression class="nav-link text-wrap d-inline-block w-100"> stochasticLinearRegression </a> <nav id=toc-toc-51 class="nav flex-column pl-2"> <a href=#agg_functions-stochasticlinearregression-parameters title=Параметры class="nav-link text-wrap d-inline-block w-100"> Параметры </a> <a href=#agg_functions-stochasticlinearregression-usage title=Использование class="nav-link text-wrap d-inline-block w-100"> Использование </a> <a href=#agg_functions-stochasticlinearregression-notes title=Примечания class="nav-link text-wrap d-inline-block w-100"> Примечания </a> </nav> <a href=#agg_functions-stochasticlogisticregression title=stochasticLogisticRegression class="nav-link text-wrap d-inline-block w-100"> stochasticLogisticRegression </a> <nav id=toc-toc-52 class="nav flex-column pl-2"> <a href=#agg_functions-stochasticlogisticregression-parameters title=Параметры class="nav-link text-wrap d-inline-block w-100"> Параметры </a> </nav> </nav> </div> </div> </div> <script async type=text/javascript src=/js/base.js?7bd05efd></script> <noscript> <div><img src=https://mc.yandex.ru/watch/18343495 alt=Yandex></div> </noscript> </body> </html>