<!DOCTYPE html><html lang=fa data-version=v19.17 data-single-page=false> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Changelog - مستندات v19.17ClickHouse</title><link rel="shortcut icon" href=/favicon.ico><meta property=og:title content="Changelog - مستندات v19.17ClickHouse"><meta property=og:description content="ClickHouse release v19.16.2.2, 2019-10-30 Backward Incompatible Change Add missing arity validation for count/counIf. #7"><meta property=og:type content=website><meta property=og:image content=https://clickhouse.tech/images/logo.png><meta property=twitter:title content="Changelog - مستندات v19.17ClickHouse"><meta name=description content="ClickHouse release v19.16.2.2, 2019-10-30 Backward Incompatible Change Add missing arity validation for count/counIf. #7"><meta name=keywords content="ClickHouse, DBMS, OLAP, relational, analytics, analytical, big data, open-source, SQL, web-analytics"><link href=/css/base.css?1d858e50 media=all rel=stylesheet></head> <body dir=rtl data-spy=scroll data-target=#toc data-offset=80> <nav id=top-nav class="navbar navbar-dark navbar-expand-md bg-dark-alt text-white sticky-top"> <div class="container-fluid justify-content-between"> <a href=/ class="d-block navbar-brand mr-3"> <img id=docs-logo-icon src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"> </a> <div class="w-100 navbar-text text-left d-none d-md-block"> <h1 class="h3 m-0 p-0 d-inline"> <a href=# class="text-white text-decoration-none"> Changelog </a> </h1> </div> <div class="d-none d-md-block"> <ul class="navbar-nav ml-auto mt-2 mt-lg-0 justify-content-end"> <li class=nav-item> <a href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/fa/changelog.md title="Edit this article" class=nav-link rel="external nofollow noreferrer" target=_blank><img src=/images/mkdocs/edit.svg alt="Edit this article" class=mt-1 height=22></a> </li> <li class=nav-item> <a class=nav-link href=https://github.com/ClickHouse/ClickHouse rel="external nofollow noreferrer"> <img src=/images/index/github.svg alt="GitHub repository" title="Go to GitHub" height=32> </a> </li> <li id=languages-wrapper class="nav-item dropdown"> <div id=languages-dropdown> <a class="nav-link dropdown-toggle d-inline-block mt-1 text-muted" href=# id=lang-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false> <img src=/images/flags/fa.svg alt=فارسی title=فارسی width=32 class="d-inline-block mt-n1"> </a> <div class="dropdown-menu bg-dark" aria-labelledby=lang-dropdown> <a href=/docs/v19.17/en/changelog/ class=dropdown-item> <img src=/images/flags/en.svg alt title width=32 class="d-inline-block mr-2">English </a> <a href=/docs/v19.17/zh/changelog/ class=dropdown-item> <img src=/images/flags/zh.svg alt title width=32 class="d-inline-block mr-2">中文 </a> <a href=/docs/v19.17/es/changelog/ class=dropdown-item> <img src=/images/flags/es.svg alt title width=32 class="d-inline-block mr-2">Español </a> <a href=/docs/v19.17/fr/changelog/ class=dropdown-item> <img src=/images/flags/fr.svg alt title width=32 class="d-inline-block mr-2">Français </a> <a href=/docs/v19.17/ru/changelog/ class=dropdown-item> <img src=/images/flags/ru.svg alt title width=32 class="d-inline-block mr-2">Русский </a> <a href=/docs/v19.17/ja/changelog/ class=dropdown-item> <img src=/images/flags/ja.svg alt title width=32 class="d-inline-block mr-2">日本語 </a> <a href=/docs/v19.17/fa/changelog/ class="dropdown-item disabled"> <img src=/images/flags/fa.svg alt title width=32 class="d-inline-block mr-2">فارسی </a> </div> </div> </li> </ul> </div> <form id=search-form class="form-inline m-0"> <div class=input-group> <div class="input-group-prepend w-100"> <span class="input-group-text bg-secondary-alt text-muted border-0 mr-n1" id=search-icon> <img src=/images/mkdocs/search.svg> </span> <input id=docsearch-input class="form-control bg-secondary-alt text-muted border-0 pl-1" type=search placeholder=Search aria-label=Search> </div> </div> </form> <button id=navbar-toggler class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#sidebar aria-controls=sidebar aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> </nav> <div class="container-fluid text-right"> <div class="row justify-content-end justify-content-xl-center"> <div id=sidebar class="col-xl-2 col-md-4 bg-secondary-alt p-3 d-print-none min-vh-100 overflow-auto"> <div class=overflow-auto> <div id=single-page-switch class="btn-group mb-2 float-right" role=group aria-label="چند صفحه یا یک صفحه"> <a href=.. role=button class="btn btn-dark active" aria-pressed=true> <img src=/images/mkdocs/multi.svg alt="نسخه چند صفحه ای" title="نسخه چند صفحه ای"> </a> <a href=../single/ role=button class="btn btn-dark-alt active" aria-pressed=true> <img src=/images/mkdocs/single.svg alt="نسخه تک صفحه ای" title="نسخه تک صفحه ای"> </a> </div> <div class="dropdown mb-3"> <a class="btn btn-dark dropdown-toggle text-muted" href=# role=button id=select-version data-toggle=dropdown aria-haspopup=true aria-expanded=false> نسخه: <span class=text-light>v19.17</span> </a> <div class="dropdown-menu bg-dark text-muted p-1" aria-labelledby=select-version> <a href=/docs/fa/ class=dropdown-item> <span class=text-light>جدیدترین</span> </a> <a href=/docs/v20.3/fa/ class=dropdown-item>v20.3</a> <a href=/docs/v20.1/fa/ class=dropdown-item>v20.1</a> <a href=/docs/v19.17/fa/ class="dropdown-item disable">v19.17</a> <a href=/docs/v19.16/fa/ class=dropdown-item>v19.16</a> <a href=/docs/v19.15/fa/ class=dropdown-item>v19.15</a> <a href=/docs/v19.14/fa/ class=dropdown-item>v19.14</a> <a href=/docs/v19.13/fa/ class=dropdown-item>v19.13</a> <a href=/docs/v19.11/fa/ class=dropdown-item>v19.11</a> <a href=/docs/v19.10/fa/ class=dropdown-item>v19.10</a> <a href=/docs/v19.9/fa/ class=dropdown-item>v19.9</a> <a href=/docs/v19.8/fa/ class=dropdown-item>v19.8</a> </div> </div> <nav id=sidebar-nav class="nav flex-column mb-5"> <a href=#sidebar-sidebar-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-1 title=Introduction class="nav-link text-light text-wrap dropdown-toggle px-0">Introduction</a> <div id=sidebar-sidebar-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../ title="ClickHouse چیست؟" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ClickHouse چیست؟</a> <a href=../introduction/distinctive_features/ title=" ویژگی های برجسته ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> ویژگی های برجسته ClickHouse</a> <a href=../introduction/features_considered_disadvantages/ title=" ویژگی های از ClickHouse که می تواند معایبی باشد" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> ویژگی های از ClickHouse که می تواند معایبی باشد</a> <a href=../introduction/performance/ title=Performance class="nav-link text-light text-wrap d-inline-block w-100 px-0">Performance</a> <a href=../introduction/ya_metrika_task/ title="The Yandex.Metrica task" class="nav-link text-light text-wrap d-inline-block w-100 px-0">The Yandex.Metrica task</a> </nav> </div> <a href=#sidebar-sidebar-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2 title="Getting started" class="nav-link text-light text-wrap dropdown-toggle px-0">Getting started</a> <div id=sidebar-sidebar-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../getting_started/ title=" شروع به کار" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> شروع به کار</a> <a href=#sidebar-sidebar-2-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2-2 title="Example datasets" class="nav-link text-light text-wrap dropdown-toggle px-0">Example datasets</a> <div id=sidebar-sidebar-2-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../getting_started/example_datasets/ontime/ title=OnTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">OnTime</a> <a href=../getting_started/example_datasets/nyc_taxi/ title=" داده های تاکسی New York" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> داده های تاکسی New York</a> <a href=../getting_started/example_datasets/amplab_benchmark/ title=" بنچمارک AMPLab Big Data" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> بنچمارک AMPLab Big Data</a> <a href=../getting_started/example_datasets/wikistat/ title=WikiStat class="nav-link text-light text-wrap d-inline-block w-100 px-0">WikiStat</a> <a href=../getting_started/example_datasets/criteo/ title=" ترابایت از لاگ های کلیک از سرویس Criteo" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> ترابایت از لاگ های کلیک از سرویس Criteo</a> <a href=../getting_started/example_datasets/star_schema/ title=" بنچمارک Star Schema" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> بنچمارک Star Schema</a> <a href=../getting_started/example_datasets/metrica/ title="Yandex.Metrica Data" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Yandex.Metrica Data</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3 title=Interfaces class="nav-link text-light text-wrap dropdown-toggle px-0">Interfaces</a> <div id=sidebar-sidebar-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../interfaces/ title="Interface ها" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interface ها</a> <a href=../interfaces/cli/ title=" کلاینت Command-line" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> کلاینت Command-line</a> <a href=../interfaces/tcp/ title="Native interface (TCP)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Native interface (TCP)</a> <a href=../interfaces/http/ title="HTTP interface" class="nav-link text-light text-wrap d-inline-block w-100 px-0">HTTP interface</a> <a href=../interfaces/formats/ title=" فرمت های Input و Output" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> فرمت های Input و Output</a> <a href=../interfaces/jdbc/ title=" درایور JDBC" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> درایور JDBC</a> <a href=../interfaces/odbc/ title=" درایور ODBC" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> درایور ODBC</a> <a href=../interfaces/cpp/ title="C ++ کتابخانه مشتری" class="nav-link text-light text-wrap d-inline-block w-100 px-0">C ++ کتابخانه مشتری</a> <a href=#sidebar-sidebar-3-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-9 title=Third-party class="nav-link text-light text-wrap dropdown-toggle px-0">Third-party</a> <div id=sidebar-sidebar-3-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../interfaces/third-party/client_libraries/ title="کتابخانه های مشتری" class="nav-link text-light text-wrap d-inline-block w-100 px-0">کتابخانه های مشتری</a> <a href=../interfaces/third-party/integrations/ title=یکپارچگی class="nav-link text-light text-wrap d-inline-block w-100 px-0">یکپارچگی</a> <a href=../interfaces/third-party/gui/ title="رابط های بصری" class="nav-link text-light text-wrap d-inline-block w-100 px-0">رابط های بصری</a> <a href=../interfaces/third-party/proxy/ title=پروکسی class="nav-link text-light text-wrap d-inline-block w-100 px-0">پروکسی</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4 title="Data types" class="nav-link text-light text-wrap dropdown-toggle px-0">Data types</a> <div id=sidebar-sidebar-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../data_types/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../data_types/int_uint/ title="UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64</a> <a href=../data_types/float/ title="Float32, Float64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Float32, Float64</a> <a href=../data_types/decimal/ title=Decimal class="nav-link text-light text-wrap d-inline-block w-100 px-0">Decimal</a> <a href=../data_types/boolean/ title=" مقادیر Boolean" class="nav-link text-light text-wrap d-inline-block w-100 px-0"> مقادیر Boolean</a> <a href=../data_types/string/ title=String class="nav-link text-light text-wrap d-inline-block w-100 px-0">String</a> <a href=../data_types/fixedstring/ title=FixedString(N) class="nav-link text-light text-wrap d-inline-block w-100 px-0">FixedString(N)</a> <a href=../data_types/uuid/ title=UUID class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUID</a> <a href=../data_types/date/ title=Date class="nav-link text-light text-wrap d-inline-block w-100 px-0">Date</a> <a href=../data_types/datetime/ title=DateTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime</a> <a href=../data_types/enum/ title=Enum class="nav-link text-light text-wrap d-inline-block w-100 px-0">Enum</a> <a href=../data_types/array/ title=Array(T) class="nav-link text-light text-wrap d-inline-block w-100 px-0">Array(T)</a> <a href=../data_types/nested_data_structures/aggregatefunction/ title="AggregateFunction(name, types_of_arguments...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregateFunction(name, types_of_arguments...)</a> <a href=../data_types/tuple/ title="Tuple(T1, T2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tuple(T1, T2, ...)</a> <a href=../data_types/nullable/ title=Nullable class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nullable</a> <a href=#sidebar-sidebar-4-16 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-16 title="Nested data structures" class="nav-link text-light text-wrap dropdown-toggle px-0">Nested data structures</a> <div id=sidebar-sidebar-4-16 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../data_types/nested_data_structures/nested/ title="Nested(Name1 Type1, Name2 Type2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nested(Name1 Type1, Name2 Type2, ...)</a> </nav> </div> <a href=#sidebar-sidebar-4-17 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-17 title="Special data types" class="nav-link text-light text-wrap dropdown-toggle px-0">Special data types</a> <div id=sidebar-sidebar-4-17 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../data_types/special_data_types/expression/ title=Expression class="nav-link text-light text-wrap d-inline-block w-100 px-0">Expression</a> <a href=../data_types/special_data_types/set/ title=Set class="nav-link text-light text-wrap d-inline-block w-100 px-0">Set</a> <a href=../data_types/special_data_types/nothing/ title=Nothing class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nothing</a> <a href=../data_types/special_data_types/interval/ title=Interval class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interval</a> </nav> </div> <a href=#sidebar-sidebar-4-18 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-18 title=Domains class="nav-link text-light text-wrap dropdown-toggle px-0">Domains</a> <div id=sidebar-sidebar-4-18 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../data_types/domains/overview/ title=Overview class="nav-link text-light text-wrap d-inline-block w-100 px-0">Overview</a> <a href=../data_types/domains/ipv4/ title=IPv4 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv4</a> <a href=../data_types/domains/ipv6/ title=IPv6 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv6</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5 title="Database Engines" class="nav-link text-light text-wrap dropdown-toggle px-0">Database Engines</a> <div id=sidebar-sidebar-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../database_engines/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../database_engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../database_engines/lazy/ title=Lazy class="nav-link text-light text-wrap d-inline-block w-100 px-0">Lazy</a> </nav> </div> <a href=#sidebar-sidebar-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6 title="Table Engines" class="nav-link text-light text-wrap dropdown-toggle px-0">Table Engines</a> <div id=sidebar-sidebar-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/table_engines/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=#sidebar-sidebar-6-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-2 title="MergeTree Family" class="nav-link text-light text-wrap dropdown-toggle px-0">MergeTree Family</a> <div id=sidebar-sidebar-6-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/table_engines/mergetree/ title=MergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">MergeTree</a> <a href=../operations/table_engines/replication/ title="Data Replication" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Data Replication</a> <a href=../operations/table_engines/custom_partitioning_key/ title="Custom Partitioning Key" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Custom Partitioning Key</a> <a href=../operations/table_engines/replacingmergetree/ title=ReplacingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">ReplacingMergeTree</a> <a href=../operations/table_engines/summingmergetree/ title=SummingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">SummingMergeTree</a> <a href=../operations/table_engines/aggregatingmergetree/ title=AggregatingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregatingMergeTree</a> <a href=../operations/table_engines/collapsingmergetree/ title=CollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">CollapsingMergeTree</a> <a href=../operations/table_engines/versionedcollapsingmergetree/ title=VersionedCollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">VersionedCollapsingMergeTree</a> <a href=../operations/table_engines/graphitemergetree/ title=GraphiteMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">GraphiteMergeTree</a> </nav> </div> <a href=#sidebar-sidebar-6-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-3 title="Log Family" class="nav-link text-light text-wrap dropdown-toggle px-0">Log Family</a> <div id=sidebar-sidebar-6-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/table_engines/log_family/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../operations/table_engines/stripelog/ title=StripeLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">StripeLog</a> <a href=../operations/table_engines/log/ title=Log class="nav-link text-light text-wrap d-inline-block w-100 px-0">Log</a> <a href=../operations/table_engines/tinylog/ title=TinyLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">TinyLog</a> </nav> </div> <a href=#sidebar-sidebar-6-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-4 title=Integrations class="nav-link text-light text-wrap dropdown-toggle px-0">Integrations</a> <div id=sidebar-sidebar-6-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/table_engines/kafka/ title=Kafka class="nav-link text-light text-wrap d-inline-block w-100 px-0">Kafka</a> <a href=../operations/table_engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../operations/table_engines/jdbc/ title=JDBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC</a> <a href=../operations/table_engines/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> <a href=../operations/table_engines/hdfs/ title=HDFS class="nav-link text-light text-wrap d-inline-block w-100 px-0">HDFS</a> </nav> </div> <a href=#sidebar-sidebar-6-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-5 title=Special class="nav-link text-light text-wrap dropdown-toggle px-0">Special</a> <div id=sidebar-sidebar-6-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/table_engines/distributed/ title=Distributed class="nav-link text-light text-wrap d-inline-block w-100 px-0">Distributed</a> <a href=../operations/table_engines/external_data/ title="External data" class="nav-link text-light text-wrap d-inline-block w-100 px-0">External data</a> <a href=../operations/table_engines/dictionary/ title=Dictionary class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionary</a> <a href=../operations/table_engines/merge/ title=Merge class="nav-link text-light text-wrap d-inline-block w-100 px-0">Merge</a> <a href=../operations/table_engines/file/ title=File class="nav-link text-light text-wrap d-inline-block w-100 px-0">File</a> <a href=../operations/table_engines/null/ title=Null class="nav-link text-light text-wrap d-inline-block w-100 px-0">Null</a> <a href=../operations/table_engines/set/ title=Set class="nav-link text-light text-wrap d-inline-block w-100 px-0">Set</a> <a href=../operations/table_engines/join/ title=Join class="nav-link text-light text-wrap d-inline-block w-100 px-0">Join</a> <a href=../operations/table_engines/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../operations/table_engines/view/ title=View class="nav-link text-light text-wrap d-inline-block w-100 px-0">View</a> <a href=../operations/table_engines/materializedview/ title=MaterializedView class="nav-link text-light text-wrap d-inline-block w-100 px-0">MaterializedView</a> <a href=../operations/table_engines/memory/ title=Memory class="nav-link text-light text-wrap d-inline-block w-100 px-0">Memory</a> <a href=../operations/table_engines/buffer/ title=Buffer class="nav-link text-light text-wrap d-inline-block w-100 px-0">Buffer</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7 title="SQL Reference" class="nav-link text-light text-wrap dropdown-toggle px-0">SQL Reference</a> <div id=sidebar-sidebar-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/select/ title=SELECT class="nav-link text-light text-wrap d-inline-block w-100 px-0">SELECT</a> <a href=../query_language/insert_into/ title="INSERT INTO" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INSERT INTO</a> <a href=../query_language/create/ title=CREATE class="nav-link text-light text-wrap d-inline-block w-100 px-0">CREATE</a> <a href=../query_language/alter/ title=ALTER class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALTER</a> <a href=../query_language/system/ title=SYSTEM class="nav-link text-light text-wrap d-inline-block w-100 px-0">SYSTEM</a> <a href=../query_language/show/ title=SYSTEM class="nav-link text-light text-wrap d-inline-block w-100 px-0">SYSTEM</a> <a href=../query_language/misc/ title="Other Kinds of Queries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Other Kinds of Queries</a> <a href=#sidebar-sidebar-7-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-9 title=Functions class="nav-link text-light text-wrap dropdown-toggle px-0">Functions</a> <div id=sidebar-sidebar-7-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../query_language/functions/arithmetic_functions/ title=Arithmetic class="nav-link text-light text-wrap d-inline-block w-100 px-0">Arithmetic</a> <a href=../query_language/functions/comparison_functions/ title=Comparison class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comparison</a> <a href=../query_language/functions/logical_functions/ title=Logical class="nav-link text-light text-wrap d-inline-block w-100 px-0">Logical</a> <a href=../query_language/functions/type_conversion_functions/ title="Type Conversion" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Type Conversion</a> <a href=../query_language/functions/date_time_functions/ title="Working with Dates and Times" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with Dates and Times</a> <a href=../query_language/functions/string_functions/ title="Working with strings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with strings</a> <a href=../query_language/functions/string_search_functions/ title="For Searching Strings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">For Searching Strings</a> <a href=../query_language/functions/string_replace_functions/ title="For Replacing in Strings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">For Replacing in Strings</a> <a href=../query_language/functions/conditional_functions/ title="Conditional " class="nav-link text-light text-wrap d-inline-block w-100 px-0">Conditional </a> <a href=../query_language/functions/math_functions/ title=Mathematical class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mathematical</a> <a href=../query_language/functions/rounding_functions/ title=Rounding class="nav-link text-light text-wrap d-inline-block w-100 px-0">Rounding</a> <a href=../query_language/functions/array_functions/ title="Working with Arrays" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with Arrays</a> <a href=../query_language/functions/splitting_merging_functions/ title="Splitting and Merging Strings and Arrays" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Splitting and Merging Strings and Arrays</a> <a href=../query_language/functions/bit_functions/ title=Bit class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bit</a> <a href=../query_language/functions/bitmap_functions/ title=Bitmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bitmap</a> <a href=../query_language/functions/hash_functions/ title=Hash class="nav-link text-light text-wrap d-inline-block w-100 px-0">Hash</a> <a href=../query_language/functions/random_functions/ title="Generating Pseudo-Random Numbers" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Generating Pseudo-Random Numbers</a> <a href=../query_language/functions/encoding_functions/ title=Encoding class="nav-link text-light text-wrap d-inline-block w-100 px-0">Encoding</a> <a href=../query_language/functions/uuid_functions/ title="Working with UUID" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with UUID</a> <a href=../query_language/functions/url_functions/ title="Working with URLs" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with URLs</a> <a href=../query_language/functions/ip_address_functions/ title="Working with IP Addresses" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with IP Addresses</a> <a href=../query_language/functions/json_functions/ title="Working with JSON." class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with JSON.</a> <a href=../query_language/functions/higher_order_functions/ title=Higher-Order class="nav-link text-light text-wrap d-inline-block w-100 px-0">Higher-Order</a> <a href=../query_language/functions/ext_dict_functions/ title="Working with External Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with External Dictionaries</a> <a href=../query_language/functions/ym_dict_functions/ title="Working with Yandex.Metrica Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with Yandex.Metrica Dictionaries</a> <a href=../query_language/functions/in_functions/ title="Implementing the IN Operator" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Implementing the IN Operator</a> <a href=../query_language/functions/array_join/ title=arrayJoin class="nav-link text-light text-wrap d-inline-block w-100 px-0">arrayJoin</a> <a href=../query_language/functions/geo/ title="Working with geographical coordinates" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with geographical coordinates</a> <a href=../query_language/functions/functions_for_nulls/ title="Working with Nullable arguments" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Working with Nullable arguments</a> <a href=../query_language/functions/machine_learning_functions/ title="Machine Learning Functions" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Machine Learning Functions</a> <a href=../query_language/functions/other_functions/ title=Other class="nav-link text-light text-wrap d-inline-block w-100 px-0">Other</a> </nav> </div> <a href=#sidebar-sidebar-7-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-10 title="Aggregate Functions" class="nav-link text-light text-wrap dropdown-toggle px-0">Aggregate Functions</a> <div id=sidebar-sidebar-7-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/agg_functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../query_language/agg_functions/reference/ title=Reference class="nav-link text-light text-wrap d-inline-block w-100 px-0">Reference</a> <a href=../query_language/agg_functions/combinators/ title="Aggregate function combinators" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aggregate function combinators</a> <a href=../query_language/agg_functions/parametric_functions/ title="Parametric aggregate functions" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Parametric aggregate functions</a> </nav> </div> <a href=#sidebar-sidebar-7-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-11 title="Table Functions" class="nav-link text-light text-wrap dropdown-toggle px-0">Table Functions</a> <div id=sidebar-sidebar-7-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/table_functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../query_language/table_functions/file/ title=file class="nav-link text-light text-wrap d-inline-block w-100 px-0">file</a> <a href=../query_language/table_functions/merge/ title=merge class="nav-link text-light text-wrap d-inline-block w-100 px-0">merge</a> <a href=../query_language/table_functions/numbers/ title=numbers class="nav-link text-light text-wrap d-inline-block w-100 px-0">numbers</a> <a href=../query_language/table_functions/remote/ title=remote class="nav-link text-light text-wrap d-inline-block w-100 px-0">remote</a> <a href=../query_language/table_functions/url/ title=url class="nav-link text-light text-wrap d-inline-block w-100 px-0">url</a> <a href=../query_language/table_functions/mysql/ title=mysql class="nav-link text-light text-wrap d-inline-block w-100 px-0">mysql</a> <a href=../query_language/table_functions/jdbc/ title=jdbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">jdbc</a> <a href=../query_language/table_functions/odbc/ title=odbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">odbc</a> <a href=../query_language/table_functions/hdfs/ title=hdfs class="nav-link text-light text-wrap d-inline-block w-100 px-0">hdfs</a> <a href=../query_language/table_functions/input/ title=input class="nav-link text-light text-wrap d-inline-block w-100 px-0">input</a> </nav> </div> <a href=#sidebar-sidebar-7-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-12 title=Dictionaries class="nav-link text-light text-wrap dropdown-toggle px-0">Dictionaries</a> <div id=sidebar-sidebar-7-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/dicts/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=#sidebar-sidebar-7-12-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-12-2 title="External Dictionaries" class="nav-link text-light text-wrap dropdown-toggle px-0">External Dictionaries</a> <div id=sidebar-sidebar-7-12-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../query_language/dicts/external_dicts/ title="General Description" class="nav-link text-light text-wrap d-inline-block w-100 px-0">General Description</a> <a href=../query_language/dicts/external_dicts_dict/ title="Configuring an External Dictionary" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Configuring an External Dictionary</a> <a href=../query_language/dicts/external_dicts_dict_layout/ title="Storing Dictionaries in Memory" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Storing Dictionaries in Memory</a> <a href=../query_language/dicts/external_dicts_dict_lifetime/ title="Dictionary Updates" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionary Updates</a> <a href=../query_language/dicts/external_dicts_dict_sources/ title="Sources of External Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Sources of External Dictionaries</a> <a href=../query_language/dicts/external_dicts_dict_structure/ title="Dictionary Key and Fields" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionary Key and Fields</a> </nav> </div> <a href=../query_language/dicts/internal_dicts/ title="Internal Dictionaries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Internal Dictionaries</a> <a href=../query_language/operators/ title=Operators class="nav-link text-light text-wrap d-inline-block w-100 px-0">Operators</a> <a href=../query_language/syntax/ title="General Syntax" class="nav-link text-light text-wrap d-inline-block w-100 px-0">General Syntax</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8 title=Operations class="nav-link text-light text-wrap dropdown-toggle px-0">Operations</a> <div id=sidebar-sidebar-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../operations/requirements/ title=Requirements class="nav-link text-light text-wrap d-inline-block w-100 px-0">Requirements</a> <a href=../operations/monitoring/ title=Monitoring class="nav-link text-light text-wrap d-inline-block w-100 px-0">Monitoring</a> <a href=../operations/troubleshooting/ title=Troubleshooting class="nav-link text-light text-wrap d-inline-block w-100 px-0">Troubleshooting</a> <a href=../operations/tips/ title="Usage Recommendations" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Usage Recommendations</a> <a href=../operations/update/ title="ClickHouse Update" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ClickHouse Update</a> <a href=../operations/access_rights/ title="Access Rights" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Access Rights</a> <a href=../operations/backup/ title="Data Backup" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Data Backup</a> <a href=../operations/configuration_files/ title="Configuration Files" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Configuration Files</a> <a href=../operations/quotas/ title=Quotas class="nav-link text-light text-wrap d-inline-block w-100 px-0">Quotas</a> <a href=../operations/system_tables/ title="System Tables" class="nav-link text-light text-wrap d-inline-block w-100 px-0">System Tables</a> <a href=#sidebar-sidebar-8-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-12 title="Server Configuration Parameters" class="nav-link text-light text-wrap dropdown-toggle px-0">Server Configuration Parameters</a> <div id=sidebar-sidebar-8-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/server_settings/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../operations/server_settings/settings/ title="Server Settings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Server Settings</a> </nav> </div> <a href=#sidebar-sidebar-8-13 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-13 title=Settings class="nav-link text-light text-wrap dropdown-toggle px-0">Settings</a> <div id=sidebar-sidebar-8-13 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/settings/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../operations/settings/permissions_for_queries/ title="Permissions for Queries" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Permissions for Queries</a> <a href=../operations/settings/query_complexity/ title="Restrictions on Query Complexity" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Restrictions on Query Complexity</a> <a href=../operations/settings/settings/ title=Settings class="nav-link text-light text-wrap d-inline-block w-100 px-0">Settings</a> <a href=../operations/settings/settings_profiles/ title="Settings Profiles" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Settings Profiles</a> <a href=../operations/settings/settings_users/ title="User Settings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">User Settings</a> <a href=../operations/settings/constraints_on_settings/ title="Constraints on Settings" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Constraints on Settings</a> </nav> </div> <a href=#sidebar-sidebar-8-14 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8-14 title=Utilities class="nav-link text-light text-wrap dropdown-toggle px-0">Utilities</a> <div id=sidebar-sidebar-8-14 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../operations/utils/ title=Overview class="nav-link text-light text-wrap d-inline-block w-100 px-0">Overview</a> <a href=../operations/utils/clickhouse-copier/ title=clickhouse-copier class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-copier</a> <a href=../operations/utils/clickhouse-local/ title=clickhouse-local class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-local</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-9 title=F.A.Q. class="nav-link text-light text-wrap dropdown-toggle px-0">F.A.Q.</a> <div id=sidebar-sidebar-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../faq/general/ title="General Questions" class="nav-link text-light text-wrap d-inline-block w-100 px-0">General Questions</a> </nav> </div> <a href=#sidebar-sidebar-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-10 title=Development class="nav-link text-light text-wrap dropdown-toggle px-0">Development</a> <div id=sidebar-sidebar-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../development/architecture/ title="Overview of ClickHouse Architecture" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Overview of ClickHouse Architecture</a> <a href=../development/build/ title="How to Build ClickHouse on Linux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">How to Build ClickHouse on Linux</a> <a href=../development/build_osx/ title="How to Build ClickHouse on Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">How to Build ClickHouse on Mac OS X</a> <a href=../development/style/ title="How to Write C++ code" class="nav-link text-light text-wrap d-inline-block w-100 px-0">How to Write C++ code</a> <a href=../development/tests/ title="How to Run ClickHouse Tests" class="nav-link text-light text-wrap d-inline-block w-100 px-0">How to Run ClickHouse Tests</a> <a href=../development/contrib/ title="Third-Party Libraries Used" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Third-Party Libraries Used</a> </nav> </div> <a href=#sidebar-sidebar-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11 title="What's New" class="nav-link text-light text-wrap dropdown-toggle px-0">What's New</a> <div id=sidebar-sidebar-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../roadmap/ title=Roadmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">Roadmap</a> <a href=../changelog/ title=Changelog class="nav-link text-white active text-wrap d-inline-block w-100 px-0">Changelog</a> <a href=../security_changelog/ title="Security Changelog" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Security Changelog</a> </nav> </div> <a href=../single/clickhouse_fa.pdf class="nav-link border-top border-secondary mt-3 px-0 pt-3 text-light"> <img src=/images/mkdocs/pdf.svg alt="نسخه PDF" title="نسخه PDF" height=24 class="d-block mr-1 float-left"><div>نسخه PDF</div> </a> </nav> </div> </div> <div id=content-wrapper class="col-md-8 p-2 p-md-5"> <div id=content> <h2 id=clickhouse-release-v19-16-2-2-2019-10-30>ClickHouse release v19.16.2.2, 2019-10-30<a class=headerlink href=#clickhouse-release-v19-16-2-2-2019-10-30 title="Permanent link">&para;</a></h2> <h3 id=backward-incompatible-change>Backward Incompatible Change<a class=headerlink href=#backward-incompatible-change title="Permanent link">&para;</a></h3> <ul> <li>Add missing arity validation for count/counIf.<br> <a href=https://github.com/ClickHouse/ClickHouse/issues/7095 rel="external nofollow noreferrer">#7095</a><br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7298 rel="external nofollow noreferrer">#7298</a> (<a href=https://github.com/Vdimir rel="external nofollow noreferrer">Vdimir</a>)</li> <li>Remove legacy <code>asterisk_left_columns_only</code> setting (it was disabled by default).<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7335 rel="external nofollow noreferrer">#7335</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem<br> Zuikov</a>)</li> <li>Format strings for Template data format are now specified in files.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7118 rel="external nofollow noreferrer">#7118</a><br> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> </ul> <h3 id=new-feature>New Feature<a class=headerlink href=#new-feature title="Permanent link">&para;</a></h3> <ul> <li>Introduce uniqCombined64() to calculate cardinality greater than UINT_MAX.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7213 rel="external nofollow noreferrer">#7213</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7222 rel="external nofollow noreferrer">#7222</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat<br> Khuzhin</a>)</li> <li>Support Bloom filter indexes on Array columns.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/6984 rel="external nofollow noreferrer">#6984</a><br> (<a href=https://github.com/achimbab rel="external nofollow noreferrer">achimbab</a>)</li> <li>Add a function <code>getMacro(name)</code> that returns String with the value of corresponding <code>&lt;macros&gt;</code><br> from server configuration. <a href=https://github.com/ClickHouse/ClickHouse/pull/7240 rel="external nofollow noreferrer">#7240</a><br> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Set two configuration options for a dictionary based on an HTTP source: <code>credentials</code> and<br> <code>http-headers</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/7092 rel="external nofollow noreferrer">#7092</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume<br> Tassery</a>)</li> <li>Add a new ProfileEvent <code>Merge</code> that counts the number of launched background merges.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7093 rel="external nofollow noreferrer">#7093</a> (<a href=https://github.com/millb rel="external nofollow noreferrer">Mikhail<br> Korotov</a>)</li> <li>Add fullHostName function that returns a fully qualified domain name.<br> <a href=https://github.com/ClickHouse/ClickHouse/issues/7263 rel="external nofollow noreferrer">#7263</a><br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7291 rel="external nofollow noreferrer">#7291</a> (<a href=https://github.com/sundy-li rel="external nofollow noreferrer">sundyli</a>)</li> <li>Add function <code>arraySplit</code> and <code>arrayReverseSplit</code> which split an array by "cut off"<br> conditions. They are useful in time sequence handling.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7294 rel="external nofollow noreferrer">#7294</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> <li>Add new functions that return the Array of all matched indices in multiMatch family of functions.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7299 rel="external nofollow noreferrer">#7299</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila<br> Kutenin</a>)</li> <li>Add a new database engine <code>Lazy</code> that is optimized for storing a large number of small -Log<br> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/7171 rel="external nofollow noreferrer">#7171</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita<br> Vasilev</a>)</li> <li>Add aggregate functions groupBitmapAnd, -Or, -Xor for bitmap columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/7109 rel="external nofollow noreferrer">#7109</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang<br> Yu</a>)</li> <li>Add aggregate function combinators -OrNull and -OrDefault, which return null<br> or default values when there is nothing to aggregate.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7331 rel="external nofollow noreferrer">#7331</a><br> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> <li>Introduce CustomSeparated data format that supports custom escaping and<br> delimiter rules. <a href=https://github.com/ClickHouse/ClickHouse/pull/7118 rel="external nofollow noreferrer">#7118</a><br> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> </ul> <h3 id=bug-fix>Bug Fix<a class=headerlink href=#bug-fix title="Permanent link">&para;</a></h3> <ul> <li>Fix wrong query result if it has <code>WHERE IN (SELECT ...)</code> section and <code>optimize_read_in_order</code> is<br> used. <a href=https://github.com/ClickHouse/ClickHouse/pull/7371 rel="external nofollow noreferrer">#7371</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton<br> Popov</a>)</li> <li>Disabled MariaDB authentication plugin, which depends on files outside of project.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7140 rel="external nofollow noreferrer">#7140</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy<br> Baranov</a>)</li> <li>Fix exception <code>Cannot convert column ... because it is constant but values of constants are different in source and result</code> which could rarely happen when functions <code>now()</code>, <code>today()</code>,<br> <code>yesterday()</code>, <code>randConstant()</code> are used.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7156 rel="external nofollow noreferrer">#7156</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai<br> Kochetov</a>)</li> <li>Fixed issue of using HTTP keep alive timeout instead of TCP keep alive timeout.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7351 rel="external nofollow noreferrer">#7351</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily<br> Nemkov</a>)</li> <li>Fixed a segmentation fault in groupBitmapOr (issue <a href=https://github.com/ClickHouse/ClickHouse/issues/7109 rel="external nofollow noreferrer">#7109</a>).<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7289 rel="external nofollow noreferrer">#7289</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang<br> Yu</a>)</li> <li>For materialized views the commit for Kafka is called after all data were written.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7175 rel="external nofollow noreferrer">#7175</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fixed wrong <code>duration_ms</code> value in <code>system.part_log</code> table. It was ten times off.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7172 rel="external nofollow noreferrer">#7172</a> (<a href=https://github.com/excitoon rel="external nofollow noreferrer">Vladimir<br> Chebotarev</a>)</li> <li>A quick fix to resolve crash in LIVE VIEW table and re-enabling all LIVE VIEW tests.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7201 rel="external nofollow noreferrer">#7201</a><br> (<a href=https://github.com/vzakaznikov rel="external nofollow noreferrer">vzakaznikov</a>)</li> <li>Serialize NULL values correctly in min/max indexes of MergeTree parts.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7234 rel="external nofollow noreferrer">#7234</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">Alexander<br> Kuzmenkov</a>)</li> <li>Don't put virtual columns to .sql metadata when table is created as <code>CREATE TABLE AS</code>.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7183 rel="external nofollow noreferrer">#7183</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fix segmentation fault in <code>ATTACH PART</code> query.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7185 rel="external nofollow noreferrer">#7185</a><br> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix wrong result for some queries given by the optimization of empty IN subqueries and empty<br> INNER/RIGHT JOIN. <a href=https://github.com/ClickHouse/ClickHouse/pull/7284 rel="external nofollow noreferrer">#7284</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai<br> Kochetov</a>)</li> <li>Fixing AddressSanitizer error in the LIVE VIEW getHeader() method.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7271 rel="external nofollow noreferrer">#7271</a><br> (<a href=https://github.com/vzakaznikov rel="external nofollow noreferrer">vzakaznikov</a>)</li> </ul> <h3 id=improvement>Improvement<a class=headerlink href=#improvement title="Permanent link">&para;</a></h3> <ul> <li>Add a message in case of queue_wait_max_ms wait takes place.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7390 rel="external nofollow noreferrer">#7390</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat<br> Khuzhin</a>)</li> <li>Made setting <code>s3_min_upload_part_size</code> table-level.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7059 rel="external nofollow noreferrer">#7059</a> (<a href=https://github.com/excitoon rel="external nofollow noreferrer">Vladimir<br> Chebotarev</a>)</li> <li>Check TTL in StorageFactory. <a href=https://github.com/ClickHouse/ClickHouse/pull/7304 rel="external nofollow noreferrer">#7304</a><br> (<a href=https://github.com/sundy-li rel="external nofollow noreferrer">sundyli</a>)</li> <li>Squash left-hand blocks in partial merge join (optimization).<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7122 rel="external nofollow noreferrer">#7122</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem<br> Zuikov</a>)</li> <li>Do not allow non-deterministic functions in mutations of Replicated table engines, because this<br> can introduce inconsistencies between replicas.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7247 rel="external nofollow noreferrer">#7247</a> (<a href=https://github.com/Akazz rel="external nofollow noreferrer">Alexander<br> Kazakov</a>)</li> <li>Disable memory tracker while converting exception stack trace to string. It can prevent the loss<br> of error messages of type <code>Memory limit exceeded</code> on server, which caused the <code>Attempt to read after eof</code> exception on client. <a href=https://github.com/ClickHouse/ClickHouse/pull/7264 rel="external nofollow noreferrer">#7264</a><br> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Miscellaneous format improvements. Resolves<br> <a href=https://github.com/ClickHouse/ClickHouse/issues/6033 rel="external nofollow noreferrer">#6033</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/issues/2633 rel="external nofollow noreferrer">#2633</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/issues/6611 rel="external nofollow noreferrer">#6611</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/issues/6742 rel="external nofollow noreferrer">#6742</a><br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7215 rel="external nofollow noreferrer">#7215</a><br> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>ClickHouse ignores values on the right side of IN operator that are not convertible to the left<br> side type. Make it work properly for compound types -- Array and Tuple.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7283 rel="external nofollow noreferrer">#7283</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">Alexander<br> Kuzmenkov</a>)</li> <li>Support missing inequalities for ASOF JOIN. It's possible to join less-or-equal variant and strict<br> greater and less variants for ASOF column in ON syntax.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7282 rel="external nofollow noreferrer">#7282</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem<br> Zuikov</a>)</li> <li>Optimize partial merge join. <a href=https://github.com/ClickHouse/ClickHouse/pull/7070 rel="external nofollow noreferrer">#7070</a><br> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Do not use more then 98K of memory in uniqCombined functions.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7236 rel="external nofollow noreferrer">#7236</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7270 rel="external nofollow noreferrer">#7270</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat<br> Khuzhin</a>)</li> <li>Flush parts of right-hand joining table on disk in PartialMergeJoin (if there is not enough<br> memory). Load data back when needed. <a href=https://github.com/ClickHouse/ClickHouse/pull/7186 rel="external nofollow noreferrer">#7186</a><br> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=performance-improvement>Performance Improvement<a class=headerlink href=#performance-improvement title="Permanent link">&para;</a></h3> <ul> <li>Speed up joinGet with const arguments by avoiding data duplication.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7359 rel="external nofollow noreferrer">#7359</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos<br> Bird</a>)</li> <li>Return early if the subquery is empty.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7007 rel="external nofollow noreferrer">#7007</a> (<a href=https://github.com/nicelulu rel="external nofollow noreferrer">小路</a>)</li> <li>Optimize parsing of SQL expression in Values.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/6781 rel="external nofollow noreferrer">#6781</a><br> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> </ul> <h3 id=build-testing-packaging-improvement>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement title="Permanent link">&para;</a></h3> <ul> <li>Disable some contribs for cross-compilation to Mac OS.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7101 rel="external nofollow noreferrer">#7101</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Add missing linking with PocoXML for clickhouse_common_io.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7200 rel="external nofollow noreferrer">#7200</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat<br> Khuzhin</a>)</li> <li>Accept multiple test filter arguments in clickhouse-test.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7226 rel="external nofollow noreferrer">#7226</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">Alexander<br> Kuzmenkov</a>)</li> <li>Enable musl and jemalloc for ARM. <a href=https://github.com/ClickHouse/ClickHouse/pull/7300 rel="external nofollow noreferrer">#7300</a><br> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Added <code>--client-option</code> parameter to <code>clickhouse-test</code> to pass additional parameters to client.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7277 rel="external nofollow noreferrer">#7277</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai<br> Kochetov</a>)</li> <li>Preserve existing configs on rpm package upgrade.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7103 rel="external nofollow noreferrer">#7103</a><br> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Fix errors detected by PVS. <a href=https://github.com/ClickHouse/ClickHouse/pull/7153 rel="external nofollow noreferrer">#7153</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem<br> Zuikov</a>)</li> <li>Fix build for Darwin. <a href=https://github.com/ClickHouse/ClickHouse/pull/7149 rel="external nofollow noreferrer">#7149</a><br> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>glibc 2.29 compatibility. <a href=https://github.com/ClickHouse/ClickHouse/pull/7142 rel="external nofollow noreferrer">#7142</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos<br> Bird</a>)</li> <li>Make sure dh_clean does not touch potential source files.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7205 rel="external nofollow noreferrer">#7205</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos<br> Bird</a>)</li> <li>Attempt to avoid conflict when updating from altinity rpm - it has config file packaged separately<br> in clickhouse-server-common. <a href=https://github.com/ClickHouse/ClickHouse/pull/7073 rel="external nofollow noreferrer">#7073</a><br> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Optimize some header files for faster rebuilds.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7212 rel="external nofollow noreferrer">#7212</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7231 rel="external nofollow noreferrer">#7231</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">Alexander<br> Kuzmenkov</a>)</li> <li>Add performance tests for Date and DateTime. <a href=https://github.com/ClickHouse/ClickHouse/pull/7332 rel="external nofollow noreferrer">#7332</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily<br> Nemkov</a>)</li> <li>Fix some tests that contained non-deterministic mutations.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7132 rel="external nofollow noreferrer">#7132</a> (<a href=https://github.com/Akazz rel="external nofollow noreferrer">Alexander<br> Kazakov</a>)</li> <li>Add build with MemorySanitizer to CI. <a href=https://github.com/ClickHouse/ClickHouse/pull/7066 rel="external nofollow noreferrer">#7066</a><br> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">Alexander Kuzmenkov</a>)</li> <li>Avoid use of uninitialized values in MetricsTransmitter.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7158 rel="external nofollow noreferrer">#7158</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat<br> Khuzhin</a>)</li> <li>Fix some issues in Fields found by MemorySanitizer.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7135 rel="external nofollow noreferrer">#7135</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7179 rel="external nofollow noreferrer">#7179</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">Alexander<br> Kuzmenkov</a>), <a href=https://github.com/ClickHouse/ClickHouse/pull/7376 rel="external nofollow noreferrer">#7376</a><br> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Fix undefined behavior in murmurhash32. <a href=https://github.com/ClickHouse/ClickHouse/pull/7388 rel="external nofollow noreferrer">#7388</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos<br> Bird</a>)</li> <li>Fix undefined behavior in StoragesInfoStream. <a href=https://github.com/ClickHouse/ClickHouse/pull/7384 rel="external nofollow noreferrer">#7384</a><br> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Fixed constant expressions folding for external database engines (MySQL, ODBC, JDBC). In previous<br> versions it wasn't working for multiple constant expressions and was not working at all for Date,<br> DateTime and UUID. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/7245 rel="external nofollow noreferrer">#7245</a><br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7252 rel="external nofollow noreferrer">#7252</a><br> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixing ThreadSanitizer data race error in the LIVE VIEW when accessing no_users_thread variable.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7353 rel="external nofollow noreferrer">#7353</a><br> (<a href=https://github.com/vzakaznikov rel="external nofollow noreferrer">vzakaznikov</a>)</li> <li>Get rid of malloc symbols in libcommon<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7134 rel="external nofollow noreferrer">#7134</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7065 rel="external nofollow noreferrer">#7065</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos<br> Bird</a>)</li> <li>Add global flag ENABLE_LIBRARIES for disabling all libraries.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7063 rel="external nofollow noreferrer">#7063</a><br> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=code-cleanup>Code cleanup<a class=headerlink href=#code-cleanup title="Permanent link">&para;</a></h3> <ul> <li>Generalize configuration repository to prepare for DDL for Dictionaries. <a href=https://github.com/ClickHouse/ClickHouse/pull/7155 rel="external nofollow noreferrer">#7155</a><br> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Parser for dictionaries DDL without any semantic.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7209 rel="external nofollow noreferrer">#7209</a><br> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Split ParserCreateQuery into different smaller parsers.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7253 rel="external nofollow noreferrer">#7253</a><br> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Small refactoring and renaming near external dictionaries.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7111 rel="external nofollow noreferrer">#7111</a><br> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Refactor some code to prepare for role-based access control. <a href=https://github.com/ClickHouse/ClickHouse/pull/7235 rel="external nofollow noreferrer">#7235</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly<br> Baranov</a>)</li> <li>Some improvements in DatabaseOrdinary code.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7086 rel="external nofollow noreferrer">#7086</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita<br> Vasilev</a>)</li> <li>Do not use iterators in find() and emplace() methods of hash tables.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7026 rel="external nofollow noreferrer">#7026</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">Alexander<br> Kuzmenkov</a>)</li> <li>Fix getMultipleValuesFromConfig in case when parameter root is not empty. <a href=https://github.com/ClickHouse/ClickHouse/pull/7374 rel="external nofollow noreferrer">#7374</a><br> (<a href=https://github.com/millb rel="external nofollow noreferrer">Mikhail Korotov</a>)</li> <li>Remove some copy-paste (TemporaryFile and TemporaryFileStream)<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7166 rel="external nofollow noreferrer">#7166</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem<br> Zuikov</a>)</li> <li>Improved code readability a little bit (<code>MergeTreeData::getActiveContainingPart</code>).<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7361 rel="external nofollow noreferrer">#7361</a> (<a href=https://github.com/excitoon rel="external nofollow noreferrer">Vladimir<br> Chebotarev</a>)</li> <li>Wait for all scheduled jobs, which are using local objects, if <code>ThreadPool::schedule(...)</code> throws<br> an exception. Rename <code>ThreadPool::schedule(...)</code> to <code>ThreadPool::scheduleOrThrowOnError(...)</code> and<br> fix comments to make obvious that it may throw.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7350 rel="external nofollow noreferrer">#7350</a><br> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> </ul> <h2 id=clickhouse-release-19-15-4-10-2019-10-31>ClickHouse release 19.15.4.10, 2019-10-31<a class=headerlink href=#clickhouse-release-19-15-4-10-2019-10-31 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_1>Bug Fix<a class=headerlink href=#bug-fix_1 title="Permanent link">&para;</a></h3> <ul> <li>Added handling of SQL_TINYINT and SQL_BIGINT, and fix handling of SQL_FLOAT data source types in ODBC Bridge.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7491 rel="external nofollow noreferrer">#7491</a> (<a href=https://github.com/traceon rel="external nofollow noreferrer">Denis Glazachev</a>)</li> <li>Allowed to have some parts on destination disk or volume in MOVE PARTITION.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7434 rel="external nofollow noreferrer">#7434</a> (<a href=https://github.com/excitoon rel="external nofollow noreferrer">Vladimir Chebotarev</a>)</li> <li>Fixed NULL-values in nullable columns through ODBC-bridge.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7402 rel="external nofollow noreferrer">#7402</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Fixed INSERT into Distributed non local node with MATERIALIZED columns.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7377 rel="external nofollow noreferrer">#7377</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Fixed function getMultipleValuesFromConfig.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7374 rel="external nofollow noreferrer">#7374</a> (<a href=https://github.com/millb rel="external nofollow noreferrer">Mikhail Korotov</a>)</li> <li>Fixed issue of using HTTP keep alive timeout instead of TCP keep alive timeout.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7351 rel="external nofollow noreferrer">#7351</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Wait for all jobs to finish on exception (fixes rare segfaults).<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7350 rel="external nofollow noreferrer">#7350</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Don't push to MVs when inserting into Kafka table.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7265 rel="external nofollow noreferrer">#7265</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Disable memory tracker for exception stack.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7264 rel="external nofollow noreferrer">#7264</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fixed bad code in transforming query for external database.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7252 rel="external nofollow noreferrer">#7252</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Avoid use of uninitialized values in MetricsTransmitter.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7158 rel="external nofollow noreferrer">#7158</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Added example config with macros for tests (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-15-3-6-2019-10-09>ClickHouse release 19.15.3.6, 2019-10-09<a class=headerlink href=#clickhouse-release-19-15-3-6-2019-10-09 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_2>Bug Fix<a class=headerlink href=#bug-fix_2 title="Permanent link">&para;</a></h3> <ul> <li>Fixed bad_variant in hashed dictionary.<br> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed up bug with segmentation fault in ATTACH PART query.<br> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed time calculation in <code>MergeTreeData</code>.<br> (<a href=https://github.com/excitoon rel="external nofollow noreferrer">Vladimir Chebotarev</a>)</li> <li>Commit to Kafka explicitly after the writing is finalized.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7175 rel="external nofollow noreferrer">#7175</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Serialize NULL values correctly in min/max indexes of MergeTree parts.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/7234 rel="external nofollow noreferrer">#7234</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">Alexander Kuzmenkov</a>)</li> </ul> <h2 id=clickhouse-release-19-15-2-2-2019-10-01>ClickHouse release 19.15.2.2, 2019-10-01<a class=headerlink href=#clickhouse-release-19-15-2-2-2019-10-01 title="Permanent link">&para;</a></h2> <h3 id=new-feature_1>New Feature<a class=headerlink href=#new-feature_1 title="Permanent link">&para;</a></h3> <ul> <li>Tiered storage: support to use multiple storage volumes for tables with MergeTree engine. It's possible to store fresh data on SSD and automatically move old data to HDD. (<a href=https://clickhouse.github.io/clickhouse-presentations/meetup30/new_features/#12 rel="external nofollow noreferrer">example</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4918 rel="external nofollow noreferrer">#4918</a> (<a href=https://github.com/ObjatieGroba rel="external nofollow noreferrer">Igr</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6489 rel="external nofollow noreferrer">#6489</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Add table function <code>input</code> for reading incoming data in <code>INSERT SELECT</code> query. <a href=https://github.com/ClickHouse/ClickHouse/pull/5450 rel="external nofollow noreferrer">#5450</a> (<a href=https://github.com/palasonic1 rel="external nofollow noreferrer">palasonic1</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6832 rel="external nofollow noreferrer">#6832</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Add a <code>sparse_hashed</code> dictionary layout, that is functionally equivalent to the <code>hashed</code> layout, but is more memory efficient. It uses about twice as less memory at the cost of slower value retrieval. <a href=https://github.com/ClickHouse/ClickHouse/pull/6894 rel="external nofollow noreferrer">#6894</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Implement ability to define list of users for access to dictionaries. Only current connected database using. <a href=https://github.com/ClickHouse/ClickHouse/pull/6907 rel="external nofollow noreferrer">#6907</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Add <code>LIMIT</code> option to <code>SHOW</code> query. <a href=https://github.com/ClickHouse/ClickHouse/pull/6944 rel="external nofollow noreferrer">#6944</a> (<a href=https://github.com/malkfilipp rel="external nofollow noreferrer">Philipp Malkovsky</a>)</li> <li>Add <code>bitmapSubsetLimit(bitmap, range_start, limit)</code> function, that returns subset of the smallest <code>limit</code> values in set that is no smaller than <code>range_start</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6957 rel="external nofollow noreferrer">#6957</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang Yu</a>)</li> <li>Add <code>bitmapMin</code> and <code>bitmapMax</code> functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/6970 rel="external nofollow noreferrer">#6970</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang Yu</a>)</li> <li>Add function <code>repeat</code> related to <a href=https://github.com/yandex/ClickHouse/issues/6648 rel="external nofollow noreferrer">issue-6648</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6999 rel="external nofollow noreferrer">#6999</a> (<a href=https://github.com/ucasFL rel="external nofollow noreferrer">flynn</a>)</li> </ul> <h3 id=experimental-feature>Experimental Feature<a class=headerlink href=#experimental-feature title="Permanent link">&para;</a></h3> <ul> <li>Implement (in memory) Merge Join variant that does not change current pipeline. Result is partially sorted by merge key. Set <code>partial_merge_join = 1</code> to use this feature. The Merge Join is still in development. <a href=https://github.com/ClickHouse/ClickHouse/pull/6940 rel="external nofollow noreferrer">#6940</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Add <code>S3</code> engine and table function. It is still in development (no authentication support yet). <a href=https://github.com/ClickHouse/ClickHouse/pull/5596 rel="external nofollow noreferrer">#5596</a> (<a href=https://github.com/excitoon rel="external nofollow noreferrer">Vladimir Chebotarev</a>)</li> </ul> <h3 id=improvement_1>Improvement<a class=headerlink href=#improvement_1 title="Permanent link">&para;</a></h3> <ul> <li>Every message read from Kafka is inserted atomically. This resolves almost all known issues with Kafka engine. <a href=https://github.com/ClickHouse/ClickHouse/pull/6950 rel="external nofollow noreferrer">#6950</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Improvements for failover of Distributed queries. Shorten recovery time, also it is now configurable and can be seen in <code>system.clusters</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6399 rel="external nofollow noreferrer">#6399</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Support numeric values for Enums directly in <code>IN</code> section. #6766 <a href=https://github.com/ClickHouse/ClickHouse/pull/6941 rel="external nofollow noreferrer">#6941</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Support (optional, disabled by default) redirects on URL storage. <a href=https://github.com/ClickHouse/ClickHouse/pull/6914 rel="external nofollow noreferrer">#6914</a> (<a href=https://github.com/maqroll rel="external nofollow noreferrer">maqroll</a>)</li> <li>Add information message when client with an older version connects to a server. <a href=https://github.com/ClickHouse/ClickHouse/pull/6893 rel="external nofollow noreferrer">#6893</a> (<a href=https://github.com/malkfilipp rel="external nofollow noreferrer">Philipp Malkovsky</a>)</li> <li>Remove maximum backoff sleep time limit for sending data in Distributed tables <a href=https://github.com/ClickHouse/ClickHouse/pull/6895 rel="external nofollow noreferrer">#6895</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Add ability to send profile events (counters) with cumulative values to graphite. It can be enabled under <code>&lt;events_cumulative&gt;</code> in server <code>config.xml</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6969 rel="external nofollow noreferrer">#6969</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Add automatically cast type <code>T</code> to <code>LowCardinality(T)</code> while inserting data in column of type <code>LowCardinality(T)</code> in Native format via HTTP. <a href=https://github.com/ClickHouse/ClickHouse/pull/6891 rel="external nofollow noreferrer">#6891</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Add ability to use function <code>hex</code> without using <code>reinterpretAsString</code> for <code>Float32</code>, <code>Float64</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/7024 rel="external nofollow noreferrer">#7024</a> (<a href=https://github.com/millb rel="external nofollow noreferrer">Mikhail Korotov</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_1>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_1 title="Permanent link">&para;</a></h3> <ul> <li>Add gdb-index to clickhouse binary with debug info. It will speed up startup time of <code>gdb</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6947 rel="external nofollow noreferrer">#6947</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Speed up deb packaging with patched dpkg-deb which uses <code>pigz</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6960 rel="external nofollow noreferrer">#6960</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Set <code>enable_fuzzing = 1</code> to enable libfuzzer instrumentation of all the project code. <a href=https://github.com/ClickHouse/ClickHouse/pull/7042 rel="external nofollow noreferrer">#7042</a> (<a href=https://github.com/kyprizel rel="external nofollow noreferrer">kyprizel</a>)</li> <li>Add split build smoke test in CI. <a href=https://github.com/ClickHouse/ClickHouse/pull/7061 rel="external nofollow noreferrer">#7061</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Add build with MemorySanitizer to CI. <a href=https://github.com/ClickHouse/ClickHouse/pull/7066 rel="external nofollow noreferrer">#7066</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">Alexander Kuzmenkov</a>)</li> <li>Replace <code>libsparsehash</code> with <code>sparsehash-c11</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/6965 rel="external nofollow noreferrer">#6965</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> </ul> <h3 id=bug-fix_3>Bug Fix<a class=headerlink href=#bug-fix_3 title="Permanent link">&para;</a></h3> <ul> <li>Fixed performance degradation of index analysis on complex keys on large tables. This fixes #6924. <a href=https://github.com/ClickHouse/ClickHouse/pull/7075 rel="external nofollow noreferrer">#7075</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix logical error causing segfaults when selecting from Kafka empty topic. <a href=https://github.com/ClickHouse/ClickHouse/pull/6909 rel="external nofollow noreferrer">#6909</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fix too early MySQL connection close in <code>MySQLBlockInputStream.cpp</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6882 rel="external nofollow noreferrer">#6882</a> (<a href=https://github.com/clemrodriguez rel="external nofollow noreferrer">Clément Rodriguez</a>)</li> <li>Returned support for very old Linux kernels (fix <a href=https://github.com/ClickHouse/ClickHouse/issues/6841 rel="external nofollow noreferrer">#6841</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6853 rel="external nofollow noreferrer">#6853</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix possible data loss in <code>insert select</code> query in case of empty block in input stream. #6834 #6862 <a href=https://github.com/ClickHouse/ClickHouse/pull/6911 rel="external nofollow noreferrer">#6911</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix for function <code>АrrayEnumerateUniqRanked</code> with empty arrays in params <a href=https://github.com/ClickHouse/ClickHouse/pull/6928 rel="external nofollow noreferrer">#6928</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix complex queries with array joins and global subqueries. <a href=https://github.com/ClickHouse/ClickHouse/pull/6934 rel="external nofollow noreferrer">#6934</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fix <code>Unknown identifier</code> error in ORDER BY and GROUP BY with multiple JOINs <a href=https://github.com/ClickHouse/ClickHouse/pull/7022 rel="external nofollow noreferrer">#7022</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed <code>MSan</code> warning while executing function with <code>LowCardinality</code> argument. <a href=https://github.com/ClickHouse/ClickHouse/pull/7062 rel="external nofollow noreferrer">#7062</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> </ul> <h3 id=backward-incompatible-change_1>Backward Incompatible Change<a class=headerlink href=#backward-incompatible-change_1 title="Permanent link">&para;</a></h3> <ul> <li>Changed serialization format of bitmap<em> aggregate function states to improve performance. Serialized states of bitmap</em> from previous versions cannot be read. <a href=https://github.com/ClickHouse/ClickHouse/pull/6908 rel="external nofollow noreferrer">#6908</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang Yu</a>)</li> </ul> <h2 id=clickhouse-release-19-14-7-15-2019-10-02>ClickHouse release 19.14.7.15, 2019-10-02<a class=headerlink href=#clickhouse-release-19-14-7-15-2019-10-02 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_4>Bug Fix<a class=headerlink href=#bug-fix_4 title="Permanent link">&para;</a></h3> <ul> <li>This release also contains all bug fixes from 19.11.12.69.</li> <li>Fixed compatibility for distributed queries between 19.14 and earlier versions. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/7068 rel="external nofollow noreferrer">#7068</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/7069 rel="external nofollow noreferrer">#7069</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-14-6-12-2019-09-19>ClickHouse release 19.14.6.12, 2019-09-19<a class=headerlink href=#clickhouse-release-19-14-6-12-2019-09-19 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_5>Bug Fix<a class=headerlink href=#bug-fix_5 title="Permanent link">&para;</a></h3> <ul> <li>Fix for function <code>АrrayEnumerateUniqRanked</code> with empty arrays in params. <a href=https://github.com/ClickHouse/ClickHouse/pull/6928 rel="external nofollow noreferrer">#6928</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed subquery name in queries with <code>ARRAY JOIN</code> and <code>GLOBAL IN subquery</code> with alias. Use subquery alias for external table name if it is specified. <a href=https://github.com/ClickHouse/ClickHouse/pull/6934 rel="external nofollow noreferrer">#6934</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_2>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_2 title="Permanent link">&para;</a></h3> <ul> <li>Fix <a href=https://clickhouse-test-reports.s3.yandex.net/6944/aab95fd5175a513413c7395a73a82044bdafb906/functional_stateless_tests_(debug).html rel="external nofollow noreferrer">flapping</a> test <code>00715_fetch_merged_or_mutated_part_zookeeper</code> by rewriting it to a shell scripts because it needs to wait for mutations to apply. <a href=https://github.com/ClickHouse/ClickHouse/pull/6977 rel="external nofollow noreferrer">#6977</a> (<a href=https://github.com/Akazz rel="external nofollow noreferrer">Alexander Kazakov</a>)</li> <li>Fixed UBSan and MemSan failure in function <code>groupUniqArray</code> with emtpy array argument. It was caused by placing of empty <code>PaddedPODArray</code> into hash table zero cell because constructor for zero cell value was not called. <a href=https://github.com/ClickHouse/ClickHouse/pull/6937 rel="external nofollow noreferrer">#6937</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> </ul> <h2 id=clickhouse-release-19-14-3-3-2019-09-10>ClickHouse release 19.14.3.3, 2019-09-10<a class=headerlink href=#clickhouse-release-19-14-3-3-2019-09-10 title="Permanent link">&para;</a></h2> <h3 id=new-feature_2>New Feature<a class=headerlink href=#new-feature_2 title="Permanent link">&para;</a></h3> <ul> <li><code>WITH FILL</code> modifier for <code>ORDER BY</code>. (continuation of <a href=https://github.com/ClickHouse/ClickHouse/issues/5069 rel="external nofollow noreferrer">#5069</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6610 rel="external nofollow noreferrer">#6610</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li><code>WITH TIES</code> modifier for <code>LIMIT</code>. (continuation of <a href=https://github.com/ClickHouse/ClickHouse/issues/5069 rel="external nofollow noreferrer">#5069</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6610 rel="external nofollow noreferrer">#6610</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Parse unquoted <code>NULL</code> literal as NULL (if setting <code>format_csv_unquoted_null_literal_as_null=1</code>). Initialize null fields with default values if data type of this field is not nullable (if setting <code>input_format_null_as_default=1</code>). <a href=https://github.com/ClickHouse/ClickHouse/issues/5990 rel="external nofollow noreferrer">#5990</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6055 rel="external nofollow noreferrer">#6055</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Support for wildcards in paths of table functions <code>file</code> and <code>hdfs</code>. If the path contains wildcards, the table will be readonly. Example of usage: <code>select * from hdfs('hdfs://hdfs1:9000/some_dir/another_dir/*/file{0..9}{0..9}')</code> and <code>select * from file('some_dir/{some_file,another_file,yet_another}.tsv', 'TSV', 'value UInt32')</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6092 rel="external nofollow noreferrer">#6092</a> (<a href=https://github.com/stavrolia rel="external nofollow noreferrer">Olga Khvostikova</a>)</li> <li>New <code>system.metric_log</code> table which stores values of <code>system.events</code> and <code>system.metrics</code> with specified time interval. <a href=https://github.com/ClickHouse/ClickHouse/issues/6363 rel="external nofollow noreferrer">#6363</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6467 rel="external nofollow noreferrer">#6467</a> (<a href=https://github.com/nikitamikhaylov rel="external nofollow noreferrer">Nikita Mikhaylov</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6530 rel="external nofollow noreferrer">#6530</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Allow to write ClickHouse text logs to <code>system.text_log</code> table. <a href=https://github.com/ClickHouse/ClickHouse/issues/6037 rel="external nofollow noreferrer">#6037</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6103 rel="external nofollow noreferrer">#6103</a> (<a href=https://github.com/nikitamikhaylov rel="external nofollow noreferrer">Nikita Mikhaylov</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6164 rel="external nofollow noreferrer">#6164</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Show private symbols in stack traces (this is done via parsing symbol tables of ELF files). Added information about file and line number in stack traces if debug info is present. Speedup symbol name lookup with indexing symbols present in program. Added new SQL functions for introspection: <code>demangle</code> and <code>addressToLine</code>. Renamed function <code>symbolizeAddress</code> to <code>addressToSymbol</code> for consistency. Function <code>addressToSymbol</code> will return mangled name for performance reasons and you have to apply <code>demangle</code>. Added setting <code>allow_introspection_functions</code> which is turned off by default. <a href=https://github.com/ClickHouse/ClickHouse/pull/6201 rel="external nofollow noreferrer">#6201</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Table function <code>values</code> (the name is case-insensitive). It allows to read from <code>VALUES</code> list proposed in <a href=https://github.com/ClickHouse/ClickHouse/issues/5984 rel="external nofollow noreferrer">#5984</a>. Example: <code>SELECT * FROM VALUES('a UInt64, s String', (1, 'one'), (2, 'two'), (3, 'three'))</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/6217 rel="external nofollow noreferrer">#6217</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6209 rel="external nofollow noreferrer">#6209</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Added an ability to alter storage settings. Syntax: <code>ALTER TABLE &lt;table&gt; MODIFY SETTING &lt;setting&gt; = &lt;value&gt;</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6366 rel="external nofollow noreferrer">#6366</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6669 rel="external nofollow noreferrer">#6669</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6685 rel="external nofollow noreferrer">#6685</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Support for removing of detached parts. Syntax: <code>ALTER TABLE &lt;table_name&gt; DROP DETACHED PART '&lt;part_id&gt;'</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6158 rel="external nofollow noreferrer">#6158</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Table constraints. Allows to add constraint to table definition which will be checked at insert. <a href=https://github.com/ClickHouse/ClickHouse/pull/5273 rel="external nofollow noreferrer">#5273</a> (<a href=https://github.com/NanoBjorn rel="external nofollow noreferrer">Gleb Novikov</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6652 rel="external nofollow noreferrer">#6652</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Suppport for cascaded materialized views. <a href=https://github.com/ClickHouse/ClickHouse/pull/6324 rel="external nofollow noreferrer">#6324</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Turn on query profiler by default to sample every query execution thread once a second. <a href=https://github.com/ClickHouse/ClickHouse/pull/6283 rel="external nofollow noreferrer">#6283</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Input format <code>ORC</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6454 rel="external nofollow noreferrer">#6454</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6703 rel="external nofollow noreferrer">#6703</a> (<a href=https://github.com/akonyaev90 rel="external nofollow noreferrer">akonyaev90</a>)</li> <li>Added two new functions: <code>sigmoid</code> and <code>tanh</code> (that are useful for machine learning applications). <a href=https://github.com/ClickHouse/ClickHouse/pull/6254 rel="external nofollow noreferrer">#6254</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Function <code>hasToken(haystack, token)</code>, <code>hasTokenCaseInsensitive(haystack, token)</code> to check if given token is in haystack. Token is a maximal length substring between two non alphanumeric ASCII characters (or boundaries of haystack). Token must be a constant string. Supported by tokenbf_v1 index specialization. <a href=https://github.com/ClickHouse/ClickHouse/pull/6596 rel="external nofollow noreferrer">#6596</a>, <a href=https://github.com/ClickHouse/ClickHouse/pull/6662 rel="external nofollow noreferrer">#6662</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>New function <code>neighbor(value, offset[, default_value])</code>. Allows to reach prev/next value within column in a block of data. <a href=https://github.com/ClickHouse/ClickHouse/pull/5925 rel="external nofollow noreferrer">#5925</a> (<a href=https://github.com/alex-krash rel="external nofollow noreferrer">Alex Krash</a>) <a href=https://github.com/ClickHouse/ClickHouse/commit/6685365ab8c5b74f9650492c88a012596eb1b0c6 rel="external nofollow noreferrer">6685365ab8c5b74f9650492c88a012596eb1b0c6</a> <a href=https://github.com/ClickHouse/ClickHouse/commit/341e2e4587a18065c2da1ca888c73389f48ce36c rel="external nofollow noreferrer">341e2e4587a18065c2da1ca888c73389f48ce36c</a> <a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">Alexey Milovidov</a></li> <li>Created a function <code>currentUser()</code>, returning login of authorized user. Added alias <code>user()</code> for compatibility with MySQL. <a href=https://github.com/ClickHouse/ClickHouse/pull/6470 rel="external nofollow noreferrer">#6470</a> (<a href=https://github.com/alex-krash rel="external nofollow noreferrer">Alex Krash</a>)</li> <li>New aggregate functions <code>quantilesExactInclusive</code> and <code>quantilesExactExclusive</code> which were proposed in <a href=https://github.com/ClickHouse/ClickHouse/issues/5885 rel="external nofollow noreferrer">#5885</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6477 rel="external nofollow noreferrer">#6477</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Function <code>bitmapRange(bitmap, range_begin, range_end)</code> which returns new set with specified range (not include the <code>range_end</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/6314 rel="external nofollow noreferrer">#6314</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang Yu</a>)</li> <li>Function <code>geohashesInBox(longitude_min, latitude_min, longitude_max, latitude_max, precision)</code> which creates array of precision-long strings of geohash-boxes covering provided area. <a href=https://github.com/ClickHouse/ClickHouse/pull/6127 rel="external nofollow noreferrer">#6127</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Implement support for INSERT query with <code>Kafka</code> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/6012 rel="external nofollow noreferrer">#6012</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Added support for <code>_partition</code> and <code>_timestamp</code> virtual columns to Kafka engine. <a href=https://github.com/ClickHouse/ClickHouse/pull/6400 rel="external nofollow noreferrer">#6400</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Possibility to remove sensitive data from <code>query_log</code>, server logs, process list with regexp-based rules. <a href=https://github.com/ClickHouse/ClickHouse/pull/5710 rel="external nofollow noreferrer">#5710</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> </ul> <h3 id=experimental-feature_1>Experimental Feature<a class=headerlink href=#experimental-feature_1 title="Permanent link">&para;</a></h3> <ul> <li>Input and output data format <code>Template</code>. It allows to specify custom format string for input and output. <a href=https://github.com/ClickHouse/ClickHouse/issues/4354 rel="external nofollow noreferrer">#4354</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6727 rel="external nofollow noreferrer">#6727</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Implementation of <code>LIVE VIEW</code> tables that were originally proposed in <a href=https://github.com/ClickHouse/ClickHouse/pull/2898 rel="external nofollow noreferrer">#2898</a>, prepared in <a href=https://github.com/ClickHouse/ClickHouse/issues/3925 rel="external nofollow noreferrer">#3925</a>, and then updated in <a href=https://github.com/ClickHouse/ClickHouse/issues/5541 rel="external nofollow noreferrer">#5541</a>. See <a href=https://github.com/ClickHouse/ClickHouse/issues/5541 rel="external nofollow noreferrer">#5541</a> for detailed description. <a href=https://github.com/ClickHouse/ClickHouse/issues/5541 rel="external nofollow noreferrer">#5541</a> (<a href=https://github.com/vzakaznikov rel="external nofollow noreferrer">vzakaznikov</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6425 rel="external nofollow noreferrer">#6425</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6656 rel="external nofollow noreferrer">#6656</a> (<a href=https://github.com/vzakaznikov rel="external nofollow noreferrer">vzakaznikov</a>) Note that <code>LIVE VIEW</code> feature may be removed in next versions.</li> </ul> <h3 id=bug-fix_6>Bug Fix<a class=headerlink href=#bug-fix_6 title="Permanent link">&para;</a></h3> <ul> <li>This release also contains all bug fixes from 19.13 and 19.11.</li> <li>Fix segmentation fault when the table has skip indices and vertical merge happens. <a href=https://github.com/ClickHouse/ClickHouse/pull/6723 rel="external nofollow noreferrer">#6723</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix per-column TTL with non-trivial column defaults. Previously in case of force TTL merge with <code>OPTIMIZE ... FINAL</code> query, expired values was replaced by type defaults instead of user-specified column defaults. <a href=https://github.com/ClickHouse/ClickHouse/pull/6796 rel="external nofollow noreferrer">#6796</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fix Kafka messages duplication problem on normal server restart. <a href=https://github.com/ClickHouse/ClickHouse/pull/6597 rel="external nofollow noreferrer">#6597</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fixed infinite loop when reading Kafka messages. Do not pause/resume consumer on subscription at all - otherwise it may get paused indefinitely in some scenarios. <a href=https://github.com/ClickHouse/ClickHouse/pull/6354 rel="external nofollow noreferrer">#6354</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fix <code>Key expression contains comparison between inconvertible types</code> exception in <code>bitmapContains</code> function. <a href=https://github.com/ClickHouse/ClickHouse/issues/6136 rel="external nofollow noreferrer">#6136</a> <a href=https://github.com/ClickHouse/ClickHouse/issues/6146 rel="external nofollow noreferrer">#6146</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6156 rel="external nofollow noreferrer">#6156</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Fix segfault with enabled <code>optimize_skip_unused_shards</code> and missing sharding key. <a href=https://github.com/ClickHouse/ClickHouse/pull/6384 rel="external nofollow noreferrer">#6384</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fixed wrong code in mutations that may lead to memory corruption. Fixed segfault with read of address <code>0x14c0</code> that may happed due to concurrent <code>DROP TABLE</code> and <code>SELECT</code> from <code>system.parts</code> or <code>system.parts_columns</code>. Fixed race condition in preparation of mutation queries. Fixed deadlock caused by <code>OPTIMIZE</code> of Replicated tables and concurrent modification operations like ALTERs. <a href=https://github.com/ClickHouse/ClickHouse/pull/6514 rel="external nofollow noreferrer">#6514</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Removed extra verbose logging in MySQL interface <a href=https://github.com/ClickHouse/ClickHouse/pull/6389 rel="external nofollow noreferrer">#6389</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Return ability to parse boolean settings from 'true' and 'false' in configuration file. <a href=https://github.com/ClickHouse/ClickHouse/pull/6278 rel="external nofollow noreferrer">#6278</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix crash in <code>quantile</code> and <code>median</code> function over <code>Nullable(Decimal128)</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6378 rel="external nofollow noreferrer">#6378</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed possible incomplete result returned by <code>SELECT</code> query with <code>WHERE</code> condition on primary key contained conversion to Float type. It was caused by incorrect checking of monotonicity in <code>toFloat</code> function. <a href=https://github.com/ClickHouse/ClickHouse/issues/6248 rel="external nofollow noreferrer">#6248</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6374 rel="external nofollow noreferrer">#6374</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Check <code>max_expanded_ast_elements</code> setting for mutations. Clear mutations after <code>TRUNCATE TABLE</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6205 rel="external nofollow noreferrer">#6205</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Fix JOIN results for key columns when used with <code>join_use_nulls</code>. Attach Nulls instead of columns defaults. <a href=https://github.com/ClickHouse/ClickHouse/pull/6249 rel="external nofollow noreferrer">#6249</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix for skip indices with vertical merge and alter. Fix for <code>Bad size of marks file</code> exception. <a href=https://github.com/ClickHouse/ClickHouse/issues/6594 rel="external nofollow noreferrer">#6594</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6713 rel="external nofollow noreferrer">#6713</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix rare crash in <code>ALTER MODIFY COLUMN</code> and vertical merge when one of merged/altered parts is empty (0 rows) <a href=https://github.com/ClickHouse/ClickHouse/issues/6746 rel="external nofollow noreferrer">#6746</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6780 rel="external nofollow noreferrer">#6780</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed bug in conversion of <code>LowCardinality</code> types in <code>AggregateFunctionFactory</code>. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/6257 rel="external nofollow noreferrer">#6257</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6281 rel="external nofollow noreferrer">#6281</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix wrong behavior and possible segfaults in <code>topK</code> and <code>topKWeighted</code> aggregated functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/6404 rel="external nofollow noreferrer">#6404</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fixed unsafe code around <code>getIdentifier</code> function. <a href=https://github.com/ClickHouse/ClickHouse/issues/6401 rel="external nofollow noreferrer">#6401</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6409 rel="external nofollow noreferrer">#6409</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed bug in MySQL wire protocol (is used while connecting to ClickHouse form MySQL client). Caused by heap buffer overflow in <code>PacketPayloadWriteBuffer</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6212 rel="external nofollow noreferrer">#6212</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Fixed memory leak in <code>bitmapSubsetInRange</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/6819 rel="external nofollow noreferrer">#6819</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang Yu</a>)</li> <li>Fix rare bug when mutation executed after granularity change. <a href=https://github.com/ClickHouse/ClickHouse/pull/6816 rel="external nofollow noreferrer">#6816</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Allow protobuf message with all fields by default. <a href=https://github.com/ClickHouse/ClickHouse/pull/6132 rel="external nofollow noreferrer">#6132</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Resolve a bug with <code>nullIf</code> function when we send a <code>NULL</code> argument on the second argument. <a href=https://github.com/ClickHouse/ClickHouse/pull/6446 rel="external nofollow noreferrer">#6446</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Fix rare bug with wrong memory allocation/deallocation in complex key cache dictionaries with string fields which leads to infinite memory consumption (looks like memory leak). Bug reproduces when string size was a power of two starting from eight (8, 16, 32, etc). <a href=https://github.com/ClickHouse/ClickHouse/pull/6447 rel="external nofollow noreferrer">#6447</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed Gorilla encoding on small sequences which caused exception <code>Cannot write after end of buffer</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/6398 rel="external nofollow noreferrer">#6398</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6444 rel="external nofollow noreferrer">#6444</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Allow to use not nullable types in JOINs with <code>join_use_nulls</code> enabled. <a href=https://github.com/ClickHouse/ClickHouse/pull/6705 rel="external nofollow noreferrer">#6705</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Disable <code>Poco::AbstractConfiguration</code> substitutions in query in <code>clickhouse-client</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6706 rel="external nofollow noreferrer">#6706</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Avoid deadlock in <code>REPLACE PARTITION</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6677 rel="external nofollow noreferrer">#6677</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Using <code>arrayReduce</code> for constant arguments may lead to segfault. <a href=https://github.com/ClickHouse/ClickHouse/issues/6242 rel="external nofollow noreferrer">#6242</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6326 rel="external nofollow noreferrer">#6326</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix inconsistent parts which can appear if replica was restored after <code>DROP PARTITION</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/6522 rel="external nofollow noreferrer">#6522</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6523 rel="external nofollow noreferrer">#6523</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Fixed hang in <code>JSONExtractRaw</code> function. <a href=https://github.com/ClickHouse/ClickHouse/issues/6195 rel="external nofollow noreferrer">#6195</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6198 rel="external nofollow noreferrer">#6198</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix bug with incorrect skip indices serialization and aggregation with adaptive granularity. <a href=https://github.com/ClickHouse/ClickHouse/issues/6594 rel="external nofollow noreferrer">#6594</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6748 rel="external nofollow noreferrer">#6748</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix <code>WITH ROLLUP</code> and <code>WITH CUBE</code> modifiers of <code>GROUP BY</code> with two-level aggregation. <a href=https://github.com/ClickHouse/ClickHouse/pull/6225 rel="external nofollow noreferrer">#6225</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fix bug with writing secondary indices marks with adaptive granularity. <a href=https://github.com/ClickHouse/ClickHouse/pull/6126 rel="external nofollow noreferrer">#6126</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix initialization order while server startup. Since <code>StorageMergeTree::background_task_handle</code> is initialized in <code>startup()</code> the <code>MergeTreeBlockOutputStream::write()</code> may try to use it before initialization. Just check if it is initialized. <a href=https://github.com/ClickHouse/ClickHouse/pull/6080 rel="external nofollow noreferrer">#6080</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Clearing the data buffer from the previous read operation that was completed with an error. <a href=https://github.com/ClickHouse/ClickHouse/pull/6026 rel="external nofollow noreferrer">#6026</a> (<a href=https://github.com/bopohaa rel="external nofollow noreferrer">Nikolay</a>)</li> <li>Fix bug with enabling adaptive granularity when creating new replica for Replicated*MergeTree table. <a href=https://github.com/ClickHouse/ClickHouse/issues/6394 rel="external nofollow noreferrer">#6394</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6452 rel="external nofollow noreferrer">#6452</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed possible crash during server startup in case of exception happened in <code>libunwind</code> during exception at access to uninitialised <code>ThreadStatus</code> structure. <a href=https://github.com/ClickHouse/ClickHouse/pull/6456 rel="external nofollow noreferrer">#6456</a> (<a href=https://github.com/nikitamikhaylov rel="external nofollow noreferrer">Nikita Mikhaylov</a>)</li> <li>Fix crash in <code>yandexConsistentHash</code> function. Found by fuzz test. <a href=https://github.com/ClickHouse/ClickHouse/issues/6304 rel="external nofollow noreferrer">#6304</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6305 rel="external nofollow noreferrer">#6305</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed the possibility of hanging queries when server is overloaded and global thread pool becomes near full. This have higher chance to happen on clusters with large number of shards (hundreds), because distributed queries allocate a thread per connection to each shard. For example, this issue may reproduce if a cluster of 330 shards is processing 30 concurrent distributed queries. This issue affects all versions starting from 19.2. <a href=https://github.com/ClickHouse/ClickHouse/pull/6301 rel="external nofollow noreferrer">#6301</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed logic of <code>arrayEnumerateUniqRanked</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/6423 rel="external nofollow noreferrer">#6423</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix segfault when decoding symbol table. <a href=https://github.com/ClickHouse/ClickHouse/pull/6603 rel="external nofollow noreferrer">#6603</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Fixed irrelevant exception in cast of <code>LowCardinality(Nullable)</code> to not-Nullable column in case if it doesn't contain Nulls (e.g. in query like <code>SELECT CAST(CAST('Hello' AS LowCardinality(Nullable(String))) AS String)</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/6094 rel="external nofollow noreferrer">#6094</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6119 rel="external nofollow noreferrer">#6119</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Removed extra quoting of description in <code>system.settings</code> table. <a href=https://github.com/ClickHouse/ClickHouse/issues/6696 rel="external nofollow noreferrer">#6696</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6699 rel="external nofollow noreferrer">#6699</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Avoid possible deadlock in <code>TRUNCATE</code> of Replicated table. <a href=https://github.com/ClickHouse/ClickHouse/pull/6695 rel="external nofollow noreferrer">#6695</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix reading in order of sorting key. <a href=https://github.com/ClickHouse/ClickHouse/pull/6189 rel="external nofollow noreferrer">#6189</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fix <code>ALTER TABLE ... UPDATE</code> query for tables with <code>enable_mixed_granularity_parts=1</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6543 rel="external nofollow noreferrer">#6543</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix bug opened by <a href=https://github.com/ClickHouse/ClickHouse/pull/4405 rel="external nofollow noreferrer">#4405</a> (since 19.4.0). Reproduces in queries to Distributed tables over MergeTree tables when we doesn't query any columns (<code>SELECT 1</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/6236 rel="external nofollow noreferrer">#6236</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed overflow in integer division of signed type to unsigned type. The behaviour was exactly as in C or C++ language (integer promotion rules) that may be surprising. Please note that the overflow is still possible when dividing large signed number to large unsigned number or vice-versa (but that case is less usual). The issue existed in all server versions. <a href=https://github.com/ClickHouse/ClickHouse/issues/6214 rel="external nofollow noreferrer">#6214</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6233 rel="external nofollow noreferrer">#6233</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Limit maximum sleep time for throttling when <code>max_execution_speed</code> or <code>max_execution_speed_bytes</code> is set. Fixed false errors like <code>Estimated query execution time (inf seconds) is too long</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/5547 rel="external nofollow noreferrer">#5547</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6232 rel="external nofollow noreferrer">#6232</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed issues about using <code>MATERIALIZED</code> columns and aliases in <code>MaterializedView</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/448 rel="external nofollow noreferrer">#448</a> <a href=https://github.com/ClickHouse/ClickHouse/issues/3484 rel="external nofollow noreferrer">#3484</a> <a href=https://github.com/ClickHouse/ClickHouse/issues/3450 rel="external nofollow noreferrer">#3450</a> <a href=https://github.com/ClickHouse/ClickHouse/issues/2878 rel="external nofollow noreferrer">#2878</a> <a href=https://github.com/ClickHouse/ClickHouse/issues/2285 rel="external nofollow noreferrer">#2285</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3796 rel="external nofollow noreferrer">#3796</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6316 rel="external nofollow noreferrer">#6316</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix <code>FormatFactory</code> behaviour for input streams which are not implemented as processor. <a href=https://github.com/ClickHouse/ClickHouse/pull/6495 rel="external nofollow noreferrer">#6495</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fixed typo. <a href=https://github.com/ClickHouse/ClickHouse/pull/6631 rel="external nofollow noreferrer">#6631</a> (<a href=https://github.com/alexryndin rel="external nofollow noreferrer">Alex Ryndin</a>)</li> <li>Typo in the error message ( is -&gt; are ). <a href=https://github.com/ClickHouse/ClickHouse/pull/6839 rel="external nofollow noreferrer">#6839</a> (<a href=https://github.com/den-crane rel="external nofollow noreferrer">Denis Zhuravlev</a>)</li> <li>Fixed error while parsing of columns list from string if type contained a comma (this issue was relevant for <code>File</code>, <code>URL</code>, <code>HDFS</code> storages) <a href=https://github.com/ClickHouse/ClickHouse/issues/6217 rel="external nofollow noreferrer">#6217</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6209 rel="external nofollow noreferrer">#6209</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> </ul> <h3 id=security-fix>Security Fix<a class=headerlink href=#security-fix title="Permanent link">&para;</a></h3> <ul> <li>This release also contains all bug security fixes from 19.13 and 19.11.</li> <li>Fixed the possibility of a fabricated query to cause server crash due to stack overflow in SQL parser. Fixed the possibility of stack overflow in Merge and Distributed tables, materialized views and conditions for row-level security that involve subqueries. <a href=https://github.com/ClickHouse/ClickHouse/pull/6433 rel="external nofollow noreferrer">#6433</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=improvement_2>Improvement<a class=headerlink href=#improvement_2 title="Permanent link">&para;</a></h3> <ul> <li>Correct implementation of ternary logic for <code>AND/OR</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6048 rel="external nofollow noreferrer">#6048</a> (<a href=https://github.com/Akazz rel="external nofollow noreferrer">Alexander Kazakov</a>)</li> <li>Now values and rows with expired TTL will be removed after <code>OPTIMIZE ... FINAL</code> query from old parts without TTL infos or with outdated TTL infos, e.g. after <code>ALTER ... MODIFY TTL</code> query. Added queries <code>SYSTEM STOP/START TTL MERGES</code> to disallow/allow assign merges with TTL and filter expired values in all merges. <a href=https://github.com/ClickHouse/ClickHouse/pull/6274 rel="external nofollow noreferrer">#6274</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Possibility to change the location of ClickHouse history file for client using <code>CLICKHOUSE_HISTORY_FILE</code> env. <a href=https://github.com/ClickHouse/ClickHouse/pull/6840 rel="external nofollow noreferrer">#6840</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Remove <code>dry_run</code> flag from <code>InterpreterSelectQuery</code>. ... <a href=https://github.com/ClickHouse/ClickHouse/pull/6375 rel="external nofollow noreferrer">#6375</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Support <code>ASOF JOIN</code> with <code>ON</code> section. <a href=https://github.com/ClickHouse/ClickHouse/pull/6211 rel="external nofollow noreferrer">#6211</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Better support of skip indexes for mutations and replication. Support for <code>MATERIALIZE/CLEAR INDEX ... IN PARTITION</code> query. <code>UPDATE x = x</code> recalculates all indices that use column <code>x</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5053 rel="external nofollow noreferrer">#5053</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Allow to <code>ATTACH</code> live views (for example, at the server startup) regardless to <code>allow_experimental_live_view</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/6754 rel="external nofollow noreferrer">#6754</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>For stack traces gathered by query profiler, do not include stack frames generated by the query profiler itself. <a href=https://github.com/ClickHouse/ClickHouse/pull/6250 rel="external nofollow noreferrer">#6250</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Now table functions <code>values</code>, <code>file</code>, <code>url</code>, <code>hdfs</code> have support for ALIAS columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/6255 rel="external nofollow noreferrer">#6255</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Throw an exception if <code>config.d</code> file doesn't have the corresponding root element as the config file. <a href=https://github.com/ClickHouse/ClickHouse/pull/6123 rel="external nofollow noreferrer">#6123</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Print extra info in exception message for <code>no space left on device</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/6182 rel="external nofollow noreferrer">#6182</a>, <a href=https://github.com/ClickHouse/ClickHouse/issues/6252 rel="external nofollow noreferrer">#6252</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6352 rel="external nofollow noreferrer">#6352</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>When determining shards of a <code>Distributed</code> table to be covered by a read query (for <code>optimize_skip_unused_shards</code> = 1) ClickHouse now checks conditions from both <code>prewhere</code> and <code>where</code> clauses of select statement. <a href=https://github.com/ClickHouse/ClickHouse/pull/6521 rel="external nofollow noreferrer">#6521</a> (<a href=https://github.com/Akazz rel="external nofollow noreferrer">Alexander Kazakov</a>)</li> <li>Enabled <code>SIMDJSON</code> for machines without AVX2 but with SSE 4.2 and PCLMUL instruction set. <a href=https://github.com/ClickHouse/ClickHouse/issues/6285 rel="external nofollow noreferrer">#6285</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6320 rel="external nofollow noreferrer">#6320</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>ClickHouse can work on filesystems without <code>O_DIRECT</code> support (such as ZFS and BtrFS) without additional tuning. <a href=https://github.com/ClickHouse/ClickHouse/issues/4449 rel="external nofollow noreferrer">#4449</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6730 rel="external nofollow noreferrer">#6730</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Support push down predicate for final subquery. <a href=https://github.com/ClickHouse/ClickHouse/pull/6120 rel="external nofollow noreferrer">#6120</a> (<a href=https://github.com/TCeason rel="external nofollow noreferrer">TCeason</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6162 rel="external nofollow noreferrer">#6162</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Better <code>JOIN ON</code> keys extraction <a href=https://github.com/ClickHouse/ClickHouse/pull/6131 rel="external nofollow noreferrer">#6131</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Upated <code>SIMDJSON</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/6285 rel="external nofollow noreferrer">#6285</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6306 rel="external nofollow noreferrer">#6306</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Optimize selecting of smallest column for <code>SELECT count()</code> query. <a href=https://github.com/ClickHouse/ClickHouse/pull/6344 rel="external nofollow noreferrer">#6344</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Added <code>strict</code> parameter in <code>windowFunnel()</code>. When the <code>strict</code> is set, the <code>windowFunnel()</code> applies conditions only for the unique values. <a href=https://github.com/ClickHouse/ClickHouse/pull/6548 rel="external nofollow noreferrer">#6548</a> (<a href=https://github.com/achimbab rel="external nofollow noreferrer">achimbab</a>)</li> <li>Safer interface of <code>mysqlxx::Pool</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6150 rel="external nofollow noreferrer">#6150</a> (<a href=https://github.com/avasiliev rel="external nofollow noreferrer">avasiliev</a>)</li> <li>Options line size when executing with <code>--help</code> option now corresponds with terminal size. <a href=https://github.com/ClickHouse/ClickHouse/pull/6590 rel="external nofollow noreferrer">#6590</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Disable "read in order" optimization for aggregation without keys. <a href=https://github.com/ClickHouse/ClickHouse/pull/6599 rel="external nofollow noreferrer">#6599</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>HTTP status code for <code>INCORRECT_DATA</code> and <code>TYPE_MISMATCH</code> error codes was changed from default <code>500 Internal Server Error</code> to <code>400 Bad Request</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6271 rel="external nofollow noreferrer">#6271</a> (<a href=https://github.com/a-rodin rel="external nofollow noreferrer">Alexander Rodin</a>)</li> <li>Move Join object from <code>ExpressionAction</code> into <code>AnalyzedJoin</code>. <code>ExpressionAnalyzer</code> and <code>ExpressionAction</code> do not know about <code>Join</code> class anymore. Its logic is hidden by <code>AnalyzedJoin</code> iface. <a href=https://github.com/ClickHouse/ClickHouse/pull/6801 rel="external nofollow noreferrer">#6801</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed possible deadlock of distributed queries when one of shards is localhost but the query is sent via network connection. <a href=https://github.com/ClickHouse/ClickHouse/pull/6759 rel="external nofollow noreferrer">#6759</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Changed semantic of multiple tables <code>RENAME</code> to avoid possible deadlocks. <a href=https://github.com/ClickHouse/ClickHouse/issues/6757 rel="external nofollow noreferrer">#6757</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6756 rel="external nofollow noreferrer">#6756</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Rewritten MySQL compatibility server to prevent loading full packet payload in memory. Decreased memory consumption for each connection to approximately <code>2 * DBMS_DEFAULT_BUFFER_SIZE</code> (read/write buffers). <a href=https://github.com/ClickHouse/ClickHouse/pull/5811 rel="external nofollow noreferrer">#5811</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Move AST alias interpreting logic out of parser that doesn't have to know anything about query semantics. <a href=https://github.com/ClickHouse/ClickHouse/pull/6108 rel="external nofollow noreferrer">#6108</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Slightly more safe parsing of <code>NamesAndTypesList</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/6408 rel="external nofollow noreferrer">#6408</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6410 rel="external nofollow noreferrer">#6410</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>clickhouse-copier</code>: Allow use <code>where_condition</code> from config with <code>partition_key</code> alias in query for checking partition existence (Earlier it was used only in reading data queries). <a href=https://github.com/ClickHouse/ClickHouse/pull/6577 rel="external nofollow noreferrer">#6577</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Added optional message argument in <code>throwIf</code>. (<a href=https://github.com/ClickHouse/ClickHouse/issues/5772 rel="external nofollow noreferrer">#5772</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6329 rel="external nofollow noreferrer">#6329</a> (<a href=https://github.com/Vdimir rel="external nofollow noreferrer">Vdimir</a>)</li> <li>Server exception got while sending insertion data is now being processed in client as well. <a href=https://github.com/ClickHouse/ClickHouse/issues/5891 rel="external nofollow noreferrer">#5891</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6711 rel="external nofollow noreferrer">#6711</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Added a metric <code>DistributedFilesToInsert</code> that shows the total number of files in filesystem that are selected to send to remote servers by Distributed tables. The number is summed across all shards. <a href=https://github.com/ClickHouse/ClickHouse/pull/6600 rel="external nofollow noreferrer">#6600</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Move most of JOINs prepare logic from <code>ExpressionAction/ExpressionAnalyzer</code> to <code>AnalyzedJoin</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6785 rel="external nofollow noreferrer">#6785</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix TSan <a href=https://clickhouse-test-reports.s3.yandex.net/6399/c1c1d1daa98e199e620766f1bd06a5921050a00d/functional_stateful_tests_(thread).html rel="external nofollow noreferrer">warning</a> 'lock-order-inversion'. <a href=https://github.com/ClickHouse/ClickHouse/pull/6740 rel="external nofollow noreferrer">#6740</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Better information messages about lack of Linux capabilities. Logging fatal errors with "fatal" level, that will make it easier to find in <code>system.text_log</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6441 rel="external nofollow noreferrer">#6441</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>When enable dumping temporary data to the disk to restrict memory usage during <code>GROUP BY</code>, <code>ORDER BY</code>, it didn't check the free disk space. The fix add a new setting <code>min_free_disk_space</code>, when the free disk space it smaller then the threshold, the query will stop and throw <code>ErrorCodes::NOT_ENOUGH_SPACE</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6678 rel="external nofollow noreferrer">#6678</a> (<a href=https://github.com/weiqxu rel="external nofollow noreferrer">Weiqing Xu</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6691 rel="external nofollow noreferrer">#6691</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Removed recursive rwlock by thread. It makes no sense, because threads are reused between queries. <code>SELECT</code> query may acquire a lock in one thread, hold a lock from another thread and exit from first thread. In the same time, first thread can be reused by <code>DROP</code> query. This will lead to false "Attempt to acquire exclusive lock recursively" messages. <a href=https://github.com/ClickHouse/ClickHouse/pull/6771 rel="external nofollow noreferrer">#6771</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Split <code>ExpressionAnalyzer.appendJoin()</code>. Prepare a place in <code>ExpressionAnalyzer</code> for <code>MergeJoin</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6524 rel="external nofollow noreferrer">#6524</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Added <code>mysql_native_password</code> authentication plugin to MySQL compatibility server. <a href=https://github.com/ClickHouse/ClickHouse/pull/6194 rel="external nofollow noreferrer">#6194</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Less number of <code>clock_gettime</code> calls; fixed ABI compatibility between debug/release in <code>Allocator</code> (insignificant issue). <a href=https://github.com/ClickHouse/ClickHouse/pull/6197 rel="external nofollow noreferrer">#6197</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Move <code>collectUsedColumns</code> from <code>ExpressionAnalyzer</code> to <code>SyntaxAnalyzer</code>. <code>SyntaxAnalyzer</code> makes <code>required_source_columns</code> itself now. <a href=https://github.com/ClickHouse/ClickHouse/pull/6416 rel="external nofollow noreferrer">#6416</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Add setting <code>joined_subquery_requires_alias</code> to require aliases for subselects and table functions in <code>FROM</code> that more than one table is present (i.e. queries with JOINs). <a href=https://github.com/ClickHouse/ClickHouse/pull/6733 rel="external nofollow noreferrer">#6733</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Extract <code>GetAggregatesVisitor</code> class from <code>ExpressionAnalyzer</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6458 rel="external nofollow noreferrer">#6458</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li><code>system.query_log</code>: change data type of <code>type</code> column to <code>Enum</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6265 rel="external nofollow noreferrer">#6265</a> (<a href=https://github.com/nikitamikhaylov rel="external nofollow noreferrer">Nikita Mikhaylov</a>)</li> <li>Static linking of <code>sha256_password</code> authentication plugin. <a href=https://github.com/ClickHouse/ClickHouse/pull/6512 rel="external nofollow noreferrer">#6512</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Avoid extra dependency for the setting <code>compile</code> to work. In previous versions, the user may get error like <code>cannot open crti.o</code>, <code>unable to find library -lc</code> etc. <a href=https://github.com/ClickHouse/ClickHouse/pull/6309 rel="external nofollow noreferrer">#6309</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>More validation of the input that may come from malicious replica. <a href=https://github.com/ClickHouse/ClickHouse/pull/6303 rel="external nofollow noreferrer">#6303</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Now <code>clickhouse-obfuscator</code> file is available in <code>clickhouse-client</code> package. In previous versions it was available as <code>clickhouse obfuscator</code> (with whitespace). <a href=https://github.com/ClickHouse/ClickHouse/issues/5816 rel="external nofollow noreferrer">#5816</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6609 rel="external nofollow noreferrer">#6609</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Fixed deadlock when we have at least two queries that read at least two tables in different order and another query that performs DDL operation on one of tables. Fixed another very rare deadlock. <a href=https://github.com/ClickHouse/ClickHouse/pull/6764 rel="external nofollow noreferrer">#6764</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added <code>os_thread_ids</code> column to <code>system.processes</code> and <code>system.query_log</code> for better debugging possibilities. <a href=https://github.com/ClickHouse/ClickHouse/pull/6763 rel="external nofollow noreferrer">#6763</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>A workaround for PHP mysqlnd extension bugs which occur when <code>sha256_password</code> is used as a default authentication plugin (described in <a href=https://github.com/ClickHouse/ClickHouse/issues/6031 rel="external nofollow noreferrer">#6031</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/6113 rel="external nofollow noreferrer">#6113</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Remove unneeded place with changed nullability columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/6693 rel="external nofollow noreferrer">#6693</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Set default value of <code>queue_max_wait_ms</code> to zero, because current value (five seconds) makes no sense. There are rare circumstances when this settings has any use. Added settings <code>replace_running_query_max_wait_ms</code>, <code>kafka_max_wait_ms</code> and <code>connection_pool_max_wait_ms</code> for disambiguation. <a href=https://github.com/ClickHouse/ClickHouse/pull/6692 rel="external nofollow noreferrer">#6692</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Extract <code>SelectQueryExpressionAnalyzer</code> from <code>ExpressionAnalyzer</code>. Keep the last one for non-select queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/6499 rel="external nofollow noreferrer">#6499</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Removed duplicating input and output formats. <a href=https://github.com/ClickHouse/ClickHouse/pull/6239 rel="external nofollow noreferrer">#6239</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Allow user to override <code>poll_interval</code> and <code>idle_connection_timeout</code> settings on connection. <a href=https://github.com/ClickHouse/ClickHouse/pull/6230 rel="external nofollow noreferrer">#6230</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>MergeTree</code> now has an additional option <code>ttl_only_drop_parts</code> (disabled by default) to avoid partial pruning of parts, so that they dropped completely when all the rows in a part are expired. <a href=https://github.com/ClickHouse/ClickHouse/pull/6191 rel="external nofollow noreferrer">#6191</a> (<a href=https://github.com/svladykin rel="external nofollow noreferrer">Sergi Vladykin</a>)</li> <li>Type checks for set index functions. Throw exception if function got a wrong type. This fixes fuzz test with UBSan. <a href=https://github.com/ClickHouse/ClickHouse/pull/6511 rel="external nofollow noreferrer">#6511</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> </ul> <h3 id=performance-improvement_1>Performance Improvement<a class=headerlink href=#performance-improvement_1 title="Permanent link">&para;</a></h3> <ul> <li>Optimize queries with <code>ORDER BY expressions</code> clause, where <code>expressions</code> have coinciding prefix with sorting key in <code>MergeTree</code> tables. This optimization is controlled by <code>optimize_read_in_order</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/6054 rel="external nofollow noreferrer">#6054</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6629 rel="external nofollow noreferrer">#6629</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Allow to use multiple threads during parts loading and removal. <a href=https://github.com/ClickHouse/ClickHouse/issues/6372 rel="external nofollow noreferrer">#6372</a> <a href=https://github.com/ClickHouse/ClickHouse/issues/6074 rel="external nofollow noreferrer">#6074</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6438 rel="external nofollow noreferrer">#6438</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Implemented batch variant of updating aggregate function states. It may lead to performance benefits. <a href=https://github.com/ClickHouse/ClickHouse/pull/6435 rel="external nofollow noreferrer">#6435</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Using <code>FastOps</code> library for functions <code>exp</code>, <code>log</code>, <code>sigmoid</code>, <code>tanh</code>. FastOps is a fast vector math library from Michael Parakhin (Yandex CTO). Improved performance of <code>exp</code> and <code>log</code> functions more than 6 times. The functions <code>exp</code> and <code>log</code> from <code>Float32</code> argument will return <code>Float32</code> (in previous versions they always return <code>Float64</code>). Now <code>exp(nan)</code> may return <code>inf</code>. The result of <code>exp</code> and <code>log</code> functions may be not the nearest machine representable number to the true answer. <a href=https://github.com/ClickHouse/ClickHouse/pull/6254 rel="external nofollow noreferrer">#6254</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>) Using Danila Kutenin variant to make fastops working <a href=https://github.com/ClickHouse/ClickHouse/pull/6317 rel="external nofollow noreferrer">#6317</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Disable consecutive key optimization for <code>UInt8/16</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6298 rel="external nofollow noreferrer">#6298</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6701 rel="external nofollow noreferrer">#6701</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Improved performance of <code>simdjson</code> library by getting rid of dynamic allocation in <code>ParsedJson::Iterator</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6479 rel="external nofollow noreferrer">#6479</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Pre-fault pages when allocating memory with <code>mmap()</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6667 rel="external nofollow noreferrer">#6667</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Fix performance bug in <code>Decimal</code> comparison. <a href=https://github.com/ClickHouse/ClickHouse/pull/6380 rel="external nofollow noreferrer">#6380</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_3>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_3 title="Permanent link">&para;</a></h3> <ul> <li>Remove Compiler (runtime template instantiation) because we've win over it's performance. <a href=https://github.com/ClickHouse/ClickHouse/pull/6646 rel="external nofollow noreferrer">#6646</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added performance test to show degradation of performance in gcc-9 in more isolated way. <a href=https://github.com/ClickHouse/ClickHouse/pull/6302 rel="external nofollow noreferrer">#6302</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added table function <code>numbers_mt</code>, which is multithreaded version of <code>numbers</code>. Updated performance tests with hash functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/6554 rel="external nofollow noreferrer">#6554</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Comparison mode in <code>clickhouse-benchmark</code> <a href=https://github.com/ClickHouse/ClickHouse/issues/6220 rel="external nofollow noreferrer">#6220</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6343 rel="external nofollow noreferrer">#6343</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Best effort for printing stack traces. Also added <code>SIGPROF</code> as a debugging signal to print stack trace of a running thread. <a href=https://github.com/ClickHouse/ClickHouse/pull/6529 rel="external nofollow noreferrer">#6529</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Every function in its own file, part 10. <a href=https://github.com/ClickHouse/ClickHouse/pull/6321 rel="external nofollow noreferrer">#6321</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Remove doubled const <code>TABLE_IS_READ_ONLY</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6566 rel="external nofollow noreferrer">#6566</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Formatting changes for <code>StringHashMap</code> PR <a href=https://github.com/ClickHouse/ClickHouse/issues/5417 rel="external nofollow noreferrer">#5417</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6700 rel="external nofollow noreferrer">#6700</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Better subquery for join creation in <code>ExpressionAnalyzer</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6824 rel="external nofollow noreferrer">#6824</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Remove a redundant condition (found by PVS Studio). <a href=https://github.com/ClickHouse/ClickHouse/pull/6775 rel="external nofollow noreferrer">#6775</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Separate the hash table interface for <code>ReverseIndex</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6672 rel="external nofollow noreferrer">#6672</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Refactoring of settings. <a href=https://github.com/ClickHouse/ClickHouse/pull/6689 rel="external nofollow noreferrer">#6689</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Add comments for <code>set</code> index functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/6319 rel="external nofollow noreferrer">#6319</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Increase OOM score in debug version on Linux. <a href=https://github.com/ClickHouse/ClickHouse/pull/6152 rel="external nofollow noreferrer">#6152</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>HDFS HA now work in debug build. <a href=https://github.com/ClickHouse/ClickHouse/pull/6650 rel="external nofollow noreferrer">#6650</a> (<a href=https://github.com/weiqxu rel="external nofollow noreferrer">Weiqing Xu</a>)</li> <li>Added a test to <code>transform_query_for_external_database</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6388 rel="external nofollow noreferrer">#6388</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Add test for multiple materialized views for Kafka table. <a href=https://github.com/ClickHouse/ClickHouse/pull/6509 rel="external nofollow noreferrer">#6509</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Make a better build scheme. <a href=https://github.com/ClickHouse/ClickHouse/pull/6500 rel="external nofollow noreferrer">#6500</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fixed <code>test_external_dictionaries</code> integration in case it was executed under non root user. <a href=https://github.com/ClickHouse/ClickHouse/pull/6507 rel="external nofollow noreferrer">#6507</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>The bug reproduces when total size of written packets exceeds <code>DBMS_DEFAULT_BUFFER_SIZE</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6204 rel="external nofollow noreferrer">#6204</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Added a test for <code>RENAME</code> table race condition <a href=https://github.com/ClickHouse/ClickHouse/pull/6752 rel="external nofollow noreferrer">#6752</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Avoid data race on Settings in <code>KILL QUERY</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6753 rel="external nofollow noreferrer">#6753</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Add integration test for handling errors by a cache dictionary. <a href=https://github.com/ClickHouse/ClickHouse/pull/6755 rel="external nofollow noreferrer">#6755</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Disable parsing of ELF object files on Mac OS, because it makes no sense. <a href=https://github.com/ClickHouse/ClickHouse/pull/6578 rel="external nofollow noreferrer">#6578</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Attempt to make changelog generator better. <a href=https://github.com/ClickHouse/ClickHouse/pull/6327 rel="external nofollow noreferrer">#6327</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Adding <code>-Wshadow</code> switch to the GCC. <a href=https://github.com/ClickHouse/ClickHouse/pull/6325 rel="external nofollow noreferrer">#6325</a> (<a href=https://github.com/kreuzerkrieg rel="external nofollow noreferrer">kreuzerkrieg</a>)</li> <li>Removed obsolete code for <code>mimalloc</code> support. <a href=https://github.com/ClickHouse/ClickHouse/pull/6715 rel="external nofollow noreferrer">#6715</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>zlib-ng</code> determines x86 capabilities and saves this info to global variables. This is done in defalteInit call, which may be made by different threads simultaneously. To avoid multithreaded writes, do it on library startup. <a href=https://github.com/ClickHouse/ClickHouse/pull/6141 rel="external nofollow noreferrer">#6141</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Regression test for a bug which in join which was fixed in <a href=https://github.com/ClickHouse/ClickHouse/issues/5192 rel="external nofollow noreferrer">#5192</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6147 rel="external nofollow noreferrer">#6147</a> (<a href=https://github.com/theruziev rel="external nofollow noreferrer">Bakhtiyor Ruziev</a>)</li> <li>Fixed MSan report. <a href=https://github.com/ClickHouse/ClickHouse/pull/6144 rel="external nofollow noreferrer">#6144</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix flapping TTL test. <a href=https://github.com/ClickHouse/ClickHouse/pull/6782 rel="external nofollow noreferrer">#6782</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fixed false data race in <code>MergeTreeDataPart::is_frozen</code> field. <a href=https://github.com/ClickHouse/ClickHouse/pull/6583 rel="external nofollow noreferrer">#6583</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed timeouts in fuzz test. In previous version, it managed to find false hangup in query <code>SELECT * FROM numbers_mt(gccMurmurHash(''))</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6582 rel="external nofollow noreferrer">#6582</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added debug checks to <code>static_cast</code> of columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/6581 rel="external nofollow noreferrer">#6581</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Support for Oracle Linux in official RPM packages. <a href=https://github.com/ClickHouse/ClickHouse/issues/6356 rel="external nofollow noreferrer">#6356</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6585 rel="external nofollow noreferrer">#6585</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Changed json perftests from <code>once</code> to <code>loop</code> type. <a href=https://github.com/ClickHouse/ClickHouse/pull/6536 rel="external nofollow noreferrer">#6536</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li><code>odbc-bridge.cpp</code> defines <code>main()</code> so it should not be included in <code>clickhouse-lib</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6538 rel="external nofollow noreferrer">#6538</a> (<a href=https://github.com/orivej rel="external nofollow noreferrer">Orivej Desh</a>)</li> <li>Test for crash in <code>FULL|RIGHT JOIN</code> with nulls in right table's keys. <a href=https://github.com/ClickHouse/ClickHouse/pull/6362 rel="external nofollow noreferrer">#6362</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Added a test for the limit on expansion of aliases just in case. <a href=https://github.com/ClickHouse/ClickHouse/pull/6442 rel="external nofollow noreferrer">#6442</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Switched from <code>boost::filesystem</code> to <code>std::filesystem</code> where appropriate. <a href=https://github.com/ClickHouse/ClickHouse/pull/6253 rel="external nofollow noreferrer">#6253</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6385 rel="external nofollow noreferrer">#6385</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added RPM packages to website. <a href=https://github.com/ClickHouse/ClickHouse/pull/6251 rel="external nofollow noreferrer">#6251</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Add a test for fixed <code>Unknown identifier</code> exception in <code>IN</code> section. <a href=https://github.com/ClickHouse/ClickHouse/pull/6708 rel="external nofollow noreferrer">#6708</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Simplify <code>shared_ptr_helper</code> because people facing difficulties understanding it. <a href=https://github.com/ClickHouse/ClickHouse/pull/6675 rel="external nofollow noreferrer">#6675</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added performance tests for fixed Gorilla and DoubleDelta codec. <a href=https://github.com/ClickHouse/ClickHouse/pull/6179 rel="external nofollow noreferrer">#6179</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Split the integration test <code>test_dictionaries</code> into 4 separate tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/6776 rel="external nofollow noreferrer">#6776</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fix PVS-Studio warning in <code>PipelineExecutor</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6777 rel="external nofollow noreferrer">#6777</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Allow to use <code>library</code> dictionary source with ASan. <a href=https://github.com/ClickHouse/ClickHouse/pull/6482 rel="external nofollow noreferrer">#6482</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added option to generate changelog from a list of PRs. <a href=https://github.com/ClickHouse/ClickHouse/pull/6350 rel="external nofollow noreferrer">#6350</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Lock the <code>TinyLog</code> storage when reading. <a href=https://github.com/ClickHouse/ClickHouse/pull/6226 rel="external nofollow noreferrer">#6226</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Check for broken symlinks in CI. <a href=https://github.com/ClickHouse/ClickHouse/pull/6634 rel="external nofollow noreferrer">#6634</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Increase timeout for "stack overflow" test because it may take a long time in debug build. <a href=https://github.com/ClickHouse/ClickHouse/pull/6637 rel="external nofollow noreferrer">#6637</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added a check for double whitespaces. <a href=https://github.com/ClickHouse/ClickHouse/pull/6643 rel="external nofollow noreferrer">#6643</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix <code>new/delete</code> memory tracking when build with sanitizers. Tracking is not clear. It only prevents memory limit exceptions in tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/6450 rel="external nofollow noreferrer">#6450</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Enable back the check of undefined symbols while linking. <a href=https://github.com/ClickHouse/ClickHouse/pull/6453 rel="external nofollow noreferrer">#6453</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Avoid rebuilding <code>hyperscan</code> every day. <a href=https://github.com/ClickHouse/ClickHouse/pull/6307 rel="external nofollow noreferrer">#6307</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed UBSan report in <code>ProtobufWriter</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6163 rel="external nofollow noreferrer">#6163</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Don't allow to use query profiler with sanitizers because it is not compatible. <a href=https://github.com/ClickHouse/ClickHouse/pull/6769 rel="external nofollow noreferrer">#6769</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Add test for reloading a dictionary after fail by timer. <a href=https://github.com/ClickHouse/ClickHouse/pull/6114 rel="external nofollow noreferrer">#6114</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fix inconsistency in <code>PipelineExecutor::prepareProcessor</code> argument type. <a href=https://github.com/ClickHouse/ClickHouse/pull/6494 rel="external nofollow noreferrer">#6494</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Added a test for bad URIs. <a href=https://github.com/ClickHouse/ClickHouse/pull/6493 rel="external nofollow noreferrer">#6493</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added more checks to <code>CAST</code> function. This should get more information about segmentation fault in fuzzy test. <a href=https://github.com/ClickHouse/ClickHouse/pull/6346 rel="external nofollow noreferrer">#6346</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Added <code>gcc-9</code> support to <code>docker/builder</code> container that builds image locally. <a href=https://github.com/ClickHouse/ClickHouse/pull/6333 rel="external nofollow noreferrer">#6333</a> (<a href=https://github.com/NanoBjorn rel="external nofollow noreferrer">Gleb Novikov</a>)</li> <li>Test for primary key with <code>LowCardinality(String)</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/5044 rel="external nofollow noreferrer">#5044</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6219 rel="external nofollow noreferrer">#6219</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Fixed tests affected by slow stack traces printing. <a href=https://github.com/ClickHouse/ClickHouse/pull/6315 rel="external nofollow noreferrer">#6315</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Add a test case for crash in <code>groupUniqArray</code> fixed in <a href=https://github.com/ClickHouse/ClickHouse/pull/6029 rel="external nofollow noreferrer">#6029</a>. <a href=https://github.com/ClickHouse/ClickHouse/issues/4402 rel="external nofollow noreferrer">#4402</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6129 rel="external nofollow noreferrer">#6129</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Fixed indices mutations tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/6645 rel="external nofollow noreferrer">#6645</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>In performance test, do not read query log for queries we didn't run. <a href=https://github.com/ClickHouse/ClickHouse/pull/6427 rel="external nofollow noreferrer">#6427</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Materialized view now could be created with any low cardinality types regardless to the setting about suspicious low cardinality types. <a href=https://github.com/ClickHouse/ClickHouse/pull/6428 rel="external nofollow noreferrer">#6428</a> (<a href=https://github.com/stavrolia rel="external nofollow noreferrer">Olga Khvostikova</a>)</li> <li>Updated tests for <code>send_logs_level</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/6207 rel="external nofollow noreferrer">#6207</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix build under gcc-8.2. <a href=https://github.com/ClickHouse/ClickHouse/pull/6196 rel="external nofollow noreferrer">#6196</a> (<a href=https://github.com/zlobober rel="external nofollow noreferrer">Max Akhmedov</a>)</li> <li>Fix build with internal libc++. <a href=https://github.com/ClickHouse/ClickHouse/pull/6724 rel="external nofollow noreferrer">#6724</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fix shared build with <code>rdkafka</code> library <a href=https://github.com/ClickHouse/ClickHouse/pull/6101 rel="external nofollow noreferrer">#6101</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fixes for Mac OS build (incomplete). <a href=https://github.com/ClickHouse/ClickHouse/pull/6390 rel="external nofollow noreferrer">#6390</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6429 rel="external nofollow noreferrer">#6429</a> (<a href=https://github.com/alex-zaitsev rel="external nofollow noreferrer">alex-zaitsev</a>)</li> <li>Fix "splitted" build. <a href=https://github.com/ClickHouse/ClickHouse/pull/6618 rel="external nofollow noreferrer">#6618</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Other build fixes: <a href=https://github.com/ClickHouse/ClickHouse/pull/6186 rel="external nofollow noreferrer">#6186</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6486 rel="external nofollow noreferrer">#6486</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6348 rel="external nofollow noreferrer">#6348</a> (<a href=https://github.com/Vxider rel="external nofollow noreferrer">vxider</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6744 rel="external nofollow noreferrer">#6744</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6016 rel="external nofollow noreferrer">#6016</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6421 rel="external nofollow noreferrer">#6421</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6491 rel="external nofollow noreferrer">#6491</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=backward-incompatible-change_2>Backward Incompatible Change<a class=headerlink href=#backward-incompatible-change_2 title="Permanent link">&para;</a></h3> <ul> <li>Removed rarely used table function <code>catBoostPool</code> and storage <code>CatBoostPool</code>. If you have used this table function, please write email to <code>clickhouse-feedback@yandex-team.com</code>. Note that CatBoost integration remains and will be supported. <a href=https://github.com/ClickHouse/ClickHouse/pull/6279 rel="external nofollow noreferrer">#6279</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Disable <code>ANY RIGHT JOIN</code> and <code>ANY FULL JOIN</code> by default. Set <code>any_join_get_any_from_right_table</code> setting to enable them. <a href=https://github.com/ClickHouse/ClickHouse/issues/5126 rel="external nofollow noreferrer">#5126</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6351 rel="external nofollow noreferrer">#6351</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h2 id=clickhouse-release-19-13-6-51-2019-10-02>ClickHouse release 19.13.6.51, 2019-10-02<a class=headerlink href=#clickhouse-release-19-13-6-51-2019-10-02 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_7>Bug Fix<a class=headerlink href=#bug-fix_7 title="Permanent link">&para;</a></h3> <ul> <li>This release also contains all bug fixes from 19.11.12.69.</li> </ul> <h2 id=clickhouse-release-19-13-5-44-2019-09-20>ClickHouse release 19.13.5.44, 2019-09-20<a class=headerlink href=#clickhouse-release-19-13-5-44-2019-09-20 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_8>Bug Fix<a class=headerlink href=#bug-fix_8 title="Permanent link">&para;</a></h3> <ul> <li>This release also contains all bug fixes from 19.14.6.12.</li> <li>Fixed possible inconsistent state of table while executing <code>DROP</code> query for replicated table while zookeeper is not accessible. <a href=https://github.com/ClickHouse/ClickHouse/issues/6045 rel="external nofollow noreferrer">#6045</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6413 rel="external nofollow noreferrer">#6413</a> (<a href=https://github.com/nikitamikhaylov rel="external nofollow noreferrer">Nikita Mikhaylov</a>)</li> <li>Fix for data race in StorageMerge <a href=https://github.com/ClickHouse/ClickHouse/pull/6717 rel="external nofollow noreferrer">#6717</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix bug introduced in query profiler which leads to endless recv from socket. <a href=https://github.com/ClickHouse/ClickHouse/pull/6386 rel="external nofollow noreferrer">#6386</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix excessive CPU usage while executing <code>JSONExtractRaw</code> function over a boolean value. <a href=https://github.com/ClickHouse/ClickHouse/pull/6208 rel="external nofollow noreferrer">#6208</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fixes the regression while pushing to materialized view. <a href=https://github.com/ClickHouse/ClickHouse/pull/6415 rel="external nofollow noreferrer">#6415</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Table function <code>url</code> had the vulnerability allowed the attacker to inject arbitrary HTTP headers in the request. This issue was found by <a href=https://github.com/NSTikhomirov rel="external nofollow noreferrer">Nikita Tikhomirov</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6466 rel="external nofollow noreferrer">#6466</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix useless <code>AST</code> check in Set index. <a href=https://github.com/ClickHouse/ClickHouse/issues/6510 rel="external nofollow noreferrer">#6510</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6651 rel="external nofollow noreferrer">#6651</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Fixed parsing of <code>AggregateFunction</code> values embedded in query. <a href=https://github.com/ClickHouse/ClickHouse/issues/6575 rel="external nofollow noreferrer">#6575</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6773 rel="external nofollow noreferrer">#6773</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang Yu</a>)</li> <li>Fixed wrong behaviour of <code>trim</code> functions family. <a href=https://github.com/ClickHouse/ClickHouse/pull/6647 rel="external nofollow noreferrer">#6647</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-13-4-32-2019-09-10>ClickHouse release 19.13.4.32, 2019-09-10<a class=headerlink href=#clickhouse-release-19-13-4-32-2019-09-10 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_9>Bug Fix<a class=headerlink href=#bug-fix_9 title="Permanent link">&para;</a></h3> <ul> <li>This release also contains all bug security fixes from 19.11.9.52 and 19.11.10.54.</li> <li>Fixed data race in <code>system.parts</code> table and <code>ALTER</code> query. <a href=https://github.com/ClickHouse/ClickHouse/issues/6245 rel="external nofollow noreferrer">#6245</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6513 rel="external nofollow noreferrer">#6513</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed mismatched header in streams happened in case of reading from empty distributed table with sample and prewhere. <a href=https://github.com/ClickHouse/ClickHouse/issues/6167 rel="external nofollow noreferrer">#6167</a> (<a href=https://github.com/fancyqlx rel="external nofollow noreferrer">Lixiang Qian</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6823 rel="external nofollow noreferrer">#6823</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fixed crash when using <code>IN</code> clause with a subquery with a tuple. <a href=https://github.com/ClickHouse/ClickHouse/issues/6125 rel="external nofollow noreferrer">#6125</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6550 rel="external nofollow noreferrer">#6550</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Fix case with same column names in <code>GLOBAL JOIN ON</code> section. <a href=https://github.com/ClickHouse/ClickHouse/pull/6181 rel="external nofollow noreferrer">#6181</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix crash when casting types to <code>Decimal</code> that do not support it. Throw exception instead. <a href=https://github.com/ClickHouse/ClickHouse/pull/6297 rel="external nofollow noreferrer">#6297</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed crash in <code>extractAll()</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/6644 rel="external nofollow noreferrer">#6644</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Query transformation for <code>MySQL</code>, <code>ODBC</code>, <code>JDBC</code> table functions now works properly for <code>SELECT WHERE</code> queries with multiple <code>AND</code> expressions. <a href=https://github.com/ClickHouse/ClickHouse/issues/6381 rel="external nofollow noreferrer">#6381</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6676 rel="external nofollow noreferrer">#6676</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Added previous declaration checks for MySQL 8 integration. <a href=https://github.com/ClickHouse/ClickHouse/pull/6569 rel="external nofollow noreferrer">#6569</a> (<a href=https://github.com/rafaeldtinoco rel="external nofollow noreferrer">Rafael David Tinoco</a>)</li> </ul> <h3 id=security-fix_1>Security Fix<a class=headerlink href=#security-fix_1 title="Permanent link">&para;</a></h3> <ul> <li>Fix two vulnerabilities in codecs in decompression phase (malicious user can fabricate compressed data that will lead to buffer overflow in decompression). <a href=https://github.com/ClickHouse/ClickHouse/pull/6670 rel="external nofollow noreferrer">#6670</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h2 id=clickhouse-release-19-11-13-74-2019-11-01>ClickHouse release 19.11.13.74, 2019-11-01<a class=headerlink href=#clickhouse-release-19-11-13-74-2019-11-01 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_10>Bug Fix<a class=headerlink href=#bug-fix_10 title="Permanent link">&para;</a></h3> <ul> <li>Fixed rare crash in <code>ALTER MODIFY COLUMN</code> and vertical merge when one of merged/altered parts is empty (0 rows). <a href=https://github.com/ClickHouse/ClickHouse/pull/6780 rel="external nofollow noreferrer">#6780</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Manual update of <code>SIMDJSON</code>. This fixes possible flooding of stderr files with bogus json diagnostic messages. <a href=https://github.com/ClickHouse/ClickHouse/pull/7548 rel="external nofollow noreferrer">#7548</a> (<a href=https://github.com/Akazz rel="external nofollow noreferrer">Alexander Kazakov</a>)</li> <li>Fixed bug with <code>mrk</code> file extension for mutations (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> </ul> <h2 id=clickhouse-release-19-11-12-69-2019-10-02>ClickHouse release 19.11.12.69, 2019-10-02<a class=headerlink href=#clickhouse-release-19-11-12-69-2019-10-02 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_11>Bug Fix<a class=headerlink href=#bug-fix_11 title="Permanent link">&para;</a></h3> <ul> <li>Fixed performance degradation of index analysis on complex keys on large tables. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/6924 rel="external nofollow noreferrer">#6924</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/7075 rel="external nofollow noreferrer">#7075</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Avoid rare SIGSEGV while sending data in tables with Distributed engine (<code>Failed to send batch: file with index XXXXX is absent</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/7032 rel="external nofollow noreferrer">#7032</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Fix <code>Unknown identifier</code> with multiple joins. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5254 rel="external nofollow noreferrer">#5254</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/7022 rel="external nofollow noreferrer">#7022</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h2 id=clickhouse-release-19-11-10-54-2019-09-10>ClickHouse release 19.11.10.54, 2019-09-10<a class=headerlink href=#clickhouse-release-19-11-10-54-2019-09-10 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_12>Bug Fix<a class=headerlink href=#bug-fix_12 title="Permanent link">&para;</a></h3> <ul> <li>Do store offsets for Kafka messages manually to be able to commit them all at once for all partitions. Fixes potential duplication in "one consumer - many partitions" scenario. <a href=https://github.com/ClickHouse/ClickHouse/pull/6872 rel="external nofollow noreferrer">#6872</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h2 id=clickhouse-release-19-11-9-52-2019-09-6>ClickHouse release 19.11.9.52, 2019-09-6<a class=headerlink href=#clickhouse-release-19-11-9-52-2019-09-6 title="Permanent link">&para;</a></h2> <ul> <li>Improve error handling in cache dictionaries. <a href=https://github.com/ClickHouse/ClickHouse/pull/6737 rel="external nofollow noreferrer">#6737</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fixed bug in function <code>arrayEnumerateUniqRanked</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6779 rel="external nofollow noreferrer">#6779</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix <code>JSONExtract</code> function while extracting a <code>Tuple</code> from JSON. <a href=https://github.com/ClickHouse/ClickHouse/pull/6718 rel="external nofollow noreferrer">#6718</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fixed possible data loss after <code>ALTER DELETE</code> query on table with skipping index. <a href=https://github.com/ClickHouse/ClickHouse/issues/6224 rel="external nofollow noreferrer">#6224</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6282 rel="external nofollow noreferrer">#6282</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Fixed performance test. <a href=https://github.com/ClickHouse/ClickHouse/pull/6392 rel="external nofollow noreferrer">#6392</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Parquet: Fix reading boolean columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/6579 rel="external nofollow noreferrer">#6579</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed wrong behaviour of <code>nullIf</code> function for constant arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/6518 rel="external nofollow noreferrer">#6518</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6580 rel="external nofollow noreferrer">#6580</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix Kafka messages duplication problem on normal server restart. <a href=https://github.com/ClickHouse/ClickHouse/pull/6597 rel="external nofollow noreferrer">#6597</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fixed an issue when long <code>ALTER UPDATE</code> or <code>ALTER DELETE</code> may prevent regular merges to run. Prevent mutations from executing if there is no enough free threads available. <a href=https://github.com/ClickHouse/ClickHouse/issues/6502 rel="external nofollow noreferrer">#6502</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6617 rel="external nofollow noreferrer">#6617</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Fixed error with processing "timezone" in server configuration file. <a href=https://github.com/ClickHouse/ClickHouse/pull/6709 rel="external nofollow noreferrer">#6709</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix kafka tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/6805 rel="external nofollow noreferrer">#6805</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h3 id=security-fix_2>Security Fix<a class=headerlink href=#security-fix_2 title="Permanent link">&para;</a></h3> <ul> <li>If the attacker has write access to ZooKeeper and is able to run custom server available from the network where ClickHouse run, it can create custom-built malicious server that will act as ClickHouse replica and register it in ZooKeeper. When another replica will fetch data part from malicious replica, it can force clickhouse-server to write to arbitrary path on filesystem. Found by Eldar Zaitov, information security team at Yandex. <a href=https://github.com/ClickHouse/ClickHouse/pull/6247 rel="external nofollow noreferrer">#6247</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-13-3-26-2019-08-22>ClickHouse release 19.13.3.26, 2019-08-22<a class=headerlink href=#clickhouse-release-19-13-3-26-2019-08-22 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_13>Bug Fix<a class=headerlink href=#bug-fix_13 title="Permanent link">&para;</a></h3> <ul> <li>Fix <code>ALTER TABLE ... UPDATE</code> query for tables with <code>enable_mixed_granularity_parts=1</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6543 rel="external nofollow noreferrer">#6543</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix NPE when using IN clause with a subquery with a tuple. <a href=https://github.com/ClickHouse/ClickHouse/issues/6125 rel="external nofollow noreferrer">#6125</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6550 rel="external nofollow noreferrer">#6550</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Fixed an issue that if a stale replica becomes alive, it may still have data parts that were removed by DROP PARTITION. <a href=https://github.com/ClickHouse/ClickHouse/issues/6522 rel="external nofollow noreferrer">#6522</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6523 rel="external nofollow noreferrer">#6523</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Fixed issue with parsing CSV <a href=https://github.com/ClickHouse/ClickHouse/issues/6426 rel="external nofollow noreferrer">#6426</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6559 rel="external nofollow noreferrer">#6559</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Fixed data race in system.parts table and ALTER query. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/6245 rel="external nofollow noreferrer">#6245</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6513 rel="external nofollow noreferrer">#6513</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed wrong code in mutations that may lead to memory corruption. Fixed segfault with read of address <code>0x14c0</code> that may happed due to concurrent <code>DROP TABLE</code> and <code>SELECT</code> from <code>system.parts</code> or <code>system.parts_columns</code>. Fixed race condition in preparation of mutation queries. Fixed deadlock caused by <code>OPTIMIZE</code> of Replicated tables and concurrent modification operations like ALTERs. <a href=https://github.com/ClickHouse/ClickHouse/pull/6514 rel="external nofollow noreferrer">#6514</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed possible data loss after <code>ALTER DELETE</code> query on table with skipping index. <a href=https://github.com/ClickHouse/ClickHouse/issues/6224 rel="external nofollow noreferrer">#6224</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6282 rel="external nofollow noreferrer">#6282</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> </ul> <h3 id=security-fix_3>Security Fix<a class=headerlink href=#security-fix_3 title="Permanent link">&para;</a></h3> <ul> <li>If the attacker has write access to ZooKeeper and is able to run custom server available from the network where ClickHouse run, it can create custom-built malicious server that will act as ClickHouse replica and register it in ZooKeeper. When another replica will fetch data part from malicious replica, it can force clickhouse-server to write to arbitrary path on filesystem. Found by Eldar Zaitov, information security team at Yandex. <a href=https://github.com/ClickHouse/ClickHouse/pull/6247 rel="external nofollow noreferrer">#6247</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-13-2-19-2019-08-14>ClickHouse release 19.13.2.19, 2019-08-14<a class=headerlink href=#clickhouse-release-19-13-2-19-2019-08-14 title="Permanent link">&para;</a></h2> <h3 id=new-feature_3>New Feature<a class=headerlink href=#new-feature_3 title="Permanent link">&para;</a></h3> <ul> <li>Sampling profiler on query level. <a href=https://gist.github.com/alexey-milovidov/92758583dd41c24c360fdb8d6a4da194 rel="external nofollow noreferrer">Example</a>. <a href=https://github.com/ClickHouse/ClickHouse/issues/4247 rel="external nofollow noreferrer">#4247</a> (<a href=https://github.com/laplab rel="external nofollow noreferrer">laplab</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6124 rel="external nofollow noreferrer">#6124</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/6250 rel="external nofollow noreferrer">#6250</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6283 rel="external nofollow noreferrer">#6283</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6386 rel="external nofollow noreferrer">#6386</a></li> <li>Allow to specify a list of columns with <code>COLUMNS('regexp')</code> expression that works like a more sophisticated variant of <code>*</code> asterisk. <a href=https://github.com/ClickHouse/ClickHouse/pull/5951 rel="external nofollow noreferrer">#5951</a> (<a href=https://github.com/mfridental rel="external nofollow noreferrer">mfridental</a>), (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>CREATE TABLE AS table_function()</code> is now possible <a href=https://github.com/ClickHouse/ClickHouse/pull/6057 rel="external nofollow noreferrer">#6057</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Adam optimizer for stochastic gradient descent is used by default in <code>stochasticLinearRegression()</code> and <code>stochasticLogisticRegression()</code> aggregate functions, because it shows good quality without almost any tuning. <a href=https://github.com/ClickHouse/ClickHouse/pull/6000 rel="external nofollow noreferrer">#6000</a> (<a href=https://github.com/Quid37 rel="external nofollow noreferrer">Quid37</a>)</li> <li>Added functions for working with the сustom week number <a href=https://github.com/ClickHouse/ClickHouse/pull/5212 rel="external nofollow noreferrer">#5212</a> (<a href=https://github.com/andyyzh rel="external nofollow noreferrer">Andy Yang</a>)</li> <li><code>RENAME</code> queries now work with all storages. <a href=https://github.com/ClickHouse/ClickHouse/pull/5953 rel="external nofollow noreferrer">#5953</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Now client receive logs from server with any desired level by setting <code>send_logs_level</code> regardless to the log level specified in server settings. <a href=https://github.com/ClickHouse/ClickHouse/pull/5964 rel="external nofollow noreferrer">#5964</a> (<a href=https://github.com/nikitamikhaylov rel="external nofollow noreferrer">Nikita Mikhaylov</a>)</li> </ul> <h3 id=backward-incompatible-change_3>Backward Incompatible Change<a class=headerlink href=#backward-incompatible-change_3 title="Permanent link">&para;</a></h3> <ul> <li>The setting <code>input_format_defaults_for_omitted_fields</code> is enabled by default. Inserts in Distibuted tables need this setting to be the same on cluster (you need to set it before rolling update). It enables calculation of complex default expressions for omitted fields in <code>JSONEachRow</code> and <code>CSV*</code> formats. It should be the expected behaviour but may lead to negligible performance difference. <a href=https://github.com/ClickHouse/ClickHouse/pull/6043 rel="external nofollow noreferrer">#6043</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>), <a href=https://github.com/ClickHouse/ClickHouse/pull/5625 rel="external nofollow noreferrer">#5625</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> </ul> <h3 id=experimental-features>Experimental features<a class=headerlink href=#experimental-features title="Permanent link">&para;</a></h3> <ul> <li>New query processing pipeline. Use <code>experimental_use_processors=1</code> option to enable it. Use for your own trouble. <a href=https://github.com/ClickHouse/ClickHouse/pull/4914 rel="external nofollow noreferrer">#4914</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> </ul> <h3 id=bug-fix_14>Bug Fix<a class=headerlink href=#bug-fix_14 title="Permanent link">&para;</a></h3> <ul> <li>Kafka integration has been fixed in this version.</li> <li>Fixed <code>DoubleDelta</code> encoding of <code>Int64</code> for large <code>DoubleDelta</code> values, improved <code>DoubleDelta</code> encoding for random data for <code>Int32</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5998 rel="external nofollow noreferrer">#5998</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Fixed overestimation of <code>max_rows_to_read</code> if the setting <code>merge_tree_uniform_read_distribution</code> is set to 0. <a href=https://github.com/ClickHouse/ClickHouse/pull/6019 rel="external nofollow noreferrer">#6019</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=improvement_3>Improvement<a class=headerlink href=#improvement_3 title="Permanent link">&para;</a></h3> <ul> <li>Throws an exception if <code>config.d</code> file doesn't have the corresponding root element as the config file <a href=https://github.com/ClickHouse/ClickHouse/pull/6123 rel="external nofollow noreferrer">#6123</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> </ul> <h3 id=performance-improvement_2>Performance Improvement<a class=headerlink href=#performance-improvement_2 title="Permanent link">&para;</a></h3> <ul> <li>Optimize <code>count()</code>. Now it uses the smallest column (if possible). <a href=https://github.com/ClickHouse/ClickHouse/pull/6028 rel="external nofollow noreferrer">#6028</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_4>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_4 title="Permanent link">&para;</a></h3> <ul> <li>Report memory usage in performance tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/5899 rel="external nofollow noreferrer">#5899</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Fix build with external <code>libcxx</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/6010 rel="external nofollow noreferrer">#6010</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fix shared build with <code>rdkafka</code> library <a href=https://github.com/ClickHouse/ClickHouse/pull/6101 rel="external nofollow noreferrer">#6101</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h2 id=clickhouse-release-19-11-11-57-2019-09-13>ClickHouse release 19.11.11.57, 2019-09-13<a class=headerlink href=#clickhouse-release-19-11-11-57-2019-09-13 title="Permanent link">&para;</a></h2> <ul> <li>Fix logical error causing segfaults when selecting from Kafka empty topic. <a href=https://github.com/ClickHouse/ClickHouse/issues/6902 rel="external nofollow noreferrer">#6902</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6909 rel="external nofollow noreferrer">#6909</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fix for function <code>АrrayEnumerateUniqRanked</code> with empty arrays in params. <a href=https://github.com/ClickHouse/ClickHouse/pull/6928 rel="external nofollow noreferrer">#6928</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h2 id=clickhouse-release-19-11-8-46-2019-08-22>ClickHouse release 19.11.8.46, 2019-08-22<a class=headerlink href=#clickhouse-release-19-11-8-46-2019-08-22 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_15>Bug Fix<a class=headerlink href=#bug-fix_15 title="Permanent link">&para;</a></h3> <ul> <li>Fix <code>ALTER TABLE ... UPDATE</code> query for tables with <code>enable_mixed_granularity_parts=1</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6543 rel="external nofollow noreferrer">#6543</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix NPE when using IN clause with a subquery with a tuple. <a href=https://github.com/ClickHouse/ClickHouse/issues/6125 rel="external nofollow noreferrer">#6125</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6550 rel="external nofollow noreferrer">#6550</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Fixed an issue that if a stale replica becomes alive, it may still have data parts that were removed by DROP PARTITION. <a href=https://github.com/ClickHouse/ClickHouse/issues/6522 rel="external nofollow noreferrer">#6522</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6523 rel="external nofollow noreferrer">#6523</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Fixed issue with parsing CSV <a href=https://github.com/ClickHouse/ClickHouse/issues/6426 rel="external nofollow noreferrer">#6426</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6559 rel="external nofollow noreferrer">#6559</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer">tavplubix</a>)</li> <li>Fixed data race in system.parts table and ALTER query. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/6245 rel="external nofollow noreferrer">#6245</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6513 rel="external nofollow noreferrer">#6513</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed wrong code in mutations that may lead to memory corruption. Fixed segfault with read of address <code>0x14c0</code> that may happed due to concurrent <code>DROP TABLE</code> and <code>SELECT</code> from <code>system.parts</code> or <code>system.parts_columns</code>. Fixed race condition in preparation of mutation queries. Fixed deadlock caused by <code>OPTIMIZE</code> of Replicated tables and concurrent modification operations like ALTERs. <a href=https://github.com/ClickHouse/ClickHouse/pull/6514 rel="external nofollow noreferrer">#6514</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-11-7-40-2019-08-14>ClickHouse release 19.11.7.40, 2019-08-14<a class=headerlink href=#clickhouse-release-19-11-7-40-2019-08-14 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_16>Bug fix<a class=headerlink href=#bug-fix_16 title="Permanent link">&para;</a></h3> <ul> <li>Kafka integration has been fixed in this version.</li> <li>Fix segfault when using <code>arrayReduce</code> for constant arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/6326 rel="external nofollow noreferrer">#6326</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed <code>toFloat()</code> monotonicity. <a href=https://github.com/ClickHouse/ClickHouse/pull/6374 rel="external nofollow noreferrer">#6374</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Fix segfault with enabled <code>optimize_skip_unused_shards</code> and missing sharding key. <a href=https://github.com/ClickHouse/ClickHouse/pull/6384 rel="external nofollow noreferrer">#6384</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">CurtizJ</a>)</li> <li>Fixed logic of <code>arrayEnumerateUniqRanked</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/6423 rel="external nofollow noreferrer">#6423</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Removed extra verbose logging from MySQL handler. <a href=https://github.com/ClickHouse/ClickHouse/pull/6389 rel="external nofollow noreferrer">#6389</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix wrong behavior and possible segfaults in <code>topK</code> and <code>topKWeighted</code> aggregated functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/6404 rel="external nofollow noreferrer">#6404</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">CurtizJ</a>)</li> <li>Do not expose virtual columns in <code>system.columns</code> table. This is required for backward compatibility. <a href=https://github.com/ClickHouse/ClickHouse/pull/6406 rel="external nofollow noreferrer">#6406</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix bug with memory allocation for string fields in complex key cache dictionary. <a href=https://github.com/ClickHouse/ClickHouse/pull/6447 rel="external nofollow noreferrer">#6447</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix bug with enabling adaptive granularity when creating new replica for <code>Replicated*MergeTree</code> table. <a href=https://github.com/ClickHouse/ClickHouse/pull/6452 rel="external nofollow noreferrer">#6452</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix infinite loop when reading Kafka messages. <a href=https://github.com/ClickHouse/ClickHouse/pull/6354 rel="external nofollow noreferrer">#6354</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">abyss7</a>)</li> <li>Fixed the possibility of a fabricated query to cause server crash due to stack overflow in SQL parser and possibility of stack overflow in <code>Merge</code> and <code>Distributed</code> tables <a href=https://github.com/ClickHouse/ClickHouse/pull/6433 rel="external nofollow noreferrer">#6433</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed Gorilla encoding error on small sequences. <a href=https://github.com/ClickHouse/ClickHouse/pull/6444 rel="external nofollow noreferrer">#6444</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Enmk</a>)</li> </ul> <h3 id=improvement_4>Improvement<a class=headerlink href=#improvement_4 title="Permanent link">&para;</a></h3> <ul> <li>Allow user to override <code>poll_interval</code> and <code>idle_connection_timeout</code> settings on connection. <a href=https://github.com/ClickHouse/ClickHouse/pull/6230 rel="external nofollow noreferrer">#6230</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-11-5-28-2019-08-05>ClickHouse release 19.11.5.28, 2019-08-05<a class=headerlink href=#clickhouse-release-19-11-5-28-2019-08-05 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_17>Bug fix<a class=headerlink href=#bug-fix_17 title="Permanent link">&para;</a></h3> <ul> <li>Fixed the possibility of hanging queries when server is overloaded. <a href=https://github.com/ClickHouse/ClickHouse/pull/6301 rel="external nofollow noreferrer">#6301</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix FPE in yandexConsistentHash function. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/6304 rel="external nofollow noreferrer">#6304</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6126 rel="external nofollow noreferrer">#6126</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed bug in conversion of <code>LowCardinality</code> types in <code>AggregateFunctionFactory</code>. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/6257 rel="external nofollow noreferrer">#6257</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6281 rel="external nofollow noreferrer">#6281</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix parsing of <code>bool</code> settings from <code>true</code> and <code>false</code> strings in configuration files. <a href=https://github.com/ClickHouse/ClickHouse/pull/6278 rel="external nofollow noreferrer">#6278</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix rare bug with incompatible stream headers in queries to <code>Distributed</code> table over <code>MergeTree</code> table when part of <code>WHERE</code> moves to <code>PREWHERE</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6236 rel="external nofollow noreferrer">#6236</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed overflow in integer division of signed type to unsigned type. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/6214 rel="external nofollow noreferrer">#6214</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6233 rel="external nofollow noreferrer">#6233</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=backward-incompatible-change_4>Backward Incompatible Change<a class=headerlink href=#backward-incompatible-change_4 title="Permanent link">&para;</a></h3> <ul> <li><code>Kafka</code> still broken.</li> </ul> <h2 id=clickhouse-release-19-11-4-24-2019-08-01>ClickHouse release 19.11.4.24, 2019-08-01<a class=headerlink href=#clickhouse-release-19-11-4-24-2019-08-01 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_18>Bug Fix<a class=headerlink href=#bug-fix_18 title="Permanent link">&para;</a></h3> <ul> <li>Fix bug with writing secondary indices marks with adaptive granularity. <a href=https://github.com/ClickHouse/ClickHouse/pull/6126 rel="external nofollow noreferrer">#6126</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix <code>WITH ROLLUP</code> and <code>WITH CUBE</code> modifiers of <code>GROUP BY</code> with two-level aggregation. <a href=https://github.com/ClickHouse/ClickHouse/pull/6225 rel="external nofollow noreferrer">#6225</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fixed hang in <code>JSONExtractRaw</code> function. Fixed <a href=https://github.com/ClickHouse/ClickHouse/issues/6195 rel="external nofollow noreferrer">#6195</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6198 rel="external nofollow noreferrer">#6198</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix segfault in ExternalLoader::reloadOutdated(). <a href=https://github.com/ClickHouse/ClickHouse/pull/6082 rel="external nofollow noreferrer">#6082</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fixed the case when server may close listening sockets but not shutdown and continue serving remaining queries. You may end up with two running clickhouse-server processes. Sometimes, the server may return an error <code>bad_function_call</code> for remaining queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/6231 rel="external nofollow noreferrer">#6231</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed useless and incorrect condition on update field for initial loading of external dictionaries via ODBC, MySQL, ClickHouse and HTTP. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/6069 rel="external nofollow noreferrer">#6069</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6083 rel="external nofollow noreferrer">#6083</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed irrelevant exception in cast of <code>LowCardinality(Nullable)</code> to not-Nullable column in case if it doesn't contain Nulls (e.g. in query like <code>SELECT CAST(CAST('Hello' AS LowCardinality(Nullable(String))) AS String)</code>. <a href=https://github.com/ClickHouse/ClickHouse/issues/6094 rel="external nofollow noreferrer">#6094</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/6119 rel="external nofollow noreferrer">#6119</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix non-deterministic result of "uniq" aggregate function in extreme rare cases. The bug was present in all ClickHouse versions. <a href=https://github.com/ClickHouse/ClickHouse/pull/6058 rel="external nofollow noreferrer">#6058</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Segfault when we set a little bit too high CIDR on the function <code>IPv6CIDRToRange</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/6068 rel="external nofollow noreferrer">#6068</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Fixed small memory leak when server throw many exceptions from many different contexts. <a href=https://github.com/ClickHouse/ClickHouse/pull/6144 rel="external nofollow noreferrer">#6144</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix the situation when consumer got paused before subscription and not resumed afterwards. <a href=https://github.com/ClickHouse/ClickHouse/pull/6075 rel="external nofollow noreferrer">#6075</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>) Note that Kafka is broken in this version.</li> <li>Clearing the Kafka data buffer from the previous read operation that was completed with an error <a href=https://github.com/ClickHouse/ClickHouse/pull/6026 rel="external nofollow noreferrer">#6026</a> (<a href=https://github.com/bopohaa rel="external nofollow noreferrer">Nikolay</a>) Note that Kafka is broken in this version.</li> <li>Since <code>StorageMergeTree::background_task_handle</code> is initialized in <code>startup()</code> the <code>MergeTreeBlockOutputStream::write()</code> may try to use it before initialization. Just check if it is initialized. <a href=https://github.com/ClickHouse/ClickHouse/pull/6080 rel="external nofollow noreferrer">#6080</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_5>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_5 title="Permanent link">&para;</a></h3> <ul> <li>Added official <code>rpm</code> packages. <a href=https://github.com/ClickHouse/ClickHouse/pull/5740 rel="external nofollow noreferrer">#5740</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>) (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Add an ability to build <code>.rpm</code> and <code>.tgz</code> packages with <code>packager</code> script. <a href=https://github.com/ClickHouse/ClickHouse/pull/5769 rel="external nofollow noreferrer">#5769</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixes for "Arcadia" build system. <a href=https://github.com/ClickHouse/ClickHouse/pull/6223 rel="external nofollow noreferrer">#6223</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=backward-incompatible-change_5>Backward Incompatible Change<a class=headerlink href=#backward-incompatible-change_5 title="Permanent link">&para;</a></h3> <ul> <li><code>Kafka</code> is broken in this version.</li> </ul> <h2 id=clickhouse-release-19-11-3-11-2019-07-18>ClickHouse release 19.11.3.11, 2019-07-18<a class=headerlink href=#clickhouse-release-19-11-3-11-2019-07-18 title="Permanent link">&para;</a></h2> <h3 id=new-feature_4>New Feature<a class=headerlink href=#new-feature_4 title="Permanent link">&para;</a></h3> <ul> <li>Added support for prepared statements. <a href=https://github.com/ClickHouse/ClickHouse/pull/5331/ rel="external nofollow noreferrer">#5331</a> (<a href=https://github.com/sanych73 rel="external nofollow noreferrer">Alexander</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/5630 rel="external nofollow noreferrer">#5630</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>DoubleDelta</code> and <code>Gorilla</code> column codecs <a href=https://github.com/ClickHouse/ClickHouse/pull/5600 rel="external nofollow noreferrer">#5600</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Added <code>os_thread_priority</code> setting that allows to control the "nice" value of query processing threads that is used by OS to adjust dynamic scheduling priority. It requires <code>CAP_SYS_NICE</code> capabilities to work. This implements <a href=https://github.com/ClickHouse/ClickHouse/issues/5858 rel="external nofollow noreferrer">#5858</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5909 rel="external nofollow noreferrer">#5909</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Implement <code>_topic</code>, <code>_offset</code>, <code>_key</code> columns for Kafka engine <a href=https://github.com/ClickHouse/ClickHouse/pull/5382 rel="external nofollow noreferrer">#5382</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>) Note that Kafka is broken in this version.</li> <li>Add aggregate function combinator <code>-Resample</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/5590 rel="external nofollow noreferrer">#5590</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> <li>Aggregate functions <code>groupArrayMovingSum(win_size)(x)</code> and <code>groupArrayMovingAvg(win_size)(x)</code>, which calculate moving sum/avg with or without window-size limitation. <a href=https://github.com/ClickHouse/ClickHouse/pull/5595 rel="external nofollow noreferrer">#5595</a> (<a href=https://github.com/inv2004 rel="external nofollow noreferrer">inv2004</a>)</li> <li>Add synonim <code>arrayFlatten</code> &lt;-&gt; <code>flatten</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/5764 rel="external nofollow noreferrer">#5764</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> <li>Intergate H3 function <code>geoToH3</code> from Uber. <a href=https://github.com/ClickHouse/ClickHouse/pull/4724 rel="external nofollow noreferrer">#4724</a> (<a href=https://github.com/BHYCHIK rel="external nofollow noreferrer">Remen Ivan</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/5805 rel="external nofollow noreferrer">#5805</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=bug-fix_19>Bug Fix<a class=headerlink href=#bug-fix_19 title="Permanent link">&para;</a></h3> <ul> <li>Implement DNS cache with asynchronous update. Separate thread resolves all hosts and updates DNS cache with period (setting <code>dns_cache_update_period</code>). It should help, when ip of hosts changes frequently. <a href=https://github.com/ClickHouse/ClickHouse/pull/5857 rel="external nofollow noreferrer">#5857</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fix segfault in <code>Delta</code> codec which affects columns with values less than 32 bits size. The bug led to random memory corruption. <a href=https://github.com/ClickHouse/ClickHouse/pull/5786 rel="external nofollow noreferrer">#5786</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix segfault in TTL merge with non-physical columns in block. <a href=https://github.com/ClickHouse/ClickHouse/pull/5819 rel="external nofollow noreferrer">#5819</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fix rare bug in checking of part with <code>LowCardinality</code> column. Previously <code>checkDataPart</code> always fails for part with <code>LowCardinality</code> column. <a href=https://github.com/ClickHouse/ClickHouse/pull/5832 rel="external nofollow noreferrer">#5832</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Avoid hanging connections when server thread pool is full. It is important for connections from <code>remote</code> table function or connections to a shard without replicas when there is long connection timeout. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5878 rel="external nofollow noreferrer">#5878</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5881 rel="external nofollow noreferrer">#5881</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Support for constant arguments to <code>evalMLModel</code> function. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5817 rel="external nofollow noreferrer">#5817</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5820 rel="external nofollow noreferrer">#5820</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed the issue when ClickHouse determines default time zone as <code>UCT</code> instead of <code>UTC</code>. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5804 rel="external nofollow noreferrer">#5804</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5828 rel="external nofollow noreferrer">#5828</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed buffer underflow in <code>visitParamExtractRaw</code>. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5901 rel="external nofollow noreferrer">#5901</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5902 rel="external nofollow noreferrer">#5902</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Now distributed <code>DROP/ALTER/TRUNCATE/OPTIMIZE ON CLUSTER</code> queries will be executed directly on leader replica. <a href=https://github.com/ClickHouse/ClickHouse/pull/5757 rel="external nofollow noreferrer">#5757</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix <code>coalesce</code> for <code>ColumnConst</code> with <code>ColumnNullable</code> + related changes. <a href=https://github.com/ClickHouse/ClickHouse/pull/5755 rel="external nofollow noreferrer">#5755</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix the <code>ReadBufferFromKafkaConsumer</code> so that it keeps reading new messages after <code>commit()</code> even if it was stalled before <a href=https://github.com/ClickHouse/ClickHouse/pull/5852 rel="external nofollow noreferrer">#5852</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fix <code>FULL</code> and <code>RIGHT</code> JOIN results when joining on <code>Nullable</code> keys in right table. <a href=https://github.com/ClickHouse/ClickHouse/pull/5859 rel="external nofollow noreferrer">#5859</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Possible fix of infinite sleeping of low-priority queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/5842 rel="external nofollow noreferrer">#5842</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix race condition, which cause that some queries may not appear in query_log after <code>SYSTEM FLUSH LOGS</code> query. <a href=https://github.com/ClickHouse/ClickHouse/issues/5456 rel="external nofollow noreferrer">#5456</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5685 rel="external nofollow noreferrer">#5685</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fixed <code>heap-use-after-free</code> ASan warning in ClusterCopier caused by watch which try to use already removed copier object. <a href=https://github.com/ClickHouse/ClickHouse/pull/5871 rel="external nofollow noreferrer">#5871</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fixed wrong <code>StringRef</code> pointer returned by some implementations of <code>IColumn::deserializeAndInsertFromArena</code>. This bug affected only unit-tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/5973 rel="external nofollow noreferrer">#5973</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Prevent source and intermediate array join columns of masking same name columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/5941 rel="external nofollow noreferrer">#5941</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix insert and select query to MySQL engine with MySQL style identifier quoting. <a href=https://github.com/ClickHouse/ClickHouse/pull/5704 rel="external nofollow noreferrer">#5704</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Now <code>CHECK TABLE</code> query can work with MergeTree engine family. It returns check status and message if any for each part (or file in case of simplier engines). Also, fix bug in fetch of a broken part. <a href=https://github.com/ClickHouse/ClickHouse/pull/5865 rel="external nofollow noreferrer">#5865</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix SPLIT_SHARED_LIBRARIES runtime <a href=https://github.com/ClickHouse/ClickHouse/pull/5793 rel="external nofollow noreferrer">#5793</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Fixed time zone initialization when <code>/etc/localtime</code> is a relative symlink like <code>../usr/share/zoneinfo/Europe/Moscow</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/5922 rel="external nofollow noreferrer">#5922</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>clickhouse-copier: Fix use-after free on shutdown <a href=https://github.com/ClickHouse/ClickHouse/pull/5752 rel="external nofollow noreferrer">#5752</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Updated <code>simdjson</code>. Fixed the issue that some invalid JSONs with zero bytes successfully parse. <a href=https://github.com/ClickHouse/ClickHouse/pull/5938 rel="external nofollow noreferrer">#5938</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix shutdown of SystemLogs <a href=https://github.com/ClickHouse/ClickHouse/pull/5802 rel="external nofollow noreferrer">#5802</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fix hanging when condition in invalidate_query depends on a dictionary. <a href=https://github.com/ClickHouse/ClickHouse/pull/6011 rel="external nofollow noreferrer">#6011</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> </ul> <h3 id=improvement_5>Improvement<a class=headerlink href=#improvement_5 title="Permanent link">&para;</a></h3> <ul> <li>Allow unresolvable addresses in cluster configuration. They will be considered unavailable and tried to resolve at every connection attempt. This is especially useful for Kubernetes. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5714 rel="external nofollow noreferrer">#5714</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5924 rel="external nofollow noreferrer">#5924</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Close idle TCP connections (with one hour timeout by default). This is especially important for large clusters with multiple distributed tables on every server, because every server can possibly keep a connection pool to every other server, and after peak query concurrency, connections will stall. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5879 rel="external nofollow noreferrer">#5879</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5880 rel="external nofollow noreferrer">#5880</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Better quality of <code>topK</code> function. Changed the SavingSpace set behavior to remove the last element if the new element have a bigger weight. <a href=https://github.com/ClickHouse/ClickHouse/issues/5833 rel="external nofollow noreferrer">#5833</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5850 rel="external nofollow noreferrer">#5850</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>URL functions to work with domains now can work for incomplete URLs without scheme <a href=https://github.com/ClickHouse/ClickHouse/pull/5725 rel="external nofollow noreferrer">#5725</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Checksums added to the <code>system.parts_columns</code> table. <a href=https://github.com/ClickHouse/ClickHouse/pull/5874 rel="external nofollow noreferrer">#5874</a> (<a href=https://github.com/nikitamikhaylov rel="external nofollow noreferrer">Nikita Mikhaylov</a>)</li> <li>Added <code>Enum</code> data type as a synonim for <code>Enum8</code> or <code>Enum16</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5886 rel="external nofollow noreferrer">#5886</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Full bit transpose variant for <code>T64</code> codec. Could lead to better compression with <code>zstd</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5742 rel="external nofollow noreferrer">#5742</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Condition on <code>startsWith</code> function now can uses primary key. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5310 rel="external nofollow noreferrer">#5310</a> and <a href=https://github.com/ClickHouse/ClickHouse/issues/5882 rel="external nofollow noreferrer">#5882</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5919 rel="external nofollow noreferrer">#5919</a> (<a href=https://github.com/dimarub2000 rel="external nofollow noreferrer">dimarub2000</a>)</li> <li>Allow to use <code>clickhouse-copier</code> with cross-replication cluster topology by permitting empty database name. <a href=https://github.com/ClickHouse/ClickHouse/pull/5745 rel="external nofollow noreferrer">#5745</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> <li>Use <code>UTC</code> as default timezone on a system without <code>tzdata</code> (e.g. bare Docker container). Before this patch, error message <code>Could not determine local time zone</code> was printed and server or client refused to start. <a href=https://github.com/ClickHouse/ClickHouse/pull/5827 rel="external nofollow noreferrer">#5827</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Returned back support for floating point argument in function <code>quantileTiming</code> for backward compatibility. <a href=https://github.com/ClickHouse/ClickHouse/pull/5911 rel="external nofollow noreferrer">#5911</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Show which table is missing column in error messages. <a href=https://github.com/ClickHouse/ClickHouse/pull/5768 rel="external nofollow noreferrer">#5768</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Disallow run query with same query_id by various users <a href=https://github.com/ClickHouse/ClickHouse/pull/5430 rel="external nofollow noreferrer">#5430</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>More robust code for sending metrics to Graphite. It will work even during long multiple <code>RENAME TABLE</code> operation. <a href=https://github.com/ClickHouse/ClickHouse/pull/5875 rel="external nofollow noreferrer">#5875</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>More informative error messages will be displayed when ThreadPool cannot schedule a task for execution. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5305 rel="external nofollow noreferrer">#5305</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5801 rel="external nofollow noreferrer">#5801</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Inverting ngramSearch to be more intuitive <a href=https://github.com/ClickHouse/ClickHouse/pull/5807 rel="external nofollow noreferrer">#5807</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Add user parsing in HDFS engine builder <a href=https://github.com/ClickHouse/ClickHouse/pull/5946 rel="external nofollow noreferrer">#5946</a> (<a href=https://github.com/akonyaev90 rel="external nofollow noreferrer">akonyaev90</a>)</li> <li>Update default value of <code>max_ast_elements parameter</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/5933 rel="external nofollow noreferrer">#5933</a> (<a href=https://github.com/izebit rel="external nofollow noreferrer">Artem Konovalov</a>)</li> <li>Added a notion of obsolete settings. The obsolete setting <code>allow_experimental_low_cardinality_type</code> can be used with no effect. <a href=https://github.com/ClickHouse/ClickHouse/commit/0f15c01c6802f7ce1a1494c12c846be8c98944cd rel="external nofollow noreferrer">0f15c01c6802f7ce1a1494c12c846be8c98944cd</a> <a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">Alexey Milovidov</a></li> </ul> <h3 id=performance-improvement_3>Performance Improvement<a class=headerlink href=#performance-improvement_3 title="Permanent link">&para;</a></h3> <ul> <li>Increase number of streams to SELECT from Merge table for more uniform distribution of threads. Added setting <code>max_streams_multiplier_for_merge_tables</code>. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5797 rel="external nofollow noreferrer">#5797</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5915 rel="external nofollow noreferrer">#5915</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_6>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_6 title="Permanent link">&para;</a></h3> <ul> <li>Add a backward compatibility test for client-server interaction with different versions of clickhouse. <a href=https://github.com/ClickHouse/ClickHouse/pull/5868 rel="external nofollow noreferrer">#5868</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Test coverage information in every commit and pull request. <a href=https://github.com/ClickHouse/ClickHouse/pull/5896 rel="external nofollow noreferrer">#5896</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Cooperate with address sanitizer to support our custom allocators (<code>Arena</code> and <code>ArenaWithFreeLists</code>) for better debugging of "use-after-free" errors. <a href=https://github.com/ClickHouse/ClickHouse/pull/5728 rel="external nofollow noreferrer">#5728</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Switch to <a href=https://github.com/llvm-mirror/libunwind rel="external nofollow noreferrer">LLVM libunwind implementation</a> for C++ exception handling and for stack traces printing <a href=https://github.com/ClickHouse/ClickHouse/pull/4828 rel="external nofollow noreferrer">#4828</a> (<a href=https://github.com/laplab rel="external nofollow noreferrer">Nikita Lapkov</a>)</li> <li>Add two more warnings from -Weverything <a href=https://github.com/ClickHouse/ClickHouse/pull/5923 rel="external nofollow noreferrer">#5923</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Allow to build ClickHouse with Memory Sanitizer. <a href=https://github.com/ClickHouse/ClickHouse/pull/3949 rel="external nofollow noreferrer">#3949</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed ubsan report about <code>bitTest</code> function in fuzz test. <a href=https://github.com/ClickHouse/ClickHouse/pull/5943 rel="external nofollow noreferrer">#5943</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Docker: added possibility to init a ClickHouse instance which requires authentication. <a href=https://github.com/ClickHouse/ClickHouse/pull/5727 rel="external nofollow noreferrer">#5727</a> (<a href=https://github.com/shurshun rel="external nofollow noreferrer">Korviakov Andrey</a>)</li> <li>Update librdkafka to version 1.1.0 <a href=https://github.com/ClickHouse/ClickHouse/pull/5872 rel="external nofollow noreferrer">#5872</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Add global timeout for integration tests and disable some of them in tests code. <a href=https://github.com/ClickHouse/ClickHouse/pull/5741 rel="external nofollow noreferrer">#5741</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix some ThreadSanitizer failures. <a href=https://github.com/ClickHouse/ClickHouse/pull/5854 rel="external nofollow noreferrer">#5854</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>The <code>--no-undefined</code> option forces the linker to check all external names for existence while linking. It's very useful to track real dependencies between libraries in the split build mode. <a href=https://github.com/ClickHouse/ClickHouse/pull/5855 rel="external nofollow noreferrer">#5855</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Added performance test for <a href=https://github.com/ClickHouse/ClickHouse/issues/5797 rel="external nofollow noreferrer">#5797</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5914 rel="external nofollow noreferrer">#5914</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed compatibility with gcc-7. <a href=https://github.com/ClickHouse/ClickHouse/pull/5840 rel="external nofollow noreferrer">#5840</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added support for gcc-9. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/5717 rel="external nofollow noreferrer">#5717</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5774 rel="external nofollow noreferrer">#5774</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed error when libunwind can be linked incorrectly. <a href=https://github.com/ClickHouse/ClickHouse/pull/5948 rel="external nofollow noreferrer">#5948</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed a few warnings found by PVS-Studio. <a href=https://github.com/ClickHouse/ClickHouse/pull/5921 rel="external nofollow noreferrer">#5921</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added initial support for <code>clang-tidy</code> static analyzer. <a href=https://github.com/ClickHouse/ClickHouse/pull/5806 rel="external nofollow noreferrer">#5806</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Convert BSD/Linux endian macros( 'be64toh' and 'htobe64') to the Mac OS X equivalents <a href=https://github.com/ClickHouse/ClickHouse/pull/5785 rel="external nofollow noreferrer">#5785</a> (<a href=https://github.com/fredchenbj rel="external nofollow noreferrer">Fu Chen</a>)</li> <li>Improved integration tests guide. <a href=https://github.com/ClickHouse/ClickHouse/pull/5796 rel="external nofollow noreferrer">#5796</a> (<a href=https://github.com/excitoon rel="external nofollow noreferrer">Vladimir Chebotarev</a>)</li> <li>Fixing build at macosx + gcc9 <a href=https://github.com/ClickHouse/ClickHouse/pull/5822 rel="external nofollow noreferrer">#5822</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Fix a hard-to-spot typo: aggreAGte -&gt; aggregate. <a href=https://github.com/ClickHouse/ClickHouse/pull/5753 rel="external nofollow noreferrer">#5753</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Fix freebsd build <a href=https://github.com/ClickHouse/ClickHouse/pull/5760 rel="external nofollow noreferrer">#5760</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Add link to experimental YouTube channel to website <a href=https://github.com/ClickHouse/ClickHouse/pull/5845 rel="external nofollow noreferrer">#5845</a> (<a href=https://github.com/blinkov rel="external nofollow noreferrer">Ivan Blinkov</a>)</li> <li>CMake: add option for coverage flags: WITH_COVERAGE <a href=https://github.com/ClickHouse/ClickHouse/pull/5776 rel="external nofollow noreferrer">#5776</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix initial size of some inline PODArray's. <a href=https://github.com/ClickHouse/ClickHouse/pull/5787 rel="external nofollow noreferrer">#5787</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>clickhouse-server.postinst: fix os detection for centos 6 <a href=https://github.com/ClickHouse/ClickHouse/pull/5788 rel="external nofollow noreferrer">#5788</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Added Arch linux package generation. <a href=https://github.com/ClickHouse/ClickHouse/pull/5719 rel="external nofollow noreferrer">#5719</a> (<a href=https://github.com/excitoon rel="external nofollow noreferrer">Vladimir Chebotarev</a>)</li> <li>Split Common/config.h by libs (dbms) <a href=https://github.com/ClickHouse/ClickHouse/pull/5715 rel="external nofollow noreferrer">#5715</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixes for "Arcadia" build platform <a href=https://github.com/ClickHouse/ClickHouse/pull/5795 rel="external nofollow noreferrer">#5795</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixes for unconventional build (gcc9, no submodules) <a href=https://github.com/ClickHouse/ClickHouse/pull/5792 rel="external nofollow noreferrer">#5792</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Require explicit type in unalignedStore because it was proven to be bug-prone <a href=https://github.com/ClickHouse/ClickHouse/pull/5791 rel="external nofollow noreferrer">#5791</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Fixes MacOS build <a href=https://github.com/ClickHouse/ClickHouse/pull/5830 rel="external nofollow noreferrer">#5830</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Performance test concerning the new JIT feature with bigger dataset, as requested here <a href=https://github.com/ClickHouse/ClickHouse/issues/5263 rel="external nofollow noreferrer">#5263</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5887 rel="external nofollow noreferrer">#5887</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Run stateful tests in stress test <a href=https://github.com/ClickHouse/ClickHouse/commit/12693e568722f11e19859742f56428455501fd2a rel="external nofollow noreferrer">12693e568722f11e19859742f56428455501fd2a</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> </ul> <h3 id=backward-incompatible-change_6>Backward Incompatible Change<a class=headerlink href=#backward-incompatible-change_6 title="Permanent link">&para;</a></h3> <ul> <li><code>Kafka</code> is broken in this version.</li> <li>Enable <code>adaptive_index_granularity</code> = 10MB by default for new <code>MergeTree</code> tables. If you created new MergeTree tables on version 19.11+, downgrade to versions prior to 19.6 will be impossible. <a href=https://github.com/ClickHouse/ClickHouse/pull/5628 rel="external nofollow noreferrer">#5628</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Removed obsolete undocumented embedded dictionaries that were used by Yandex.Metrica. The functions <code>OSIn</code>, <code>SEIn</code>, <code>OSToRoot</code>, <code>SEToRoot</code>, <code>OSHierarchy</code>, <code>SEHierarchy</code> are no longer available. If you are using these functions, write email to <a href=mailto:clickhouse-feedback@yandex-team.com>&#99;&#108;&#105;&#99;&#107;&#104;&#111;&#117;&#115;&#101;&#45;&#102;&#101;&#101;&#100;&#98;&#97;&#99;&#107;&#64;&#121;&#97;&#110;&#100;&#101;&#120;&#45;&#116;&#101;&#97;&#109;&#46;&#99;&#111;&#109;</a>. Note: at the last moment we decided to keep these functions for a while. <a href=https://github.com/ClickHouse/ClickHouse/pull/5780 rel="external nofollow noreferrer">#5780</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-10-1-5-2019-07-12>ClickHouse release 19.10.1.5, 2019-07-12<a class=headerlink href=#clickhouse-release-19-10-1-5-2019-07-12 title="Permanent link">&para;</a></h2> <h3 id=new-feature_5>New Feature<a class=headerlink href=#new-feature_5 title="Permanent link">&para;</a></h3> <ul> <li>Add new column codec: <code>T64</code>. Made for (U)IntX/EnumX/Data(Time)/DecimalX columns. It should be good for columns with constant or small range values. Codec itself allows enlarge or shrink data type without re-compression. <a href=https://github.com/ClickHouse/ClickHouse/pull/5557 rel="external nofollow noreferrer">#5557</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Add database engine <code>MySQL</code> that allow to view all the tables in remote MySQL server <a href=https://github.com/ClickHouse/ClickHouse/pull/5599 rel="external nofollow noreferrer">#5599</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li><code>bitmapContains</code> implementation. It's 2x faster than <code>bitmapHasAny</code> if the second bitmap contains one element. <a href=https://github.com/ClickHouse/ClickHouse/pull/5535 rel="external nofollow noreferrer">#5535</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang Yu</a>)</li> <li>Support for <code>crc32</code> function (with behaviour exactly as in MySQL or PHP). Do not use it if you need a hash function. <a href=https://github.com/ClickHouse/ClickHouse/pull/5661 rel="external nofollow noreferrer">#5661</a> (<a href=https://github.com/BHYCHIK rel="external nofollow noreferrer">Remen Ivan</a>)</li> <li>Implemented <code>SYSTEM START/STOP DISTRIBUTED SENDS</code> queries to control asynchronous inserts into <code>Distributed</code> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/4935 rel="external nofollow noreferrer">#4935</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> </ul> <h3 id=bug-fix_20>Bug Fix<a class=headerlink href=#bug-fix_20 title="Permanent link">&para;</a></h3> <ul> <li>Ignore query execution limits and max parts size for merge limits while executing mutations. <a href=https://github.com/ClickHouse/ClickHouse/pull/5659 rel="external nofollow noreferrer">#5659</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fix bug which may lead to deduplication of normal blocks (extremely rare) and insertion of duplicate blocks (more often). <a href=https://github.com/ClickHouse/ClickHouse/pull/5549 rel="external nofollow noreferrer">#5549</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix of function <code>arrayEnumerateUniqRanked</code> for arguments with empty arrays <a href=https://github.com/ClickHouse/ClickHouse/pull/5559 rel="external nofollow noreferrer">#5559</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Don't subscribe to Kafka topics without intent to poll any messages. <a href=https://github.com/ClickHouse/ClickHouse/pull/5698 rel="external nofollow noreferrer">#5698</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Make setting <code>join_use_nulls</code> get no effect for types that cannot be inside Nullable <a href=https://github.com/ClickHouse/ClickHouse/pull/5700 rel="external nofollow noreferrer">#5700</a> (<a href=https://github.com/stavrolia rel="external nofollow noreferrer">Olga Khvostikova</a>)</li> <li>Fixed <code>Incorrect size of index granularity</code> errors <a href=https://github.com/ClickHouse/ClickHouse/pull/5720 rel="external nofollow noreferrer">#5720</a> (<a href=https://github.com/coraxster rel="external nofollow noreferrer">coraxster</a>)</li> <li>Fix Float to Decimal convert overflow <a href=https://github.com/ClickHouse/ClickHouse/pull/5607 rel="external nofollow noreferrer">#5607</a> (<a href=https://github.com/coraxster rel="external nofollow noreferrer">coraxster</a>)</li> <li>Flush buffer when <code>WriteBufferFromHDFS</code>'s destructor is called. This fixes writing into <code>HDFS</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5684 rel="external nofollow noreferrer">#5684</a> (<a href=https://github.com/eejoin rel="external nofollow noreferrer">Xindong Peng</a>)</li> </ul> <h3 id=improvement_6>Improvement<a class=headerlink href=#improvement_6 title="Permanent link">&para;</a></h3> <ul> <li>Treat empty cells in <code>CSV</code> as default values when the setting <code>input_format_defaults_for_omitted_fields</code> is enabled. <a href=https://github.com/ClickHouse/ClickHouse/pull/5625 rel="external nofollow noreferrer">#5625</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Non-blocking loading of external dictionaries. <a href=https://github.com/ClickHouse/ClickHouse/pull/5567 rel="external nofollow noreferrer">#5567</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Network timeouts can be dynamically changed for already established connections according to the settings. <a href=https://github.com/ClickHouse/ClickHouse/pull/4558 rel="external nofollow noreferrer">#4558</a> (<a href=https://github.com/podshumok rel="external nofollow noreferrer">Konstantin Podshumok</a>)</li> <li>Using "public_suffix_list" for functions <code>firstSignificantSubdomain</code>, <code>cutToFirstSignificantSubdomain</code>. It's using a perfect hash table generated by <code>gperf</code> with a list generated from the file: <a href=https://publicsuffix.org/list/public_suffix_list.dat rel="external nofollow noreferrer">https://publicsuffix.org/list/public_suffix_list.dat</a>. (for example, now we recognize the domain <code>ac.uk</code> as non-significant). <a href=https://github.com/ClickHouse/ClickHouse/pull/5030 rel="external nofollow noreferrer">#5030</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Adopted <code>IPv6</code> data type in system tables; unified client info columns in <code>system.processes</code> and <code>system.query_log</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/5640 rel="external nofollow noreferrer">#5640</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Using sessions for connections with MySQL compatibility protocol. #5476 <a href=https://github.com/ClickHouse/ClickHouse/pull/5646 rel="external nofollow noreferrer">#5646</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Support more <code>ALTER</code> queries <code>ON CLUSTER</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5593 rel="external nofollow noreferrer">#5593</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5613 rel="external nofollow noreferrer">#5613</a> (<a href=https://github.com/sundy-li rel="external nofollow noreferrer">sundyli</a>)</li> <li>Support <code>&lt;logger&gt;</code> section in <code>clickhouse-local</code> config file. <a href=https://github.com/ClickHouse/ClickHouse/pull/5540 rel="external nofollow noreferrer">#5540</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Allow run query with <code>remote</code> table function in <code>clickhouse-local</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/5627 rel="external nofollow noreferrer">#5627</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=performance-improvement_4>Performance Improvement<a class=headerlink href=#performance-improvement_4 title="Permanent link">&para;</a></h3> <ul> <li>Add the possibility to write the final mark at the end of MergeTree columns. It allows to avoid useless reads for keys that are out of table data range. It is enabled only if adaptive index granularity is in use. <a href=https://github.com/ClickHouse/ClickHouse/pull/5624 rel="external nofollow noreferrer">#5624</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Improved performance of MergeTree tables on very slow filesystems by reducing number of <code>stat</code> syscalls. <a href=https://github.com/ClickHouse/ClickHouse/pull/5648 rel="external nofollow noreferrer">#5648</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed performance degradation in reading from MergeTree tables that was introduced in version 19.6. Fixes #5631. <a href=https://github.com/ClickHouse/ClickHouse/pull/5633 rel="external nofollow noreferrer">#5633</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_7>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_7 title="Permanent link">&para;</a></h3> <ul> <li>Implemented <code>TestKeeper</code> as an implementation of ZooKeeper interface used for testing <a href=https://github.com/ClickHouse/ClickHouse/pull/5643 rel="external nofollow noreferrer">#5643</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>) (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">levushkin aleksej</a>)</li> <li>From now on <code>.sql</code> tests can be run isolated by server, in parallel, with random database. It allows to run them faster, add new tests with custom server configurations, and be sure that different tests doesn't affect each other. <a href=https://github.com/ClickHouse/ClickHouse/pull/5554 rel="external nofollow noreferrer">#5554</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Remove <code>&lt;name&gt;</code> and <code>&lt;metrics&gt;</code> from performance tests <a href=https://github.com/ClickHouse/ClickHouse/pull/5672 rel="external nofollow noreferrer">#5672</a> (<a href=https://github.com/stavrolia rel="external nofollow noreferrer">Olga Khvostikova</a>)</li> <li>Fixed "select_format" performance test for <code>Pretty</code> formats <a href=https://github.com/ClickHouse/ClickHouse/pull/5642 rel="external nofollow noreferrer">#5642</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-9-3-31-2019-07-05>ClickHouse release 19.9.3.31, 2019-07-05<a class=headerlink href=#clickhouse-release-19-9-3-31-2019-07-05 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_21>Bug Fix<a class=headerlink href=#bug-fix_21 title="Permanent link">&para;</a></h3> <ul> <li>Fix segfault in Delta codec which affects columns with values less than 32 bits size. The bug led to random memory corruption. <a href=https://github.com/ClickHouse/ClickHouse/pull/5786 rel="external nofollow noreferrer">#5786</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix rare bug in checking of part with LowCardinality column. <a href=https://github.com/ClickHouse/ClickHouse/pull/5832 rel="external nofollow noreferrer">#5832</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix segfault in TTL merge with non-physical columns in block. <a href=https://github.com/ClickHouse/ClickHouse/pull/5819 rel="external nofollow noreferrer">#5819</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fix potential infinite sleeping of low-priority queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/5842 rel="external nofollow noreferrer">#5842</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix how ClickHouse determines default time zone as UCT instead of UTC. <a href=https://github.com/ClickHouse/ClickHouse/pull/5828 rel="external nofollow noreferrer">#5828</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix bug about executing distributed DROP/ALTER/TRUNCATE/OPTIMIZE ON CLUSTER queries on follower replica before leader replica. Now they will be executed directly on leader replica. <a href=https://github.com/ClickHouse/ClickHouse/pull/5757 rel="external nofollow noreferrer">#5757</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix race condition, which cause that some queries may not appear in query_log instantly after SYSTEM FLUSH LOGS query. <a href=https://github.com/ClickHouse/ClickHouse/pull/5685 rel="external nofollow noreferrer">#5685</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Added missing support for constant arguments to <code>evalMLModel</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/5820 rel="external nofollow noreferrer">#5820</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-7-5-29-2019-07-05>ClickHouse release 19.7.5.29, 2019-07-05<a class=headerlink href=#clickhouse-release-19-7-5-29-2019-07-05 title="Permanent link">&para;</a></h2> <h3 id=bug-fix_22>Bug Fix<a class=headerlink href=#bug-fix_22 title="Permanent link">&para;</a></h3> <ul> <li>Fix performance regression in some queries with JOIN. <a href=https://github.com/ClickHouse/ClickHouse/pull/5192 rel="external nofollow noreferrer">#5192</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> </ul> <h2 id=clickhouse-release-19-9-2-4-2019-06-24>ClickHouse release 19.9.2.4, 2019-06-24<a class=headerlink href=#clickhouse-release-19-9-2-4-2019-06-24 title="Permanent link">&para;</a></h2> <h3 id=new-feature_6>New Feature<a class=headerlink href=#new-feature_6 title="Permanent link">&para;</a></h3> <ul> <li>Print information about frozen parts in <code>system.parts</code> table. <a href=https://github.com/ClickHouse/ClickHouse/pull/5471 rel="external nofollow noreferrer">#5471</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Ask client password on clickhouse-client start on tty if not set in arguments <a href=https://github.com/ClickHouse/ClickHouse/pull/5092 rel="external nofollow noreferrer">#5092</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Implement <code>dictGet</code> and <code>dictGetOrDefault</code> functions for Decimal types. <a href=https://github.com/ClickHouse/ClickHouse/pull/5394 rel="external nofollow noreferrer">#5394</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=improvement_7>Improvement<a class=headerlink href=#improvement_7 title="Permanent link">&para;</a></h3> <ul> <li>Debian init: Add service stop timeout <a href=https://github.com/ClickHouse/ClickHouse/pull/5522 rel="external nofollow noreferrer">#5522</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Add setting forbidden by default to create table with suspicious types for LowCardinality <a href=https://github.com/ClickHouse/ClickHouse/pull/5448 rel="external nofollow noreferrer">#5448</a> (<a href=https://github.com/stavrolia rel="external nofollow noreferrer">Olga Khvostikova</a>)</li> <li>Regression functions return model weights when not used as State in function <code>evalMLMethod</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5411 rel="external nofollow noreferrer">#5411</a> (<a href=https://github.com/Quid37 rel="external nofollow noreferrer">Quid37</a>)</li> <li>Rename and improve regression methods. <a href=https://github.com/ClickHouse/ClickHouse/pull/5492 rel="external nofollow noreferrer">#5492</a> (<a href=https://github.com/Quid37 rel="external nofollow noreferrer">Quid37</a>)</li> <li>Clearer interfaces of string searchers. <a href=https://github.com/ClickHouse/ClickHouse/pull/5586 rel="external nofollow noreferrer">#5586</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> </ul> <h3 id=bug-fix_23>Bug Fix<a class=headerlink href=#bug-fix_23 title="Permanent link">&para;</a></h3> <ul> <li>Fix potential data loss in Kafka <a href=https://github.com/ClickHouse/ClickHouse/pull/5445 rel="external nofollow noreferrer">#5445</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fix potential infinite loop in <code>PrettySpace</code> format when called with zero columns <a href=https://github.com/ClickHouse/ClickHouse/pull/5560 rel="external nofollow noreferrer">#5560</a> (<a href=https://github.com/stavrolia rel="external nofollow noreferrer">Olga Khvostikova</a>)</li> <li>Fixed UInt32 overflow bug in linear models. Allow eval ML model for non-const model argument. <a href=https://github.com/ClickHouse/ClickHouse/pull/5516 rel="external nofollow noreferrer">#5516</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li><code>ALTER TABLE ... DROP INDEX IF EXISTS ...</code> should not raise an exception if provided index does not exist <a href=https://github.com/ClickHouse/ClickHouse/pull/5524 rel="external nofollow noreferrer">#5524</a> (<a href=https://github.com/NanoBjorn rel="external nofollow noreferrer">Gleb Novikov</a>)</li> <li>Fix segfault with <code>bitmapHasAny</code> in scalar subquery <a href=https://github.com/ClickHouse/ClickHouse/pull/5528 rel="external nofollow noreferrer">#5528</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang Yu</a>)</li> <li>Fixed error when replication connection pool doesn't retry to resolve host, even when DNS cache was dropped. <a href=https://github.com/ClickHouse/ClickHouse/pull/5534 rel="external nofollow noreferrer">#5534</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed <code>ALTER ... MODIFY TTL</code> on ReplicatedMergeTree. <a href=https://github.com/ClickHouse/ClickHouse/pull/5539 rel="external nofollow noreferrer">#5539</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Fix INSERT into Distributed table with MATERIALIZED column <a href=https://github.com/ClickHouse/ClickHouse/pull/5429 rel="external nofollow noreferrer">#5429</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Fix bad alloc when truncate Join storage <a href=https://github.com/ClickHouse/ClickHouse/pull/5437 rel="external nofollow noreferrer">#5437</a> (<a href=https://github.com/TCeason rel="external nofollow noreferrer">TCeason</a>)</li> <li>In recent versions of package tzdata some of files are symlinks now. The current mechanism for detecting default timezone gets broken and gives wrong names for some timezones. Now at least we force the timezone name to the contents of TZ if provided. <a href=https://github.com/ClickHouse/ClickHouse/pull/5443 rel="external nofollow noreferrer">#5443</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fix some extremely rare cases with MultiVolnitsky searcher when the constant needles in sum are at least 16KB long. The algorithm missed or overwrote the previous results which can lead to the incorrect result of <code>multiSearchAny</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5588 rel="external nofollow noreferrer">#5588</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Fix the issue when settings for ExternalData requests couldn't use ClickHouse settings. Also, for now, settings <code>date_time_input_format</code> and <code>low_cardinality_allow_in_native_format</code> cannot be used because of the ambiguity of names (in external data it can be interpreted as table format and in the query it can be a setting). <a href=https://github.com/ClickHouse/ClickHouse/pull/5455 rel="external nofollow noreferrer">#5455</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Fix bug when parts were removed only from FS without dropping them from Zookeeper. <a href=https://github.com/ClickHouse/ClickHouse/pull/5520 rel="external nofollow noreferrer">#5520</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Remove debug logging from MySQL protocol <a href=https://github.com/ClickHouse/ClickHouse/pull/5478 rel="external nofollow noreferrer">#5478</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Skip ZNONODE during DDL query processing <a href=https://github.com/ClickHouse/ClickHouse/pull/5489 rel="external nofollow noreferrer">#5489</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Fix mix <code>UNION ALL</code> result column type. There were cases with inconsistent data and column types of resulting columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/5503 rel="external nofollow noreferrer">#5503</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Throw an exception on wrong integers in <code>dictGetT</code> functions instead of crash. <a href=https://github.com/ClickHouse/ClickHouse/pull/5446 rel="external nofollow noreferrer">#5446</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix wrong element_count and load_factor for hashed dictionary in <code>system.dictionaries</code> table. <a href=https://github.com/ClickHouse/ClickHouse/pull/5440 rel="external nofollow noreferrer">#5440</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_8>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_8 title="Permanent link">&para;</a></h3> <ul> <li>Fixed build without <code>Brotli</code> HTTP compression support (<code>ENABLE_BROTLI=OFF</code> cmake variable). <a href=https://github.com/ClickHouse/ClickHouse/pull/5521 rel="external nofollow noreferrer">#5521</a> (<a href=https://github.com/citrin rel="external nofollow noreferrer">Anton Yuzhaninov</a>)</li> <li>Include roaring.h as roaring/roaring.h <a href=https://github.com/ClickHouse/ClickHouse/pull/5523 rel="external nofollow noreferrer">#5523</a> (<a href=https://github.com/orivej rel="external nofollow noreferrer">Orivej Desh</a>)</li> <li>Fix gcc9 warnings in hyperscan (#line directive is evil!) <a href=https://github.com/ClickHouse/ClickHouse/pull/5546 rel="external nofollow noreferrer">#5546</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Fix all warnings when compiling with gcc-9. Fix some contrib issues. Fix gcc9 ICE and submit it to bugzilla. <a href=https://github.com/ClickHouse/ClickHouse/pull/5498 rel="external nofollow noreferrer">#5498</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Fixed linking with lld <a href=https://github.com/ClickHouse/ClickHouse/pull/5477 rel="external nofollow noreferrer">#5477</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Remove unused specializations in dictionaries <a href=https://github.com/ClickHouse/ClickHouse/pull/5452 rel="external nofollow noreferrer">#5452</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Improvement performance tests for formatting and parsing tables for different types of files <a href=https://github.com/ClickHouse/ClickHouse/pull/5497 rel="external nofollow noreferrer">#5497</a> (<a href=https://github.com/stavrolia rel="external nofollow noreferrer">Olga Khvostikova</a>)</li> <li>Fixes for parallel test run <a href=https://github.com/ClickHouse/ClickHouse/pull/5506 rel="external nofollow noreferrer">#5506</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Docker: use configs from clickhouse-test <a href=https://github.com/ClickHouse/ClickHouse/pull/5531 rel="external nofollow noreferrer">#5531</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix compile for FreeBSD <a href=https://github.com/ClickHouse/ClickHouse/pull/5447 rel="external nofollow noreferrer">#5447</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Upgrade boost to 1.70 <a href=https://github.com/ClickHouse/ClickHouse/pull/5570 rel="external nofollow noreferrer">#5570</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix build clickhouse as submodule <a href=https://github.com/ClickHouse/ClickHouse/pull/5574 rel="external nofollow noreferrer">#5574</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Improve JSONExtract performance tests <a href=https://github.com/ClickHouse/ClickHouse/pull/5444 rel="external nofollow noreferrer">#5444</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> </ul> <h2 id=clickhouse-release-19-8-3-8-2019-06-11>ClickHouse release 19.8.3.8, 2019-06-11<a class=headerlink href=#clickhouse-release-19-8-3-8-2019-06-11 title="Permanent link">&para;</a></h2> <h3 id=new-features>New Features<a class=headerlink href=#new-features title="Permanent link">&para;</a></h3> <ul> <li>Added functions to work with JSON <a href=https://github.com/ClickHouse/ClickHouse/pull/4686 rel="external nofollow noreferrer">#4686</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/5124 rel="external nofollow noreferrer">#5124</a>. (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Add a function basename, with a similar behaviour to a basename function, which exists in a lot of languages (<code>os.path.basename</code> in python, <code>basename</code> in PHP, etc...). Work with both an UNIX-like path or a Windows path. <a href=https://github.com/ClickHouse/ClickHouse/pull/5136 rel="external nofollow noreferrer">#5136</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Added <code>LIMIT n, m BY</code> or <code>LIMIT m OFFSET n BY</code> syntax to set offset of n for LIMIT BY clause. <a href=https://github.com/ClickHouse/ClickHouse/pull/5138 rel="external nofollow noreferrer">#5138</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Added new data type <code>SimpleAggregateFunction</code>, which allows to have columns with light aggregation in an <code>AggregatingMergeTree</code>. This can only be used with simple functions like <code>any</code>, <code>anyLast</code>, <code>sum</code>, <code>min</code>, <code>max</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4629 rel="external nofollow noreferrer">#4629</a> (<a href=https://github.com/bgranvea rel="external nofollow noreferrer">Boris Granveaud</a>)</li> <li>Added support for non-constant arguments in function <code>ngramDistance</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/5198 rel="external nofollow noreferrer">#5198</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Added functions <code>skewPop</code>, <code>skewSamp</code>, <code>kurtPop</code> and <code>kurtSamp</code> to compute for sequence skewness, sample skewness, kurtosis and sample kurtosis respectively. <a href=https://github.com/ClickHouse/ClickHouse/pull/5200 rel="external nofollow noreferrer">#5200</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> <li>Support rename operation for <code>MaterializeView</code> storage. <a href=https://github.com/ClickHouse/ClickHouse/pull/5209 rel="external nofollow noreferrer">#5209</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Added server which allows connecting to ClickHouse using MySQL client. <a href=https://github.com/ClickHouse/ClickHouse/pull/4715 rel="external nofollow noreferrer">#4715</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Add <code>toDecimal*OrZero</code> and <code>toDecimal*OrNull</code> functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/5291 rel="external nofollow noreferrer">#5291</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Support Decimal types in functions: <code>quantile</code>, <code>quantiles</code>, <code>median</code>, <code>quantileExactWeighted</code>, <code>quantilesExactWeighted</code>, medianExactWeighted. <a href=https://github.com/ClickHouse/ClickHouse/pull/5304 rel="external nofollow noreferrer">#5304</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Added <code>toValidUTF8</code> function, which replaces all invalid UTF-8 characters by replacement character � (U+FFFD). <a href=https://github.com/ClickHouse/ClickHouse/pull/5322 rel="external nofollow noreferrer">#5322</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Added <code>format</code> function. Formatting constant pattern (simplified Python format pattern) with the strings listed in the arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/5330 rel="external nofollow noreferrer">#5330</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Added <code>system.detached_parts</code> table containing information about detached parts of <code>MergeTree</code> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/5353 rel="external nofollow noreferrer">#5353</a> (<a href=https://github.com/akuzm rel="external nofollow noreferrer">akuzm</a>)</li> <li>Added <code>ngramSearch</code> function to calculate the non-symmetric difference between needle and haystack. <a href=https://github.com/ClickHouse/ClickHouse/pull/5418 rel="external nofollow noreferrer">#5418</a><a href=https://github.com/ClickHouse/ClickHouse/pull/5422 rel="external nofollow noreferrer">#5422</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Implementation of basic machine learning methods (stochastic linear regression and logistic regression) using aggregate functions interface. Has different strategies for updating model weights (simple gradient descent, momentum method, Nesterov method). Also supports mini-batches of custom size. <a href=https://github.com/ClickHouse/ClickHouse/pull/4943 rel="external nofollow noreferrer">#4943</a> (<a href=https://github.com/Quid37 rel="external nofollow noreferrer">Quid37</a>)</li> <li>Implementation of <code>geohashEncode</code> and <code>geohashDecode</code> functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/5003 rel="external nofollow noreferrer">#5003</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Added aggregate function <code>timeSeriesGroupSum</code>, which can aggregate different time series that sample timestamp not alignment. It will use linear interpolation between two sample timestamp and then sum time-series together. Added aggregate function <code>timeSeriesGroupRateSum</code>, which calculates the rate of time-series and then sum rates together. <a href=https://github.com/ClickHouse/ClickHouse/pull/4542 rel="external nofollow noreferrer">#4542</a> (<a href=https://github.com/LiuYangkuan rel="external nofollow noreferrer">Yangkuan Liu</a>)</li> <li>Added functions <code>IPv4CIDRtoIPv4Range</code> and <code>IPv6CIDRtoIPv6Range</code> to calculate the lower and higher bounds for an IP in the subnet using a CIDR. <a href=https://github.com/ClickHouse/ClickHouse/pull/5095 rel="external nofollow noreferrer">#5095</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> <li>Add a X-ClickHouse-Summary header when we send a query using HTTP with enabled setting <code>send_progress_in_http_headers</code>. Return the usual information of X-ClickHouse-Progress, with additional information like how many rows and bytes were inserted in the query. <a href=https://github.com/ClickHouse/ClickHouse/pull/5116 rel="external nofollow noreferrer">#5116</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume Tassery</a>)</li> </ul> <h3 id=improvements>Improvements<a class=headerlink href=#improvements title="Permanent link">&para;</a></h3> <ul> <li>Added <code>max_parts_in_total</code> setting for MergeTree family of tables (default: 100 000) that prevents unsafe specification of partition key #5166. <a href=https://github.com/ClickHouse/ClickHouse/pull/5171 rel="external nofollow noreferrer">#5171</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>clickhouse-obfuscator</code>: derive seed for individual columns by combining initial seed with column name, not column position. This is intended to transform datasets with multiple related tables, so that tables will remain JOINable after transformation. <a href=https://github.com/ClickHouse/ClickHouse/pull/5178 rel="external nofollow noreferrer">#5178</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added functions <code>JSONExtractRaw</code>, <code>JSONExtractKeyAndValues</code>. Renamed functions <code>jsonExtract&lt;type&gt;</code> to <code>JSONExtract&lt;type&gt;</code>. When something goes wrong these functions return the correspondent values, not <code>NULL</code>. Modified function <code>JSONExtract</code>, now it gets the return type from its last parameter and doesn't inject nullables. Implemented fallback to RapidJSON in case AVX2 instructions are not available. Simdjson library updated to a new version. <a href=https://github.com/ClickHouse/ClickHouse/pull/5235 rel="external nofollow noreferrer">#5235</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Now <code>if</code> and <code>multiIf</code> functions don't rely on the condition's <code>Nullable</code>, but rely on the branches for sql compatibility. <a href=https://github.com/ClickHouse/ClickHouse/pull/5238 rel="external nofollow noreferrer">#5238</a> (<a href=https://github.com/janplus rel="external nofollow noreferrer">Jian Wu</a>)</li> <li><code>In</code> predicate now generates <code>Null</code> result from <code>Null</code> input like the <code>Equal</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/5152 rel="external nofollow noreferrer">#5152</a> (<a href=https://github.com/janplus rel="external nofollow noreferrer">Jian Wu</a>)</li> <li>Check the time limit every (flush_interval / poll_timeout) number of rows from Kafka. This allows to break the reading from Kafka consumer more frequently and to check the time limits for the top-level streams <a href=https://github.com/ClickHouse/ClickHouse/pull/5249 rel="external nofollow noreferrer">#5249</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Link rdkafka with bundled SASL. It should allow to use SASL SCRAM authentication <a href=https://github.com/ClickHouse/ClickHouse/pull/5253 rel="external nofollow noreferrer">#5253</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Batched version of RowRefList for ALL JOINS. <a href=https://github.com/ClickHouse/ClickHouse/pull/5267 rel="external nofollow noreferrer">#5267</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>clickhouse-server: more informative listen error messages. <a href=https://github.com/ClickHouse/ClickHouse/pull/5268 rel="external nofollow noreferrer">#5268</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Support dictionaries in clickhouse-copier for functions in <code>&lt;sharding_key&gt;</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/5270 rel="external nofollow noreferrer">#5270</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Add new setting <code>kafka_commit_every_batch</code> to regulate Kafka committing policy.<br> It allows to set commit mode: after every batch of messages is handled, or after the whole block is written to the storage. It's a trade-off between losing some messages or reading them twice in some extreme situations. <a href=https://github.com/ClickHouse/ClickHouse/pull/5308 rel="external nofollow noreferrer">#5308</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Make <code>windowFunnel</code> support other Unsigned Integer Types. <a href=https://github.com/ClickHouse/ClickHouse/pull/5320 rel="external nofollow noreferrer">#5320</a> (<a href=https://github.com/sundy-li rel="external nofollow noreferrer">sundyli</a>)</li> <li>Allow to shadow virtual column <code>_table</code> in Merge engine. <a href=https://github.com/ClickHouse/ClickHouse/pull/5325 rel="external nofollow noreferrer">#5325</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Make <code>sequenceMatch</code> aggregate functions support other unsigned Integer types <a href=https://github.com/ClickHouse/ClickHouse/pull/5339 rel="external nofollow noreferrer">#5339</a> (<a href=https://github.com/sundy-li rel="external nofollow noreferrer">sundyli</a>)</li> <li>Better error messages if checksum mismatch is most likely caused by hardware failures. <a href=https://github.com/ClickHouse/ClickHouse/pull/5355 rel="external nofollow noreferrer">#5355</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Check that underlying tables support sampling for <code>StorageMerge</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/5366 rel="external nofollow noreferrer">#5366</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Сlose MySQL connections after their usage in external dictionaries. It is related to issue #893. <a href=https://github.com/ClickHouse/ClickHouse/pull/5395 rel="external nofollow noreferrer">#5395</a> (<a href=https://github.com/clemrodriguez rel="external nofollow noreferrer">Clément Rodriguez</a>)</li> <li>Improvements of MySQL Wire Protocol. Changed name of format to MySQLWire. Using RAII for calling RSA_free. Disabling SSL if context cannot be created. <a href=https://github.com/ClickHouse/ClickHouse/pull/5419 rel="external nofollow noreferrer">#5419</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>clickhouse-client: allow to run with unaccessable history file (read-only, no disk space, file is directory, ...). <a href=https://github.com/ClickHouse/ClickHouse/pull/5431 rel="external nofollow noreferrer">#5431</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Respect query settings in asynchronous INSERTs into Distributed tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/4936 rel="external nofollow noreferrer">#4936</a> (<a href=https://github.com/TCeason rel="external nofollow noreferrer">TCeason</a>)</li> <li>Renamed functions <code>leastSqr</code> to <code>simpleLinearRegression</code>, <code>LinearRegression</code> to <code>linearRegression</code>, <code>LogisticRegression</code> to <code>logisticRegression</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5391 rel="external nofollow noreferrer">#5391</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> </ul> <h3 id=performance-improvements>Performance Improvements<a class=headerlink href=#performance-improvements title="Permanent link">&para;</a></h3> <ul> <li>Parallelize processing of parts of non-replicated MergeTree tables in ALTER MODIFY query. <a href=https://github.com/ClickHouse/ClickHouse/pull/4639 rel="external nofollow noreferrer">#4639</a> (<a href=https://github.com/IvanKush rel="external nofollow noreferrer">Ivan Kush</a>)</li> <li>Optimizations in regular expressions extraction. <a href=https://github.com/ClickHouse/ClickHouse/pull/5193 rel="external nofollow noreferrer">#5193</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5191 rel="external nofollow noreferrer">#5191</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Do not add right join key column to join result if it's used only in join on section. <a href=https://github.com/ClickHouse/ClickHouse/pull/5260 rel="external nofollow noreferrer">#5260</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Freeze the Kafka buffer after first empty response. It avoids multiple invokations of <code>ReadBuffer::next()</code> for empty result in some row-parsing streams. <a href=https://github.com/ClickHouse/ClickHouse/pull/5283 rel="external nofollow noreferrer">#5283</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li><code>concat</code> function optimization for multiple arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/5357 rel="external nofollow noreferrer">#5357</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Query optimisation. Allow push down IN statement while rewriting commа/cross join into inner one. <a href=https://github.com/ClickHouse/ClickHouse/pull/5396 rel="external nofollow noreferrer">#5396</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Upgrade our LZ4 implementation with reference one to have faster decompression. <a href=https://github.com/ClickHouse/ClickHouse/pull/5070 rel="external nofollow noreferrer">#5070</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Implemented MSD radix sort (based on kxsort), and partial sorting. <a href=https://github.com/ClickHouse/ClickHouse/pull/5129 rel="external nofollow noreferrer">#5129</a> (<a href=https://github.com/kvinty rel="external nofollow noreferrer">Evgenii Pravda</a>)</li> </ul> <h3 id=bug-fixes>Bug Fixes<a class=headerlink href=#bug-fixes title="Permanent link">&para;</a></h3> <ul> <li>Fix push require columns with join <a href=https://github.com/ClickHouse/ClickHouse/pull/5192 rel="external nofollow noreferrer">#5192</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Fixed bug, when ClickHouse is run by systemd, the command <code>sudo service clickhouse-server forcerestart</code> was not working as expected. <a href=https://github.com/ClickHouse/ClickHouse/pull/5204 rel="external nofollow noreferrer">#5204</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix http error codes in DataPartsExchange (interserver http server on 9009 port always returned code 200, even on errors). <a href=https://github.com/ClickHouse/ClickHouse/pull/5216 rel="external nofollow noreferrer">#5216</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix SimpleAggregateFunction for String longer than MAX_SMALL_STRING_SIZE <a href=https://github.com/ClickHouse/ClickHouse/pull/5311 rel="external nofollow noreferrer">#5311</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Fix error for <code>Decimal</code> to <code>Nullable(Decimal)</code> conversion in IN. Support other Decimal to Decimal conversions (including different scales). <a href=https://github.com/ClickHouse/ClickHouse/pull/5350 rel="external nofollow noreferrer">#5350</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed FPU clobbering in simdjson library that lead to wrong calculation of <code>uniqHLL</code> and <code>uniqCombined</code> aggregate function and math functions such as <code>log</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5354 rel="external nofollow noreferrer">#5354</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed handling mixed const/nonconst cases in JSON functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/5435 rel="external nofollow noreferrer">#5435</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fix <code>retention</code> function. Now all conditions that satisfy in a row of data are added to the data state. <a href=https://github.com/ClickHouse/ClickHouse/pull/5119 rel="external nofollow noreferrer">#5119</a> (<a href=https://github.com/nicelulu rel="external nofollow noreferrer">小路</a>)</li> <li>Fix result type for <code>quantileExact</code> with Decimals. <a href=https://github.com/ClickHouse/ClickHouse/pull/5304 rel="external nofollow noreferrer">#5304</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=documentation>Documentation<a class=headerlink href=#documentation title="Permanent link">&para;</a></h3> <ul> <li>Translate documentation for <code>CollapsingMergeTree</code> to chinese. <a href=https://github.com/ClickHouse/ClickHouse/pull/5168 rel="external nofollow noreferrer">#5168</a> (<a href=https://github.com/AlexZFX rel="external nofollow noreferrer">张风啸</a>)</li> <li>Translate some documentation about table engines to chinese.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5134 rel="external nofollow noreferrer">#5134</a><br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5328 rel="external nofollow noreferrer">#5328</a><br> (<a href=https://github.com/neverlee rel="external nofollow noreferrer">never lee</a>)</li> </ul> <h3 id=build-testing-packaging-improvements>Build/Testing/Packaging Improvements<a class=headerlink href=#build-testing-packaging-improvements title="Permanent link">&para;</a></h3> <ul> <li>Fix some sanitizer reports that show probable use-after-free.<a href=https://github.com/ClickHouse/ClickHouse/pull/5139 rel="external nofollow noreferrer">#5139</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5143 rel="external nofollow noreferrer">#5143</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5393 rel="external nofollow noreferrer">#5393</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Move performance tests out of separate directories for convenience. <a href=https://github.com/ClickHouse/ClickHouse/pull/5158 rel="external nofollow noreferrer">#5158</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix incorrect performance tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/5255 rel="external nofollow noreferrer">#5255</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Added a tool to calculate checksums caused by bit flips to debug hardware issues. <a href=https://github.com/ClickHouse/ClickHouse/pull/5334 rel="external nofollow noreferrer">#5334</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Make runner script more usable. <a href=https://github.com/ClickHouse/ClickHouse/pull/5340 rel="external nofollow noreferrer">#5340</a><a href=https://github.com/ClickHouse/ClickHouse/pull/5360 rel="external nofollow noreferrer">#5360</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Add small instruction how to write performance tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/5408 rel="external nofollow noreferrer">#5408</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Add ability to make substitutions in create, fill and drop query in performance tests <a href=https://github.com/ClickHouse/ClickHouse/pull/5367 rel="external nofollow noreferrer">#5367</a> (<a href=https://github.com/stavrolia rel="external nofollow noreferrer">Olga Khvostikova</a>)</li> </ul> <h2 id=clickhouse-release-19-7-5-27-2019-06-09>ClickHouse release 19.7.5.27, 2019-06-09<a class=headerlink href=#clickhouse-release-19-7-5-27-2019-06-09 title="Permanent link">&para;</a></h2> <h3 id=new-features_1>New features<a class=headerlink href=#new-features_1 title="Permanent link">&para;</a></h3> <ul> <li>Added bitmap related functions <code>bitmapHasAny</code> and <code>bitmapHasAll</code> analogous to <code>hasAny</code> and <code>hasAll</code> functions for arrays. <a href=https://github.com/ClickHouse/ClickHouse/pull/5279 rel="external nofollow noreferrer">#5279</a> (<a href=https://github.com/svladykin rel="external nofollow noreferrer">Sergi Vladykin</a>)</li> </ul> <h3 id=bug-fixes_1>Bug Fixes<a class=headerlink href=#bug-fixes_1 title="Permanent link">&para;</a></h3> <ul> <li>Fix segfault on <code>minmax</code> INDEX with Null value. <a href=https://github.com/ClickHouse/ClickHouse/pull/5246 rel="external nofollow noreferrer">#5246</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Mark all input columns in LIMIT BY as required output. It fixes 'Not found column' error in some distributed queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/5407 rel="external nofollow noreferrer">#5407</a> (<a href=https://github.com/kvap rel="external nofollow noreferrer">Constantin S. Pan</a>)</li> <li>Fix "Column '0' already exists" error in <code>SELECT .. PREWHERE</code> on column with DEFAULT <a href=https://github.com/ClickHouse/ClickHouse/pull/5397 rel="external nofollow noreferrer">#5397</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix <code>ALTER MODIFY TTL</code> query on <code>ReplicatedMergeTree</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5539/commits rel="external nofollow noreferrer">#5539</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Don't crash the server when Kafka consumers have failed to start. <a href=https://github.com/ClickHouse/ClickHouse/pull/5285 rel="external nofollow noreferrer">#5285</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fixed bitmap functions produce wrong result. <a href=https://github.com/ClickHouse/ClickHouse/pull/5359 rel="external nofollow noreferrer">#5359</a> (<a href=https://github.com/andyyzh rel="external nofollow noreferrer">Andy Yang</a>)</li> <li>Fix element_count for hashed dictionary (do not include duplicates) <a href=https://github.com/ClickHouse/ClickHouse/pull/5440 rel="external nofollow noreferrer">#5440</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Use contents of environment variable TZ as the name for timezone. It helps to correctly detect default timezone in some cases.<a href=https://github.com/ClickHouse/ClickHouse/pull/5443 rel="external nofollow noreferrer">#5443</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Do not try to convert integers in <code>dictGetT</code> functions, because it doesn't work correctly. Throw an exception instead. <a href=https://github.com/ClickHouse/ClickHouse/pull/5446 rel="external nofollow noreferrer">#5446</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix settings in ExternalData HTTP request. <a href=https://github.com/ClickHouse/ClickHouse/pull/5455 rel="external nofollow noreferrer">#5455</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila<br> Kutenin</a>)</li> <li>Fix bug when parts were removed only from FS without dropping them from Zookeeper. <a href=https://github.com/ClickHouse/ClickHouse/pull/5520 rel="external nofollow noreferrer">#5520</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix segmentation fault in <code>bitmapHasAny</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/5528 rel="external nofollow noreferrer">#5528</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer">Zhichang Yu</a>)</li> <li>Fixed error when replication connection pool doesn't retry to resolve host, even when DNS cache was dropped. <a href=https://github.com/ClickHouse/ClickHouse/pull/5534 rel="external nofollow noreferrer">#5534</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed <code>DROP INDEX IF EXISTS</code> query. Now <code>ALTER TABLE ... DROP INDEX IF EXISTS ...</code> query doesn't raise an exception if provided index does not exist. <a href=https://github.com/ClickHouse/ClickHouse/pull/5524 rel="external nofollow noreferrer">#5524</a> (<a href=https://github.com/NanoBjorn rel="external nofollow noreferrer">Gleb Novikov</a>)</li> <li>Fix union all supertype column. There were cases with inconsistent data and column types of resulting columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/5503 rel="external nofollow noreferrer">#5503</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Skip ZNONODE during DDL query processing. Before if another node removes the znode in task queue, the one that<br> did not process it, but already get list of children, will terminate the DDLWorker thread. <a href=https://github.com/ClickHouse/ClickHouse/pull/5489 rel="external nofollow noreferrer">#5489</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> <li>Fix INSERT into Distributed() table with MATERIALIZED column. <a href=https://github.com/ClickHouse/ClickHouse/pull/5429 rel="external nofollow noreferrer">#5429</a> (<a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a>)</li> </ul> <h2 id=clickhouse-release-19-7-3-9-2019-05-30>ClickHouse release 19.7.3.9, 2019-05-30<a class=headerlink href=#clickhouse-release-19-7-3-9-2019-05-30 title="Permanent link">&para;</a></h2> <h3 id=new-features_2>New Features<a class=headerlink href=#new-features_2 title="Permanent link">&para;</a></h3> <ul> <li>Allow to limit the range of a setting that can be specified by user.<br> These constraints can be set up in user settings profile.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/4931 rel="external nofollow noreferrer">#4931</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly<br> Baranov</a>)</li> <li>Add a second version of the function <code>groupUniqArray</code> with an optional<br> <code>max_size</code> parameter that limits the size of the resulting array. This<br> behavior is similar to <code>groupArray(max_size)(x)</code> function.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5026 rel="external nofollow noreferrer">#5026</a> (<a href=https://github.com/YiuRULE rel="external nofollow noreferrer">Guillaume<br> Tassery</a>)</li> <li>For TSVWithNames/CSVWithNames input file formats, column order can now be<br> determined from file header. This is controlled by<br> <code>input_format_with_names_use_header</code> parameter.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5081 rel="external nofollow noreferrer">#5081</a><br> (<a href=https://github.com/Akazz rel="external nofollow noreferrer">Alexander</a>)</li> </ul> <h3 id=bug-fixes_2>Bug Fixes<a class=headerlink href=#bug-fixes_2 title="Permanent link">&para;</a></h3> <ul> <li>Crash with uncompressed_cache + JOIN during merge (#5197)<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5133 rel="external nofollow noreferrer">#5133</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila<br> Kutenin</a>)</li> <li>Segmentation fault on a clickhouse-client query to system tables. #5066<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5127 rel="external nofollow noreferrer">#5127</a><br> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Data loss on heavy load via KafkaEngine (#4736)<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5080 rel="external nofollow noreferrer">#5080</a><br> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Fixed very rare data race condition that could happen when executing a query with UNION ALL involving at least two SELECTs from system.columns, system.tables, system.parts, system.parts_tables or tables of Merge family and performing ALTER of columns of the related tables concurrently. <a href=https://github.com/ClickHouse/ClickHouse/pull/5189 rel="external nofollow noreferrer">#5189</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=performance-improvements_1>Performance Improvements<a class=headerlink href=#performance-improvements_1 title="Permanent link">&para;</a></h3> <ul> <li>Use radix sort for sorting by single numeric column in <code>ORDER BY</code> without<br> <code>LIMIT</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/5106 rel="external nofollow noreferrer">#5106</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/4439 rel="external nofollow noreferrer">#4439</a><br> (<a href=https://github.com/kvinty rel="external nofollow noreferrer">Evgenii Pravda</a>,<br> <a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=documentation_1>Documentation<a class=headerlink href=#documentation_1 title="Permanent link">&para;</a></h3> <ul> <li>Translate documentation for some table engines to Chinese.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5107 rel="external nofollow noreferrer">#5107</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5094 rel="external nofollow noreferrer">#5094</a>,<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5087 rel="external nofollow noreferrer">#5087</a><br> (<a href=https://github.com/AlexZFX rel="external nofollow noreferrer">张风啸</a>),<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5068 rel="external nofollow noreferrer">#5068</a> (<a href=https://github.com/neverlee rel="external nofollow noreferrer">never<br> lee</a>)</li> </ul> <h3 id=build-testing-packaging-improvements_1>Build/Testing/Packaging Improvements<a class=headerlink href=#build-testing-packaging-improvements_1 title="Permanent link">&para;</a></h3> <ul> <li>Print UTF-8 characters properly in <code>clickhouse-test</code>.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5084 rel="external nofollow noreferrer">#5084</a><br> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Add command line parameter for clickhouse-client to always load suggestion<br> data. <a href=https://github.com/ClickHouse/ClickHouse/pull/5102 rel="external nofollow noreferrer">#5102</a><br> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Resolve some of PVS-Studio warnings.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5082 rel="external nofollow noreferrer">#5082</a><br> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Update LZ4 <a href=https://github.com/ClickHouse/ClickHouse/pull/5040 rel="external nofollow noreferrer">#5040</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila<br> Kutenin</a>)</li> <li>Add gperf to build requirements for upcoming pull request #5030.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/5110 rel="external nofollow noreferrer">#5110</a><br> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h2 id=clickhouse-release-19-6-3-18-2019-06-13>ClickHouse release 19.6.3.18, 2019-06-13<a class=headerlink href=#clickhouse-release-19-6-3-18-2019-06-13 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_3>Bug Fixes<a class=headerlink href=#bug-fixes_3 title="Permanent link">&para;</a></h3> <ul> <li>Fixed IN condition pushdown for queries from table functions <code>mysql</code> and <code>odbc</code> and corresponding table engines. This fixes #3540 and #2384. <a href=https://github.com/ClickHouse/ClickHouse/pull/5313 rel="external nofollow noreferrer">#5313</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix deadlock in Zookeeper. <a href=https://github.com/ClickHouse/ClickHouse/pull/5297 rel="external nofollow noreferrer">#5297</a> (<a href=https://github.com/github1youlc rel="external nofollow noreferrer">github1youlc</a>)</li> <li>Allow quoted decimals in CSV. <a href=https://github.com/ClickHouse/ClickHouse/pull/5284 rel="external nofollow noreferrer">#5284</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a></li> <li>Disallow conversion from float Inf/NaN into Decimals (throw exception). <a href=https://github.com/ClickHouse/ClickHouse/pull/5282 rel="external nofollow noreferrer">#5282</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix data race in rename query. <a href=https://github.com/ClickHouse/ClickHouse/pull/5247 rel="external nofollow noreferrer">#5247</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Temporarily disable LFAlloc. Usage of LFAlloc might lead to a lot of MAP_FAILED in allocating UncompressedCache and in a result to crashes of queries at high loaded servers. <a href=https://github.com/ClickHouse/ClickHouse/commit/cfdba938ce22f16efeec504f7f90206a515b1280 rel="external nofollow noreferrer">cfdba93</a>(<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> </ul> <h2 id=clickhouse-release-19-6-2-11-2019-05-13>ClickHouse release 19.6.2.11, 2019-05-13<a class=headerlink href=#clickhouse-release-19-6-2-11-2019-05-13 title="Permanent link">&para;</a></h2> <h3 id=new-features_3>New Features<a class=headerlink href=#new-features_3 title="Permanent link">&para;</a></h3> <ul> <li>TTL expressions for columns and tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/4212 rel="external nofollow noreferrer">#4212</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer">Anton Popov</a>)</li> <li>Added support for <code>brotli</code> compression for HTTP responses (Accept-Encoding: br) <a href=https://github.com/ClickHouse/ClickHouse/pull/4388 rel="external nofollow noreferrer">#4388</a> (<a href=https://github.com/fandyushin rel="external nofollow noreferrer">Mikhail</a>)</li> <li>Added new function <code>isValidUTF8</code> for checking whether a set of bytes is correctly utf-8 encoded. <a href=https://github.com/ClickHouse/ClickHouse/pull/4934 rel="external nofollow noreferrer">#4934</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Add new load balancing policy <code>first_or_random</code> which sends queries to the first specified host and if it's inaccessible send queries to random hosts of shard. Useful for cross-replication topology setups. <a href=https://github.com/ClickHouse/ClickHouse/pull/5012 rel="external nofollow noreferrer">#5012</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> </ul> <h3 id=experimental-features_1>Experimental Features<a class=headerlink href=#experimental-features_1 title="Permanent link">&para;</a></h3> <ul> <li>Add setting <code>index_granularity_bytes</code> (adaptive index granularity) for MergeTree* tables family. <a href=https://github.com/ClickHouse/ClickHouse/pull/4826 rel="external nofollow noreferrer">#4826</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> </ul> <h3 id=improvements_1>Improvements<a class=headerlink href=#improvements_1 title="Permanent link">&para;</a></h3> <ul> <li>Added support for non-constant and negative size and length arguments for function <code>substringUTF8</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4989 rel="external nofollow noreferrer">#4989</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Disable push-down to right table in left join, left table in right join, and both tables in full join. This fixes wrong JOIN results in some cases. <a href=https://github.com/ClickHouse/ClickHouse/pull/4846 rel="external nofollow noreferrer">#4846</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li><code>clickhouse-copier</code>: auto upload task configuration from <code>--task-file</code> option <a href=https://github.com/ClickHouse/ClickHouse/pull/4876 rel="external nofollow noreferrer">#4876</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Added typos handler for storage factory and table functions factory. <a href=https://github.com/ClickHouse/ClickHouse/pull/4891 rel="external nofollow noreferrer">#4891</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Support asterisks and qualified asterisks for multiple joins without subqueries <a href=https://github.com/ClickHouse/ClickHouse/pull/4898 rel="external nofollow noreferrer">#4898</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Make missing column error message more user friendly. <a href=https://github.com/ClickHouse/ClickHouse/pull/4915 rel="external nofollow noreferrer">#4915</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=performance-improvements_2>Performance Improvements<a class=headerlink href=#performance-improvements_2 title="Permanent link">&para;</a></h3> <ul> <li>Significant speedup of ASOF JOIN <a href=https://github.com/ClickHouse/ClickHouse/pull/4924 rel="external nofollow noreferrer">#4924</a> (<a href=https://github.com/Gladdy rel="external nofollow noreferrer">Martijn Bakker</a>)</li> </ul> <h3 id=backward-incompatible-changes>Backward Incompatible Changes<a class=headerlink href=#backward-incompatible-changes title="Permanent link">&para;</a></h3> <ul> <li>HTTP header <code>Query-Id</code> was renamed to <code>X-ClickHouse-Query-Id</code> for consistency. <a href=https://github.com/ClickHouse/ClickHouse/pull/4972 rel="external nofollow noreferrer">#4972</a> (<a href=https://github.com/fandyushin rel="external nofollow noreferrer">Mikhail</a>)</li> </ul> <h3 id=bug-fixes_4>Bug Fixes<a class=headerlink href=#bug-fixes_4 title="Permanent link">&para;</a></h3> <ul> <li>Fixed potential null pointer dereference in <code>clickhouse-copier</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4900 rel="external nofollow noreferrer">#4900</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed error on query with JOIN + ARRAY JOIN <a href=https://github.com/ClickHouse/ClickHouse/pull/4938 rel="external nofollow noreferrer">#4938</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed hanging on start of the server when a dictionary depends on another dictionary via a database with engine=Dictionary. <a href=https://github.com/ClickHouse/ClickHouse/pull/4962 rel="external nofollow noreferrer">#4962</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Partially fix distributed_product_mode = local. It's possible to allow columns of local tables in where/having/order by/... via table aliases. Throw exception if table does not have alias. There's not possible to access to the columns without table aliases yet. <a href=https://github.com/ClickHouse/ClickHouse/pull/4986 rel="external nofollow noreferrer">#4986</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix potentially wrong result for <code>SELECT DISTINCT</code> with <code>JOIN</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/5001 rel="external nofollow noreferrer">#5001</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed very rare data race condition that could happen when executing a query with UNION ALL involving at least two SELECTs from system.columns, system.tables, system.parts, system.parts_tables or tables of Merge family and performing ALTER of columns of the related tables concurrently. <a href=https://github.com/ClickHouse/ClickHouse/pull/5189 rel="external nofollow noreferrer">#5189</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=build-testing-packaging-improvements_2>Build/Testing/Packaging Improvements<a class=headerlink href=#build-testing-packaging-improvements_2 title="Permanent link">&para;</a></h3> <ul> <li>Fixed test failures when running clickhouse-server on different host <a href=https://github.com/ClickHouse/ClickHouse/pull/4713 rel="external nofollow noreferrer">#4713</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>clickhouse-test: Disable color control sequences in non tty environment. <a href=https://github.com/ClickHouse/ClickHouse/pull/4937 rel="external nofollow noreferrer">#4937</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>clickhouse-test: Allow use any test database (remove <code>test.</code> qualification where it possible) <a href=https://github.com/ClickHouse/ClickHouse/pull/5008 rel="external nofollow noreferrer">#5008</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix ubsan errors <a href=https://github.com/ClickHouse/ClickHouse/pull/5037 rel="external nofollow noreferrer">#5037</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Yandex LFAlloc was added to ClickHouse to allocate MarkCache and UncompressedCache data in different ways to catch segfaults more reliable <a href=https://github.com/ClickHouse/ClickHouse/pull/4995 rel="external nofollow noreferrer">#4995</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Python util to help with backports and changelogs. <a href=https://github.com/ClickHouse/ClickHouse/pull/4949 rel="external nofollow noreferrer">#4949</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h2 id=clickhouse-release-19-5-4-22-2019-05-13>ClickHouse release 19.5.4.22, 2019-05-13<a class=headerlink href=#clickhouse-release-19-5-4-22-2019-05-13 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_5>Bug fixes<a class=headerlink href=#bug-fixes_5 title="Permanent link">&para;</a></h3> <ul> <li>Fixed possible crash in bitmap* functions <a href=https://github.com/ClickHouse/ClickHouse/pull/5220 rel="external nofollow noreferrer">#5220</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/5228 rel="external nofollow noreferrer">#5228</a> (<a href=https://github.com/andyyzh rel="external nofollow noreferrer">Andy Yang</a>)</li> <li>Fixed very rare data race condition that could happen when executing a query with UNION ALL involving at least two SELECTs from system.columns, system.tables, system.parts, system.parts_tables or tables of Merge family and performing ALTER of columns of the related tables concurrently. <a href=https://github.com/ClickHouse/ClickHouse/pull/5189 rel="external nofollow noreferrer">#5189</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed error <code>Set for IN is not created yet in case of using single LowCardinality column in the left part of IN</code>. This error happened if LowCardinality column was the part of primary key. #5031 <a href=https://github.com/ClickHouse/ClickHouse/pull/5154 rel="external nofollow noreferrer">#5154</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Modification of retention function: If a row satisfies both the first and NTH condition, only the first satisfied condition is added to the data state. Now all conditions that satisfy in a row of data are added to the data state. <a href=https://github.com/ClickHouse/ClickHouse/pull/5119 rel="external nofollow noreferrer">#5119</a> (<a href=https://github.com/nicelulu rel="external nofollow noreferrer">小路</a>)</li> </ul> <h2 id=clickhouse-release-19-5-3-8-2019-04-18>ClickHouse release 19.5.3.8, 2019-04-18<a class=headerlink href=#clickhouse-release-19-5-3-8-2019-04-18 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_6>Bug fixes<a class=headerlink href=#bug-fixes_6 title="Permanent link">&para;</a></h3> <ul> <li>Fixed type of setting <code>max_partitions_per_insert_block</code> from boolean to UInt64. <a href=https://github.com/ClickHouse/ClickHouse/pull/5028 rel="external nofollow noreferrer">#5028</a> (<a href=https://github.com/mhsekhavat rel="external nofollow noreferrer">Mohammad Hossein Sekhavat</a>)</li> </ul> <h2 id=clickhouse-release-19-5-2-6-2019-04-15>ClickHouse release 19.5.2.6, 2019-04-15<a class=headerlink href=#clickhouse-release-19-5-2-6-2019-04-15 title="Permanent link">&para;</a></h2> <h3 id=new-features_4>New Features<a class=headerlink href=#new-features_4 title="Permanent link">&para;</a></h3> <ul> <li><a href=https://github.com/intel/hyperscan rel="external nofollow noreferrer">Hyperscan</a> multiple regular expression matching was added (functions <code>multiMatchAny</code>, <code>multiMatchAnyIndex</code>, <code>multiFuzzyMatchAny</code>, <code>multiFuzzyMatchAnyIndex</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4780 rel="external nofollow noreferrer">#4780</a>, <a href=https://github.com/ClickHouse/ClickHouse/pull/4841 rel="external nofollow noreferrer">#4841</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li><code>multiSearchFirstPosition</code> function was added. <a href=https://github.com/ClickHouse/ClickHouse/pull/4780 rel="external nofollow noreferrer">#4780</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Implement the predefined expression filter per row for tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/4792 rel="external nofollow noreferrer">#4792</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>A new type of data skipping indices based on bloom filters (can be used for <code>equal</code>, <code>in</code> and <code>like</code> functions). <a href=https://github.com/ClickHouse/ClickHouse/pull/4499 rel="external nofollow noreferrer">#4499</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Added <code>ASOF JOIN</code> which allows to run queries that join to the most recent value known. <a href=https://github.com/ClickHouse/ClickHouse/pull/4774 rel="external nofollow noreferrer">#4774</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4867 rel="external nofollow noreferrer">#4867</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4863 rel="external nofollow noreferrer">#4863</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4875 rel="external nofollow noreferrer">#4875</a> (<a href=https://github.com/Gladdy rel="external nofollow noreferrer">Martijn Bakker</a>, <a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Rewrite multiple <code>COMMA JOIN</code> to <code>CROSS JOIN</code>. Then rewrite them to <code>INNER JOIN</code> if possible. <a href=https://github.com/ClickHouse/ClickHouse/pull/4661 rel="external nofollow noreferrer">#4661</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=improvement_8>Improvement<a class=headerlink href=#improvement_8 title="Permanent link">&para;</a></h3> <ul> <li><code>topK</code> and <code>topKWeighted</code> now supports custom <code>loadFactor</code> (fixes issue <a href=https://github.com/ClickHouse/ClickHouse/issues/4252 rel="external nofollow noreferrer">#4252</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4634 rel="external nofollow noreferrer">#4634</a> (<a href=https://github.com/kirillDanshin rel="external nofollow noreferrer">Kirill Danshin</a>)</li> <li>Allow to use <code>parallel_replicas_count &gt; 1</code> even for tables without sampling (the setting is simply ignored for them). In previous versions it was lead to exception. <a href=https://github.com/ClickHouse/ClickHouse/pull/4637 rel="external nofollow noreferrer">#4637</a> (<a href=https://github.com/digitalist rel="external nofollow noreferrer">Alexey Elymanov</a>)</li> <li>Support for <code>CREATE OR REPLACE VIEW</code>. Allow to create a view or set a new definition in a single statement. <a href=https://github.com/ClickHouse/ClickHouse/pull/4654 rel="external nofollow noreferrer">#4654</a> (<a href=https://github.com/bgranvea rel="external nofollow noreferrer">Boris Granveaud</a>)</li> <li><code>Buffer</code> table engine now supports <code>PREWHERE</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4671 rel="external nofollow noreferrer">#4671</a> (<a href=https://github.com/LiuYangkuan rel="external nofollow noreferrer">Yangkuan Liu</a>)</li> <li>Add ability to start replicated table without metadata in zookeeper in <code>readonly</code> mode. <a href=https://github.com/ClickHouse/ClickHouse/pull/4691 rel="external nofollow noreferrer">#4691</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed flicker of progress bar in clickhouse-client. The issue was most noticeable when using <code>FORMAT Null</code> with streaming queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/4811 rel="external nofollow noreferrer">#4811</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Allow to disable functions with <code>hyperscan</code> library on per user basis to limit potentially excessive and uncontrolled resource usage. <a href=https://github.com/ClickHouse/ClickHouse/pull/4816 rel="external nofollow noreferrer">#4816</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Add version number logging in all errors. <a href=https://github.com/ClickHouse/ClickHouse/pull/4824 rel="external nofollow noreferrer">#4824</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Added restriction to the <code>multiMatch</code> functions which requires string size to fit into <code>unsigned int</code>. Also added the number of arguments limit to the <code>multiSearch</code> functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/4834 rel="external nofollow noreferrer">#4834</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Improved usage of scratch space and error handling in Hyperscan. <a href=https://github.com/ClickHouse/ClickHouse/pull/4866 rel="external nofollow noreferrer">#4866</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Fill <code>system.graphite_detentions</code> from a table config of <code>*GraphiteMergeTree</code> engine tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/4584 rel="external nofollow noreferrer">#4584</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer">Mikhail f. Shiryaev</a>)</li> <li>Rename <code>trigramDistance</code> function to <code>ngramDistance</code> and add more functions with <code>CaseInsensitive</code> and <code>UTF</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4602 rel="external nofollow noreferrer">#4602</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Improved data skipping indices calculation. <a href=https://github.com/ClickHouse/ClickHouse/pull/4640 rel="external nofollow noreferrer">#4640</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Keep ordinary, <code>DEFAULT</code>, <code>MATERIALIZED</code> and <code>ALIAS</code> columns in a single list (fixes issue <a href=https://github.com/ClickHouse/ClickHouse/issues/2867 rel="external nofollow noreferrer">#2867</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4707 rel="external nofollow noreferrer">#4707</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> </ul> <h3 id=bug-fix_24>Bug Fix<a class=headerlink href=#bug-fix_24 title="Permanent link">&para;</a></h3> <ul> <li>Avoid <code>std::terminate</code> in case of memory allocation failure. Now <code>std::bad_alloc</code> exception is thrown as expected. <a href=https://github.com/ClickHouse/ClickHouse/pull/4665 rel="external nofollow noreferrer">#4665</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixes capnproto reading from buffer. Sometimes files wasn't loaded successfully by HTTP. <a href=https://github.com/ClickHouse/ClickHouse/pull/4674 rel="external nofollow noreferrer">#4674</a> (<a href=https://github.com/smirnov-vs rel="external nofollow noreferrer">Vladislav</a>)</li> <li>Fix error <code>Unknown log entry type: 0</code> after <code>OPTIMIZE TABLE FINAL</code> query. <a href=https://github.com/ClickHouse/ClickHouse/pull/4683 rel="external nofollow noreferrer">#4683</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Wrong arguments to <code>hasAny</code> or <code>hasAll</code> functions may lead to segfault. <a href=https://github.com/ClickHouse/ClickHouse/pull/4698 rel="external nofollow noreferrer">#4698</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Deadlock may happen while executing <code>DROP DATABASE dictionary</code> query. <a href=https://github.com/ClickHouse/ClickHouse/pull/4701 rel="external nofollow noreferrer">#4701</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix undefined behavior in <code>median</code> and <code>quantile</code> functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/4702 rel="external nofollow noreferrer">#4702</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> <li>Fix compression level detection when <code>network_compression_method</code> in lowercase. Broken in v19.1. <a href=https://github.com/ClickHouse/ClickHouse/pull/4706 rel="external nofollow noreferrer">#4706</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed ignorance of <code>&lt;timezone&gt;UTC&lt;/timezone&gt;</code> setting (fixes issue <a href=https://github.com/ClickHouse/ClickHouse/issues/4658 rel="external nofollow noreferrer">#4658</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4718 rel="external nofollow noreferrer">#4718</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix <code>histogram</code> function behaviour with <code>Distributed</code> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/4741 rel="external nofollow noreferrer">#4741</a> (<a href=https://github.com/olegkv rel="external nofollow noreferrer">olegkv</a>)</li> <li>Fixed tsan report <code>destroy of a locked mutex</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4742 rel="external nofollow noreferrer">#4742</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed TSan report on shutdown due to race condition in system logs usage. Fixed potential use-after-free on shutdown when part_log is enabled. <a href=https://github.com/ClickHouse/ClickHouse/pull/4758 rel="external nofollow noreferrer">#4758</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix recheck parts in <code>ReplicatedMergeTreeAlterThread</code> in case of error. <a href=https://github.com/ClickHouse/ClickHouse/pull/4772 rel="external nofollow noreferrer">#4772</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Arithmetic operations on intermediate aggregate function states were not working for constant arguments (such as subquery results). <a href=https://github.com/ClickHouse/ClickHouse/pull/4776 rel="external nofollow noreferrer">#4776</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Always backquote column names in metadata. Otherwise it's impossible to create a table with column named <code>index</code> (server won't restart due to malformed <code>ATTACH</code> query in metadata). <a href=https://github.com/ClickHouse/ClickHouse/pull/4782 rel="external nofollow noreferrer">#4782</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix crash in <code>ALTER ... MODIFY ORDER BY</code> on <code>Distributed</code> table. <a href=https://github.com/ClickHouse/ClickHouse/pull/4790 rel="external nofollow noreferrer">#4790</a> (<a href=https://github.com/TCeason rel="external nofollow noreferrer">TCeason</a>)</li> <li>Fix segfault in <code>JOIN ON</code> with enabled <code>enable_optimize_predicate_expression</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4794 rel="external nofollow noreferrer">#4794</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Fix bug with adding an extraneous row after consuming a protobuf message from Kafka. <a href=https://github.com/ClickHouse/ClickHouse/pull/4808 rel="external nofollow noreferrer">#4808</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fix crash of <code>JOIN</code> on not-nullable vs nullable column. Fix <code>NULLs</code> in right keys in <code>ANY JOIN</code> + <code>join_use_nulls</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4815 rel="external nofollow noreferrer">#4815</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix segmentation fault in <code>clickhouse-copier</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4835 rel="external nofollow noreferrer">#4835</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed race condition in <code>SELECT</code> from <code>system.tables</code> if the table is renamed or altered concurrently. <a href=https://github.com/ClickHouse/ClickHouse/pull/4836 rel="external nofollow noreferrer">#4836</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed data race when fetching data part that is already obsolete. <a href=https://github.com/ClickHouse/ClickHouse/pull/4839 rel="external nofollow noreferrer">#4839</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed rare data race that can happen during <code>RENAME</code> table of MergeTree family. <a href=https://github.com/ClickHouse/ClickHouse/pull/4844 rel="external nofollow noreferrer">#4844</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed segmentation fault in function <code>arrayIntersect</code>. Segmentation fault could happen if function was called with mixed constant and ordinary arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/4847 rel="external nofollow noreferrer">#4847</a> (<a href=https://github.com/fancyqlx rel="external nofollow noreferrer">Lixiang Qian</a>)</li> <li>Fixed reading from <code>Array(LowCardinality)</code> column in rare case when column contained a long sequence of empty arrays. <a href=https://github.com/ClickHouse/ClickHouse/pull/4850 rel="external nofollow noreferrer">#4850</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix crash in <code>FULL/RIGHT JOIN</code> when we joining on nullable vs not nullable. <a href=https://github.com/ClickHouse/ClickHouse/pull/4855 rel="external nofollow noreferrer">#4855</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix <code>No message received</code> exception while fetching parts between replicas. <a href=https://github.com/ClickHouse/ClickHouse/pull/4856 rel="external nofollow noreferrer">#4856</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed <code>arrayIntersect</code> function wrong result in case of several repeated values in single array. <a href=https://github.com/ClickHouse/ClickHouse/pull/4871 rel="external nofollow noreferrer">#4871</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix a race condition during concurrent <code>ALTER COLUMN</code> queries that could lead to a server crash (fixes issue <a href=https://github.com/ClickHouse/ClickHouse/issues/3421 rel="external nofollow noreferrer">#3421</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4592 rel="external nofollow noreferrer">#4592</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Fix incorrect result in <code>FULL/RIGHT JOIN</code> with const column. <a href=https://github.com/ClickHouse/ClickHouse/pull/4723 rel="external nofollow noreferrer">#4723</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix duplicates in <code>GLOBAL JOIN</code> with asterisk. <a href=https://github.com/ClickHouse/ClickHouse/pull/4705 rel="external nofollow noreferrer">#4705</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix parameter deduction in <code>ALTER MODIFY</code> of column <code>CODEC</code> when column type is not specified. <a href=https://github.com/ClickHouse/ClickHouse/pull/4883 rel="external nofollow noreferrer">#4883</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Functions <code>cutQueryStringAndFragment()</code> and <code>queryStringAndFragment()</code> now works correctly when <code>URL</code> contains a fragment and no query. <a href=https://github.com/ClickHouse/ClickHouse/pull/4894 rel="external nofollow noreferrer">#4894</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fix rare bug when setting <code>min_bytes_to_use_direct_io</code> is greater than zero, which occures when thread have to seek backward in column file. <a href=https://github.com/ClickHouse/ClickHouse/pull/4897 rel="external nofollow noreferrer">#4897</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix wrong argument types for aggregate functions with <code>LowCardinality</code> arguments (fixes issue <a href=https://github.com/ClickHouse/ClickHouse/issues/4919 rel="external nofollow noreferrer">#4919</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4922 rel="external nofollow noreferrer">#4922</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix wrong name qualification in <code>GLOBAL JOIN</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4969 rel="external nofollow noreferrer">#4969</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix function <code>toISOWeek</code> result for year 1970. <a href=https://github.com/ClickHouse/ClickHouse/pull/4988 rel="external nofollow noreferrer">#4988</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix <code>DROP</code>, <code>TRUNCATE</code> and <code>OPTIMIZE</code> queries duplication, when executed on <code>ON CLUSTER</code> for <code>ReplicatedMergeTree*</code> tables family. <a href=https://github.com/ClickHouse/ClickHouse/pull/4991 rel="external nofollow noreferrer">#4991</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> </ul> <h3 id=backward-incompatible-change_7>Backward Incompatible Change<a class=headerlink href=#backward-incompatible-change_7 title="Permanent link">&para;</a></h3> <ul> <li>Rename setting <code>insert_sample_with_metadata</code> to setting <code>input_format_defaults_for_omitted_fields</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4771 rel="external nofollow noreferrer">#4771</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Added setting <code>max_partitions_per_insert_block</code> (with value 100 by default). If inserted block contains larger number of partitions, an exception is thrown. Set it to 0 if you want to remove the limit (not recommended). <a href=https://github.com/ClickHouse/ClickHouse/pull/4845 rel="external nofollow noreferrer">#4845</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Multi-search functions were renamed (<code>multiPosition</code> to <code>multiSearchAllPositions</code>, <code>multiSearch</code> to <code>multiSearchAny</code>, <code>firstMatch</code> to <code>multiSearchFirstIndex</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4780 rel="external nofollow noreferrer">#4780</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> </ul> <h3 id=performance-improvement_5>Performance Improvement<a class=headerlink href=#performance-improvement_5 title="Permanent link">&para;</a></h3> <ul> <li>Optimize Volnitsky searcher by inlining, giving about 5-10% search improvement for queries with many needles or many similar bigrams. <a href=https://github.com/ClickHouse/ClickHouse/pull/4862 rel="external nofollow noreferrer">#4862</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Fix performance issue when setting <code>use_uncompressed_cache</code> is greater than zero, which appeared when all read data contained in cache. <a href=https://github.com/ClickHouse/ClickHouse/pull/4913 rel="external nofollow noreferrer">#4913</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_9>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_9 title="Permanent link">&para;</a></h3> <ul> <li>Hardening debug build: more granular memory mappings and ASLR; add memory protection for mark cache and index. This allows to find more memory stomping bugs in case when ASan and MSan cannot do it. <a href=https://github.com/ClickHouse/ClickHouse/pull/4632 rel="external nofollow noreferrer">#4632</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Add support for cmake variables <code>ENABLE_PROTOBUF</code>, <code>ENABLE_PARQUET</code> and <code>ENABLE_BROTLI</code> which allows to enable/disable the above features (same as we can do for librdkafka, mysql, etc). <a href=https://github.com/ClickHouse/ClickHouse/pull/4669 rel="external nofollow noreferrer">#4669</a> (<a href=https://github.com/silviucpp rel="external nofollow noreferrer">Silviu Caragea</a>)</li> <li>Add ability to print process list and stacktraces of all threads if some queries are hung after test run. <a href=https://github.com/ClickHouse/ClickHouse/pull/4675 rel="external nofollow noreferrer">#4675</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Add retries on <code>Connection loss</code> error in <code>clickhouse-test</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4682 rel="external nofollow noreferrer">#4682</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Add freebsd build with vagrant and build with thread sanitizer to packager script. <a href=https://github.com/ClickHouse/ClickHouse/pull/4712 rel="external nofollow noreferrer">#4712</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4748 rel="external nofollow noreferrer">#4748</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Now user asked for password for user <code>'default'</code> during installation. <a href=https://github.com/ClickHouse/ClickHouse/pull/4725 rel="external nofollow noreferrer">#4725</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Suppress warning in <code>rdkafka</code> library. <a href=https://github.com/ClickHouse/ClickHouse/pull/4740 rel="external nofollow noreferrer">#4740</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Allow ability to build without ssl. <a href=https://github.com/ClickHouse/ClickHouse/pull/4750 rel="external nofollow noreferrer">#4750</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Add a way to launch clickhouse-server image from a custom user. <a href=https://github.com/ClickHouse/ClickHouse/pull/4753 rel="external nofollow noreferrer">#4753</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer">Mikhail f. Shiryaev</a>)</li> <li>Upgrade contrib boost to 1.69. <a href=https://github.com/ClickHouse/ClickHouse/pull/4793 rel="external nofollow noreferrer">#4793</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Disable usage of <code>mremap</code> when compiled with Thread Sanitizer. Surprisingly enough, TSan does not intercept <code>mremap</code> (though it does intercept <code>mmap</code>, <code>munmap</code>) that leads to false positives. Fixed TSan report in stateful tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/4859 rel="external nofollow noreferrer">#4859</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Add test checking using format schema via HTTP interface. <a href=https://github.com/ClickHouse/ClickHouse/pull/4864 rel="external nofollow noreferrer">#4864</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> </ul> <h2 id=clickhouse-release-19-4-4-33-2019-04-17>ClickHouse release 19.4.4.33, 2019-04-17<a class=headerlink href=#clickhouse-release-19-4-4-33-2019-04-17 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_7>Bug Fixes<a class=headerlink href=#bug-fixes_7 title="Permanent link">&para;</a></h3> <ul> <li>Avoid <code>std::terminate</code> in case of memory allocation failure. Now <code>std::bad_alloc</code> exception is thrown as expected. <a href=https://github.com/ClickHouse/ClickHouse/pull/4665 rel="external nofollow noreferrer">#4665</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixes capnproto reading from buffer. Sometimes files wasn't loaded successfully by HTTP. <a href=https://github.com/ClickHouse/ClickHouse/pull/4674 rel="external nofollow noreferrer">#4674</a> (<a href=https://github.com/smirnov-vs rel="external nofollow noreferrer">Vladislav</a>)</li> <li>Fix error <code>Unknown log entry type: 0</code> after <code>OPTIMIZE TABLE FINAL</code> query. <a href=https://github.com/ClickHouse/ClickHouse/pull/4683 rel="external nofollow noreferrer">#4683</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Wrong arguments to <code>hasAny</code> or <code>hasAll</code> functions may lead to segfault. <a href=https://github.com/ClickHouse/ClickHouse/pull/4698 rel="external nofollow noreferrer">#4698</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Deadlock may happen while executing <code>DROP DATABASE dictionary</code> query. <a href=https://github.com/ClickHouse/ClickHouse/pull/4701 rel="external nofollow noreferrer">#4701</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix undefined behavior in <code>median</code> and <code>quantile</code> functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/4702 rel="external nofollow noreferrer">#4702</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> <li>Fix compression level detection when <code>network_compression_method</code> in lowercase. Broken in v19.1. <a href=https://github.com/ClickHouse/ClickHouse/pull/4706 rel="external nofollow noreferrer">#4706</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed ignorance of <code>&lt;timezone&gt;UTC&lt;/timezone&gt;</code> setting (fixes issue <a href=https://github.com/ClickHouse/ClickHouse/issues/4658 rel="external nofollow noreferrer">#4658</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4718 rel="external nofollow noreferrer">#4718</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fix <code>histogram</code> function behaviour with <code>Distributed</code> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/4741 rel="external nofollow noreferrer">#4741</a> (<a href=https://github.com/olegkv rel="external nofollow noreferrer">olegkv</a>)</li> <li>Fixed tsan report <code>destroy of a locked mutex</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4742 rel="external nofollow noreferrer">#4742</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed TSan report on shutdown due to race condition in system logs usage. Fixed potential use-after-free on shutdown when part_log is enabled. <a href=https://github.com/ClickHouse/ClickHouse/pull/4758 rel="external nofollow noreferrer">#4758</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix recheck parts in <code>ReplicatedMergeTreeAlterThread</code> in case of error. <a href=https://github.com/ClickHouse/ClickHouse/pull/4772 rel="external nofollow noreferrer">#4772</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Arithmetic operations on intermediate aggregate function states were not working for constant arguments (such as subquery results). <a href=https://github.com/ClickHouse/ClickHouse/pull/4776 rel="external nofollow noreferrer">#4776</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Always backquote column names in metadata. Otherwise it's impossible to create a table with column named <code>index</code> (server won't restart due to malformed <code>ATTACH</code> query in metadata). <a href=https://github.com/ClickHouse/ClickHouse/pull/4782 rel="external nofollow noreferrer">#4782</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix crash in <code>ALTER ... MODIFY ORDER BY</code> on <code>Distributed</code> table. <a href=https://github.com/ClickHouse/ClickHouse/pull/4790 rel="external nofollow noreferrer">#4790</a> (<a href=https://github.com/TCeason rel="external nofollow noreferrer">TCeason</a>)</li> <li>Fix segfault in <code>JOIN ON</code> with enabled <code>enable_optimize_predicate_expression</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4794 rel="external nofollow noreferrer">#4794</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Fix bug with adding an extraneous row after consuming a protobuf message from Kafka. <a href=https://github.com/ClickHouse/ClickHouse/pull/4808 rel="external nofollow noreferrer">#4808</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fix segmentation fault in <code>clickhouse-copier</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4835 rel="external nofollow noreferrer">#4835</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed race condition in <code>SELECT</code> from <code>system.tables</code> if the table is renamed or altered concurrently. <a href=https://github.com/ClickHouse/ClickHouse/pull/4836 rel="external nofollow noreferrer">#4836</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed data race when fetching data part that is already obsolete. <a href=https://github.com/ClickHouse/ClickHouse/pull/4839 rel="external nofollow noreferrer">#4839</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed rare data race that can happen during <code>RENAME</code> table of MergeTree family. <a href=https://github.com/ClickHouse/ClickHouse/pull/4844 rel="external nofollow noreferrer">#4844</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed segmentation fault in function <code>arrayIntersect</code>. Segmentation fault could happen if function was called with mixed constant and ordinary arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/4847 rel="external nofollow noreferrer">#4847</a> (<a href=https://github.com/fancyqlx rel="external nofollow noreferrer">Lixiang Qian</a>)</li> <li>Fixed reading from <code>Array(LowCardinality)</code> column in rare case when column contained a long sequence of empty arrays. <a href=https://github.com/ClickHouse/ClickHouse/pull/4850 rel="external nofollow noreferrer">#4850</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix <code>No message received</code> exception while fetching parts between replicas. <a href=https://github.com/ClickHouse/ClickHouse/pull/4856 rel="external nofollow noreferrer">#4856</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed <code>arrayIntersect</code> function wrong result in case of several repeated values in single array. <a href=https://github.com/ClickHouse/ClickHouse/pull/4871 rel="external nofollow noreferrer">#4871</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix a race condition during concurrent <code>ALTER COLUMN</code> queries that could lead to a server crash (fixes issue <a href=https://github.com/ClickHouse/ClickHouse/issues/3421 rel="external nofollow noreferrer">#3421</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4592 rel="external nofollow noreferrer">#4592</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Fix parameter deduction in <code>ALTER MODIFY</code> of column <code>CODEC</code> when column type is not specified. <a href=https://github.com/ClickHouse/ClickHouse/pull/4883 rel="external nofollow noreferrer">#4883</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Functions <code>cutQueryStringAndFragment()</code> and <code>queryStringAndFragment()</code> now works correctly when <code>URL</code> contains a fragment and no query. <a href=https://github.com/ClickHouse/ClickHouse/pull/4894 rel="external nofollow noreferrer">#4894</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Fix rare bug when setting <code>min_bytes_to_use_direct_io</code> is greater than zero, which occures when thread have to seek backward in column file. <a href=https://github.com/ClickHouse/ClickHouse/pull/4897 rel="external nofollow noreferrer">#4897</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix wrong argument types for aggregate functions with <code>LowCardinality</code> arguments (fixes issue <a href=https://github.com/ClickHouse/ClickHouse/issues/4919 rel="external nofollow noreferrer">#4919</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4922 rel="external nofollow noreferrer">#4922</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fix function <code>toISOWeek</code> result for year 1970. <a href=https://github.com/ClickHouse/ClickHouse/pull/4988 rel="external nofollow noreferrer">#4988</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix <code>DROP</code>, <code>TRUNCATE</code> and <code>OPTIMIZE</code> queries duplication, when executed on <code>ON CLUSTER</code> for <code>ReplicatedMergeTree*</code> tables family. <a href=https://github.com/ClickHouse/ClickHouse/pull/4991 rel="external nofollow noreferrer">#4991</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> </ul> <h3 id=improvements_2>Improvements<a class=headerlink href=#improvements_2 title="Permanent link">&para;</a></h3> <ul> <li>Keep ordinary, <code>DEFAULT</code>, <code>MATERIALIZED</code> and <code>ALIAS</code> columns in a single list (fixes issue <a href=https://github.com/ClickHouse/ClickHouse/issues/2867 rel="external nofollow noreferrer">#2867</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4707 rel="external nofollow noreferrer">#4707</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> </ul> <h2 id=clickhouse-release-19-4-3-11-2019-04-02>ClickHouse release 19.4.3.11, 2019-04-02<a class=headerlink href=#clickhouse-release-19-4-3-11-2019-04-02 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_8>Bug Fixes<a class=headerlink href=#bug-fixes_8 title="Permanent link">&para;</a></h3> <ul> <li>Fix crash in <code>FULL/RIGHT JOIN</code> when we joining on nullable vs not nullable. <a href=https://github.com/ClickHouse/ClickHouse/pull/4855 rel="external nofollow noreferrer">#4855</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix segmentation fault in <code>clickhouse-copier</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4835 rel="external nofollow noreferrer">#4835</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_10>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_10 title="Permanent link">&para;</a></h3> <ul> <li>Add a way to launch clickhouse-server image from a custom user. <a href=https://github.com/ClickHouse/ClickHouse/pull/4753 rel="external nofollow noreferrer">#4753</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer">Mikhail f. Shiryaev</a>)</li> </ul> <h2 id=clickhouse-release-19-4-2-7-2019-03-30>ClickHouse release 19.4.2.7, 2019-03-30<a class=headerlink href=#clickhouse-release-19-4-2-7-2019-03-30 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_9>Bug Fixes<a class=headerlink href=#bug-fixes_9 title="Permanent link">&para;</a></h3> <ul> <li>Fixed reading from <code>Array(LowCardinality)</code> column in rare case when column contained a long sequence of empty arrays. <a href=https://github.com/ClickHouse/ClickHouse/pull/4850 rel="external nofollow noreferrer">#4850</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> </ul> <h2 id=clickhouse-release-19-4-1-3-2019-03-19>ClickHouse release 19.4.1.3, 2019-03-19<a class=headerlink href=#clickhouse-release-19-4-1-3-2019-03-19 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_10>Bug Fixes<a class=headerlink href=#bug-fixes_10 title="Permanent link">&para;</a></h3> <ul> <li>Fixed remote queries which contain both <code>LIMIT BY</code> and <code>LIMIT</code>. Previously, if <code>LIMIT BY</code> and <code>LIMIT</code> were used for remote query, <code>LIMIT</code> could happen before <code>LIMIT BY</code>, which led to too filtered result. <a href=https://github.com/ClickHouse/ClickHouse/pull/4708 rel="external nofollow noreferrer">#4708</a> (<a href=https://github.com/kvap rel="external nofollow noreferrer">Constantin S. Pan</a>)</li> </ul> <h2 id=clickhouse-release-19-4-0-49-2019-03-09>ClickHouse release 19.4.0.49, 2019-03-09<a class=headerlink href=#clickhouse-release-19-4-0-49-2019-03-09 title="Permanent link">&para;</a></h2> <h3 id=new-features_5>New Features<a class=headerlink href=#new-features_5 title="Permanent link">&para;</a></h3> <ul> <li>Added full support for <code>Protobuf</code> format (input and output, nested data structures). <a href=https://github.com/ClickHouse/ClickHouse/pull/4174 rel="external nofollow noreferrer">#4174</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4493 rel="external nofollow noreferrer">#4493</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Added bitmap functions with Roaring Bitmaps. <a href=https://github.com/ClickHouse/ClickHouse/pull/4207 rel="external nofollow noreferrer">#4207</a> (<a href=https://github.com/andyyzh rel="external nofollow noreferrer">Andy Yang</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/4568 rel="external nofollow noreferrer">#4568</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Parquet format support. <a href=https://github.com/ClickHouse/ClickHouse/pull/4448 rel="external nofollow noreferrer">#4448</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>N-gram distance was added for fuzzy string comparison. It is similar to q-gram metrics in R language. <a href=https://github.com/ClickHouse/ClickHouse/pull/4466 rel="external nofollow noreferrer">#4466</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Combine rules for graphite rollup from dedicated aggregation and retention patterns. <a href=https://github.com/ClickHouse/ClickHouse/pull/4426 rel="external nofollow noreferrer">#4426</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer">Mikhail f. Shiryaev</a>)</li> <li>Added <code>max_execution_speed</code> and <code>max_execution_speed_bytes</code> to limit resource usage. Added <code>min_execution_speed_bytes</code> setting to complement the <code>min_execution_speed</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4430 rel="external nofollow noreferrer">#4430</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Implemented function <code>flatten</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4555 rel="external nofollow noreferrer">#4555</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4409 rel="external nofollow noreferrer">#4409</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>, <a href=https://github.com/kzon rel="external nofollow noreferrer">kzon</a>)</li> <li>Added functions <code>arrayEnumerateDenseRanked</code> and <code>arrayEnumerateUniqRanked</code> (it's like <code>arrayEnumerateUniq</code> but allows to fine tune array depth to look inside multidimensional arrays). <a href=https://github.com/ClickHouse/ClickHouse/pull/4475 rel="external nofollow noreferrer">#4475</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/4601 rel="external nofollow noreferrer">#4601</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Multiple JOINS with some restrictions: no asterisks, no complex aliases in ON/WHERE/GROUP BY/... <a href=https://github.com/ClickHouse/ClickHouse/pull/4462 rel="external nofollow noreferrer">#4462</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=bug-fixes_11>Bug Fixes<a class=headerlink href=#bug-fixes_11 title="Permanent link">&para;</a></h3> <ul> <li>This release also contains all bug fixes from 19.3 and 19.1.</li> <li>Fixed bug in data skipping indices: order of granules after INSERT was incorrect. <a href=https://github.com/ClickHouse/ClickHouse/pull/4407 rel="external nofollow noreferrer">#4407</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Fixed <code>set</code> index for <code>Nullable</code> and <code>LowCardinality</code> columns. Before it, <code>set</code> index with <code>Nullable</code> or <code>LowCardinality</code> column led to error <code>Data type must be deserialized with multiple streams</code> while selecting. <a href=https://github.com/ClickHouse/ClickHouse/pull/4594 rel="external nofollow noreferrer">#4594</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Correctly set update_time on full <code>executable</code> dictionary update. <a href=https://github.com/ClickHouse/ClickHouse/pull/4551 rel="external nofollow noreferrer">#4551</a> (<a href=https://github.com/temoon rel="external nofollow noreferrer">Tema Novikov</a>)</li> <li>Fix broken progress bar in 19.3. <a href=https://github.com/ClickHouse/ClickHouse/pull/4627 rel="external nofollow noreferrer">#4627</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Fixed inconsistent values of MemoryTracker when memory region was shrinked, in certain cases. <a href=https://github.com/ClickHouse/ClickHouse/pull/4619 rel="external nofollow noreferrer">#4619</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed undefined behaviour in ThreadPool. <a href=https://github.com/ClickHouse/ClickHouse/pull/4612 rel="external nofollow noreferrer">#4612</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed a very rare crash with the message <code>mutex lock failed: Invalid argument</code> that could happen when a MergeTree table was dropped concurrently with a SELECT. <a href=https://github.com/ClickHouse/ClickHouse/pull/4608 rel="external nofollow noreferrer">#4608</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>ODBC driver compatibility with <code>LowCardinality</code> data type. <a href=https://github.com/ClickHouse/ClickHouse/pull/4381 rel="external nofollow noreferrer">#4381</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>FreeBSD: Fixup for <code>AIOcontextPool: Found io_event with unknown id 0</code> error. <a href=https://github.com/ClickHouse/ClickHouse/pull/4438 rel="external nofollow noreferrer">#4438</a> (<a href=https://github.com/urgordeadbeef rel="external nofollow noreferrer">urgordeadbeef</a>)</li> <li><code>system.part_log</code> table was created regardless to configuration. <a href=https://github.com/ClickHouse/ClickHouse/pull/4483 rel="external nofollow noreferrer">#4483</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix undefined behaviour in <code>dictIsIn</code> function for cache dictionaries. <a href=https://github.com/ClickHouse/ClickHouse/pull/4515 rel="external nofollow noreferrer">#4515</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed a deadlock when a SELECT query locks the same table multiple times (e.g. from different threads or when executing multiple subqueries) and there is a concurrent DDL query. <a href=https://github.com/ClickHouse/ClickHouse/pull/4535 rel="external nofollow noreferrer">#4535</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Disable compile_expressions by default until we get own <code>llvm</code> contrib and can test it with <code>clang</code> and <code>asan</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4579 rel="external nofollow noreferrer">#4579</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Prevent <code>std::terminate</code> when <code>invalidate_query</code> for <code>clickhouse</code> external dictionary source has returned wrong resultset (empty or more than one row or more than one column). Fixed issue when the <code>invalidate_query</code> was performed every five seconds regardless to the <code>lifetime</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4583 rel="external nofollow noreferrer">#4583</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Avoid deadlock when the <code>invalidate_query</code> for a dictionary with <code>clickhouse</code> source was involving <code>system.dictionaries</code> table or <code>Dictionaries</code> database (rare case). <a href=https://github.com/ClickHouse/ClickHouse/pull/4599 rel="external nofollow noreferrer">#4599</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixes for CROSS JOIN with empty WHERE. <a href=https://github.com/ClickHouse/ClickHouse/pull/4598 rel="external nofollow noreferrer">#4598</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed segfault in function "replicate" when constant argument is passed. <a href=https://github.com/ClickHouse/ClickHouse/pull/4603 rel="external nofollow noreferrer">#4603</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix lambda function with predicate optimizer. <a href=https://github.com/ClickHouse/ClickHouse/pull/4408 rel="external nofollow noreferrer">#4408</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Multiple JOINs multiple fixes. <a href=https://github.com/ClickHouse/ClickHouse/pull/4595 rel="external nofollow noreferrer">#4595</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=improvements_3>Improvements<a class=headerlink href=#improvements_3 title="Permanent link">&para;</a></h3> <ul> <li>Support aliases in JOIN ON section for right table columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/4412 rel="external nofollow noreferrer">#4412</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Result of multiple JOINs need correct result names to be used in subselects. Replace flat aliases with source names in result. <a href=https://github.com/ClickHouse/ClickHouse/pull/4474 rel="external nofollow noreferrer">#4474</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Improve push-down logic for joined statements. <a href=https://github.com/ClickHouse/ClickHouse/pull/4387 rel="external nofollow noreferrer">#4387</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h3 id=performance-improvements_3>Performance Improvements<a class=headerlink href=#performance-improvements_3 title="Permanent link">&para;</a></h3> <ul> <li>Improved heuristics of "move to PREWHERE" optimization. <a href=https://github.com/ClickHouse/ClickHouse/pull/4405 rel="external nofollow noreferrer">#4405</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Use proper lookup tables that uses HashTable's API for 8-bit and 16-bit keys. <a href=https://github.com/ClickHouse/ClickHouse/pull/4536 rel="external nofollow noreferrer">#4536</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Improved performance of string comparison. <a href=https://github.com/ClickHouse/ClickHouse/pull/4564 rel="external nofollow noreferrer">#4564</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Cleanup distributed DDL queue in a separate thread so that it doesn't slow down the main loop that processes distributed DDL tasks. <a href=https://github.com/ClickHouse/ClickHouse/pull/4502 rel="external nofollow noreferrer">#4502</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>When <code>min_bytes_to_use_direct_io</code> is set to 1, not every file was opened with O_DIRECT mode because the data size to read was sometimes underestimated by the size of one compressed block. <a href=https://github.com/ClickHouse/ClickHouse/pull/4526 rel="external nofollow noreferrer">#4526</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_11>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_11 title="Permanent link">&para;</a></h3> <ul> <li>Added support for clang-9 <a href=https://github.com/ClickHouse/ClickHouse/pull/4604 rel="external nofollow noreferrer">#4604</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix wrong <code>__asm__</code> instructions (again) <a href=https://github.com/ClickHouse/ClickHouse/pull/4621 rel="external nofollow noreferrer">#4621</a> (<a href=https://github.com/podshumok rel="external nofollow noreferrer">Konstantin Podshumok</a>)</li> <li>Add ability to specify settings for <code>clickhouse-performance-test</code> from command line. <a href=https://github.com/ClickHouse/ClickHouse/pull/4437 rel="external nofollow noreferrer">#4437</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Add dictionaries tests to integration tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/4477 rel="external nofollow noreferrer">#4477</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Added queries from the benchmark on the website to automated performance tests. <a href=https://github.com/ClickHouse/ClickHouse/pull/4496 rel="external nofollow noreferrer">#4496</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>xxhash.h</code> does not exist in external lz4 because it is an implementation detail and its symbols are namespaced with <code>XXH_NAMESPACE</code> macro. When lz4 is external, xxHash has to be external too, and the dependents have to link to it. <a href=https://github.com/ClickHouse/ClickHouse/pull/4495 rel="external nofollow noreferrer">#4495</a> (<a href=https://github.com/orivej rel="external nofollow noreferrer">Orivej Desh</a>)</li> <li>Fixed a case when <code>quantileTiming</code> aggregate function can be called with negative or floating point argument (this fixes fuzz test with undefined behaviour sanitizer). <a href=https://github.com/ClickHouse/ClickHouse/pull/4506 rel="external nofollow noreferrer">#4506</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Spelling error correction. <a href=https://github.com/ClickHouse/ClickHouse/pull/4531 rel="external nofollow noreferrer">#4531</a> (<a href=https://github.com/sdk2 rel="external nofollow noreferrer">sdk2</a>)</li> <li>Fix compilation on Mac. <a href=https://github.com/ClickHouse/ClickHouse/pull/4371 rel="external nofollow noreferrer">#4371</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Build fixes for FreeBSD and various unusual build configurations. <a href=https://github.com/ClickHouse/ClickHouse/pull/4444 rel="external nofollow noreferrer">#4444</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h2 id=clickhouse-release-19-3-9-1-2019-04-02>ClickHouse release 19.3.9.1, 2019-04-02<a class=headerlink href=#clickhouse-release-19-3-9-1-2019-04-02 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_12>Bug Fixes<a class=headerlink href=#bug-fixes_12 title="Permanent link">&para;</a></h3> <ul> <li>Fix crash in <code>FULL/RIGHT JOIN</code> when we joining on nullable vs not nullable. <a href=https://github.com/ClickHouse/ClickHouse/pull/4855 rel="external nofollow noreferrer">#4855</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fix segmentation fault in <code>clickhouse-copier</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4835 rel="external nofollow noreferrer">#4835</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed reading from <code>Array(LowCardinality)</code> column in rare case when column contained a long sequence of empty arrays. <a href=https://github.com/ClickHouse/ClickHouse/pull/4850 rel="external nofollow noreferrer">#4850</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> </ul> <h3 id=build-testing-packaging-improvement_12>Build/Testing/Packaging Improvement<a class=headerlink href=#build-testing-packaging-improvement_12 title="Permanent link">&para;</a></h3> <ul> <li>Add a way to launch clickhouse-server image from a custom user <a href=https://github.com/ClickHouse/ClickHouse/pull/4753 rel="external nofollow noreferrer">#4753</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer">Mikhail f. Shiryaev</a>)</li> </ul> <h2 id=clickhouse-release-19-3-7-2019-03-12>ClickHouse release 19.3.7, 2019-03-12<a class=headerlink href=#clickhouse-release-19-3-7-2019-03-12 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_13>Bug fixes<a class=headerlink href=#bug-fixes_13 title="Permanent link">&para;</a></h3> <ul> <li>Fixed error in #3920. This error manifestate itself as random cache corruption (messages <code>Unknown codec family code</code>, <code>Cannot seek through file</code>) and segfaults. This bug first appeared in version 19.1 and is present in versions up to 19.1.10 and 19.3.6. <a href=https://github.com/ClickHouse/ClickHouse/pull/4623 rel="external nofollow noreferrer">#4623</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-3-6-2019-03-02>ClickHouse release 19.3.6, 2019-03-02<a class=headerlink href=#clickhouse-release-19-3-6-2019-03-02 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_14>Bug fixes<a class=headerlink href=#bug-fixes_14 title="Permanent link">&para;</a></h3> <ul> <li>When there are more than 1000 threads in a thread pool, <code>std::terminate</code> may happen on thread exit. <a href=https://github.com/azat rel="external nofollow noreferrer">Azat Khuzhin</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4485 rel="external nofollow noreferrer">#4485</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4505 rel="external nofollow noreferrer">#4505</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Now it's possible to create <code>ReplicatedMergeTree*</code> tables with comments on columns without defaults and tables with columns codecs without comments and defaults. Also fix comparison of codecs. <a href=https://github.com/ClickHouse/ClickHouse/pull/4523 rel="external nofollow noreferrer">#4523</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed crash on JOIN with array or tuple. <a href=https://github.com/ClickHouse/ClickHouse/pull/4552 rel="external nofollow noreferrer">#4552</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed crash in clickhouse-copier with the message <code>ThreadStatus not created</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4540 rel="external nofollow noreferrer">#4540</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed hangup on server shutdown if distributed DDLs were used. <a href=https://github.com/ClickHouse/ClickHouse/pull/4472 rel="external nofollow noreferrer">#4472</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Incorrect column numbers were printed in error message about text format parsing for columns with number greater than 10. <a href=https://github.com/ClickHouse/ClickHouse/pull/4484 rel="external nofollow noreferrer">#4484</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=build-testing-packaging-improvements_3>Build/Testing/Packaging Improvements<a class=headerlink href=#build-testing-packaging-improvements_3 title="Permanent link">&para;</a></h3> <ul> <li>Fixed build with AVX enabled. <a href=https://github.com/ClickHouse/ClickHouse/pull/4527 rel="external nofollow noreferrer">#4527</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Enable extended accounting and IO accounting based on good known version instead of kernel under which it is compiled. <a href=https://github.com/ClickHouse/ClickHouse/pull/4541 rel="external nofollow noreferrer">#4541</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> <li>Allow to skip setting of core_dump.size_limit, warning instead of throw if limit set fail. <a href=https://github.com/ClickHouse/ClickHouse/pull/4473 rel="external nofollow noreferrer">#4473</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Removed the <code>inline</code> tags of <code>void readBinary(...)</code> in <code>Field.cpp</code>. Also merged redundant <code>namespace DB</code> blocks. <a href=https://github.com/ClickHouse/ClickHouse/pull/4530 rel="external nofollow noreferrer">#4530</a> (<a href=https://github.com/hczhcz rel="external nofollow noreferrer">hcz</a>)</li> </ul> <h2 id=clickhouse-release-19-3-5-2019-02-21>ClickHouse release 19.3.5, 2019-02-21<a class=headerlink href=#clickhouse-release-19-3-5-2019-02-21 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_15>Bug fixes<a class=headerlink href=#bug-fixes_15 title="Permanent link">&para;</a></h3> <ul> <li>Fixed bug with large http insert queries processing. <a href=https://github.com/ClickHouse/ClickHouse/pull/4454 rel="external nofollow noreferrer">#4454</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed backward incompatibility with old versions due to wrong implementation of <code>send_logs_level</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/4445 rel="external nofollow noreferrer">#4445</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed backward incompatibility of table function <code>remote</code> introduced with column comments. <a href=https://github.com/ClickHouse/ClickHouse/pull/4446 rel="external nofollow noreferrer">#4446</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-3-4-2019-02-16>ClickHouse release 19.3.4, 2019-02-16<a class=headerlink href=#clickhouse-release-19-3-4-2019-02-16 title="Permanent link">&para;</a></h2> <h3 id=improvements_4>Improvements<a class=headerlink href=#improvements_4 title="Permanent link">&para;</a></h3> <ul> <li>Table index size is not accounted for memory limits when doing <code>ATTACH TABLE</code> query. Avoided the possibility that a table cannot be attached after being detached. <a href=https://github.com/ClickHouse/ClickHouse/pull/4396 rel="external nofollow noreferrer">#4396</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Slightly raised up the limit on max string and array size received from ZooKeeper. It allows to continue to work with increased size of <code>CLIENT_JVMFLAGS=-Djute.maxbuffer=...</code> on ZooKeeper. <a href=https://github.com/ClickHouse/ClickHouse/pull/4398 rel="external nofollow noreferrer">#4398</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Allow to repair abandoned replica even if it already has huge number of nodes in its queue. <a href=https://github.com/ClickHouse/ClickHouse/pull/4399 rel="external nofollow noreferrer">#4399</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Add one required argument to <code>SET</code> index (max stored rows number). <a href=https://github.com/ClickHouse/ClickHouse/pull/4386 rel="external nofollow noreferrer">#4386</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> </ul> <h3 id=bug-fixes_16>Bug Fixes<a class=headerlink href=#bug-fixes_16 title="Permanent link">&para;</a></h3> <ul> <li>Fixed <code>WITH ROLLUP</code> result for group by single <code>LowCardinality</code> key. <a href=https://github.com/ClickHouse/ClickHouse/pull/4384 rel="external nofollow noreferrer">#4384</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Fixed bug in the set index (dropping a granule if it contains more than <code>max_rows</code> rows). <a href=https://github.com/ClickHouse/ClickHouse/pull/4386 rel="external nofollow noreferrer">#4386</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>A lot of FreeBSD build fixes. <a href=https://github.com/ClickHouse/ClickHouse/pull/4397 rel="external nofollow noreferrer">#4397</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed aliases substitution in queries with subquery containing same alias (issue <a href=https://github.com/ClickHouse/ClickHouse/issues/4110 rel="external nofollow noreferrer">#4110</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/4351 rel="external nofollow noreferrer">#4351</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=build-testing-packaging-improvements_4>Build/Testing/Packaging Improvements<a class=headerlink href=#build-testing-packaging-improvements_4 title="Permanent link">&para;</a></h3> <ul> <li>Add ability to run <code>clickhouse-server</code> for stateless tests in docker image. <a href=https://github.com/ClickHouse/ClickHouse/pull/4347 rel="external nofollow noreferrer">#4347</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> </ul> <h2 id=clickhouse-release-19-3-3-2019-02-13>ClickHouse release 19.3.3, 2019-02-13<a class=headerlink href=#clickhouse-release-19-3-3-2019-02-13 title="Permanent link">&para;</a></h2> <h3 id=new-features_6>New Features<a class=headerlink href=#new-features_6 title="Permanent link">&para;</a></h3> <ul> <li>Added the <code>KILL MUTATION</code> statement that allows removing mutations that are for some reasons stuck. Added <code>latest_failed_part</code>, <code>latest_fail_time</code>, <code>latest_fail_reason</code> fields to the <code>system.mutations</code> table for easier troubleshooting. <a href=https://github.com/ClickHouse/ClickHouse/pull/4287 rel="external nofollow noreferrer">#4287</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Added aggregate function <code>entropy</code> which computes Shannon entropy. <a href=https://github.com/ClickHouse/ClickHouse/pull/4238 rel="external nofollow noreferrer">#4238</a> (<a href=https://github.com/Quid37 rel="external nofollow noreferrer">Quid37</a>)</li> <li>Added ability to send queries <code>INSERT INTO tbl VALUES (....</code> to server without splitting on <code>query</code> and <code>data</code> parts. <a href=https://github.com/ClickHouse/ClickHouse/pull/4301 rel="external nofollow noreferrer">#4301</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Generic implementation of <code>arrayWithConstant</code> function was added. <a href=https://github.com/ClickHouse/ClickHouse/pull/4322 rel="external nofollow noreferrer">#4322</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Implemented <code>NOT BETWEEN</code> comparison operator. <a href=https://github.com/ClickHouse/ClickHouse/pull/4228 rel="external nofollow noreferrer">#4228</a> (<a href=https://github.com/nezed rel="external nofollow noreferrer">Dmitry Naumov</a>)</li> <li>Implement <code>sumMapFiltered</code> in order to be able to limit the number of keys for which values will be summed by <code>sumMap</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4129 rel="external nofollow noreferrer">#4129</a> (<a href=https://github.com/ercolanelli-leo rel="external nofollow noreferrer">Léo Ercolanelli</a>)</li> <li>Added support of <code>Nullable</code> types in <code>mysql</code> table function. <a href=https://github.com/ClickHouse/ClickHouse/pull/4198 rel="external nofollow noreferrer">#4198</a> (<a href=https://github.com/edonin rel="external nofollow noreferrer">Emmanuel Donin de Rosière</a>)</li> <li>Support for arbitrary constant expressions in <code>LIMIT</code> clause. <a href=https://github.com/ClickHouse/ClickHouse/pull/4246 rel="external nofollow noreferrer">#4246</a> (<a href=https://github.com/k3box rel="external nofollow noreferrer">k3box</a>)</li> <li>Added <code>topKWeighted</code> aggregate function that takes additional argument with (unsigned integer) weight. <a href=https://github.com/ClickHouse/ClickHouse/pull/4245 rel="external nofollow noreferrer">#4245</a> (<a href=https://github.com/andrewgolman rel="external nofollow noreferrer">Andrew Golman</a>)</li> <li><code>StorageJoin</code> now supports <code>join_any_take_last_row</code> setting that allows overwriting existing values of the same key. <a href=https://github.com/ClickHouse/ClickHouse/pull/3973 rel="external nofollow noreferrer">#3973</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a></li> <li>Added function <code>toStartOfInterval</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4304 rel="external nofollow noreferrer">#4304</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Added <code>RowBinaryWithNamesAndTypes</code> format. <a href=https://github.com/ClickHouse/ClickHouse/pull/4200 rel="external nofollow noreferrer">#4200</a> (<a href=https://github.com/DarkWanderer rel="external nofollow noreferrer">Oleg V. Kozlyuk</a>)</li> <li>Added <code>IPv4</code> and <code>IPv6</code> data types. More effective implementations of <code>IPv*</code> functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/3669 rel="external nofollow noreferrer">#3669</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer">Vasily Nemkov</a>)</li> <li>Added function <code>toStartOfTenMinutes()</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4298 rel="external nofollow noreferrer">#4298</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Added <code>Protobuf</code> output format. <a href=https://github.com/ClickHouse/ClickHouse/pull/4005 rel="external nofollow noreferrer">#4005</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4158 rel="external nofollow noreferrer">#4158</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer">Vitaly Baranov</a>)</li> <li>Added brotli support for HTTP interface for data import (INSERTs). <a href=https://github.com/ClickHouse/ClickHouse/pull/4235 rel="external nofollow noreferrer">#4235</a> (<a href=https://github.com/fandyushin rel="external nofollow noreferrer">Mikhail </a>)</li> <li>Added hints while user make typo in function name or type in command line client. <a href=https://github.com/ClickHouse/ClickHouse/pull/4239 rel="external nofollow noreferrer">#4239</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Added <code>Query-Id</code> to Server's HTTP Response header. <a href=https://github.com/ClickHouse/ClickHouse/pull/4231 rel="external nofollow noreferrer">#4231</a> (<a href=https://github.com/fandyushin rel="external nofollow noreferrer">Mikhail </a>)</li> </ul> <h3 id=experimental-features_2>Experimental features<a class=headerlink href=#experimental-features_2 title="Permanent link">&para;</a></h3> <ul> <li>Added <code>minmax</code> and <code>set</code> data skipping indices for MergeTree table engines family. <a href=https://github.com/ClickHouse/ClickHouse/pull/4143 rel="external nofollow noreferrer">#4143</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li>Added conversion of <code>CROSS JOIN</code> to <code>INNER JOIN</code> if possible. <a href=https://github.com/ClickHouse/ClickHouse/pull/4221 rel="external nofollow noreferrer">#4221</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4266 rel="external nofollow noreferrer">#4266</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=bug-fixes_17>Bug Fixes<a class=headerlink href=#bug-fixes_17 title="Permanent link">&para;</a></h3> <ul> <li>Fixed <code>Not found column</code> for duplicate columns in <code>JOIN ON</code> section. <a href=https://github.com/ClickHouse/ClickHouse/pull/4279 rel="external nofollow noreferrer">#4279</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Make <code>START REPLICATED SENDS</code> command start replicated sends. <a href=https://github.com/ClickHouse/ClickHouse/pull/4229 rel="external nofollow noreferrer">#4229</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> <li>Fixed aggregate functions execution with <code>Array(LowCardinality)</code> arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/4055 rel="external nofollow noreferrer">#4055</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Fixed wrong behaviour when doing <code>INSERT ... SELECT ... FROM file(...)</code> query and file has <code>CSVWithNames</code> or <code>TSVWIthNames</code> format and the first data row is missing. <a href=https://github.com/ClickHouse/ClickHouse/pull/4297 rel="external nofollow noreferrer">#4297</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed crash on dictionary reload if dictionary not available. This bug was appeared in 19.1.6. <a href=https://github.com/ClickHouse/ClickHouse/pull/4188 rel="external nofollow noreferrer">#4188</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed <code>ALL JOIN</code> with duplicates in right table. <a href=https://github.com/ClickHouse/ClickHouse/pull/4184 rel="external nofollow noreferrer">#4184</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed segmentation fault with <code>use_uncompressed_cache=1</code> and exception with wrong uncompressed size. This bug was appeared in 19.1.6. <a href=https://github.com/ClickHouse/ClickHouse/pull/4186 rel="external nofollow noreferrer">#4186</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed <code>compile_expressions</code> bug with comparison of big (more than int16) dates. <a href=https://github.com/ClickHouse/ClickHouse/pull/4341 rel="external nofollow noreferrer">#4341</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed infinite loop when selecting from table function <code>numbers(0)</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4280 rel="external nofollow noreferrer">#4280</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Temporarily disable predicate optimization for <code>ORDER BY</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3890 rel="external nofollow noreferrer">#3890</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Fixed <code>Illegal instruction</code> error when using base64 functions on old CPUs. This error has been reproduced only when ClickHouse was compiled with gcc-8. <a href=https://github.com/ClickHouse/ClickHouse/pull/4275 rel="external nofollow noreferrer">#4275</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed <code>No message received</code> error when interacting with PostgreSQL ODBC Driver through TLS connection. Also fixes segfault when using MySQL ODBC Driver. <a href=https://github.com/ClickHouse/ClickHouse/pull/4170 rel="external nofollow noreferrer">#4170</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed incorrect result when <code>Date</code> and <code>DateTime</code> arguments are used in branches of conditional operator (function <code>if</code>). Added generic case for function <code>if</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4243 rel="external nofollow noreferrer">#4243</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>ClickHouse dictionaries now load within <code>clickhouse</code> process. <a href=https://github.com/ClickHouse/ClickHouse/pull/4166 rel="external nofollow noreferrer">#4166</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed deadlock when <code>SELECT</code> from a table with <code>File</code> engine was retried after <code>No such file or directory</code> error. <a href=https://github.com/ClickHouse/ClickHouse/pull/4161 rel="external nofollow noreferrer">#4161</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed race condition when selecting from <code>system.tables</code> may give <code>table doesn't exist</code> error. <a href=https://github.com/ClickHouse/ClickHouse/pull/4313 rel="external nofollow noreferrer">#4313</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>clickhouse-client</code> can segfault on exit while loading data for command line suggestions if it was run in interactive mode. <a href=https://github.com/ClickHouse/ClickHouse/pull/4317 rel="external nofollow noreferrer">#4317</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed a bug when the execution of mutations containing <code>IN</code> operators was producing incorrect results. <a href=https://github.com/ClickHouse/ClickHouse/pull/4099 rel="external nofollow noreferrer">#4099</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Fixed error: if there is a database with <code>Dictionary</code> engine, all dictionaries forced to load at server startup, and if there is a dictionary with ClickHouse source from localhost, the dictionary cannot load. <a href=https://github.com/ClickHouse/ClickHouse/pull/4255 rel="external nofollow noreferrer">#4255</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed error when system logs are tried to create again at server shutdown. <a href=https://github.com/ClickHouse/ClickHouse/pull/4254 rel="external nofollow noreferrer">#4254</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Correctly return the right type and properly handle locks in <code>joinGet</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/4153 rel="external nofollow noreferrer">#4153</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Added <code>sumMapWithOverflow</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/4151 rel="external nofollow noreferrer">#4151</a> (<a href=https://github.com/ercolanelli-leo rel="external nofollow noreferrer">Léo Ercolanelli</a>)</li> <li>Fixed segfault with <code>allow_experimental_multiple_joins_emulation</code>. <a href=https://github.com/ClickHouse/ClickHouse/commit/52de2cd927f7b5257dd67e175f0a5560a48840d0 rel="external nofollow noreferrer">52de2c</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed bug with incorrect <code>Date</code> and <code>DateTime</code> comparison. <a href=https://github.com/ClickHouse/ClickHouse/pull/4237 rel="external nofollow noreferrer">#4237</a> (<a href=https://github.com/valexey rel="external nofollow noreferrer">valexey</a>)</li> <li>Fixed fuzz test under undefined behavior sanitizer: added parameter type check for <code>quantile*Weighted</code> family of functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/4145 rel="external nofollow noreferrer">#4145</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed rare race condition when removing of old data parts can fail with <code>File not found</code> error. <a href=https://github.com/ClickHouse/ClickHouse/pull/4378 rel="external nofollow noreferrer">#4378</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix install package with missing /etc/clickhouse-server/config.xml. <a href=https://github.com/ClickHouse/ClickHouse/pull/4343 rel="external nofollow noreferrer">#4343</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=build-testing-packaging-improvements_5>Build/Testing/Packaging Improvements<a class=headerlink href=#build-testing-packaging-improvements_5 title="Permanent link">&para;</a></h3> <ul> <li>Debian package: correct /etc/clickhouse-server/preprocessed link according to config. <a href=https://github.com/ClickHouse/ClickHouse/pull/4205 rel="external nofollow noreferrer">#4205</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Various build fixes for FreeBSD. <a href=https://github.com/ClickHouse/ClickHouse/pull/4225 rel="external nofollow noreferrer">#4225</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Added ability to create, fill and drop tables in perftest. <a href=https://github.com/ClickHouse/ClickHouse/pull/4220 rel="external nofollow noreferrer">#4220</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Added a script to check for duplicate includes. <a href=https://github.com/ClickHouse/ClickHouse/pull/4326 rel="external nofollow noreferrer">#4326</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added ability to run queries by index in performance test. <a href=https://github.com/ClickHouse/ClickHouse/pull/4264 rel="external nofollow noreferrer">#4264</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Package with debug symbols is suggested to be installed. <a href=https://github.com/ClickHouse/ClickHouse/pull/4274 rel="external nofollow noreferrer">#4274</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Refactoring of performance-test. Better logging and signals handling. <a href=https://github.com/ClickHouse/ClickHouse/pull/4171 rel="external nofollow noreferrer">#4171</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Added docs to anonymized Yandex.Metrika datasets. <a href=https://github.com/ClickHouse/ClickHouse/pull/4164 rel="external nofollow noreferrer">#4164</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Аdded tool for converting an old month-partitioned part to the custom-partitioned format. <a href=https://github.com/ClickHouse/ClickHouse/pull/4195 rel="external nofollow noreferrer">#4195</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Added docs about two datasets in s3. <a href=https://github.com/ClickHouse/ClickHouse/pull/4144 rel="external nofollow noreferrer">#4144</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Added script which creates changelog from pull requests description. <a href=https://github.com/ClickHouse/ClickHouse/pull/4169 rel="external nofollow noreferrer">#4169</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4173 rel="external nofollow noreferrer">#4173</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>) (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Added puppet module for Clickhouse. <a href=https://github.com/ClickHouse/ClickHouse/pull/4182 rel="external nofollow noreferrer">#4182</a> (<a href=https://github.com/MaxFedotov rel="external nofollow noreferrer">Maxim Fedotov</a>)</li> <li>Added docs for a group of undocumented functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/4168 rel="external nofollow noreferrer">#4168</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>ARM build fixes. <a href=https://github.com/ClickHouse/ClickHouse/pull/4210 rel="external nofollow noreferrer">#4210</a><a href=https://github.com/ClickHouse/ClickHouse/pull/4306 rel="external nofollow noreferrer">#4306</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4291 rel="external nofollow noreferrer">#4291</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>) (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Dictionary tests now able to run from <code>ctest</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4189 rel="external nofollow noreferrer">#4189</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Now <code>/etc/ssl</code> is used as default directory with SSL certificates. <a href=https://github.com/ClickHouse/ClickHouse/pull/4167 rel="external nofollow noreferrer">#4167</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added checking SSE and AVX instruction at start. <a href=https://github.com/ClickHouse/ClickHouse/pull/4234 rel="external nofollow noreferrer">#4234</a> (<a href=https://github.com/igron99 rel="external nofollow noreferrer">Igr</a>)</li> <li>Init script will wait server until start. <a href=https://github.com/ClickHouse/ClickHouse/pull/4281 rel="external nofollow noreferrer">#4281</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=backward-incompatible-changes_1>Backward Incompatible Changes<a class=headerlink href=#backward-incompatible-changes_1 title="Permanent link">&para;</a></h3> <ul> <li>Removed <code>allow_experimental_low_cardinality_type</code> setting. <code>LowCardinality</code> data types are production ready. <a href=https://github.com/ClickHouse/ClickHouse/pull/4323 rel="external nofollow noreferrer">#4323</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Reduce mark cache size and uncompressed cache size accordingly to available memory amount. <a href=https://github.com/ClickHouse/ClickHouse/pull/4240 rel="external nofollow noreferrer">#4240</a> (<a href=https://github.com/k-lopatin rel="external nofollow noreferrer">Lopatin Konstantin</a></li> <li>Added keyword <code>INDEX</code> in <code>CREATE TABLE</code> query. A column with name <code>index</code> must be quoted with backticks or double quotes: <code>`index`</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4143 rel="external nofollow noreferrer">#4143</a> (<a href=https://github.com/nikvas0 rel="external nofollow noreferrer">Nikita Vasilev</a>)</li> <li><code>sumMap</code> now promote result type instead of overflow. The old <code>sumMap</code> behavior can be obtained by using <code>sumMapWithOverflow</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/4151 rel="external nofollow noreferrer">#4151</a> (<a href=https://github.com/ercolanelli-leo rel="external nofollow noreferrer">Léo Ercolanelli</a>)</li> </ul> <h3 id=performance-improvements_4>Performance Improvements<a class=headerlink href=#performance-improvements_4 title="Permanent link">&para;</a></h3> <ul> <li><code>std::sort</code> replaced by <code>pdqsort</code> for queries without <code>LIMIT</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4236 rel="external nofollow noreferrer">#4236</a> (<a href=https://github.com/kvinty rel="external nofollow noreferrer">Evgenii Pravda</a>)</li> <li>Now server reuse threads from global thread pool. This affects performance in some corner cases. <a href=https://github.com/ClickHouse/ClickHouse/pull/4150 rel="external nofollow noreferrer">#4150</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=improvements_5>Improvements<a class=headerlink href=#improvements_5 title="Permanent link">&para;</a></h3> <ul> <li>Implemented AIO support for FreeBSD. <a href=https://github.com/ClickHouse/ClickHouse/pull/4305 rel="external nofollow noreferrer">#4305</a> (<a href=https://github.com/urgordeadbeef rel="external nofollow noreferrer">urgordeadbeef</a>)</li> <li><code>SELECT * FROM a JOIN b USING a, b</code> now return <code>a</code> and <code>b</code> columns only from the left table. <a href=https://github.com/ClickHouse/ClickHouse/pull/4141 rel="external nofollow noreferrer">#4141</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Allow <code>-C</code> option of client to work as <code>-c</code> option. <a href=https://github.com/ClickHouse/ClickHouse/pull/4232 rel="external nofollow noreferrer">#4232</a> (<a href=https://github.com/syominsergey rel="external nofollow noreferrer">syominsergey</a>)</li> <li>Now option <code>--password</code> used without value requires password from stdin. <a href=https://github.com/ClickHouse/ClickHouse/pull/4230 rel="external nofollow noreferrer">#4230</a> (<a href=https://github.com/bsd-conqueror rel="external nofollow noreferrer">BSD_Conqueror</a>)</li> <li>Added highlighting of unescaped metacharacters in string literals that contain <code>LIKE</code> expressions or regexps. <a href=https://github.com/ClickHouse/ClickHouse/pull/4327 rel="external nofollow noreferrer">#4327</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added cancelling of HTTP read only queries if client socket goes away. <a href=https://github.com/ClickHouse/ClickHouse/pull/4213 rel="external nofollow noreferrer">#4213</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> <li>Now server reports progress to keep client connections alive. <a href=https://github.com/ClickHouse/ClickHouse/pull/4215 rel="external nofollow noreferrer">#4215</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Slightly better message with reason for OPTIMIZE query with <code>optimize_throw_if_noop</code> setting enabled. <a href=https://github.com/ClickHouse/ClickHouse/pull/4294 rel="external nofollow noreferrer">#4294</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added support of <code>--version</code> option for clickhouse server. <a href=https://github.com/ClickHouse/ClickHouse/pull/4251 rel="external nofollow noreferrer">#4251</a> (<a href=https://github.com/k-lopatin rel="external nofollow noreferrer">Lopatin Konstantin</a>)</li> <li>Added <code>--help/-h</code> option to <code>clickhouse-server</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4233 rel="external nofollow noreferrer">#4233</a> (<a href=https://github.com/yurriy rel="external nofollow noreferrer">Yuriy Baranov</a>)</li> <li>Added support for scalar subqueries with aggregate function state result. <a href=https://github.com/ClickHouse/ClickHouse/pull/4348 rel="external nofollow noreferrer">#4348</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">Nikolai Kochetov</a>)</li> <li>Improved server shutdown time and ALTERs waiting time. <a href=https://github.com/ClickHouse/ClickHouse/pull/4372 rel="external nofollow noreferrer">#4372</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added info about the replicated_can_become_leader setting to system.replicas and add logging if the replica won't try to become leader. <a href=https://github.com/ClickHouse/ClickHouse/pull/4379 rel="external nofollow noreferrer">#4379</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> </ul> <h2 id=clickhouse-release-19-1-14-2019-03-14>ClickHouse release 19.1.14, 2019-03-14<a class=headerlink href=#clickhouse-release-19-1-14-2019-03-14 title="Permanent link">&para;</a></h2> <ul> <li>Fixed error <code>Column ... queried more than once</code> that may happen if the setting <code>asterisk_left_columns_only</code> is set to 1 in case of using <code>GLOBAL JOIN</code> with <code>SELECT *</code> (rare case). The issue does not exist in 19.3 and newer. <a href=https://github.com/ClickHouse/ClickHouse/pull/4692/commits/6bac7d8d11a9b0d6de0b32b53c47eb2f6f8e7062 rel="external nofollow noreferrer">6bac7d8d</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h2 id=clickhouse-release-19-1-13-2019-03-12>ClickHouse release 19.1.13, 2019-03-12<a class=headerlink href=#clickhouse-release-19-1-13-2019-03-12 title="Permanent link">&para;</a></h2> <p>This release contains exactly the same set of patches as 19.3.7.</p> <h2 id=clickhouse-release-19-1-10-2019-03-03>ClickHouse release 19.1.10, 2019-03-03<a class=headerlink href=#clickhouse-release-19-1-10-2019-03-03 title="Permanent link">&para;</a></h2> <p>This release contains exactly the same set of patches as 19.3.6.</p> <h2 id=clickhouse-release-19-1-9-2019-02-21>ClickHouse release 19.1.9, 2019-02-21<a class=headerlink href=#clickhouse-release-19-1-9-2019-02-21 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_18>Bug fixes<a class=headerlink href=#bug-fixes_18 title="Permanent link">&para;</a></h3> <ul> <li>Fixed backward incompatibility with old versions due to wrong implementation of <code>send_logs_level</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/4445 rel="external nofollow noreferrer">#4445</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed backward incompatibility of table function <code>remote</code> introduced with column comments. <a href=https://github.com/ClickHouse/ClickHouse/pull/4446 rel="external nofollow noreferrer">#4446</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-1-8-2019-02-16>ClickHouse release 19.1.8, 2019-02-16<a class=headerlink href=#clickhouse-release-19-1-8-2019-02-16 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_19>Bug Fixes<a class=headerlink href=#bug-fixes_19 title="Permanent link">&para;</a></h3> <ul> <li>Fix install package with missing /etc/clickhouse-server/config.xml. <a href=https://github.com/ClickHouse/ClickHouse/pull/4343 rel="external nofollow noreferrer">#4343</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h2 id=clickhouse-release-19-1-7-2019-02-15>ClickHouse release 19.1.7, 2019-02-15<a class=headerlink href=#clickhouse-release-19-1-7-2019-02-15 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_20>Bug Fixes<a class=headerlink href=#bug-fixes_20 title="Permanent link">&para;</a></h3> <ul> <li>Correctly return the right type and properly handle locks in <code>joinGet</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/4153 rel="external nofollow noreferrer">#4153</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Fixed error when system logs are tried to create again at server shutdown. <a href=https://github.com/ClickHouse/ClickHouse/pull/4254 rel="external nofollow noreferrer">#4254</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed error: if there is a database with <code>Dictionary</code> engine, all dictionaries forced to load at server startup, and if there is a dictionary with ClickHouse source from localhost, the dictionary cannot load. <a href=https://github.com/ClickHouse/ClickHouse/pull/4255 rel="external nofollow noreferrer">#4255</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed a bug when the execution of mutations containing <code>IN</code> operators was producing incorrect results. <a href=https://github.com/ClickHouse/ClickHouse/pull/4099 rel="external nofollow noreferrer">#4099</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li><code>clickhouse-client</code> can segfault on exit while loading data for command line suggestions if it was run in interactive mode. <a href=https://github.com/ClickHouse/ClickHouse/pull/4317 rel="external nofollow noreferrer">#4317</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed race condition when selecting from <code>system.tables</code> may give <code>table doesn't exist</code> error. <a href=https://github.com/ClickHouse/ClickHouse/pull/4313 rel="external nofollow noreferrer">#4313</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed deadlock when <code>SELECT</code> from a table with <code>File</code> engine was retried after <code>No such file or directory</code> error. <a href=https://github.com/ClickHouse/ClickHouse/pull/4161 rel="external nofollow noreferrer">#4161</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed an issue: local ClickHouse dictionaries are loaded via TCP, but should load within process. <a href=https://github.com/ClickHouse/ClickHouse/pull/4166 rel="external nofollow noreferrer">#4166</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed <code>No message received</code> error when interacting with PostgreSQL ODBC Driver through TLS connection. Also fixes segfault when using MySQL ODBC Driver. <a href=https://github.com/ClickHouse/ClickHouse/pull/4170 rel="external nofollow noreferrer">#4170</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Temporarily disable predicate optimization for <code>ORDER BY</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3890 rel="external nofollow noreferrer">#3890</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Fixed infinite loop when selecting from table function <code>numbers(0)</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4280 rel="external nofollow noreferrer">#4280</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed <code>compile_expressions</code> bug with comparison of big (more than int16) dates. <a href=https://github.com/ClickHouse/ClickHouse/pull/4341 rel="external nofollow noreferrer">#4341</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed segmentation fault with <code>uncompressed_cache=1</code> and exception with wrong uncompressed size. <a href=https://github.com/ClickHouse/ClickHouse/pull/4186 rel="external nofollow noreferrer">#4186</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed <code>ALL JOIN</code> with duplicates in right table. <a href=https://github.com/ClickHouse/ClickHouse/pull/4184 rel="external nofollow noreferrer">#4184</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Fixed wrong behaviour when doing <code>INSERT ... SELECT ... FROM file(...)</code> query and file has <code>CSVWithNames</code> or <code>TSVWIthNames</code> format and the first data row is missing. <a href=https://github.com/ClickHouse/ClickHouse/pull/4297 rel="external nofollow noreferrer">#4297</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed aggregate functions execution with <code>Array(LowCardinality)</code> arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/4055 rel="external nofollow noreferrer">#4055</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Debian package: correct /etc/clickhouse-server/preprocessed link according to config. <a href=https://github.com/ClickHouse/ClickHouse/pull/4205 rel="external nofollow noreferrer">#4205</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed fuzz test under undefined behavior sanitizer: added parameter type check for <code>quantile*Weighted</code> family of functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/4145 rel="external nofollow noreferrer">#4145</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Make <code>START REPLICATED SENDS</code> command start replicated sends. <a href=https://github.com/ClickHouse/ClickHouse/pull/4229 rel="external nofollow noreferrer">#4229</a> (<a href=https://github.com/nvartolomei rel="external nofollow noreferrer">nvartolomei</a>)</li> <li>Fixed <code>Not found column</code> for duplicate columns in JOIN ON section. <a href=https://github.com/ClickHouse/ClickHouse/pull/4279 rel="external nofollow noreferrer">#4279</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Now <code>/etc/ssl</code> is used as default directory with SSL certificates. <a href=https://github.com/ClickHouse/ClickHouse/pull/4167 rel="external nofollow noreferrer">#4167</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed crash on dictionary reload if dictionary not available. <a href=https://github.com/ClickHouse/ClickHouse/pull/4188 rel="external nofollow noreferrer">#4188</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Fixed bug with incorrect <code>Date</code> and <code>DateTime</code> comparison. <a href=https://github.com/ClickHouse/ClickHouse/pull/4237 rel="external nofollow noreferrer">#4237</a> (<a href=https://github.com/valexey rel="external nofollow noreferrer">valexey</a>)</li> <li>Fixed incorrect result when <code>Date</code> and <code>DateTime</code> arguments are used in branches of conditional operator (function <code>if</code>). Added generic case for function <code>if</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4243 rel="external nofollow noreferrer">#4243</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h2 id=clickhouse-release-19-1-6-2019-01-24>ClickHouse release 19.1.6, 2019-01-24<a class=headerlink href=#clickhouse-release-19-1-6-2019-01-24 title="Permanent link">&para;</a></h2> <h3 id=new-features_7>New Features<a class=headerlink href=#new-features_7 title="Permanent link">&para;</a></h3> <ul> <li>Custom per column compression codecs for tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/3899 rel="external nofollow noreferrer">#3899</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4111 rel="external nofollow noreferrer">#4111</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>, <a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>, <a href=https://github.com/Sindbag rel="external nofollow noreferrer">Anatoly</a>)</li> <li>Added compression codec <code>Delta</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4052 rel="external nofollow noreferrer">#4052</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Allow to <code>ALTER</code> compression codecs. <a href=https://github.com/ClickHouse/ClickHouse/pull/4054 rel="external nofollow noreferrer">#4054</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Added functions <code>left</code>, <code>right</code>, <code>trim</code>, <code>ltrim</code>, <code>rtrim</code>, <code>timestampadd</code>, <code>timestampsub</code> for SQL standard compatibility. <a href=https://github.com/ClickHouse/ClickHouse/pull/3826 rel="external nofollow noreferrer">#3826</a> (<a href=https://github.com/blinkov rel="external nofollow noreferrer">Ivan Blinkov</a>)</li> <li>Support for write in <code>HDFS</code> tables and <code>hdfs</code> table function. <a href=https://github.com/ClickHouse/ClickHouse/pull/4084 rel="external nofollow noreferrer">#4084</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Added functions to search for multiple constant strings from big haystack: <code>multiPosition</code>, <code>multiSearch</code> ,<code>firstMatch</code> also with <code>-UTF8</code>, <code>-CaseInsensitive</code>, and <code>-CaseInsensitiveUTF8</code> variants. <a href=https://github.com/ClickHouse/ClickHouse/pull/4053 rel="external nofollow noreferrer">#4053</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Pruning of unused shards if <code>SELECT</code> query filters by sharding key (setting <code>optimize_skip_unused_shards</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/3851 rel="external nofollow noreferrer">#3851</a> (<a href=https://github.com/kanterov rel="external nofollow noreferrer">Gleb Kanterov</a>, <a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Allow <code>Kafka</code> engine to ignore some number of parsing errors per block. <a href=https://github.com/ClickHouse/ClickHouse/pull/4094 rel="external nofollow noreferrer">#4094</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Added support for <code>CatBoost</code> multiclass models evaluation. Function <code>modelEvaluate</code> returns tuple with per-class raw predictions for multiclass models. <code>libcatboostmodel.so</code> should be built with <a href=https://github.com/catboost/catboost/pull/607 rel="external nofollow noreferrer">#607</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3959 rel="external nofollow noreferrer">#3959</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Added functions <code>filesystemAvailable</code>, <code>filesystemFree</code>, <code>filesystemCapacity</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4097 rel="external nofollow noreferrer">#4097</a> (<a href=https://github.com/bgranvea rel="external nofollow noreferrer">Boris Granveaud</a>)</li> <li>Added hashing functions <code>xxHash64</code> and <code>xxHash32</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3905 rel="external nofollow noreferrer">#3905</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Added <code>gccMurmurHash</code> hashing function (GCC flavoured Murmur hash) which uses the same hash seed as <a href=https://github.com/gcc-mirror/gcc/blob/41d6b10e96a1de98e90a7c0378437c3255814b16/libstdc%2B%2B-v3/include/bits/functional_hash.h#L191 rel="external nofollow noreferrer">gcc</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4000 rel="external nofollow noreferrer">#4000</a> (<a href=https://github.com/sundy-li rel="external nofollow noreferrer">sundyli</a>)</li> <li>Added hashing functions <code>javaHash</code>, <code>hiveHash</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3811 rel="external nofollow noreferrer">#3811</a> (<a href=https://github.com/shangshujie365 rel="external nofollow noreferrer">shangshujie365</a>)</li> <li>Added table function <code>remoteSecure</code>. Function works as <code>remote</code>, but uses secure connection. <a href=https://github.com/ClickHouse/ClickHouse/pull/4088 rel="external nofollow noreferrer">#4088</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> </ul> <h3 id=experimental-features_3>Experimental features<a class=headerlink href=#experimental-features_3 title="Permanent link">&para;</a></h3> <ul> <li>Added multiple JOINs emulation (<code>allow_experimental_multiple_joins_emulation</code> setting). <a href=https://github.com/ClickHouse/ClickHouse/pull/3946 rel="external nofollow noreferrer">#3946</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> </ul> <h3 id=bug-fixes_21>Bug Fixes<a class=headerlink href=#bug-fixes_21 title="Permanent link">&para;</a></h3> <ul> <li>Make <code>compiled_expression_cache_size</code> setting limited by default to lower memory consumption. <a href=https://github.com/ClickHouse/ClickHouse/pull/4041 rel="external nofollow noreferrer">#4041</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix a bug that led to hangups in threads that perform ALTERs of Replicated tables and in the thread that updates configuration from ZooKeeper. <a href=https://github.com/ClickHouse/ClickHouse/issues/2947 rel="external nofollow noreferrer">#2947</a> <a href=https://github.com/ClickHouse/ClickHouse/issues/3891 rel="external nofollow noreferrer">#3891</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3934 rel="external nofollow noreferrer">#3934</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Fixed a race condition when executing a distributed ALTER task. The race condition led to more than one replica trying to execute the task and all replicas except one failing with a ZooKeeper error. <a href=https://github.com/ClickHouse/ClickHouse/pull/3904 rel="external nofollow noreferrer">#3904</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Fix a bug when <code>from_zk</code> config elements weren't refreshed after a request to ZooKeeper timed out. <a href=https://github.com/ClickHouse/ClickHouse/issues/2947 rel="external nofollow noreferrer">#2947</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3947 rel="external nofollow noreferrer">#3947</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Fix bug with wrong prefix for IPv4 subnet masks. <a href=https://github.com/ClickHouse/ClickHouse/pull/3945 rel="external nofollow noreferrer">#3945</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed crash (<code>std::terminate</code>) in rare cases when a new thread cannot be created due to exhausted resources. <a href=https://github.com/ClickHouse/ClickHouse/pull/3956 rel="external nofollow noreferrer">#3956</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix bug when in <code>remote</code> table function execution when wrong restrictions were used for in <code>getStructureOfRemoteTable</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4009 rel="external nofollow noreferrer">#4009</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fix a leak of netlink sockets. They were placed in a pool where they were never deleted and new sockets were created at the start of a new thread when all current sockets were in use. <a href=https://github.com/ClickHouse/ClickHouse/pull/4017 rel="external nofollow noreferrer">#4017</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Fix bug with closing <code>/proc/self/fd</code> directory earlier than all fds were read from <code>/proc</code> after forking <code>odbc-bridge</code> subprocess. <a href=https://github.com/ClickHouse/ClickHouse/pull/4120 rel="external nofollow noreferrer">#4120</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed String to UInt monotonic conversion in case of usage String in primary key. <a href=https://github.com/ClickHouse/ClickHouse/pull/3870 rel="external nofollow noreferrer">#3870</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Fixed error in calculation of integer conversion function monotonicity. <a href=https://github.com/ClickHouse/ClickHouse/pull/3921 rel="external nofollow noreferrer">#3921</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed segfault in <code>arrayEnumerateUniq</code>, <code>arrayEnumerateDense</code> functions in case of some invalid arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/3909 rel="external nofollow noreferrer">#3909</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fix UB in StorageMerge. <a href=https://github.com/ClickHouse/ClickHouse/pull/3910 rel="external nofollow noreferrer">#3910</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Fixed segfault in functions <code>addDays</code>, <code>subtractDays</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3913 rel="external nofollow noreferrer">#3913</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed error: functions <code>round</code>, <code>floor</code>, <code>trunc</code>, <code>ceil</code> may return bogus result when executed on integer argument and large negative scale. <a href=https://github.com/ClickHouse/ClickHouse/pull/3914 rel="external nofollow noreferrer">#3914</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed a bug induced by 'kill query sync' which leads to a core dump. <a href=https://github.com/ClickHouse/ClickHouse/pull/3916 rel="external nofollow noreferrer">#3916</a> (<a href=https://github.com/fancyqlx rel="external nofollow noreferrer">muVulDeePecker</a>)</li> <li>Fix bug with long delay after empty replication queue. <a href=https://github.com/ClickHouse/ClickHouse/pull/3928 rel="external nofollow noreferrer">#3928</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3932 rel="external nofollow noreferrer">#3932</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Fixed excessive memory usage in case of inserting into table with <code>LowCardinality</code> primary key. <a href=https://github.com/ClickHouse/ClickHouse/pull/3955 rel="external nofollow noreferrer">#3955</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Fixed <code>LowCardinality</code> serialization for <code>Native</code> format in case of empty arrays. <a href=https://github.com/ClickHouse/ClickHouse/issues/3907 rel="external nofollow noreferrer">#3907</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4011 rel="external nofollow noreferrer">#4011</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Fixed incorrect result while using distinct by single LowCardinality numeric column. <a href=https://github.com/ClickHouse/ClickHouse/issues/3895 rel="external nofollow noreferrer">#3895</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/4012 rel="external nofollow noreferrer">#4012</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Fixed specialized aggregation with LowCardinality key (in case when <code>compile</code> setting is enabled). <a href=https://github.com/ClickHouse/ClickHouse/pull/3886 rel="external nofollow noreferrer">#3886</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Fix user and password forwarding for replicated tables queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3957 rel="external nofollow noreferrer">#3957</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>) (<a href=https://github.com/nicelulu rel="external nofollow noreferrer">小路</a>)</li> <li>Fixed very rare race condition that can happen when listing tables in Dictionary database while reloading dictionaries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3970 rel="external nofollow noreferrer">#3970</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed incorrect result when HAVING was used with ROLLUP or CUBE. <a href=https://github.com/ClickHouse/ClickHouse/issues/3756 rel="external nofollow noreferrer">#3756</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3837 rel="external nofollow noreferrer">#3837</a> (<a href=https://github.com/reflection rel="external nofollow noreferrer">Sam Chou</a>)</li> <li>Fixed column aliases for query with <code>JOIN ON</code> syntax and distributed tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/3980 rel="external nofollow noreferrer">#3980</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Fixed error in internal implementation of <code>quantileTDigest</code> (found by Artem Vakhrushev). This error never happens in ClickHouse and was relevant only for those who use ClickHouse codebase as a library directly. <a href=https://github.com/ClickHouse/ClickHouse/pull/3935 rel="external nofollow noreferrer">#3935</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=improvements_6>Improvements<a class=headerlink href=#improvements_6 title="Permanent link">&para;</a></h3> <ul> <li>Support for <code>IF NOT EXISTS</code> in <code>ALTER TABLE ADD COLUMN</code> statements along with <code>IF EXISTS</code> in <code>DROP/MODIFY/CLEAR/COMMENT COLUMN</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3900 rel="external nofollow noreferrer">#3900</a> (<a href=https://github.com/bgranvea rel="external nofollow noreferrer">Boris Granveaud</a>)</li> <li>Function <code>parseDateTimeBestEffort</code>: support for formats <code>DD.MM.YYYY</code>, <code>DD.MM.YY</code>, <code>DD-MM-YYYY</code>, <code>DD-Mon-YYYY</code>, <code>DD/Month/YYYY</code> and similar. <a href=https://github.com/ClickHouse/ClickHouse/pull/3922 rel="external nofollow noreferrer">#3922</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li><code>CapnProtoInputStream</code> now support jagged structures. <a href=https://github.com/ClickHouse/ClickHouse/pull/4063 rel="external nofollow noreferrer">#4063</a> (<a href=https://github.com/Miniwoffer rel="external nofollow noreferrer">Odin Hultgren Van Der Horst</a>)</li> <li>Usability improvement: added a check that server process is started from the data directory's owner. Do not allow to start server from root if the data belongs to non-root user. <a href=https://github.com/ClickHouse/ClickHouse/pull/3785 rel="external nofollow noreferrer">#3785</a> (<a href=https://github.com/sergey-v-galtsev rel="external nofollow noreferrer">sergey-v-galtsev</a>)</li> <li>Better logic of checking required columns during analysis of queries with JOINs. <a href=https://github.com/ClickHouse/ClickHouse/pull/3930 rel="external nofollow noreferrer">#3930</a> (<a href=https://github.com/4ertus2 rel="external nofollow noreferrer">Artem Zuikov</a>)</li> <li>Decreased the number of connections in case of large number of Distributed tables in a single server. <a href=https://github.com/ClickHouse/ClickHouse/pull/3726 rel="external nofollow noreferrer">#3726</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Supported totals row for <code>WITH TOTALS</code> query for ODBC driver. <a href=https://github.com/ClickHouse/ClickHouse/pull/3836 rel="external nofollow noreferrer">#3836</a> (<a href=https://github.com/nightweb rel="external nofollow noreferrer">Maksim Koritckiy</a>)</li> <li>Allowed to use <code>Enum</code>s as integers inside if function. <a href=https://github.com/ClickHouse/ClickHouse/pull/3875 rel="external nofollow noreferrer">#3875</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Added <code>low_cardinality_allow_in_native_format</code> setting. If disabled, do not use <code>LowCadrinality</code> type in <code>Native</code> format. <a href=https://github.com/ClickHouse/ClickHouse/pull/3879 rel="external nofollow noreferrer">#3879</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer">KochetovNicolai</a>)</li> <li>Removed some redundant objects from compiled expressions cache to lower memory usage. <a href=https://github.com/ClickHouse/ClickHouse/pull/4042 rel="external nofollow noreferrer">#4042</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Add check that <code>SET send_logs_level = 'value'</code> query accept appropriate value. <a href=https://github.com/ClickHouse/ClickHouse/pull/3873 rel="external nofollow noreferrer">#3873</a> (<a href=https://github.com/s-mx rel="external nofollow noreferrer">Sabyanin Maxim</a>)</li> <li>Fixed data type check in type conversion functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/3896 rel="external nofollow noreferrer">#3896</a> (<a href=https://github.com/zhang2014 rel="external nofollow noreferrer">Winter Zhang</a>)</li> </ul> <h3 id=performance-improvements_5>Performance Improvements<a class=headerlink href=#performance-improvements_5 title="Permanent link">&para;</a></h3> <ul> <li>Add a MergeTree setting <code>use_minimalistic_part_header_in_zookeeper</code>. If enabled, Replicated tables will store compact part metadata in a single part znode. This can dramatically reduce ZooKeeper snapshot size (especially if the tables have a lot of columns). Note that after enabling this setting you will not be able to downgrade to a version that doesn't support it. <a href=https://github.com/ClickHouse/ClickHouse/pull/3960 rel="external nofollow noreferrer">#3960</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Add an DFA-based implementation for functions <code>sequenceMatch</code> and <code>sequenceCount</code> in case pattern doesn't contain time. <a href=https://github.com/ClickHouse/ClickHouse/pull/4004 rel="external nofollow noreferrer">#4004</a> (<a href=https://github.com/ercolanelli-leo rel="external nofollow noreferrer">Léo Ercolanelli</a>)</li> <li>Performance improvement for integer numbers serialization. <a href=https://github.com/ClickHouse/ClickHouse/pull/3968 rel="external nofollow noreferrer">#3968</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Zero left padding PODArray so that -1 element is always valid and zeroed. It's used for branchless calculation of offsets. <a href=https://github.com/ClickHouse/ClickHouse/pull/3920 rel="external nofollow noreferrer">#3920</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer">Amos Bird</a>)</li> <li>Reverted <code>jemalloc</code> version which lead to performance degradation. <a href=https://github.com/ClickHouse/ClickHouse/pull/4018 rel="external nofollow noreferrer">#4018</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> </ul> <h3 id=backward-incompatible-changes_2>Backward Incompatible Changes<a class=headerlink href=#backward-incompatible-changes_2 title="Permanent link">&para;</a></h3> <ul> <li>Removed undocumented feature <code>ALTER MODIFY PRIMARY KEY</code> because it was superseded by the <code>ALTER MODIFY ORDER BY</code> command. <a href=https://github.com/ClickHouse/ClickHouse/pull/3887 rel="external nofollow noreferrer">#3887</a> (<a href=https://github.com/ztlpn rel="external nofollow noreferrer">Alex Zatelepin</a>)</li> <li>Removed function <code>shardByHash</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3833 rel="external nofollow noreferrer">#3833</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Forbid using scalar subqueries with result of type <code>AggregateFunction</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3865 rel="external nofollow noreferrer">#3865</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> </ul> <h3 id=build-testing-packaging-improvements_6>Build/Testing/Packaging Improvements<a class=headerlink href=#build-testing-packaging-improvements_6 title="Permanent link">&para;</a></h3> <ul> <li>Added support for PowerPC (<code>ppc64le</code>) build. <a href=https://github.com/ClickHouse/ClickHouse/pull/4132 rel="external nofollow noreferrer">#4132</a> (<a href=https://github.com/danlark1 rel="external nofollow noreferrer">Danila Kutenin</a>)</li> <li>Stateful functional tests are run on public available dataset. <a href=https://github.com/ClickHouse/ClickHouse/pull/3969 rel="external nofollow noreferrer">#3969</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed error when the server cannot start with the <code>bash: /usr/bin/clickhouse-extract-from-config: Operation not permitted</code> message within Docker or systemd-nspawn. <a href=https://github.com/ClickHouse/ClickHouse/pull/4136 rel="external nofollow noreferrer">#4136</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Updated <code>rdkafka</code> library to v1.0.0-RC5. Used cppkafka instead of raw C interface. <a href=https://github.com/ClickHouse/ClickHouse/pull/4025 rel="external nofollow noreferrer">#4025</a> (<a href=https://github.com/abyss7 rel="external nofollow noreferrer">Ivan</a>)</li> <li>Updated <code>mariadb-client</code> library. Fixed one of issues found by UBSan. <a href=https://github.com/ClickHouse/ClickHouse/pull/3924 rel="external nofollow noreferrer">#3924</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Some fixes for UBSan builds. <a href=https://github.com/ClickHouse/ClickHouse/pull/3926 rel="external nofollow noreferrer">#3926</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3021 rel="external nofollow noreferrer">#3021</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3948 rel="external nofollow noreferrer">#3948</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added per-commit runs of tests with UBSan build.</li> <li>Added per-commit runs of PVS-Studio static analyzer.</li> <li>Fixed bugs found by PVS-Studio. <a href=https://github.com/ClickHouse/ClickHouse/pull/4013 rel="external nofollow noreferrer">#4013</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed glibc compatibility issues. <a href=https://github.com/ClickHouse/ClickHouse/pull/4100 rel="external nofollow noreferrer">#4100</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Move Docker images to 18.10 and add compatibility file for glibc &gt;= 2.28 <a href=https://github.com/ClickHouse/ClickHouse/pull/3965 rel="external nofollow noreferrer">#3965</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Add env variable if user don't want to chown directories in server Docker image. <a href=https://github.com/ClickHouse/ClickHouse/pull/3967 rel="external nofollow noreferrer">#3967</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li>Enabled most of the warnings from <code>-Weverything</code> in clang. Enabled <code>-Wpedantic</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3986 rel="external nofollow noreferrer">#3986</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Added a few more warnings that are available only in clang 8. <a href=https://github.com/ClickHouse/ClickHouse/pull/3993 rel="external nofollow noreferrer">#3993</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Link to <code>libLLVM</code> rather than to individual LLVM libs when using shared linking. <a href=https://github.com/ClickHouse/ClickHouse/pull/3989 rel="external nofollow noreferrer">#3989</a> (<a href=https://github.com/orivej rel="external nofollow noreferrer">Orivej Desh</a>)</li> <li>Added sanitizer variables for test images. <a href=https://github.com/ClickHouse/ClickHouse/pull/4072 rel="external nofollow noreferrer">#4072</a> (<a href=https://github.com/alesapin rel="external nofollow noreferrer">alesapin</a>)</li> <li><code>clickhouse-server</code> debian package will recommend <code>libcap2-bin</code> package to use <code>setcap</code> tool for setting capabilities. This is optional. <a href=https://github.com/ClickHouse/ClickHouse/pull/4093 rel="external nofollow noreferrer">#4093</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Improved compilation time, fixed includes. <a href=https://github.com/ClickHouse/ClickHouse/pull/3898 rel="external nofollow noreferrer">#3898</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Added performance tests for hash functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/3918 rel="external nofollow noreferrer">#3918</a> (<a href=https://github.com/filimonov rel="external nofollow noreferrer">filimonov</a>)</li> <li>Fixed cyclic library dependences. <a href=https://github.com/ClickHouse/ClickHouse/pull/3958 rel="external nofollow noreferrer">#3958</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Improved compilation with low available memory. <a href=https://github.com/ClickHouse/ClickHouse/pull/4030 rel="external nofollow noreferrer">#4030</a> (<a href=https://github.com/proller rel="external nofollow noreferrer">proller</a>)</li> <li>Added test script to reproduce performance degradation in <code>jemalloc</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4036 rel="external nofollow noreferrer">#4036</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer">alexey-milovidov</a>)</li> <li>Fixed misspells in comments and string literals under <code>dbms</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/4122 rel="external nofollow noreferrer">#4122</a> (<a href=https://github.com/maiha rel="external nofollow noreferrer">maiha</a>)</li> <li>Fixed typos in comments. <a href=https://github.com/ClickHouse/ClickHouse/pull/4089 rel="external nofollow noreferrer">#4089</a> (<a href=https://github.com/kvinty rel="external nofollow noreferrer">Evgenii Pravda</a>)</li> </ul> <h2 id=clickhouse-release-18-16-1-2018-12-21>ClickHouse release 18.16.1, 2018-12-21<a class=headerlink href=#clickhouse-release-18-16-1-2018-12-21 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_22>Bug fixes:<a class=headerlink href=#bug-fixes_22 title="Permanent link">&para;</a></h3> <ul> <li>Fixed an error that led to problems with updating dictionaries with the ODBC source. <a href=https://github.com/ClickHouse/ClickHouse/issues/3825 rel="external nofollow noreferrer">#3825</a>, <a href=https://github.com/ClickHouse/ClickHouse/issues/3829 rel="external nofollow noreferrer">#3829</a></li> <li>JIT compilation of aggregate functions now works with LowCardinality columns. <a href=https://github.com/ClickHouse/ClickHouse/issues/3838 rel="external nofollow noreferrer">#3838</a></li> </ul> <h3 id=improvements_7>Improvements:<a class=headerlink href=#improvements_7 title="Permanent link">&para;</a></h3> <ul> <li>Added the <code>low_cardinality_allow_in_native_format</code> setting (enabled by default). When disabled, LowCardinality columns will be converted to ordinary columns for SELECT queries and ordinary columns will be expected for INSERT queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3879 rel="external nofollow noreferrer">#3879</a></li> </ul> <h3 id=build-improvements>Build improvements:<a class=headerlink href=#build-improvements title="Permanent link">&para;</a></h3> <ul> <li>Fixes for builds on macOS and ARM.</li> </ul> <h2 id=clickhouse-release-18-16-0-2018-12-14>ClickHouse release 18.16.0, 2018-12-14<a class=headerlink href=#clickhouse-release-18-16-0-2018-12-14 title="Permanent link">&para;</a></h2> <h3 id=new-features_8>New features:<a class=headerlink href=#new-features_8 title="Permanent link">&para;</a></h3> <ul> <li><code>DEFAULT</code> expressions are evaluated for missing fields when loading data in semi-structured input formats (<code>JSONEachRow</code>, <code>TSKV</code>). The feature is enabled with the <code>insert_sample_with_metadata</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/3555 rel="external nofollow noreferrer">#3555</a></li> <li>The <code>ALTER TABLE</code> query now has the <code>MODIFY ORDER BY</code> action for changing the sorting key when adding or removing a table column. This is useful for tables in the <code>MergeTree</code> family that perform additional tasks when merging based on this sorting key, such as <code>SummingMergeTree</code>, <code>AggregatingMergeTree</code>, and so on. <a href=https://github.com/ClickHouse/ClickHouse/pull/3581 rel="external nofollow noreferrer">#3581</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3755 rel="external nofollow noreferrer">#3755</a></li> <li>For tables in the <code>MergeTree</code> family, now you can specify a different sorting key (<code>ORDER BY</code>) and index (<code>PRIMARY KEY</code>). The sorting key can be longer than the index. <a href=https://github.com/ClickHouse/ClickHouse/pull/3581 rel="external nofollow noreferrer">#3581</a></li> <li>Added the <code>hdfs</code> table function and the <code>HDFS</code> table engine for importing and exporting data to HDFS. <a href=https://github.com/ClickHouse/ClickHouse/pull/3617 rel="external nofollow noreferrer">chenxing-xc</a></li> <li>Added functions for working with base64: <code>base64Encode</code>, <code>base64Decode</code>, <code>tryBase64Decode</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3350 rel="external nofollow noreferrer">Alexander Krasheninnikov</a></li> <li>Now you can use a parameter to configure the precision of the <code>uniqCombined</code> aggregate function (select the number of HyperLogLog cells). <a href=https://github.com/ClickHouse/ClickHouse/pull/3406 rel="external nofollow noreferrer">#3406</a></li> <li>Added the <code>system.contributors</code> table that contains the names of everyone who made commits in ClickHouse. <a href=https://github.com/ClickHouse/ClickHouse/pull/3452 rel="external nofollow noreferrer">#3452</a></li> <li>Added the ability to omit the partition for the <code>ALTER TABLE ... FREEZE</code> query in order to back up all partitions at once. <a href=https://github.com/ClickHouse/ClickHouse/pull/3514 rel="external nofollow noreferrer">#3514</a></li> <li>Added <code>dictGet</code> and <code>dictGetOrDefault</code> functions that don't require specifying the type of return value. The type is determined automatically from the dictionary description. <a href=https://github.com/ClickHouse/ClickHouse/pull/3564 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Now you can specify comments for a column in the table description and change it using <code>ALTER</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3377 rel="external nofollow noreferrer">#3377</a></li> <li>Reading is supported for <code>Join</code> type tables with simple keys. <a href=https://github.com/ClickHouse/ClickHouse/pull/3728 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Now you can specify the options <code>join_use_nulls</code>, <code>max_rows_in_join</code>, <code>max_bytes_in_join</code>, and <code>join_overflow_mode</code> when creating a <code>Join</code> type table. <a href=https://github.com/ClickHouse/ClickHouse/pull/3728 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Added the <code>joinGet</code> function that allows you to use a <code>Join</code> type table like a dictionary. <a href=https://github.com/ClickHouse/ClickHouse/pull/3728 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Added the <code>partition_key</code>, <code>sorting_key</code>, <code>primary_key</code>, and <code>sampling_key</code> columns to the <code>system.tables</code> table in order to provide information about table keys. <a href=https://github.com/ClickHouse/ClickHouse/pull/3609 rel="external nofollow noreferrer">#3609</a></li> <li>Added the <code>is_in_partition_key</code>, <code>is_in_sorting_key</code>, <code>is_in_primary_key</code>, and <code>is_in_sampling_key</code> columns to the <code>system.columns</code> table. <a href=https://github.com/ClickHouse/ClickHouse/pull/3609 rel="external nofollow noreferrer">#3609</a></li> <li>Added the <code>min_time</code> and <code>max_time</code> columns to the <code>system.parts</code> table. These columns are populated when the partitioning key is an expression consisting of <code>DateTime</code> columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/3800 rel="external nofollow noreferrer">Emmanuel Donin de Rosière</a></li> </ul> <h3 id=bug-fixes_23>Bug fixes:<a class=headerlink href=#bug-fixes_23 title="Permanent link">&para;</a></h3> <ul> <li>Fixes and performance improvements for the <code>LowCardinality</code> data type. <code>GROUP BY</code> using <code>LowCardinality(Nullable(...))</code>. Getting the values of <code>extremes</code>. Processing high-order functions. <code>LEFT ARRAY JOIN</code>. Distributed <code>GROUP BY</code>. Functions that return <code>Array</code>. Execution of <code>ORDER BY</code>. Writing to <code>Distributed</code> tables (nicelulu). Backward compatibility for <code>INSERT</code> queries from old clients that implement the <code>Native</code> protocol. Support for <code>LowCardinality</code> for <code>JOIN</code>. Improved performance when working in a single stream. <a href=https://github.com/ClickHouse/ClickHouse/pull/3823 rel="external nofollow noreferrer">#3823</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3803 rel="external nofollow noreferrer">#3803</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3799 rel="external nofollow noreferrer">#3799</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3769 rel="external nofollow noreferrer">#3769</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3744 rel="external nofollow noreferrer">#3744</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3681 rel="external nofollow noreferrer">#3681</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3651 rel="external nofollow noreferrer">#3651</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3649 rel="external nofollow noreferrer">#3649</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3641 rel="external nofollow noreferrer">#3641</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3632 rel="external nofollow noreferrer">#3632</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3568 rel="external nofollow noreferrer">#3568</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3523 rel="external nofollow noreferrer">#3523</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3518 rel="external nofollow noreferrer">#3518</a></li> <li>Fixed how the <code>select_sequential_consistency</code> option works. Previously, when this setting was enabled, an incomplete result was sometimes returned after beginning to write to a new partition. <a href=https://github.com/ClickHouse/ClickHouse/pull/2863 rel="external nofollow noreferrer">#2863</a></li> <li>Databases are correctly specified when executing DDL <code>ON CLUSTER</code> queries and <code>ALTER UPDATE/DELETE</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3772 rel="external nofollow noreferrer">#3772</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3460 rel="external nofollow noreferrer">#3460</a></li> <li>Databases are correctly specified for subqueries inside a VIEW. <a href=https://github.com/ClickHouse/ClickHouse/pull/3521 rel="external nofollow noreferrer">#3521</a></li> <li>Fixed a bug in <code>PREWHERE</code> with <code>FINAL</code> for <code>VersionedCollapsingMergeTree</code>. <a href=https://github.com/ClickHouse/ClickHouse/commit/7167bfd7b365538f7a91c4307ad77e552ab4e8c1 rel="external nofollow noreferrer">7167bfd7</a></li> <li>Now you can use <code>KILL QUERY</code> to cancel queries that have not started yet because they are waiting for the table to be locked. <a href=https://github.com/ClickHouse/ClickHouse/pull/3517 rel="external nofollow noreferrer">#3517</a></li> <li>Corrected date and time calculations if the clocks were moved back at midnight (this happens in Iran, and happened in Moscow from 1981 to 1983). Previously, this led to the time being reset a day earlier than necessary, and also caused incorrect formatting of the date and time in text format. <a href=https://github.com/ClickHouse/ClickHouse/pull/3819 rel="external nofollow noreferrer">#3819</a></li> <li>Fixed bugs in some cases of <code>VIEW</code> and subqueries that omit the database. <a href=https://github.com/ClickHouse/ClickHouse/pull/3521 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Fixed a race condition when simultaneously reading from a <code>MATERIALIZED VIEW</code> and deleting a <code>MATERIALIZED VIEW</code> due to not locking the internal <code>MATERIALIZED VIEW</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3404 rel="external nofollow noreferrer">#3404</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3694 rel="external nofollow noreferrer">#3694</a></li> <li>Fixed the error <code>Lock handler cannot be nullptr.</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/3689 rel="external nofollow noreferrer">#3689</a></li> <li>Fixed query processing when the <code>compile_expressions</code> option is enabled (it's enabled by default). Nondeterministic constant expressions like the <code>now</code> function are no longer unfolded. <a href=https://github.com/ClickHouse/ClickHouse/pull/3457 rel="external nofollow noreferrer">#3457</a></li> <li>Fixed a crash when specifying a non-constant scale argument in <code>toDecimal32/64/128</code> functions.</li> <li>Fixed an error when trying to insert an array with <code>NULL</code> elements in the <code>Values</code> format into a column of type <code>Array</code> without <code>Nullable</code> (if <code>input_format_values_interpret_expressions</code> = 1). <a href=https://github.com/ClickHouse/ClickHouse/pull/3487 rel="external nofollow noreferrer">#3487</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3503 rel="external nofollow noreferrer">#3503</a></li> <li>Fixed continuous error logging in <code>DDLWorker</code> if ZooKeeper is not available. <a href=https://github.com/ClickHouse/ClickHouse/commit/8f50c620334988b28018213ec0092fe6423847e2 rel="external nofollow noreferrer">8f50c620</a></li> <li>Fixed the return type for <code>quantile*</code> functions from <code>Date</code> and <code>DateTime</code> types of arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/3580 rel="external nofollow noreferrer">#3580</a></li> <li>Fixed the <code>WITH</code> clause if it specifies a simple alias without expressions. <a href=https://github.com/ClickHouse/ClickHouse/pull/3570 rel="external nofollow noreferrer">#3570</a></li> <li>Fixed processing of queries with named sub-queries and qualified column names when <code>enable_optimize_predicate_expression</code> is enabled. <a href=https://github.com/ClickHouse/ClickHouse/pull/3588 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Fixed the error <code>Attempt to attach to nullptr thread group</code> when working with materialized views. <a href=https://github.com/ClickHouse/ClickHouse/pull/3623 rel="external nofollow noreferrer">Marek Vavruša</a></li> <li>Fixed a crash when passing certain incorrect arguments to the <code>arrayReverse</code> function. <a href=https://github.com/ClickHouse/ClickHouse/commit/73e3a7b662161d6005e7727d8a711b930386b871 rel="external nofollow noreferrer">73e3a7b6</a></li> <li>Fixed the buffer overflow in the <code>extractURLParameter</code> function. Improved performance. Added correct processing of strings containing zero bytes. <a href=https://github.com/ClickHouse/ClickHouse/commit/141e9799e49201d84ea8e951d1bed4fb6d3dacb5 rel="external nofollow noreferrer">141e9799</a></li> <li>Fixed buffer overflow in the <code>lowerUTF8</code> and <code>upperUTF8</code> functions. Removed the ability to execute these functions over <code>FixedString</code> type arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/3662 rel="external nofollow noreferrer">#3662</a></li> <li>Fixed a rare race condition when deleting <code>MergeTree</code> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/3680 rel="external nofollow noreferrer">#3680</a></li> <li>Fixed a race condition when reading from <code>Buffer</code> tables and simultaneously performing <code>ALTER</code> or <code>DROP</code> on the target tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/3719 rel="external nofollow noreferrer">#3719</a></li> <li>Fixed a segfault if the <code>max_temporary_non_const_columns</code> limit was exceeded. <a href=https://github.com/ClickHouse/ClickHouse/pull/3788 rel="external nofollow noreferrer">#3788</a></li> </ul> <h3 id=improvements_8>Improvements:<a class=headerlink href=#improvements_8 title="Permanent link">&para;</a></h3> <ul> <li>The server does not write the processed configuration files to the <code>/etc/clickhouse-server/</code> directory. Instead, it saves them in the <code>preprocessed_configs</code> directory inside <code>path</code>. This means that the <code>/etc/clickhouse-server/</code> directory doesn't have write access for the <code>clickhouse</code> user, which improves security. <a href=https://github.com/ClickHouse/ClickHouse/pull/2443 rel="external nofollow noreferrer">#2443</a></li> <li>The <code>min_merge_bytes_to_use_direct_io</code> option is set to 10 GiB by default. A merge that forms large parts of tables from the MergeTree family will be performed in <code>O_DIRECT</code> mode, which prevents excessive page cache eviction. <a href=https://github.com/ClickHouse/ClickHouse/pull/3504 rel="external nofollow noreferrer">#3504</a></li> <li>Accelerated server start when there is a very large number of tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/3398 rel="external nofollow noreferrer">#3398</a></li> <li>Added a connection pool and HTTP <code>Keep-Alive</code> for connections between replicas. <a href=https://github.com/ClickHouse/ClickHouse/pull/3594 rel="external nofollow noreferrer">#3594</a></li> <li>If the query syntax is invalid, the <code>400 Bad Request</code> code is returned in the <code>HTTP</code> interface (500 was returned previously). <a href=https://github.com/ClickHouse/ClickHouse/commit/31bc680ac5f4bb1d0360a8ba4696fa84bb47d6ab rel="external nofollow noreferrer">31bc680a</a></li> <li>The <code>join_default_strictness</code> option is set to <code>ALL</code> by default for compatibility. <a href=https://github.com/ClickHouse/ClickHouse/commit/120e2cbe2ff4fbad626c28042d9b28781c805afe rel="external nofollow noreferrer">120e2cbe</a></li> <li>Removed logging to <code>stderr</code> from the <code>re2</code> library for invalid or complex regular expressions. <a href=https://github.com/ClickHouse/ClickHouse/pull/3723 rel="external nofollow noreferrer">#3723</a></li> <li>Added for the <code>Kafka</code> table engine: checks for subscriptions before beginning to read from Kafka; the kafka_max_block_size setting for the table. <a href=https://github.com/ClickHouse/ClickHouse/pull/3396 rel="external nofollow noreferrer">Marek Vavruša</a></li> <li>The <code>cityHash64</code>, <code>farmHash64</code>, <code>metroHash64</code>, <code>sipHash64</code>, <code>halfMD5</code>, <code>murmurHash2_32</code>, <code>murmurHash2_64</code>, <code>murmurHash3_32</code>, and <code>murmurHash3_64</code> functions now work for any number of arguments and for arguments in the form of tuples. <a href=https://github.com/ClickHouse/ClickHouse/pull/3451 rel="external nofollow noreferrer">#3451</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3519 rel="external nofollow noreferrer">#3519</a></li> <li>The <code>arrayReverse</code> function now works with any types of arrays. <a href=https://github.com/ClickHouse/ClickHouse/commit/73e3a7b662161d6005e7727d8a711b930386b871 rel="external nofollow noreferrer">73e3a7b6</a></li> <li>Added an optional parameter: the slot size for the <code>timeSlots</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/3724 rel="external nofollow noreferrer">Kirill Shvakov</a></li> <li>For <code>FULL</code> and <code>RIGHT JOIN</code>, the <code>max_block_size</code> setting is used for a stream of non-joined data from the right table. <a href=https://github.com/ClickHouse/ClickHouse/pull/3699 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Added the <code>--secure</code> command line parameter in <code>clickhouse-benchmark</code> and <code>clickhouse-performance-test</code> to enable TLS. <a href=https://github.com/ClickHouse/ClickHouse/pull/3688 rel="external nofollow noreferrer">#3688</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3690 rel="external nofollow noreferrer">#3690</a></li> <li>Type conversion when the structure of a <code>Buffer</code> type table does not match the structure of the destination table. <a href=https://github.com/ClickHouse/ClickHouse/pull/3603 rel="external nofollow noreferrer">Vitaly Baranov</a></li> <li>Added the <code>tcp_keep_alive_timeout</code> option to enable keep-alive packets after inactivity for the specified time interval. <a href=https://github.com/ClickHouse/ClickHouse/pull/3441 rel="external nofollow noreferrer">#3441</a></li> <li>Removed unnecessary quoting of values for the partition key in the <code>system.parts</code> table if it consists of a single column. <a href=https://github.com/ClickHouse/ClickHouse/pull/3652 rel="external nofollow noreferrer">#3652</a></li> <li>The modulo function works for <code>Date</code> and <code>DateTime</code> data types. <a href=https://github.com/ClickHouse/ClickHouse/pull/3385 rel="external nofollow noreferrer">#3385</a></li> <li>Added synonyms for the <code>POWER</code>, <code>LN</code>, <code>LCASE</code>, <code>UCASE</code>, <code>REPLACE</code>, <code>LOCATE</code>, <code>SUBSTR</code>, and <code>MID</code> functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/3774 rel="external nofollow noreferrer">#3774</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3763 rel="external nofollow noreferrer">#3763</a> Some function names are case-insensitive for compatibility with the SQL standard. Added syntactic sugar <code>SUBSTRING(expr FROM start FOR length)</code> for compatibility with SQL. <a href=https://github.com/ClickHouse/ClickHouse/pull/3804 rel="external nofollow noreferrer">#3804</a></li> <li>Added the ability to <code>mlock</code> memory pages corresponding to <code>clickhouse-server</code> executable code to prevent it from being forced out of memory. This feature is disabled by default. <a href=https://github.com/ClickHouse/ClickHouse/pull/3553 rel="external nofollow noreferrer">#3553</a></li> <li>Improved performance when reading from <code>O_DIRECT</code> (with the <code>min_bytes_to_use_direct_io</code> option enabled). <a href=https://github.com/ClickHouse/ClickHouse/pull/3405 rel="external nofollow noreferrer">#3405</a></li> <li>Improved performance of the <code>dictGet...OrDefault</code> function for a constant key argument and a non-constant default argument. <a href=https://github.com/ClickHouse/ClickHouse/pull/3563 rel="external nofollow noreferrer">Amos Bird</a></li> <li>The <code>firstSignificantSubdomain</code> function now processes the domains <code>gov</code>, <code>mil</code>, and <code>edu</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3601 rel="external nofollow noreferrer">Igor Hatarist</a> Improved performance. <a href=https://github.com/ClickHouse/ClickHouse/pull/3628 rel="external nofollow noreferrer">#3628</a></li> <li>Ability to specify custom environment variables for starting <code>clickhouse-server</code> using the <code>SYS-V init.d</code> script by defining <code>CLICKHOUSE_PROGRAM_ENV</code> in <code>/etc/default/clickhouse</code>.<br> <a href=https://github.com/ClickHouse/ClickHouse/pull/3612 rel="external nofollow noreferrer">Pavlo Bashynskyi</a></li> <li>Correct return code for the clickhouse-server init script. <a href=https://github.com/ClickHouse/ClickHouse/pull/3516 rel="external nofollow noreferrer">#3516</a></li> <li>The <code>system.metrics</code> table now has the <code>VersionInteger</code> metric, and <code>system.build_options</code> has the added line <code>VERSION_INTEGER</code>, which contains the numeric form of the ClickHouse version, such as <code>18016000</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3644 rel="external nofollow noreferrer">#3644</a></li> <li>Removed the ability to compare the <code>Date</code> type with a number to avoid potential errors like <code>date = 2018-12-17</code>, where quotes around the date are omitted by mistake. <a href=https://github.com/ClickHouse/ClickHouse/pull/3687 rel="external nofollow noreferrer">#3687</a></li> <li>Fixed the behavior of stateful functions like <code>rowNumberInAllBlocks</code>. They previously output a result that was one number larger due to starting during query analysis. <a href=https://github.com/ClickHouse/ClickHouse/pull/3729 rel="external nofollow noreferrer">Amos Bird</a></li> <li>If the <code>force_restore_data</code> file can't be deleted, an error message is displayed. <a href=https://github.com/ClickHouse/ClickHouse/pull/3794 rel="external nofollow noreferrer">Amos Bird</a></li> </ul> <h3 id=build-improvements_1>Build improvements:<a class=headerlink href=#build-improvements_1 title="Permanent link">&para;</a></h3> <ul> <li>Updated the <code>jemalloc</code> library, which fixes a potential memory leak. <a href=https://github.com/ClickHouse/ClickHouse/pull/3557 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Profiling with <code>jemalloc</code> is enabled by default in order to debug builds. <a href=https://github.com/ClickHouse/ClickHouse/commit/2cc82f5cbe266421cd4c1165286c2c47e5ffcb15 rel="external nofollow noreferrer">2cc82f5c</a></li> <li>Added the ability to run integration tests when only <code>Docker</code> is installed on the system. <a href=https://github.com/ClickHouse/ClickHouse/pull/3650 rel="external nofollow noreferrer">#3650</a></li> <li>Added the fuzz expression test in SELECT queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3442 rel="external nofollow noreferrer">#3442</a></li> <li>Added a stress test for commits, which performs functional tests in parallel and in random order to detect more race conditions. <a href=https://github.com/ClickHouse/ClickHouse/pull/3438 rel="external nofollow noreferrer">#3438</a></li> <li>Improved the method for starting clickhouse-server in a Docker image. <a href=https://github.com/ClickHouse/ClickHouse/pull/3663 rel="external nofollow noreferrer">Elghazal Ahmed</a></li> <li>For a Docker image, added support for initializing databases using files in the <code>/docker-entrypoint-initdb.d</code> directory. <a href=https://github.com/ClickHouse/ClickHouse/pull/3695 rel="external nofollow noreferrer">Konstantin Lebedev</a></li> <li>Fixes for builds on ARM. <a href=https://github.com/ClickHouse/ClickHouse/pull/3709 rel="external nofollow noreferrer">#3709</a></li> </ul> <h3 id=backward-incompatible-changes_3>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_3 title="Permanent link">&para;</a></h3> <ul> <li>Removed the ability to compare the <code>Date</code> type with a number. Instead of <code>toDate('2018-12-18') = 17883</code>, you must use explicit type conversion <code>= toDate(17883)</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/3687 rel="external nofollow noreferrer">#3687</a></li> </ul> <h2 id=clickhouse-release-18-14-19-2018-12-19>ClickHouse release 18.14.19, 2018-12-19<a class=headerlink href=#clickhouse-release-18-14-19-2018-12-19 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_24>Bug fixes:<a class=headerlink href=#bug-fixes_24 title="Permanent link">&para;</a></h3> <ul> <li>Fixed an error that led to problems with updating dictionaries with the ODBC source. <a href=https://github.com/ClickHouse/ClickHouse/issues/3825 rel="external nofollow noreferrer">#3825</a>, <a href=https://github.com/ClickHouse/ClickHouse/issues/3829 rel="external nofollow noreferrer">#3829</a></li> <li>Databases are correctly specified when executing DDL <code>ON CLUSTER</code> queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3460 rel="external nofollow noreferrer">#3460</a></li> <li>Fixed a segfault if the <code>max_temporary_non_const_columns</code> limit was exceeded. <a href=https://github.com/ClickHouse/ClickHouse/pull/3788 rel="external nofollow noreferrer">#3788</a></li> </ul> <h3 id=build-improvements_2>Build improvements:<a class=headerlink href=#build-improvements_2 title="Permanent link">&para;</a></h3> <ul> <li>Fixes for builds on ARM.</li> </ul> <h2 id=clickhouse-release-18-14-18-2018-12-04>ClickHouse release 18.14.18, 2018-12-04<a class=headerlink href=#clickhouse-release-18-14-18-2018-12-04 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_25>Bug fixes:<a class=headerlink href=#bug-fixes_25 title="Permanent link">&para;</a></h3> <ul> <li>Fixed error in <code>dictGet...</code> function for dictionaries of type <code>range</code>, if one of the arguments is constant and other is not. <a href=https://github.com/ClickHouse/ClickHouse/pull/3751 rel="external nofollow noreferrer">#3751</a></li> <li>Fixed error that caused messages <code>netlink: '...': attribute type 1 has an invalid length</code> to be printed in Linux kernel log, that was happening only on fresh enough versions of Linux kernel. <a href=https://github.com/ClickHouse/ClickHouse/pull/3749 rel="external nofollow noreferrer">#3749</a></li> <li>Fixed segfault in function <code>empty</code> for argument of <code>FixedString</code> type. <a href=https://github.com/ClickHouse/ClickHouse/pull/3703 rel="external nofollow noreferrer">Daniel, Dao Quang Minh</a></li> <li>Fixed excessive memory allocation when using large value of <code>max_query_size</code> setting (a memory chunk of <code>max_query_size</code> bytes was preallocated at once). <a href=https://github.com/ClickHouse/ClickHouse/pull/3720 rel="external nofollow noreferrer">#3720</a></li> </ul> <h3 id=build-changes>Build changes:<a class=headerlink href=#build-changes title="Permanent link">&para;</a></h3> <ul> <li>Fixed build with LLVM/Clang libraries of version 7 from the OS packages (these libraries are used for runtime query compilation). <a href=https://github.com/ClickHouse/ClickHouse/pull/3582 rel="external nofollow noreferrer">#3582</a></li> </ul> <h2 id=clickhouse-release-18-14-17-2018-11-30>ClickHouse release 18.14.17, 2018-11-30<a class=headerlink href=#clickhouse-release-18-14-17-2018-11-30 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_26>Bug fixes:<a class=headerlink href=#bug-fixes_26 title="Permanent link">&para;</a></h3> <ul> <li>Fixed cases when the ODBC bridge process did not terminate with the main server process. <a href=https://github.com/ClickHouse/ClickHouse/pull/3642 rel="external nofollow noreferrer">#3642</a></li> <li>Fixed synchronous insertion into the <code>Distributed</code> table with a columns list that differs from the column list of the remote table. <a href=https://github.com/ClickHouse/ClickHouse/pull/3673 rel="external nofollow noreferrer">#3673</a></li> <li>Fixed a rare race condition that can lead to a crash when dropping a MergeTree table. <a href=https://github.com/ClickHouse/ClickHouse/pull/3643 rel="external nofollow noreferrer">#3643</a></li> <li>Fixed a query deadlock in case when query thread creation fails with the <code>Resource temporarily unavailable</code> error. <a href=https://github.com/ClickHouse/ClickHouse/pull/3643 rel="external nofollow noreferrer">#3643</a></li> <li>Fixed parsing of the <code>ENGINE</code> clause when the <code>CREATE AS table</code> syntax was used and the <code>ENGINE</code> clause was specified before the <code>AS table</code> (the error resulted in ignoring the specified engine). <a href=https://github.com/ClickHouse/ClickHouse/pull/3692 rel="external nofollow noreferrer">#3692</a></li> </ul> <h2 id=clickhouse-release-18-14-15-2018-11-21>ClickHouse release 18.14.15, 2018-11-21<a class=headerlink href=#clickhouse-release-18-14-15-2018-11-21 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_27>Bug fixes:<a class=headerlink href=#bug-fixes_27 title="Permanent link">&para;</a></h3> <ul> <li>The size of memory chunk was overestimated while deserializing the column of type <code>Array(String)</code> that leads to "Memory limit exceeded" errors. The issue appeared in version 18.12.13. <a href=https://github.com/ClickHouse/ClickHouse/issues/3589 rel="external nofollow noreferrer">#3589</a></li> </ul> <h2 id=clickhouse-release-18-14-14-2018-11-20>ClickHouse release 18.14.14, 2018-11-20<a class=headerlink href=#clickhouse-release-18-14-14-2018-11-20 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_28>Bug fixes:<a class=headerlink href=#bug-fixes_28 title="Permanent link">&para;</a></h3> <ul> <li>Fixed <code>ON CLUSTER</code> queries when cluster configured as secure (flag <code>&lt;secure&gt;</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/3599 rel="external nofollow noreferrer">#3599</a></li> </ul> <h3 id=build-changes_1>Build changes:<a class=headerlink href=#build-changes_1 title="Permanent link">&para;</a></h3> <ul> <li>Fixed problems (llvm-7 from system, macos) <a href=https://github.com/ClickHouse/ClickHouse/pull/3582 rel="external nofollow noreferrer">#3582</a></li> </ul> <h2 id=clickhouse-release-18-14-13-2018-11-08>ClickHouse release 18.14.13, 2018-11-08<a class=headerlink href=#clickhouse-release-18-14-13-2018-11-08 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_29>Bug fixes:<a class=headerlink href=#bug-fixes_29 title="Permanent link">&para;</a></h3> <ul> <li>Fixed the <code>Block structure mismatch in MergingSorted stream</code> error. <a href=https://github.com/ClickHouse/ClickHouse/issues/3162 rel="external nofollow noreferrer">#3162</a></li> <li>Fixed <code>ON CLUSTER</code> queries in case when secure connections were turned on in the cluster config (the <code>&lt;secure&gt;</code> flag). <a href=https://github.com/ClickHouse/ClickHouse/pull/3465 rel="external nofollow noreferrer">#3465</a></li> <li>Fixed an error in queries that used <code>SAMPLE</code>, <code>PREWHERE</code> and alias columns. <a href=https://github.com/ClickHouse/ClickHouse/pull/3543 rel="external nofollow noreferrer">#3543</a></li> <li>Fixed a rare <code>unknown compression method</code> error when the <code>min_bytes_to_use_direct_io</code> setting was enabled. <a href=https://github.com/ClickHouse/ClickHouse/pull/3544 rel="external nofollow noreferrer">3544</a></li> </ul> <h3 id=performance-improvements_6>Performance improvements:<a class=headerlink href=#performance-improvements_6 title="Permanent link">&para;</a></h3> <ul> <li>Fixed performance regression of queries with <code>GROUP BY</code> of columns of UInt16 or Date type when executing on AMD EPYC processors. <a href=https://github.com/ClickHouse/ClickHouse/pull/3512 rel="external nofollow noreferrer">Igor Lapko</a></li> <li>Fixed performance regression of queries that process long strings. <a href=https://github.com/ClickHouse/ClickHouse/pull/3530 rel="external nofollow noreferrer">#3530</a></li> </ul> <h3 id=build-improvements_3>Build improvements:<a class=headerlink href=#build-improvements_3 title="Permanent link">&para;</a></h3> <ul> <li>Improvements for simplifying the Arcadia build. <a href=https://github.com/ClickHouse/ClickHouse/pull/3475 rel="external nofollow noreferrer">#3475</a>, <a href=https://github.com/ClickHouse/ClickHouse/pull/3535 rel="external nofollow noreferrer">#3535</a></li> </ul> <h2 id=clickhouse-release-18-14-12-2018-11-02>ClickHouse release 18.14.12, 2018-11-02<a class=headerlink href=#clickhouse-release-18-14-12-2018-11-02 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_30>Bug fixes:<a class=headerlink href=#bug-fixes_30 title="Permanent link">&para;</a></h3> <ul> <li>Fixed a crash on joining two unnamed subqueries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3505 rel="external nofollow noreferrer">#3505</a></li> <li>Fixed generating incorrect queries (with an empty <code>WHERE</code> clause) when querying external databases. <a href=https://github.com/ClickHouse/ClickHouse/pull/3477 rel="external nofollow noreferrer">hotid</a></li> <li>Fixed using an incorrect timeout value in ODBC dictionaries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3511 rel="external nofollow noreferrer">Marek Vavruša</a></li> </ul> <h2 id=clickhouse-release-18-14-11-2018-10-29>ClickHouse release 18.14.11, 2018-10-29<a class=headerlink href=#clickhouse-release-18-14-11-2018-10-29 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_31>Bug fixes:<a class=headerlink href=#bug-fixes_31 title="Permanent link">&para;</a></h3> <ul> <li>Fixed the error <code>Block structure mismatch in UNION stream: different number of columns</code> in LIMIT queries. <a href=https://github.com/ClickHouse/ClickHouse/issues/2156 rel="external nofollow noreferrer">#2156</a></li> <li>Fixed errors when merging data in tables containing arrays inside Nested structures. <a href=https://github.com/ClickHouse/ClickHouse/pull/3397 rel="external nofollow noreferrer">#3397</a></li> <li>Fixed incorrect query results if the <code>merge_tree_uniform_read_distribution</code> setting is disabled (it is enabled by default). <a href=https://github.com/ClickHouse/ClickHouse/pull/3429 rel="external nofollow noreferrer">#3429</a></li> <li>Fixed an error on inserts to a Distributed table in Native format. <a href=https://github.com/ClickHouse/ClickHouse/issues/3411 rel="external nofollow noreferrer">#3411</a></li> </ul> <h2 id=clickhouse-release-18-14-10-2018-10-23>ClickHouse release 18.14.10, 2018-10-23<a class=headerlink href=#clickhouse-release-18-14-10-2018-10-23 title="Permanent link">&para;</a></h2> <ul> <li>The <code>compile_expressions</code> setting (JIT compilation of expressions) is disabled by default. <a href=https://github.com/ClickHouse/ClickHouse/pull/3410 rel="external nofollow noreferrer">#3410</a></li> <li>The <code>enable_optimize_predicate_expression</code> setting is disabled by default.</li> </ul> <h2 id=clickhouse-release-18-14-9-2018-10-16>ClickHouse release 18.14.9, 2018-10-16<a class=headerlink href=#clickhouse-release-18-14-9-2018-10-16 title="Permanent link">&para;</a></h2> <h3 id=new-features_9>New features:<a class=headerlink href=#new-features_9 title="Permanent link">&para;</a></h3> <ul> <li>The <code>WITH CUBE</code> modifier for <code>GROUP BY</code> (the alternative syntax <code>GROUP BY CUBE(...)</code> is also available). <a href=https://github.com/ClickHouse/ClickHouse/pull/3172 rel="external nofollow noreferrer">#3172</a></li> <li>Added the <code>formatDateTime</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/2770 rel="external nofollow noreferrer">Alexandr Krasheninnikov</a></li> <li>Added the <code>JDBC</code> table engine and <code>jdbc</code> table function (requires installing clickhouse-jdbc-bridge). <a href=https://github.com/ClickHouse/ClickHouse/pull/3210 rel="external nofollow noreferrer">Alexandr Krasheninnikov</a></li> <li>Added functions for working with the ISO week number: <code>toISOWeek</code>, <code>toISOYear</code>, <code>toStartOfISOYear</code>, and <code>toDayOfYear</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3146 rel="external nofollow noreferrer">#3146</a></li> <li>Now you can use <code>Nullable</code> columns for <code>MySQL</code> and <code>ODBC</code> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/3362 rel="external nofollow noreferrer">#3362</a></li> <li>Nested data structures can be read as nested objects in <code>JSONEachRow</code> format. Added the <code>input_format_import_nested_json</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/3144 rel="external nofollow noreferrer">Veloman Yunkan</a></li> <li>Parallel processing is available for many <code>MATERIALIZED VIEW</code>s when inserting data. See the <code>parallel_view_processing</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/3208 rel="external nofollow noreferrer">Marek Vavruša</a></li> <li>Added the <code>SYSTEM FLUSH LOGS</code> query (forced log flushes to system tables such as <code>query_log</code>) <a href=https://github.com/ClickHouse/ClickHouse/pull/3321 rel="external nofollow noreferrer">#3321</a></li> <li>Now you can use pre-defined <code>database</code> and <code>table</code> macros when declaring <code>Replicated</code> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/3251 rel="external nofollow noreferrer">#3251</a></li> <li>Added the ability to read <code>Decimal</code> type values in engineering notation (indicating powers of ten). <a href=https://github.com/ClickHouse/ClickHouse/pull/3153 rel="external nofollow noreferrer">#3153</a></li> </ul> <h3 id=experimental-features_4>Experimental features:<a class=headerlink href=#experimental-features_4 title="Permanent link">&para;</a></h3> <ul> <li>Optimization of the GROUP BY clause for <code>LowCardinality data types.</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/3138 rel="external nofollow noreferrer">#3138</a></li> <li>Optimized calculation of expressions for <code>LowCardinality data types.</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/3200 rel="external nofollow noreferrer">#3200</a></li> </ul> <h3 id=improvements_9>Improvements:<a class=headerlink href=#improvements_9 title="Permanent link">&para;</a></h3> <ul> <li>Significantly reduced memory consumption for queries with <code>ORDER BY</code> and <code>LIMIT</code>. See the <code>max_bytes_before_remerge_sort</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/3205 rel="external nofollow noreferrer">#3205</a></li> <li>In the absence of <code>JOIN</code> (<code>LEFT</code>, <code>INNER</code>, ...), <code>INNER JOIN</code> is assumed. <a href=https://github.com/ClickHouse/ClickHouse/pull/3147 rel="external nofollow noreferrer">#3147</a></li> <li>Qualified asterisks work correctly in queries with <code>JOIN</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3202 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>The <code>ODBC</code> table engine correctly chooses the method for quoting identifiers in the SQL dialect of a remote database. <a href=https://github.com/ClickHouse/ClickHouse/pull/3210 rel="external nofollow noreferrer">Alexandr Krasheninnikov</a></li> <li>The <code>compile_expressions</code> setting (JIT compilation of expressions) is enabled by default.</li> <li>Fixed behavior for simultaneous DROP DATABASE/TABLE IF EXISTS and CREATE DATABASE/TABLE IF NOT EXISTS. Previously, a <code>CREATE DATABASE ... IF NOT EXISTS</code> query could return the error message "File ... already exists", and the <code>CREATE TABLE ... IF NOT EXISTS</code> and <code>DROP TABLE IF EXISTS</code> queries could return <code>Table ... is creating or attaching right now</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3101 rel="external nofollow noreferrer">#3101</a></li> <li>LIKE and IN expressions with a constant right half are passed to the remote server when querying from MySQL or ODBC tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/3182 rel="external nofollow noreferrer">#3182</a></li> <li>Comparisons with constant expressions in a WHERE clause are passed to the remote server when querying from MySQL and ODBC tables. Previously, only comparisons with constants were passed. <a href=https://github.com/ClickHouse/ClickHouse/pull/3182 rel="external nofollow noreferrer">#3182</a></li> <li>Correct calculation of row width in the terminal for <code>Pretty</code> formats, including strings with hieroglyphs. <a href=https://github.com/ClickHouse/ClickHouse/pull/3257 rel="external nofollow noreferrer">Amos Bird</a>.</li> <li><code>ON CLUSTER</code> can be specified for <code>ALTER UPDATE</code> queries.</li> <li>Improved performance for reading data in <code>JSONEachRow</code> format. <a href=https://github.com/ClickHouse/ClickHouse/pull/3332 rel="external nofollow noreferrer">#3332</a></li> <li>Added synonyms for the <code>LENGTH</code> and <code>CHARACTER_LENGTH</code> functions for compatibility. The <code>CONCAT</code> function is no longer case-sensitive. <a href=https://github.com/ClickHouse/ClickHouse/pull/3306 rel="external nofollow noreferrer">#3306</a></li> <li>Added the <code>TIMESTAMP</code> synonym for the <code>DateTime</code> type. <a href=https://github.com/ClickHouse/ClickHouse/pull/3390 rel="external nofollow noreferrer">#3390</a></li> <li>There is always space reserved for query_id in the server logs, even if the log line is not related to a query. This makes it easier to parse server text logs with third-party tools.</li> <li>Memory consumption by a query is logged when it exceeds the next level of an integer number of gigabytes. <a href=https://github.com/ClickHouse/ClickHouse/pull/3205 rel="external nofollow noreferrer">#3205</a></li> <li>Added compatibility mode for the case when the client library that uses the Native protocol sends fewer columns by mistake than the server expects for the INSERT query. This scenario was possible when using the clickhouse-cpp library. Previously, this scenario caused the server to crash. <a href=https://github.com/ClickHouse/ClickHouse/pull/3171 rel="external nofollow noreferrer">#3171</a></li> <li>In a user-defined WHERE expression in <code>clickhouse-copier</code>, you can now use a <code>partition_key</code> alias (for additional filtering by source table partition). This is useful if the partitioning scheme changes during copying, but only changes slightly. <a href=https://github.com/ClickHouse/ClickHouse/pull/3166 rel="external nofollow noreferrer">#3166</a></li> <li>The workflow of the <code>Kafka</code> engine has been moved to a background thread pool in order to automatically reduce the speed of data reading at high loads. <a href=https://github.com/ClickHouse/ClickHouse/pull/3215 rel="external nofollow noreferrer">Marek Vavruša</a>.</li> <li>Support for reading <code>Tuple</code> and <code>Nested</code> values of structures like <code>struct</code> in the <code>Cap'n'Proto format</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3216 rel="external nofollow noreferrer">Marek Vavruša</a></li> <li>The list of top-level domains for the <code>firstSignificantSubdomain</code> function now includes the domain <code>biz</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3219 rel="external nofollow noreferrer">decaseal</a></li> <li>In the configuration of external dictionaries, <code>null_value</code> is interpreted as the value of the default data type. <a href=https://github.com/ClickHouse/ClickHouse/pull/3330 rel="external nofollow noreferrer">#3330</a></li> <li>Support for the <code>intDiv</code> and <code>intDivOrZero</code> functions for <code>Decimal</code>. <a href=https://github.com/ClickHouse/ClickHouse/commit/b48402e8712e2b9b151e0eef8193811d433a1264 rel="external nofollow noreferrer">b48402e8</a></li> <li>Support for the <code>Date</code>, <code>DateTime</code>, <code>UUID</code>, and <code>Decimal</code> types as a key for the <code>sumMap</code> aggregate function. <a href=https://github.com/ClickHouse/ClickHouse/pull/3281 rel="external nofollow noreferrer">#3281</a></li> <li>Support for the <code>Decimal</code> data type in external dictionaries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3324 rel="external nofollow noreferrer">#3324</a></li> <li>Support for the <code>Decimal</code> data type in <code>SummingMergeTree</code> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/3348 rel="external nofollow noreferrer">#3348</a></li> <li>Added specializations for <code>UUID</code> in <code>if</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3366 rel="external nofollow noreferrer">#3366</a></li> <li>Reduced the number of <code>open</code> and <code>close</code> system calls when reading from a <code>MergeTree table</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3283 rel="external nofollow noreferrer">#3283</a></li> <li>A <code>TRUNCATE TABLE</code> query can be executed on any replica (the query is passed to the leader replica). <a href=https://github.com/ClickHouse/ClickHouse/pull/3375 rel="external nofollow noreferrer">Kirill Shvakov</a></li> </ul> <h3 id=bug-fixes_32>Bug fixes:<a class=headerlink href=#bug-fixes_32 title="Permanent link">&para;</a></h3> <ul> <li>Fixed an issue with <code>Dictionary</code> tables for <code>range_hashed</code> dictionaries. This error occurred in version 18.12.17. <a href=https://github.com/ClickHouse/ClickHouse/pull/1702 rel="external nofollow noreferrer">#1702</a></li> <li>Fixed an error when loading <code>range_hashed</code> dictionaries (the message <code>Unsupported type Nullable (...)</code>). This error occurred in version 18.12.17. <a href=https://github.com/ClickHouse/ClickHouse/pull/3362 rel="external nofollow noreferrer">#3362</a></li> <li>Fixed errors in the <code>pointInPolygon</code> function due to the accumulation of inaccurate calculations for polygons with a large number of vertices located close to each other. <a href=https://github.com/ClickHouse/ClickHouse/pull/3331 rel="external nofollow noreferrer">#3331</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3341 rel="external nofollow noreferrer">#3341</a></li> <li>If after merging data parts, the checksum for the resulting part differs from the result of the same merge in another replica, the result of the merge is deleted and the data part is downloaded from the other replica (this is the correct behavior). But after downloading the data part, it couldn't be added to the working set because of an error that the part already exists (because the data part was deleted with some delay after the merge). This led to cyclical attempts to download the same data. <a href=https://github.com/ClickHouse/ClickHouse/pull/3194 rel="external nofollow noreferrer">#3194</a></li> <li>Fixed incorrect calculation of total memory consumption by queries (because of incorrect calculation, the <code>max_memory_usage_for_all_queries</code> setting worked incorrectly and the <code>MemoryTracking</code> metric had an incorrect value). This error occurred in version 18.12.13. <a href=https://github.com/ClickHouse/ClickHouse/pull/3344 rel="external nofollow noreferrer">Marek Vavruša</a></li> <li>Fixed the functionality of <code>CREATE TABLE ... ON CLUSTER ... AS SELECT ...</code> This error occurred in version 18.12.13. <a href=https://github.com/ClickHouse/ClickHouse/pull/3247 rel="external nofollow noreferrer">#3247</a></li> <li>Fixed unnecessary preparation of data structures for <code>JOIN</code>s on the server that initiates the query if the <code>JOIN</code> is only performed on remote servers. <a href=https://github.com/ClickHouse/ClickHouse/pull/3340 rel="external nofollow noreferrer">#3340</a></li> <li>Fixed bugs in the <code>Kafka</code> engine: deadlocks after exceptions when starting to read data, and locks upon completion <a href=https://github.com/ClickHouse/ClickHouse/pull/3215 rel="external nofollow noreferrer">Marek Vavruša</a>.</li> <li>For <code>Kafka</code> tables, the optional <code>schema</code> parameter was not passed (the schema of the <code>Cap'n'Proto</code> format). <a href=https://github.com/ClickHouse/ClickHouse/pull/3150 rel="external nofollow noreferrer">Vojtech Splichal</a></li> <li>If the ensemble of ZooKeeper servers has servers that accept the connection but then immediately close it instead of responding to the handshake, ClickHouse chooses to connect another server. Previously, this produced the error <code>Cannot read all data. Bytes read: 0. Bytes expected: 4.</code> and the server couldn't start. <a href=https://github.com/ClickHouse/ClickHouse/commit/8218cf3a5f39a43401953769d6d12a0bb8d29da9 rel="external nofollow noreferrer">8218cf3a</a></li> <li>If the ensemble of ZooKeeper servers contains servers for which the DNS query returns an error, these servers are ignored. <a href=https://github.com/ClickHouse/ClickHouse/commit/17b8e209221061325ad7ba0539f03c6e65f87f29 rel="external nofollow noreferrer">17b8e209</a></li> <li>Fixed type conversion between <code>Date</code> and <code>DateTime</code> when inserting data in the <code>VALUES</code> format (if <code>input_format_values_interpret_expressions = 1</code>). Previously, the conversion was performed between the numerical value of the number of days in Unix Epoch time and the Unix timestamp, which led to unexpected results. <a href=https://github.com/ClickHouse/ClickHouse/pull/3229 rel="external nofollow noreferrer">#3229</a></li> <li>Corrected type conversion between <code>Decimal</code> and integer numbers. <a href=https://github.com/ClickHouse/ClickHouse/pull/3211 rel="external nofollow noreferrer">#3211</a></li> <li>Fixed errors in the <code>enable_optimize_predicate_expression</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/3231 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Fixed a parsing error in CSV format with floating-point numbers if a non-default CSV separator is used, such as <code>;</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/3155 rel="external nofollow noreferrer">#3155</a></li> <li>Fixed the <code>arrayCumSumNonNegative</code> function (it does not accumulate negative values if the accumulator is less than zero). <a href=https://github.com/ClickHouse/ClickHouse/pull/3163 rel="external nofollow noreferrer">Aleksey Studnev</a></li> <li>Fixed how <code>Merge</code> tables work on top of <code>Distributed</code> tables when using <code>PREWHERE</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3165 rel="external nofollow noreferrer">#3165</a></li> <li>Bug fixes in the <code>ALTER UPDATE</code> query.</li> <li>Fixed bugs in the <code>odbc</code> table function that appeared in version 18.12. <a href=https://github.com/ClickHouse/ClickHouse/pull/3197 rel="external nofollow noreferrer">#3197</a></li> <li>Fixed the operation of aggregate functions with <code>StateArray</code> combinators. <a href=https://github.com/ClickHouse/ClickHouse/pull/3188 rel="external nofollow noreferrer">#3188</a></li> <li>Fixed a crash when dividing a <code>Decimal</code> value by zero. <a href=https://github.com/ClickHouse/ClickHouse/commit/69dd6609193beb4e7acd3e6ad216eca0ccfb8179 rel="external nofollow noreferrer">69dd6609</a></li> <li>Fixed output of types for operations using <code>Decimal</code> and integer arguments. <a href=https://github.com/ClickHouse/ClickHouse/pull/3224 rel="external nofollow noreferrer">#3224</a></li> <li>Fixed the segfault during <code>GROUP BY</code> on <code>Decimal128</code>. <a href=https://github.com/ClickHouse/ClickHouse/commit/3359ba06c39fcd05bfdb87d6c64154819621e13a rel="external nofollow noreferrer">3359ba06</a></li> <li>The <code>log_query_threads</code> setting (logging information about each thread of query execution) now takes effect only if the <code>log_queries</code> option (logging information about queries) is set to 1. Since the <code>log_query_threads</code> option is enabled by default, information about threads was previously logged even if query logging was disabled. <a href=https://github.com/ClickHouse/ClickHouse/pull/3241 rel="external nofollow noreferrer">#3241</a></li> <li>Fixed an error in the distributed operation of the quantiles aggregate function (the error message <code>Not found column quantile...</code>). <a href=https://github.com/ClickHouse/ClickHouse/commit/292a885533b8e3b41ce8993867069d14cbd5a664 rel="external nofollow noreferrer">292a8855</a></li> <li>Fixed the compatibility problem when working on a cluster of version 18.12.17 servers and older servers at the same time. For distributed queries with GROUP BY keys of both fixed and non-fixed length, if there was a large amount of data to aggregate, the returned data was not always fully aggregated (two different rows contained the same aggregation keys). <a href=https://github.com/ClickHouse/ClickHouse/pull/3254 rel="external nofollow noreferrer">#3254</a></li> <li>Fixed handling of substitutions in <code>clickhouse-performance-test</code>, if the query contains only part of the substitutions declared in the test. <a href=https://github.com/ClickHouse/ClickHouse/pull/3263 rel="external nofollow noreferrer">#3263</a></li> <li>Fixed an error when using <code>FINAL</code> with <code>PREWHERE</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3298 rel="external nofollow noreferrer">#3298</a></li> <li>Fixed an error when using <code>PREWHERE</code> over columns that were added during <code>ALTER</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3298 rel="external nofollow noreferrer">#3298</a></li> <li>Added a check for the absence of <code>arrayJoin</code> for <code>DEFAULT</code> and <code>MATERIALIZED</code> expressions. Previously, <code>arrayJoin</code> led to an error when inserting data. <a href=https://github.com/ClickHouse/ClickHouse/pull/3337 rel="external nofollow noreferrer">#3337</a></li> <li>Added a check for the absence of <code>arrayJoin</code> in a <code>PREWHERE</code> clause. Previously, this led to messages like <code>Size ... doesn't match</code> or <code>Unknown compression method</code> when executing queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3357 rel="external nofollow noreferrer">#3357</a></li> <li>Fixed segfault that could occur in rare cases after optimization that replaced AND chains from equality evaluations with the corresponding IN expression. <a href=https://github.com/ClickHouse/ClickHouse/pull/3339 rel="external nofollow noreferrer">liuyimin-bytedance</a></li> <li>Minor corrections to <code>clickhouse-benchmark</code>: previously, client information was not sent to the server; now the number of queries executed is calculated more accurately when shutting down and for limiting the number of iterations. <a href=https://github.com/ClickHouse/ClickHouse/pull/3351 rel="external nofollow noreferrer">#3351</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3352 rel="external nofollow noreferrer">#3352</a></li> </ul> <h3 id=backward-incompatible-changes_4>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_4 title="Permanent link">&para;</a></h3> <ul> <li>Removed the <code>allow_experimental_decimal_type</code> option. The <code>Decimal</code> data type is available for default use. <a href=https://github.com/ClickHouse/ClickHouse/pull/3329 rel="external nofollow noreferrer">#3329</a></li> </ul> <h2 id=clickhouse-release-18-12-17-2018-09-16>ClickHouse release 18.12.17, 2018-09-16<a class=headerlink href=#clickhouse-release-18-12-17-2018-09-16 title="Permanent link">&para;</a></h2> <h3 id=new-features_10>New features:<a class=headerlink href=#new-features_10 title="Permanent link">&para;</a></h3> <ul> <li><code>invalidate_query</code> (the ability to specify a query to check whether an external dictionary needs to be updated) is implemented for the <code>clickhouse</code> source. <a href=https://github.com/ClickHouse/ClickHouse/pull/3126 rel="external nofollow noreferrer">#3126</a></li> <li>Added the ability to use <code>UInt*</code>, <code>Int*</code>, and <code>DateTime</code> data types (along with the <code>Date</code> type) as a <code>range_hashed</code> external dictionary key that defines the boundaries of ranges. Now <code>NULL</code> can be used to designate an open range. <a href=https://github.com/ClickHouse/ClickHouse/pull/3123 rel="external nofollow noreferrer">Vasily Nemkov</a></li> <li>The <code>Decimal</code> type now supports <code>var*</code> and <code>stddev*</code> aggregate functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/3129 rel="external nofollow noreferrer">#3129</a></li> <li>The <code>Decimal</code> type now supports mathematical functions (<code>exp</code>, <code>sin</code> and so on.) <a href=https://github.com/ClickHouse/ClickHouse/pull/3129 rel="external nofollow noreferrer">#3129</a></li> <li>The <code>system.part_log</code> table now has the <code>partition_id</code> column. <a href=https://github.com/ClickHouse/ClickHouse/pull/3089 rel="external nofollow noreferrer">#3089</a></li> </ul> <h3 id=bug-fixes_33>Bug fixes:<a class=headerlink href=#bug-fixes_33 title="Permanent link">&para;</a></h3> <ul> <li><code>Merge</code> now works correctly on <code>Distributed</code> tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/3159 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Fixed incompatibility (unnecessary dependency on the <code>glibc</code> version) that made it impossible to run ClickHouse on <code>Ubuntu Precise</code> and older versions. The incompatibility arose in version 18.12.13. <a href=https://github.com/ClickHouse/ClickHouse/pull/3130 rel="external nofollow noreferrer">#3130</a></li> <li>Fixed errors in the <code>enable_optimize_predicate_expression</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/3107 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Fixed a minor issue with backwards compatibility that appeared when working with a cluster of replicas on versions earlier than 18.12.13 and simultaneously creating a new replica of a table on a server with a newer version (shown in the message <code>Can not clone replica, because the ... updated to new ClickHouse version</code>, which is logical, but shouldn't happen). <a href=https://github.com/ClickHouse/ClickHouse/pull/3122 rel="external nofollow noreferrer">#3122</a></li> </ul> <h3 id=backward-incompatible-changes_5>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_5 title="Permanent link">&para;</a></h3> <ul> <li>The <code>enable_optimize_predicate_expression</code> option is enabled by default (which is rather optimistic). If query analysis errors occur that are related to searching for the column names, set <code>enable_optimize_predicate_expression</code> to 0. <a href=https://github.com/ClickHouse/ClickHouse/pull/3107 rel="external nofollow noreferrer">Winter Zhang</a></li> </ul> <h2 id=clickhouse-release-18-12-14-2018-09-13>ClickHouse release 18.12.14, 2018-09-13<a class=headerlink href=#clickhouse-release-18-12-14-2018-09-13 title="Permanent link">&para;</a></h2> <h3 id=new-features_11>New features:<a class=headerlink href=#new-features_11 title="Permanent link">&para;</a></h3> <ul> <li>Added support for <code>ALTER UPDATE</code> queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3035 rel="external nofollow noreferrer">#3035</a></li> <li>Added the <code>allow_ddl</code> option, which restricts the user's access to DDL queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3104 rel="external nofollow noreferrer">#3104</a></li> <li>Added the <code>min_merge_bytes_to_use_direct_io</code> option for <code>MergeTree</code> engines, which allows you to set a threshold for the total size of the merge (when above the threshold, data part files will be handled using O_DIRECT). <a href=https://github.com/ClickHouse/ClickHouse/pull/3117 rel="external nofollow noreferrer">#3117</a></li> <li>The <code>system.merges</code> system table now contains the <code>partition_id</code> column. <a href=https://github.com/ClickHouse/ClickHouse/pull/3099 rel="external nofollow noreferrer">#3099</a></li> </ul> <h3 id=improvements_10>Improvements<a class=headerlink href=#improvements_10 title="Permanent link">&para;</a></h3> <ul> <li>If a data part remains unchanged during mutation, it isn't downloaded by replicas. <a href=https://github.com/ClickHouse/ClickHouse/pull/3103 rel="external nofollow noreferrer">#3103</a></li> <li>Autocomplete is available for names of settings when working with <code>clickhouse-client</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3106 rel="external nofollow noreferrer">#3106</a></li> </ul> <h3 id=bug-fixes_34>Bug fixes:<a class=headerlink href=#bug-fixes_34 title="Permanent link">&para;</a></h3> <ul> <li>Added a check for the sizes of arrays that are elements of <code>Nested</code> type fields when inserting. <a href=https://github.com/ClickHouse/ClickHouse/pull/3118 rel="external nofollow noreferrer">#3118</a></li> <li>Fixed an error updating external dictionaries with the <code>ODBC</code> source and <code>hashed</code> storage. This error occurred in version 18.12.13.</li> <li>Fixed a crash when creating a temporary table from a query with an <code>IN</code> condition. <a href=https://github.com/ClickHouse/ClickHouse/pull/3098 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Fixed an error in aggregate functions for arrays that can have <code>NULL</code> elements. <a href=https://github.com/ClickHouse/ClickHouse/pull/3097 rel="external nofollow noreferrer">Winter Zhang</a></li> </ul> <h2 id=clickhouse-release-18-12-13-2018-09-10>ClickHouse release 18.12.13, 2018-09-10<a class=headerlink href=#clickhouse-release-18-12-13-2018-09-10 title="Permanent link">&para;</a></h2> <h3 id=new-features_12>New features:<a class=headerlink href=#new-features_12 title="Permanent link">&para;</a></h3> <ul> <li>Added the <code>DECIMAL(digits, scale)</code> data type (<code>Decimal32(scale)</code>, <code>Decimal64(scale)</code>, <code>Decimal128(scale)</code>). To enable it, use the setting <code>allow_experimental_decimal_type</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2846 rel="external nofollow noreferrer">#2846</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2970 rel="external nofollow noreferrer">#2970</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3008 rel="external nofollow noreferrer">#3008</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3047 rel="external nofollow noreferrer">#3047</a></li> <li>New <code>WITH ROLLUP</code> modifier for <code>GROUP BY</code> (alternative syntax: <code>GROUP BY ROLLUP(...)</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/2948 rel="external nofollow noreferrer">#2948</a></li> <li>In queries with JOIN, the star character expands to a list of columns in all tables, in compliance with the SQL standard. You can restore the old behavior by setting <code>asterisk_left_columns_only</code> to 1 on the user configuration level. <a href=https://github.com/ClickHouse/ClickHouse/pull/2787 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Added support for JOIN with table functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/2907 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Autocomplete by pressing Tab in clickhouse-client. <a href=https://github.com/ClickHouse/ClickHouse/pull/2447 rel="external nofollow noreferrer">Sergey Shcherbin</a></li> <li>Ctrl+C in clickhouse-client clears a query that was entered. <a href=https://github.com/ClickHouse/ClickHouse/pull/2877 rel="external nofollow noreferrer">#2877</a></li> <li>Added the <code>join_default_strictness</code> setting (values: <code>"</code>, <code>'any'</code>, <code>'all'</code>). This allows you to not specify <code>ANY</code> or <code>ALL</code> for <code>JOIN</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2982 rel="external nofollow noreferrer">#2982</a></li> <li>Each line of the server log related to query processing shows the query ID. <a href=https://github.com/ClickHouse/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>Now you can get query execution logs in clickhouse-client (use the <code>send_logs_level</code> setting). With distributed query processing, logs are cascaded from all the servers. <a href=https://github.com/ClickHouse/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>The <code>system.query_log</code> and <code>system.processes</code> (<code>SHOW PROCESSLIST</code>) tables now have information about all changed settings when you run a query (the nested structure of the <code>Settings</code> data). Added the <code>log_query_settings</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>The <code>system.query_log</code> and <code>system.processes</code> tables now show information about the number of threads that are participating in query execution (see the <code>thread_numbers</code> column). <a href=https://github.com/ClickHouse/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>Added <code>ProfileEvents</code> counters that measure the time spent on reading and writing over the network and reading and writing to disk, the number of network errors, and the time spent waiting when network bandwidth is limited. <a href=https://github.com/ClickHouse/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>Added <code>ProfileEvents</code>counters that contain the system metrics from rusage (you can use them to get information about CPU usage in userspace and the kernel, page faults, and context switches), as well as taskstats metrics (use these to obtain information about I/O wait time, CPU wait time, and the amount of data read and recorded, both with and without page cache). <a href=https://github.com/ClickHouse/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>The <code>ProfileEvents</code> counters are applied globally and for each query, as well as for each query execution thread, which allows you to profile resource consumption by query in detail. <a href=https://github.com/ClickHouse/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>Added the <code>system.query_thread_log</code> table, which contains information about each query execution thread. Added the <code>log_query_threads</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/2482 rel="external nofollow noreferrer">#2482</a></li> <li>The <code>system.metrics</code> and <code>system.events</code> tables now have built-in documentation. <a href=https://github.com/ClickHouse/ClickHouse/pull/3016 rel="external nofollow noreferrer">#3016</a></li> <li>Added the <code>arrayEnumerateDense</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/2975 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Added the <code>arrayCumSumNonNegative</code> and <code>arrayDifference</code> functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/2942 rel="external nofollow noreferrer">Aleksey Studnev</a></li> <li>Added the <code>retention</code> aggregate function. <a href=https://github.com/ClickHouse/ClickHouse/pull/2887 rel="external nofollow noreferrer">Sundy Li</a></li> <li>Now you can add (merge) states of aggregate functions by using the plus operator, and multiply the states of aggregate functions by a nonnegative constant. <a href=https://github.com/ClickHouse/ClickHouse/pull/3062 rel="external nofollow noreferrer">#3062</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3034 rel="external nofollow noreferrer">#3034</a></li> <li>Tables in the MergeTree family now have the virtual column <code>_partition_id</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3089 rel="external nofollow noreferrer">#3089</a></li> </ul> <h3 id=experimental-features_5>Experimental features:<a class=headerlink href=#experimental-features_5 title="Permanent link">&para;</a></h3> <ul> <li>Added the <code>LowCardinality(T)</code> data type. This data type automatically creates a local dictionary of values and allows data processing without unpacking the dictionary. <a href=https://github.com/ClickHouse/ClickHouse/pull/2830 rel="external nofollow noreferrer">#2830</a></li> <li>Added a cache of JIT-compiled functions and a counter for the number of uses before compiling. To JIT compile expressions, enable the <code>compile_expressions</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/2990 rel="external nofollow noreferrer">#2990</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3077 rel="external nofollow noreferrer">#3077</a></li> </ul> <h3 id=improvements_11>Improvements:<a class=headerlink href=#improvements_11 title="Permanent link">&para;</a></h3> <ul> <li>Fixed the problem with unlimited accumulation of the replication log when there are abandoned replicas. Added an effective recovery mode for replicas with a long lag.</li> <li>Improved performance of <code>GROUP BY</code> with multiple aggregation fields when one of them is string and the others are fixed length.</li> <li>Improved performance when using <code>PREWHERE</code> and with implicit transfer of expressions in <code>PREWHERE</code>.</li> <li>Improved parsing performance for text formats (<code>CSV</code>, <code>TSV</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/2977 rel="external nofollow noreferrer">Amos Bird</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2980 rel="external nofollow noreferrer">#2980</a></li> <li>Improved performance of reading strings and arrays in binary formats. <a href=https://github.com/ClickHouse/ClickHouse/pull/2955 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Increased performance and reduced memory consumption for queries to <code>system.tables</code> and <code>system.columns</code> when there is a very large number of tables on a single server. <a href=https://github.com/ClickHouse/ClickHouse/pull/2953 rel="external nofollow noreferrer">#2953</a></li> <li>Fixed a performance problem in the case of a large stream of queries that result in an error (the <code>_dl_addr</code> function is visible in <code>perf top</code>, but the server isn't using much CPU). <a href=https://github.com/ClickHouse/ClickHouse/pull/2938 rel="external nofollow noreferrer">#2938</a></li> <li>Conditions are cast into the View (when <code>enable_optimize_predicate_expression</code> is enabled). <a href=https://github.com/ClickHouse/ClickHouse/pull/2907 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Improvements to the functionality for the <code>UUID</code> data type. <a href=https://github.com/ClickHouse/ClickHouse/pull/3074 rel="external nofollow noreferrer">#3074</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2985 rel="external nofollow noreferrer">#2985</a></li> <li>The <code>UUID</code> data type is supported in The-Alchemist dictionaries. <a href=https://github.com/ClickHouse/ClickHouse/pull/2822 rel="external nofollow noreferrer">#2822</a></li> <li>The <code>visitParamExtractRaw</code> function works correctly with nested structures. <a href=https://github.com/ClickHouse/ClickHouse/pull/2974 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>When the <code>input_format_skip_unknown_fields</code> setting is enabled, object fields in <code>JSONEachRow</code> format are skipped correctly. <a href=https://github.com/ClickHouse/ClickHouse/pull/2958 rel="external nofollow noreferrer">BlahGeek</a></li> <li>For a <code>CASE</code> expression with conditions, you can now omit <code>ELSE</code>, which is equivalent to <code>ELSE NULL</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2920 rel="external nofollow noreferrer">#2920</a></li> <li>The operation timeout can now be configured when working with ZooKeeper. <a href=https://github.com/ClickHouse/ClickHouse/pull/2971 rel="external nofollow noreferrer">urykhy</a></li> <li>You can specify an offset for <code>LIMIT n, m</code> as <code>LIMIT n OFFSET m</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2840 rel="external nofollow noreferrer">#2840</a></li> <li>You can use the <code>SELECT TOP n</code> syntax as an alternative for <code>LIMIT</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2840 rel="external nofollow noreferrer">#2840</a></li> <li>Increased the size of the queue to write to system tables, so the <code>SystemLog parameter queue is full</code> error doesn't happen as often.</li> <li>The <code>windowFunnel</code> aggregate function now supports events that meet multiple conditions. <a href=https://github.com/ClickHouse/ClickHouse/pull/2801 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Duplicate columns can be used in a <code>USING</code> clause for <code>JOIN</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3006 rel="external nofollow noreferrer">#3006</a></li> <li><code>Pretty</code> formats now have a limit on column alignment by width. Use the <code>output_format_pretty_max_column_pad_width</code> setting. If a value is wider, it will still be displayed in its entirety, but the other cells in the table will not be too wide. <a href=https://github.com/ClickHouse/ClickHouse/pull/3003 rel="external nofollow noreferrer">#3003</a></li> <li>The <code>odbc</code> table function now allows you to specify the database/schema name. <a href=https://github.com/ClickHouse/ClickHouse/pull/2885 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Added the ability to use a username specified in the <code>clickhouse-client</code> config file. <a href=https://github.com/ClickHouse/ClickHouse/pull/2909 rel="external nofollow noreferrer">Vladimir Kozbin</a></li> <li>The <code>ZooKeeperExceptions</code> counter has been split into three counters: <code>ZooKeeperUserExceptions</code>, <code>ZooKeeperHardwareExceptions</code>, and <code>ZooKeeperOtherExceptions</code>.</li> <li><code>ALTER DELETE</code> queries work for materialized views.</li> <li>Added randomization when running the cleanup thread periodically for <code>ReplicatedMergeTree</code> tables in order to avoid periodic load spikes when there are a very large number of <code>ReplicatedMergeTree</code> tables.</li> <li>Support for <code>ATTACH TABLE ... ON CLUSTER</code> queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/3025 rel="external nofollow noreferrer">#3025</a></li> </ul> <h3 id=bug-fixes_35>Bug fixes:<a class=headerlink href=#bug-fixes_35 title="Permanent link">&para;</a></h3> <ul> <li>Fixed an issue with <code>Dictionary</code> tables (throws the <code>Size of offsets doesn't match size of column</code> or <code>Unknown compression method</code> exception). This bug appeared in version 18.10.3. <a href=https://github.com/ClickHouse/ClickHouse/issues/2913 rel="external nofollow noreferrer">#2913</a></li> <li>Fixed a bug when merging <code>CollapsingMergeTree</code> tables if one of the data parts is empty (these parts are formed during merge or <code>ALTER DELETE</code> if all data was deleted), and the <code>vertical</code> algorithm was used for the merge. <a href=https://github.com/ClickHouse/ClickHouse/pull/3049 rel="external nofollow noreferrer">#3049</a></li> <li>Fixed a race condition during <code>DROP</code> or <code>TRUNCATE</code> for <code>Memory</code> tables with a simultaneous <code>SELECT</code>, which could lead to server crashes. This bug appeared in version 1.1.54388. <a href=https://github.com/ClickHouse/ClickHouse/pull/3038 rel="external nofollow noreferrer">#3038</a></li> <li>Fixed the possibility of data loss when inserting in <code>Replicated</code> tables if the <code>Session is expired</code> error is returned (data loss can be detected by the <code>ReplicatedDataLoss</code> metric). This error occurred in version 1.1.54378. <a href=https://github.com/ClickHouse/ClickHouse/pull/2939 rel="external nofollow noreferrer">#2939</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2949 rel="external nofollow noreferrer">#2949</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2964 rel="external nofollow noreferrer">#2964</a></li> <li>Fixed a segfault during <code>JOIN ... ON</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/3000 rel="external nofollow noreferrer">#3000</a></li> <li>Fixed the error searching column names when the <code>WHERE</code> expression consists entirely of a qualified column name, such as <code>WHERE table.column</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2994 rel="external nofollow noreferrer">#2994</a></li> <li>Fixed the "Not found column" error that occurred when executing distributed queries if a single column consisting of an IN expression with a subquery is requested from a remote server. <a href=https://github.com/ClickHouse/ClickHouse/pull/3087 rel="external nofollow noreferrer">#3087</a></li> <li>Fixed the <code>Block structure mismatch in UNION stream: different number of columns</code> error that occurred for distributed queries if one of the shards is local and the other is not, and optimization of the move to <code>PREWHERE</code> is triggered. <a href=https://github.com/ClickHouse/ClickHouse/pull/2226 rel="external nofollow noreferrer">#2226</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3037 rel="external nofollow noreferrer">#3037</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3055 rel="external nofollow noreferrer">#3055</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3065 rel="external nofollow noreferrer">#3065</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3073 rel="external nofollow noreferrer">#3073</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3090 rel="external nofollow noreferrer">#3090</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/3093 rel="external nofollow noreferrer">#3093</a></li> <li>Fixed the <code>pointInPolygon</code> function for certain cases of non-convex polygons. <a href=https://github.com/ClickHouse/ClickHouse/pull/2910 rel="external nofollow noreferrer">#2910</a></li> <li>Fixed the incorrect result when comparing <code>nan</code> with integers. <a href=https://github.com/ClickHouse/ClickHouse/pull/3024 rel="external nofollow noreferrer">#3024</a></li> <li>Fixed an error in the <code>zlib-ng</code> library that could lead to segfault in rare cases. <a href=https://github.com/ClickHouse/ClickHouse/pull/2854 rel="external nofollow noreferrer">#2854</a></li> <li>Fixed a memory leak when inserting into a table with <code>AggregateFunction</code> columns, if the state of the aggregate function is not simple (allocates memory separately), and if a single insertion request results in multiple small blocks. <a href=https://github.com/ClickHouse/ClickHouse/pull/3084 rel="external nofollow noreferrer">#3084</a></li> <li>Fixed a race condition when creating and deleting the same <code>Buffer</code> or <code>MergeTree</code> table simultaneously.</li> <li>Fixed the possibility of a segfault when comparing tuples made up of certain non-trivial types, such as tuples. <a href=https://github.com/ClickHouse/ClickHouse/pull/2989 rel="external nofollow noreferrer">#2989</a></li> <li>Fixed the possibility of a segfault when running certain <code>ON CLUSTER</code> queries. <a href=https://github.com/ClickHouse/ClickHouse/pull/2960 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Fixed an error in the <code>arrayDistinct</code> function for <code>Nullable</code> array elements. <a href=https://github.com/ClickHouse/ClickHouse/pull/2845 rel="external nofollow noreferrer">#2845</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2937 rel="external nofollow noreferrer">#2937</a></li> <li>The <code>enable_optimize_predicate_expression</code> option now correctly supports cases with <code>SELECT *</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2929 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Fixed the segfault when re-initializing the ZooKeeper session. <a href=https://github.com/ClickHouse/ClickHouse/pull/2917 rel="external nofollow noreferrer">#2917</a></li> <li>Fixed potential blocking when working with ZooKeeper.</li> <li>Fixed incorrect code for adding nested data structures in a <code>SummingMergeTree</code>.</li> <li>When allocating memory for states of aggregate functions, alignment is correctly taken into account, which makes it possible to use operations that require alignment when implementing states of aggregate functions. <a href=https://github.com/ClickHouse/ClickHouse/pull/2808 rel="external nofollow noreferrer">chenxing-xc</a></li> </ul> <h3 id=security-fix_4>Security fix:<a class=headerlink href=#security-fix_4 title="Permanent link">&para;</a></h3> <ul> <li>Safe use of ODBC data sources. Interaction with ODBC drivers uses a separate <code>clickhouse-odbc-bridge</code> process. Errors in third-party ODBC drivers no longer cause problems with server stability or vulnerabilities. <a href=https://github.com/ClickHouse/ClickHouse/pull/2828 rel="external nofollow noreferrer">#2828</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2879 rel="external nofollow noreferrer">#2879</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2886 rel="external nofollow noreferrer">#2886</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2893 rel="external nofollow noreferrer">#2893</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2921 rel="external nofollow noreferrer">#2921</a></li> <li>Fixed incorrect validation of the file path in the <code>catBoostPool</code> table function. <a href=https://github.com/ClickHouse/ClickHouse/pull/2894 rel="external nofollow noreferrer">#2894</a></li> <li>The contents of system tables (<code>tables</code>, <code>databases</code>, <code>parts</code>, <code>columns</code>, <code>parts_columns</code>, <code>merges</code>, <code>mutations</code>, <code>replicas</code>, and <code>replication_queue</code>) are filtered according to the user's configured access to databases (<code>allow_databases</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/2856 rel="external nofollow noreferrer">Winter Zhang</a></li> </ul> <h3 id=backward-incompatible-changes_6>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_6 title="Permanent link">&para;</a></h3> <ul> <li>In queries with JOIN, the star character expands to a list of columns in all tables, in compliance with the SQL standard. You can restore the old behavior by setting <code>asterisk_left_columns_only</code> to 1 on the user configuration level.</li> </ul> <h3 id=build-changes_2>Build changes:<a class=headerlink href=#build-changes_2 title="Permanent link">&para;</a></h3> <ul> <li>Most integration tests can now be run by commit.</li> <li>Code style checks can also be run by commit.</li> <li>The <code>memcpy</code> implementation is chosen correctly when building on CentOS7/Fedora. <a href=https://github.com/ClickHouse/ClickHouse/pull/2912 rel="external nofollow noreferrer">Etienne Champetier</a></li> <li>When using clang to build, some warnings from <code>-Weverything</code> have been added, in addition to the regular <code>-Wall-Wextra -Werror</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2957 rel="external nofollow noreferrer">#2957</a></li> <li>Debugging the build uses the <code>jemalloc</code> debug option.</li> <li>The interface of the library for interacting with ZooKeeper is declared abstract. <a href=https://github.com/ClickHouse/ClickHouse/pull/2950 rel="external nofollow noreferrer">#2950</a></li> </ul> <h2 id=clickhouse-release-18-10-3-2018-08-13>ClickHouse release 18.10.3, 2018-08-13<a class=headerlink href=#clickhouse-release-18-10-3-2018-08-13 title="Permanent link">&para;</a></h2> <h3 id=new-features_13>New features:<a class=headerlink href=#new-features_13 title="Permanent link">&para;</a></h3> <ul> <li>HTTPS can be used for replication. <a href=https://github.com/ClickHouse/ClickHouse/pull/2760 rel="external nofollow noreferrer">#2760</a></li> <li>Added the functions <code>murmurHash2_64</code>, <code>murmurHash3_32</code>, <code>murmurHash3_64</code>, and <code>murmurHash3_128</code> in addition to the existing <code>murmurHash2_32</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2791 rel="external nofollow noreferrer">#2791</a></li> <li>Support for Nullable types in the ClickHouse ODBC driver (<code>ODBCDriver2</code> output format). <a href=https://github.com/ClickHouse/ClickHouse/pull/2834 rel="external nofollow noreferrer">#2834</a></li> <li>Support for <code>UUID</code> in the key columns.</li> </ul> <h3 id=improvements_12>Improvements:<a class=headerlink href=#improvements_12 title="Permanent link">&para;</a></h3> <ul> <li>Clusters can be removed without restarting the server when they are deleted from the config files. <a href=https://github.com/ClickHouse/ClickHouse/pull/2777 rel="external nofollow noreferrer">#2777</a></li> <li>External dictionaries can be removed without restarting the server when they are removed from config files. <a href=https://github.com/ClickHouse/ClickHouse/pull/2779 rel="external nofollow noreferrer">#2779</a></li> <li>Added <code>SETTINGS</code> support for the <code>Kafka</code> table engine. <a href=https://github.com/ClickHouse/ClickHouse/pull/2781 rel="external nofollow noreferrer">Alexander Marshalov</a></li> <li>Improvements for the <code>UUID</code> data type (not yet complete). <a href=https://github.com/ClickHouse/ClickHouse/pull/2618 rel="external nofollow noreferrer">#2618</a></li> <li>Support for empty parts after merges in the <code>SummingMergeTree</code>, <code>CollapsingMergeTree</code> and <code>VersionedCollapsingMergeTree</code> engines. <a href=https://github.com/ClickHouse/ClickHouse/pull/2815 rel="external nofollow noreferrer">#2815</a></li> <li>Old records of completed mutations are deleted (<code>ALTER DELETE</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/2784 rel="external nofollow noreferrer">#2784</a></li> <li>Added the <code>system.merge_tree_settings</code> table. <a href=https://github.com/ClickHouse/ClickHouse/pull/2841 rel="external nofollow noreferrer">Kirill Shvakov</a></li> <li>The <code>system.tables</code> table now has dependency columns: <code>dependencies_database</code> and <code>dependencies_table</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2851 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Added the <code>max_partition_size_to_drop</code> config option. <a href=https://github.com/ClickHouse/ClickHouse/pull/2782 rel="external nofollow noreferrer">#2782</a></li> <li>Added the <code>output_format_json_escape_forward_slashes</code> option. <a href=https://github.com/ClickHouse/ClickHouse/pull/2812 rel="external nofollow noreferrer">Alexander Bocharov</a></li> <li>Added the <code>max_fetch_partition_retries_count</code> setting. <a href=https://github.com/ClickHouse/ClickHouse/pull/2831 rel="external nofollow noreferrer">#2831</a></li> <li>Added the <code>prefer_localhost_replica</code> setting for disabling the preference for a local replica and going to a local replica without inter-process interaction. <a href=https://github.com/ClickHouse/ClickHouse/pull/2832 rel="external nofollow noreferrer">#2832</a></li> <li>The <code>quantileExact</code> aggregate function returns <code>nan</code> in the case of aggregation on an empty <code>Float32</code> or <code>Float64</code> set. <a href=https://github.com/ClickHouse/ClickHouse/pull/2855 rel="external nofollow noreferrer">Sundy Li</a></li> </ul> <h3 id=bug-fixes_36>Bug fixes:<a class=headerlink href=#bug-fixes_36 title="Permanent link">&para;</a></h3> <ul> <li>Removed unnecessary escaping of the connection string parameters for ODBC, which made it impossible to establish a connection. This error occurred in version 18.6.0.</li> <li>Fixed the logic for processing <code>REPLACE PARTITION</code> commands in the replication queue. If there are two <code>REPLACE</code> commands for the same partition, the incorrect logic could cause one of them to remain in the replication queue and not be executed. <a href=https://github.com/ClickHouse/ClickHouse/pull/2814 rel="external nofollow noreferrer">#2814</a></li> <li>Fixed a merge bug when all data parts were empty (parts that were formed from a merge or from <code>ALTER DELETE</code> if all data was deleted). This bug appeared in version 18.1.0. <a href=https://github.com/ClickHouse/ClickHouse/pull/2930 rel="external nofollow noreferrer">#2930</a></li> <li>Fixed an error for concurrent <code>Set</code> or <code>Join</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2823 rel="external nofollow noreferrer">Amos Bird</a></li> <li>Fixed the <code>Block structure mismatch in UNION stream: different number of columns</code> error that occurred for <code>UNION ALL</code> queries inside a sub-query if one of the <code>SELECT</code> queries contains duplicate column names. <a href=https://github.com/ClickHouse/ClickHouse/pull/2094 rel="external nofollow noreferrer">Winter Zhang</a></li> <li>Fixed a memory leak if an exception occurred when connecting to a MySQL server.</li> <li>Fixed incorrect clickhouse-client response code in case of a query error.</li> <li>Fixed incorrect behavior of materialized views containing DISTINCT. <a href=https://github.com/ClickHouse/ClickHouse/issues/2795 rel="external nofollow noreferrer">#2795</a></li> </ul> <h3 id=backward-incompatible-changes_7>Backward incompatible changes<a class=headerlink href=#backward-incompatible-changes_7 title="Permanent link">&para;</a></h3> <ul> <li>Removed support for CHECK TABLE queries for Distributed tables.</li> </ul> <h3 id=build-changes_3>Build changes:<a class=headerlink href=#build-changes_3 title="Permanent link">&para;</a></h3> <ul> <li>The allocator has been replaced: <code>jemalloc</code> is now used instead of <code>tcmalloc</code>. In some scenarios, this increases speed up to 20%. However, there are queries that have slowed by up to 20%. Memory consumption has been reduced by approximately 10% in some scenarios, with improved stability. With highly competitive loads, CPU usage in userspace and in system shows just a slight increase. <a href=https://github.com/ClickHouse/ClickHouse/pull/2773 rel="external nofollow noreferrer">#2773</a></li> <li>Use of libressl from a submodule. <a href=https://github.com/ClickHouse/ClickHouse/pull/1983 rel="external nofollow noreferrer">#1983</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/2807 rel="external nofollow noreferrer">#2807</a></li> <li>Use of unixodbc from a submodule. <a href=https://github.com/ClickHouse/ClickHouse/pull/2789 rel="external nofollow noreferrer">#2789</a></li> <li>Use of mariadb-connector-c from a submodule. <a href=https://github.com/ClickHouse/ClickHouse/pull/2785 rel="external nofollow noreferrer">#2785</a></li> <li>Added functional test files to the repository that depend on the availability of test data (for the time being, without the test data itself).</li> </ul> <h2 id=clickhouse-release-18-6-0-2018-08-02>ClickHouse release 18.6.0, 2018-08-02<a class=headerlink href=#clickhouse-release-18-6-0-2018-08-02 title="Permanent link">&para;</a></h2> <h3 id=new-features_14>New features:<a class=headerlink href=#new-features_14 title="Permanent link">&para;</a></h3> <ul> <li>Added support for ON expressions for the JOIN ON syntax:<br> <code>JOIN ON Expr([table.]column ...) = Expr([table.]column, ...) [AND Expr([table.]column, ...) = Expr([table.]column, ...) ...]</code><br> The expression must be a chain of equalities joined by the AND operator. Each side of the equality can be an arbitrary expression over the columns of one of the tables. The use of fully qualified column names is supported (<code>table.name</code>, <code>database.table.name</code>, <code>table_alias.name</code>, <code>subquery_alias.name</code>) for the right table. <a href=https://github.com/ClickHouse/ClickHouse/pull/2742 rel="external nofollow noreferrer">#2742</a></li> <li>HTTPS can be enabled for replication. <a href=https://github.com/ClickHouse/ClickHouse/pull/2760 rel="external nofollow noreferrer">#2760</a></li> </ul> <h3 id=improvements_13>Improvements:<a class=headerlink href=#improvements_13 title="Permanent link">&para;</a></h3> <ul> <li>The server passes the patch component of its version to the client. Data about the patch version component is in <code>system.processes</code> and <code>query_log</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/2646 rel="external nofollow noreferrer">#2646</a></li> </ul> <h2 id=clickhouse-release-18-5-1-2018-07-31>ClickHouse release 18.5.1, 2018-07-31<a class=headerlink href=#clickhouse-release-18-5-1-2018-07-31 title="Permanent link">&para;</a></h2> <h3 id=new-features_15>New features:<a class=headerlink href=#new-features_15 title="Permanent link">&para;</a></h3> <ul> <li>Added the hash function <code>murmurHash2_32</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/2756 rel="external nofollow noreferrer">#2756</a>.</li> </ul> <h3 id=improvements_14>Improvements:<a class=headerlink href=#improvements_14 title="Permanent link">&para;</a></h3> <ul> <li>Now you can use the <code>from_env</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/2741 rel="external nofollow noreferrer">#2741</a> attribute to set values in config files from environment variables.</li> <li>Added case-insensitive versions of the <code>coalesce</code>, <code>ifNull</code>, and <code>nullIf functions</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/2752 rel="external nofollow noreferrer">#2752</a>.</li> </ul> <h3 id=bug-fixes_37>Bug fixes:<a class=headerlink href=#bug-fixes_37 title="Permanent link">&para;</a></h3> <ul> <li>Fixed a possible bug when starting a replica <a href=https://github.com/ClickHouse/ClickHouse/pull/2759 rel="external nofollow noreferrer">#2759</a>.</li> </ul> <h2 id=clickhouse-release-18-4-0-2018-07-28>ClickHouse release 18.4.0, 2018-07-28<a class=headerlink href=#clickhouse-release-18-4-0-2018-07-28 title="Permanent link">&para;</a></h2> <h3 id=new-features_16>New features:<a class=headerlink href=#new-features_16 title="Permanent link">&para;</a></h3> <ul> <li>Added system tables: <code>formats</code>, <code>data_type_families</code>, <code>aggregate_function_combinators</code>, <code>table_functions</code>, <code>table_engines</code>, <code>collations</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/2721 rel="external nofollow noreferrer">#2721</a>.</li> <li>Added the ability to use a table function instead of a table as an argument of a <code>remote</code> or <code>cluster table function</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/2708 rel="external nofollow noreferrer">#2708</a>.</li> <li>Support for <code>HTTP Basic</code> authentication in the replication protocol <a href=https://github.com/ClickHouse/ClickHouse/pull/2727 rel="external nofollow noreferrer">#2727</a>.</li> <li>The <code>has</code> function now allows searching for a numeric value in an array of <code>Enum</code> values <a href=https://github.com/ClickHouse/ClickHouse/pull/2699 rel="external nofollow noreferrer">Maxim Khrisanfov</a>.</li> <li>Support for adding arbitrary message separators when reading from <code>Kafka</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/2701 rel="external nofollow noreferrer">Amos Bird</a>.</li> </ul> <h3 id=improvements_15>Improvements:<a class=headerlink href=#improvements_15 title="Permanent link">&para;</a></h3> <ul> <li>The <code>ALTER TABLE t DELETE WHERE</code> query does not rewrite data parts that were not affected by the WHERE condition <a href=https://github.com/ClickHouse/ClickHouse/pull/2694 rel="external nofollow noreferrer">#2694</a>.</li> <li>The <code>use_minimalistic_checksums_in_zookeeper</code> option for <code>ReplicatedMergeTree</code> tables is enabled by default. This setting was added in version 1.1.54378, 2018-04-16. Versions that are older than 1.1.54378 can no longer be installed.</li> <li>Support for running <code>KILL</code> and <code>OPTIMIZE</code> queries that specify <code>ON CLUSTER</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/2689 rel="external nofollow noreferrer">Winter Zhang</a>.</li> </ul> <h3 id=bug-fixes_38>Bug fixes:<a class=headerlink href=#bug-fixes_38 title="Permanent link">&para;</a></h3> <ul> <li>Fixed the error <code>Column ... is not under an aggregate function and not in GROUP BY</code> for aggregation with an IN expression. This bug appeared in version 18.1.0. (<a href=https://github.com/ClickHouse/ClickHouse/commit/bbdd780be0be06a0f336775941cdd536878dd2c2 rel="external nofollow noreferrer">bbdd780b</a>)</li> <li>Fixed a bug in the <code>windowFunnel aggregate function</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/2735 rel="external nofollow noreferrer">Winter Zhang</a>.</li> <li>Fixed a bug in the <code>anyHeavy</code> aggregate function (<a href=https://github.com/ClickHouse/ClickHouse/commit/a2101df25a6a0fba99aa71f8793d762af2b801ee rel="external nofollow noreferrer">a2101df2</a>)</li> <li>Fixed server crash when using the <code>countArray()</code> aggregate function.</li> </ul> <h3 id=backward-incompatible-changes_8>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_8 title="Permanent link">&para;</a></h3> <ul> <li>Parameters for <code>Kafka</code> engine was changed from <code>Kafka(kafka_broker_list, kafka_topic_list, kafka_group_name, kafka_format[, kafka_schema, kafka_num_consumers])</code> to <code>Kafka(kafka_broker_list, kafka_topic_list, kafka_group_name, kafka_format[, kafka_row_delimiter, kafka_schema, kafka_num_consumers])</code>. If your tables use <code>kafka_schema</code> or <code>kafka_num_consumers</code> parameters, you have to manually edit the metadata files <code>path/metadata/database/table.sql</code> and add <code>kafka_row_delimiter</code> parameter with <code>''</code> value.</li> </ul> <h2 id=clickhouse-release-18-1-0-2018-07-23>ClickHouse release 18.1.0, 2018-07-23<a class=headerlink href=#clickhouse-release-18-1-0-2018-07-23 title="Permanent link">&para;</a></h2> <h3 id=new-features_17>New features:<a class=headerlink href=#new-features_17 title="Permanent link">&para;</a></h3> <ul> <li>Support for the <code>ALTER TABLE t DELETE WHERE</code> query for non-replicated MergeTree tables (<a href=https://github.com/ClickHouse/ClickHouse/pull/2634 rel="external nofollow noreferrer">#2634</a>).</li> <li>Support for arbitrary types for the <code>uniq*</code> family of aggregate functions (<a href=https://github.com/ClickHouse/ClickHouse/issues/2010 rel="external nofollow noreferrer">#2010</a>).</li> <li>Support for arbitrary types in comparison operators (<a href=https://github.com/ClickHouse/ClickHouse/issues/2026 rel="external nofollow noreferrer">#2026</a>).</li> <li>The <code>users.xml</code> file allows setting a subnet mask in the format <code>10.0.0.1/255.255.255.0</code>. This is necessary for using masks for IPv6 networks with zeros in the middle (<a href=https://github.com/ClickHouse/ClickHouse/pull/2637 rel="external nofollow noreferrer">#2637</a>).</li> <li>Added the <code>arrayDistinct</code> function (<a href=https://github.com/ClickHouse/ClickHouse/pull/2670 rel="external nofollow noreferrer">#2670</a>).</li> <li>The SummingMergeTree engine can now work with AggregateFunction type columns (<a href=https://github.com/ClickHouse/ClickHouse/pull/2566 rel="external nofollow noreferrer">Constantin S. Pan</a>).</li> </ul> <h3 id=improvements_16>Improvements:<a class=headerlink href=#improvements_16 title="Permanent link">&para;</a></h3> <ul> <li>Changed the numbering scheme for release versions. Now the first part contains the year of release (A.D., Moscow timezone, minus 2000), the second part contains the number for major changes (increases for most releases), and the third part is the patch version. Releases are still backwards compatible, unless otherwise stated in the changelog.</li> <li>Faster conversions of floating-point numbers to a string (<a href=https://github.com/ClickHouse/ClickHouse/pull/2664 rel="external nofollow noreferrer">Amos Bird</a>).</li> <li>If some rows were skipped during an insert due to parsing errors (this is possible with the <code>input_allow_errors_num</code> and <code>input_allow_errors_ratio</code> settings enabled), the number of skipped rows is now written to the server log (<a href=https://github.com/ClickHouse/ClickHouse/pull/2669 rel="external nofollow noreferrer">Leonardo Cecchi</a>).</li> </ul> <h3 id=bug-fixes_39>Bug fixes:<a class=headerlink href=#bug-fixes_39 title="Permanent link">&para;</a></h3> <ul> <li>Fixed the TRUNCATE command for temporary tables (<a href=https://github.com/ClickHouse/ClickHouse/pull/2624 rel="external nofollow noreferrer">Amos Bird</a>).</li> <li>Fixed a rare deadlock in the ZooKeeper client library that occurred when there was a network error while reading the response (<a href=https://github.com/ClickHouse/ClickHouse/commit/c315200e64b87e44bdf740707fc857d1fdf7e947 rel="external nofollow noreferrer">c315200</a>).</li> <li>Fixed an error during a CAST to Nullable types (<a href=https://github.com/ClickHouse/ClickHouse/issues/1322 rel="external nofollow noreferrer">#1322</a>).</li> <li>Fixed the incorrect result of the <code>maxIntersection()</code> function when the boundaries of intervals coincided (<a href=https://github.com/ClickHouse/ClickHouse/pull/2657 rel="external nofollow noreferrer">Michael Furmur</a>).</li> <li>Fixed incorrect transformation of the OR expression chain in a function argument (<a href=https://github.com/ClickHouse/ClickHouse/pull/2663 rel="external nofollow noreferrer">chenxing-xc</a>).</li> <li>Fixed performance degradation for queries containing <code>IN (subquery)</code> expressions inside another subquery (<a href=https://github.com/ClickHouse/ClickHouse/issues/2571 rel="external nofollow noreferrer">#2571</a>).</li> <li>Fixed incompatibility between servers with different versions in distributed queries that use a <code>CAST</code> function that isn't in uppercase letters (<a href=https://github.com/ClickHouse/ClickHouse/commit/fe8c4d64e434cacd4ceef34faa9005129f2190a5 rel="external nofollow noreferrer">fe8c4d6</a>).</li> <li>Added missing quoting of identifiers for queries to an external DBMS (<a href=https://github.com/ClickHouse/ClickHouse/issues/2635 rel="external nofollow noreferrer">#2635</a>).</li> </ul> <h3 id=backward-incompatible-changes_9>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_9 title="Permanent link">&para;</a></h3> <ul> <li>Converting a string containing the number zero to DateTime does not work. Example: <code>SELECT toDateTime('0')</code>. This is also the reason that <code>DateTime DEFAULT '0'</code> does not work in tables, as well as <code>&lt;null_value&gt;0&lt;/null_value&gt;</code> in dictionaries. Solution: replace <code>0</code> with <code>0000-00-00 00:00:00</code>.</li> </ul> <h2 id=clickhouse-release-1-1-54394-2018-07-12>ClickHouse release 1.1.54394, 2018-07-12<a class=headerlink href=#clickhouse-release-1-1-54394-2018-07-12 title="Permanent link">&para;</a></h2> <h3 id=new-features_18>New features:<a class=headerlink href=#new-features_18 title="Permanent link">&para;</a></h3> <ul> <li>Added the <code>histogram</code> aggregate function (<a href=https://github.com/ClickHouse/ClickHouse/pull/2521 rel="external nofollow noreferrer">Mikhail Surin</a>).</li> <li>Now <code>OPTIMIZE TABLE ... FINAL</code> can be used without specifying partitions for <code>ReplicatedMergeTree</code> (<a href=https://github.com/ClickHouse/ClickHouse/pull/2600 rel="external nofollow noreferrer">Amos Bird</a>).</li> </ul> <h3 id=bug-fixes_40>Bug fixes:<a class=headerlink href=#bug-fixes_40 title="Permanent link">&para;</a></h3> <ul> <li>Fixed a problem with a very small timeout for sockets (one second) for reading and writing when sending and downloading replicated data, which made it impossible to download larger parts if there is a load on the network or disk (it resulted in cyclical attempts to download parts). This error occurred in version 1.1.54388.</li> <li>Fixed issues when using chroot in ZooKeeper if you inserted duplicate data blocks in the table.</li> <li>The <code>has</code> function now works correctly for an array with Nullable elements (<a href=https://github.com/ClickHouse/ClickHouse/issues/2115 rel="external nofollow noreferrer">#2115</a>).</li> <li>The <code>system.tables</code> table now works correctly when used in distributed queries. The <code>metadata_modification_time</code> and <code>engine_full</code> columns are now non-virtual. Fixed an error that occurred if only these columns were queried from the table.</li> <li>Fixed how an empty <code>TinyLog</code> table works after inserting an empty data block (<a href=https://github.com/ClickHouse/ClickHouse/issues/2563 rel="external nofollow noreferrer">#2563</a>).</li> <li>The <code>system.zookeeper</code> table works if the value of the node in ZooKeeper is NULL.</li> </ul> <h2 id=clickhouse-release-1-1-54390-2018-07-06>ClickHouse release 1.1.54390, 2018-07-06<a class=headerlink href=#clickhouse-release-1-1-54390-2018-07-06 title="Permanent link">&para;</a></h2> <h3 id=new-features_19>New features:<a class=headerlink href=#new-features_19 title="Permanent link">&para;</a></h3> <ul> <li>Queries can be sent in <code>multipart/form-data</code> format (in the <code>query</code> field), which is useful if external data is also sent for query processing (<a href=https://github.com/ClickHouse/ClickHouse/pull/2490 rel="external nofollow noreferrer">Olga Hvostikova</a>).</li> <li>Added the ability to enable or disable processing single or double quotes when reading data in CSV format. You can configure this in the <code>format_csv_allow_single_quotes</code> and <code>format_csv_allow_double_quotes</code> settings (<a href=https://github.com/ClickHouse/ClickHouse/pull/2574 rel="external nofollow noreferrer">Amos Bird</a>).</li> <li>Now <code>OPTIMIZE TABLE ... FINAL</code> can be used without specifying the partition for non-replicated variants of <code>MergeTree</code> (<a href=https://github.com/ClickHouse/ClickHouse/pull/2599 rel="external nofollow noreferrer">Amos Bird</a>).</li> </ul> <h3 id=improvements_17>Improvements:<a class=headerlink href=#improvements_17 title="Permanent link">&para;</a></h3> <ul> <li>Improved performance, reduced memory consumption, and correct memory consumption tracking with use of the IN operator when a table index could be used (<a href=https://github.com/ClickHouse/ClickHouse/pull/2584 rel="external nofollow noreferrer">#2584</a>).</li> <li>Removed redundant checking of checksums when adding a data part. This is important when there are a large number of replicas, because in these cases the total number of checks was equal to N^2.</li> <li>Added support for <code>Array(Tuple(...))</code> arguments for the <code>arrayEnumerateUniq</code> function (<a href=https://github.com/ClickHouse/ClickHouse/pull/2573 rel="external nofollow noreferrer">#2573</a>).</li> <li>Added <code>Nullable</code> support for the <code>runningDifference</code> function (<a href=https://github.com/ClickHouse/ClickHouse/pull/2594 rel="external nofollow noreferrer">#2594</a>).</li> <li>Improved query analysis performance when there is a very large number of expressions (<a href=https://github.com/ClickHouse/ClickHouse/pull/2572 rel="external nofollow noreferrer">#2572</a>).</li> <li>Faster selection of data parts for merging in <code>ReplicatedMergeTree</code> tables. Faster recovery of the ZooKeeper session (<a href=https://github.com/ClickHouse/ClickHouse/pull/2597 rel="external nofollow noreferrer">#2597</a>).</li> <li>The <code>format_version.txt</code> file for <code>MergeTree</code> tables is re-created if it is missing, which makes sense if ClickHouse is launched after copying the directory structure without files (<a href=https://github.com/ClickHouse/ClickHouse/pull/2593 rel="external nofollow noreferrer">Ciprian Hacman</a>).</li> </ul> <h3 id=bug-fixes_41>Bug fixes:<a class=headerlink href=#bug-fixes_41 title="Permanent link">&para;</a></h3> <ul> <li>Fixed a bug when working with ZooKeeper that could make it impossible to recover the session and readonly states of tables before restarting the server.</li> <li>Fixed a bug when working with ZooKeeper that could result in old nodes not being deleted if the session is interrupted.</li> <li>Fixed an error in the <code>quantileTDigest</code> function for Float arguments (this bug was introduced in version 1.1.54388) (<a href=https://github.com/ClickHouse/ClickHouse/pull/2553 rel="external nofollow noreferrer">Mikhail Surin</a>).</li> <li>Fixed a bug in the index for MergeTree tables if the primary key column is located inside the function for converting types between signed and unsigned integers of the same size (<a href=https://github.com/ClickHouse/ClickHouse/pull/2603 rel="external nofollow noreferrer">#2603</a>).</li> <li>Fixed segfault if <code>macros</code> are used but they aren't in the config file (<a href=https://github.com/ClickHouse/ClickHouse/pull/2570 rel="external nofollow noreferrer">#2570</a>).</li> <li>Fixed switching to the default database when reconnecting the client (<a href=https://github.com/ClickHouse/ClickHouse/pull/2583 rel="external nofollow noreferrer">#2583</a>).</li> <li>Fixed a bug that occurred when the <code>use_index_for_in_with_subqueries</code> setting was disabled.</li> </ul> <h3 id=security-fix_5>Security fix:<a class=headerlink href=#security-fix_5 title="Permanent link">&para;</a></h3> <ul> <li>Sending files is no longer possible when connected to MySQL (<code>LOAD DATA LOCAL INFILE</code>).</li> </ul> <h2 id=clickhouse-release-1-1-54388-2018-06-28>ClickHouse release 1.1.54388, 2018-06-28<a class=headerlink href=#clickhouse-release-1-1-54388-2018-06-28 title="Permanent link">&para;</a></h2> <h3 id=new-features_20>New features:<a class=headerlink href=#new-features_20 title="Permanent link">&para;</a></h3> <ul> <li>Support for the <code>ALTER TABLE t DELETE WHERE</code> query for replicated tables. Added the <code>system.mutations</code> table to track progress of this type of queries.</li> <li>Support for the <code>ALTER TABLE t [REPLACE|ATTACH] PARTITION</code> query for *MergeTree tables.</li> <li>Support for the <code>TRUNCATE TABLE</code> query (<a href=https://github.com/ClickHouse/ClickHouse/pull/2260 rel="external nofollow noreferrer">Winter Zhang</a>)</li> <li>Several new <code>SYSTEM</code> queries for replicated tables (<code>RESTART REPLICAS</code>, <code>SYNC REPLICA</code>, <code>[STOP|START] [MERGES|FETCHES|SENDS REPLICATED|REPLICATION QUEUES]</code>).</li> <li>Added the ability to write to a table with the MySQL engine and the corresponding table function (<a href=https://github.com/ClickHouse/ClickHouse/pull/2294 rel="external nofollow noreferrer">sundy-li</a>).</li> <li>Added the <code>url()</code> table function and the <code>URL</code> table engine (<a href=https://github.com/ClickHouse/ClickHouse/pull/2501 rel="external nofollow noreferrer">Alexander Sapin</a>).</li> <li>Added the <code>windowFunnel</code> aggregate function (<a href=https://github.com/ClickHouse/ClickHouse/pull/2352 rel="external nofollow noreferrer">sundy-li</a>).</li> <li>New <code>startsWith</code> and <code>endsWith</code> functions for strings (<a href=https://github.com/ClickHouse/ClickHouse/pull/2429 rel="external nofollow noreferrer">Vadim Plakhtinsky</a>).</li> <li>The <code>numbers()</code> table function now allows you to specify the offset (<a href=https://github.com/ClickHouse/ClickHouse/pull/2535 rel="external nofollow noreferrer">Winter Zhang</a>).</li> <li>The password to <code>clickhouse-client</code> can be entered interactively.</li> <li>Server logs can now be sent to syslog (<a href=https://github.com/ClickHouse/ClickHouse/pull/2459 rel="external nofollow noreferrer">Alexander Krasheninnikov</a>).</li> <li>Support for logging in dictionaries with a shared library source (<a href=https://github.com/ClickHouse/ClickHouse/pull/2472 rel="external nofollow noreferrer">Alexander Sapin</a>).</li> <li>Support for custom CSV delimiters (<a href=https://github.com/ClickHouse/ClickHouse/pull/2263 rel="external nofollow noreferrer">Ivan Zhukov</a>)</li> <li>Added the <code>date_time_input_format</code> setting. If you switch this setting to <code>'best_effort'</code>, DateTime values will be read in a wide range of formats.</li> <li>Added the <code>clickhouse-obfuscator</code> utility for data obfuscation. Usage example: publishing data used in performance tests.</li> </ul> <h3 id=experimental-features_6>Experimental features:<a class=headerlink href=#experimental-features_6 title="Permanent link">&para;</a></h3> <ul> <li>Added the ability to calculate <code>and</code> arguments only where they are needed (<a href=https://github.com/ClickHouse/ClickHouse/pull/2272 rel="external nofollow noreferrer">Anastasia Tsarkova</a>)</li> <li>JIT compilation to native code is now available for some expressions (<a href=https://github.com/ClickHouse/ClickHouse/pull/2277 rel="external nofollow noreferrer">pyos</a>).</li> </ul> <h3 id=bug-fixes_42>Bug fixes:<a class=headerlink href=#bug-fixes_42 title="Permanent link">&para;</a></h3> <ul> <li>Duplicates no longer appear for a query with <code>DISTINCT</code> and <code>ORDER BY</code>.</li> <li>Queries with <code>ARRAY JOIN</code> and <code>arrayFilter</code> no longer return an incorrect result.</li> <li>Fixed an error when reading an array column from a Nested structure (<a href=https://github.com/ClickHouse/ClickHouse/issues/2066 rel="external nofollow noreferrer">#2066</a>).</li> <li>Fixed an error when analyzing queries with a HAVING clause like <code>HAVING tuple IN (...)</code>.</li> <li>Fixed an error when analyzing queries with recursive aliases.</li> <li>Fixed an error when reading from ReplacingMergeTree with a condition in PREWHERE that filters all rows (<a href=https://github.com/ClickHouse/ClickHouse/issues/2525 rel="external nofollow noreferrer">#2525</a>).</li> <li>User profile settings were not applied when using sessions in the HTTP interface.</li> <li>Fixed how settings are applied from the command line parameters in clickhouse-local.</li> <li>The ZooKeeper client library now uses the session timeout received from the server.</li> <li>Fixed a bug in the ZooKeeper client library when the client waited for the server response longer than the timeout.</li> <li>Fixed pruning of parts for queries with conditions on partition key columns (<a href=https://github.com/ClickHouse/ClickHouse/issues/2342 rel="external nofollow noreferrer">#2342</a>).</li> <li>Merges are now possible after <code>CLEAR COLUMN IN PARTITION</code> (<a href=https://github.com/ClickHouse/ClickHouse/issues/2315 rel="external nofollow noreferrer">#2315</a>).</li> <li>Type mapping in the ODBC table function has been fixed (<a href=https://github.com/ClickHouse/ClickHouse/pull/2268 rel="external nofollow noreferrer">sundy-li</a>).</li> <li>Type comparisons have been fixed for <code>DateTime</code> with and without the time zone (<a href=https://github.com/ClickHouse/ClickHouse/pull/2400 rel="external nofollow noreferrer">Alexander Bocharov</a>).</li> <li>Fixed syntactic parsing and formatting of the <code>CAST</code> operator.</li> <li>Fixed insertion into a materialized view for the Distributed table engine (<a href=https://github.com/ClickHouse/ClickHouse/pull/2411 rel="external nofollow noreferrer">Babacar Diassé</a>).</li> <li>Fixed a race condition when writing data from the <code>Kafka</code> engine to materialized views (<a href=https://github.com/ClickHouse/ClickHouse/pull/2448 rel="external nofollow noreferrer">Yangkuan Liu</a>).</li> <li>Fixed SSRF in the remote() table function.</li> <li>Fixed exit behavior of <code>clickhouse-client</code> in multiline mode (<a href=https://github.com/ClickHouse/ClickHouse/issues/2510 rel="external nofollow noreferrer">#2510</a>).</li> </ul> <h3 id=improvements_18>Improvements:<a class=headerlink href=#improvements_18 title="Permanent link">&para;</a></h3> <ul> <li>Background tasks in replicated tables are now performed in a thread pool instead of in separate threads (<a href=https://github.com/ClickHouse/ClickHouse/pull/1722 rel="external nofollow noreferrer">Silviu Caragea</a>).</li> <li>Improved LZ4 compression performance.</li> <li>Faster analysis for queries with a large number of JOINs and sub-queries.</li> <li>The DNS cache is now updated automatically when there are too many network errors.</li> <li>Table inserts no longer occur if the insert into one of the materialized views is not possible because it has too many parts.</li> <li>Corrected the discrepancy in the event counters <code>Query</code>, <code>SelectQuery</code>, and <code>InsertQuery</code>.</li> <li>Expressions like <code>tuple IN (SELECT tuple)</code> are allowed if the tuple types match.</li> <li>A server with replicated tables can start even if you haven't configured ZooKeeper.</li> <li>When calculating the number of available CPU cores, limits on cgroups are now taken into account (<a href=https://github.com/ClickHouse/ClickHouse/pull/2325 rel="external nofollow noreferrer">Atri Sharma</a>).</li> <li>Added chown for config directories in the systemd config file (<a href=https://github.com/ClickHouse/ClickHouse/pull/2421 rel="external nofollow noreferrer">Mikhail Shiryaev</a>).</li> </ul> <h3 id=build-changes_4>Build changes:<a class=headerlink href=#build-changes_4 title="Permanent link">&para;</a></h3> <ul> <li>The gcc8 compiler can be used for builds.</li> <li>Added the ability to build llvm from submodule.</li> <li>The version of the librdkafka library has been updated to v0.11.4.</li> <li>Added the ability to use the system libcpuid library. The library version has been updated to 0.4.0.</li> <li>Fixed the build using the vectorclass library (<a href=https://github.com/ClickHouse/ClickHouse/pull/2274 rel="external nofollow noreferrer">Babacar Diassé</a>).</li> <li>Cmake now generates files for ninja by default (like when using <code>-G Ninja</code>).</li> <li>Added the ability to use the libtinfo library instead of libtermcap (<a href=https://github.com/ClickHouse/ClickHouse/pull/2519 rel="external nofollow noreferrer">Georgy Kondratiev</a>).</li> <li>Fixed a header file conflict in Fedora Rawhide (<a href=https://github.com/ClickHouse/ClickHouse/issues/2520 rel="external nofollow noreferrer">#2520</a>).</li> </ul> <h3 id=backward-incompatible-changes_10>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_10 title="Permanent link">&para;</a></h3> <ul> <li>Removed escaping in <code>Vertical</code> and <code>Pretty*</code> formats and deleted the <code>VerticalRaw</code> format.</li> <li>If servers with version 1.1.54388 (or newer) and servers with an older version are used simultaneously in a distributed query and the query has the <code>cast(x, 'Type')</code> expression without the <code>AS</code> keyword and doesn't have the word <code>cast</code> in uppercase, an exception will be thrown with a message like <code>Not found column cast(0, 'UInt8') in block</code>. Solution: Update the server on the entire cluster.</li> </ul> <h2 id=clickhouse-release-1-1-54385-2018-06-01>ClickHouse release 1.1.54385, 2018-06-01<a class=headerlink href=#clickhouse-release-1-1-54385-2018-06-01 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_43>Bug fixes:<a class=headerlink href=#bug-fixes_43 title="Permanent link">&para;</a></h3> <ul> <li>Fixed an error that in some cases caused ZooKeeper operations to block.</li> </ul> <h2 id=clickhouse-release-1-1-54383-2018-05-22>ClickHouse release 1.1.54383, 2018-05-22<a class=headerlink href=#clickhouse-release-1-1-54383-2018-05-22 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_44>Bug fixes:<a class=headerlink href=#bug-fixes_44 title="Permanent link">&para;</a></h3> <ul> <li>Fixed a slowdown of replication queue if a table has many replicas.</li> </ul> <h2 id=clickhouse-release-1-1-54381-2018-05-14>ClickHouse release 1.1.54381, 2018-05-14<a class=headerlink href=#clickhouse-release-1-1-54381-2018-05-14 title="Permanent link">&para;</a></h2> <h3 id=bug-fixes_45>Bug fixes:<a class=headerlink href=#bug-fixes_45 title="Permanent link">&para;</a></h3> <ul> <li>Fixed a nodes leak in ZooKeeper when ClickHouse loses connection to ZooKeeper server.</li> </ul> <h2 id=clickhouse-release-1-1-54380-2018-04-21>ClickHouse release 1.1.54380, 2018-04-21<a class=headerlink href=#clickhouse-release-1-1-54380-2018-04-21 title="Permanent link">&para;</a></h2> <h3 id=new-features_21>New features:<a class=headerlink href=#new-features_21 title="Permanent link">&para;</a></h3> <ul> <li>Added the table function <code>file(path, format, structure)</code>. An example reading bytes from <code>/dev/urandom</code>: <code>ln -s /dev/urandom /var/lib/clickhouse/user_files/random``clickhouse-client -q "SELECT * FROM file('random', 'RowBinary', 'd UInt8') LIMIT 10"</code>.</li> </ul> <h3 id=improvements_19>Improvements:<a class=headerlink href=#improvements_19 title="Permanent link">&para;</a></h3> <ul> <li>Subqueries can be wrapped in <code>()</code> brackets to enhance query readability. For example: <code>(SELECT 1) UNION ALL (SELECT 1)</code>.</li> <li>Simple <code>SELECT</code> queries from the <code>system.processes</code> table are not included in the <code>max_concurrent_queries</code> limit.</li> </ul> <h3 id=bug-fixes_46>Bug fixes:<a class=headerlink href=#bug-fixes_46 title="Permanent link">&para;</a></h3> <ul> <li>Fixed incorrect behavior of the <code>IN</code> operator when select from <code>MATERIALIZED VIEW</code>.</li> <li>Fixed incorrect filtering by partition index in expressions like <code>partition_key_column IN (...)</code>.</li> <li>Fixed inability to execute <code>OPTIMIZE</code> query on non-leader replica if <code>REANAME</code> was performed on the table.</li> <li>Fixed the authorization error when executing <code>OPTIMIZE</code> or <code>ALTER</code> queries on a non-leader replica.</li> <li>Fixed freezing of <code>KILL QUERY</code>.</li> <li>Fixed an error in ZooKeeper client library which led to loss of watches, freezing of distributed DDL queue, and slowdowns in the replication queue if a non-empty <code>chroot</code> prefix is used in the ZooKeeper configuration.</li> </ul> <h3 id=backward-incompatible-changes_11>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_11 title="Permanent link">&para;</a></h3> <ul> <li>Removed support for expressions like <code>(a, b) IN (SELECT (a, b))</code> (you can use the equivalent expression <code>(a, b) IN (SELECT a, b)</code>). In previous releases, these expressions led to undetermined <code>WHERE</code> filtering or caused errors.</li> </ul> <h2 id=clickhouse-release-1-1-54378-2018-04-16>ClickHouse release 1.1.54378, 2018-04-16<a class=headerlink href=#clickhouse-release-1-1-54378-2018-04-16 title="Permanent link">&para;</a></h2> <h3 id=new-features_22>New features:<a class=headerlink href=#new-features_22 title="Permanent link">&para;</a></h3> <ul> <li>Logging level can be changed without restarting the server.</li> <li>Added the <code>SHOW CREATE DATABASE</code> query.</li> <li>The <code>query_id</code> can be passed to <code>clickhouse-client</code> (elBroom).</li> <li>New setting: <code>max_network_bandwidth_for_all_users</code>.</li> <li>Added support for <code>ALTER TABLE ... PARTITION ...</code> for <code>MATERIALIZED VIEW</code>.</li> <li>Added information about the size of data parts in uncompressed form in the system table.</li> <li>Server-to-server encryption support for distributed tables (<code>&lt;secure&gt;1&lt;/secure&gt;</code> in the replica config in <code>&lt;remote_servers&gt;</code>).</li> <li>Configuration of the table level for the <code>ReplicatedMergeTree</code> family in order to minimize the amount of data stored in Zookeeper: : <code>use_minimalistic_checksums_in_zookeeper = 1</code></li> <li>Configuration of the <code>clickhouse-client</code> prompt. By default, server names are now output to the prompt. The server's display name can be changed. It's also sent in the <code>X-ClickHouse-Display-Name</code> HTTP header (Kirill Shvakov).</li> <li>Multiple comma-separated <code>topics</code> can be specified for the <code>Kafka</code> engine (Tobias Adamson)</li> <li>When a query is stopped by <code>KILL QUERY</code> or <code>replace_running_query</code>, the client receives the <code>Query was cancelled</code> exception instead of an incomplete result.</li> </ul> <h3 id=improvements_20>Improvements:<a class=headerlink href=#improvements_20 title="Permanent link">&para;</a></h3> <ul> <li><code>ALTER TABLE ... DROP/DETACH PARTITION</code> queries are run at the front of the replication queue.</li> <li><code>SELECT ... FINAL</code> and <code>OPTIMIZE ... FINAL</code> can be used even when the table has a single data part.</li> <li>A <code>query_log</code> table is recreated on the fly if it was deleted manually (Kirill Shvakov).</li> <li>The <code>lengthUTF8</code> function runs faster (zhang2014).</li> <li>Improved performance of synchronous inserts in <code>Distributed</code> tables (<code>insert_distributed_sync = 1</code>) when there is a very large number of shards.</li> <li>The server accepts the <code>send_timeout</code> and <code>receive_timeout</code> settings from the client and applies them when connecting to the client (they are applied in reverse order: the server socket's <code>send_timeout</code> is set to the <code>receive_timeout</code> value received from the client, and vice versa).</li> <li>More robust crash recovery for asynchronous insertion into <code>Distributed</code> tables.</li> <li>The return type of the <code>countEqual</code> function changed from <code>UInt32</code> to <code>UInt64</code> (谢磊).</li> </ul> <h3 id=bug-fixes_47>Bug fixes:<a class=headerlink href=#bug-fixes_47 title="Permanent link">&para;</a></h3> <ul> <li>Fixed an error with <code>IN</code> when the left side of the expression is <code>Nullable</code>.</li> <li>Correct results are now returned when using tuples with <code>IN</code> when some of the tuple components are in the table index.</li> <li>The <code>max_execution_time</code> limit now works correctly with distributed queries.</li> <li>Fixed errors when calculating the size of composite columns in the <code>system.columns</code> table.</li> <li>Fixed an error when creating a temporary table <code>CREATE TEMPORARY TABLE IF NOT EXISTS.</code></li> <li>Fixed errors in <code>StorageKafka</code> (##2075)</li> <li>Fixed server crashes from invalid arguments of certain aggregate functions.</li> <li>Fixed the error that prevented the <code>DETACH DATABASE</code> query from stopping background tasks for <code>ReplicatedMergeTree</code> tables.</li> <li><code>Too many parts</code> state is less likely to happen when inserting into aggregated materialized views (##2084).</li> <li>Corrected recursive handling of substitutions in the config if a substitution must be followed by another substitution on the same level.</li> <li>Corrected the syntax in the metadata file when creating a <code>VIEW</code> that uses a query with <code>UNION ALL</code>.</li> <li><code>SummingMergeTree</code> now works correctly for summation of nested data structures with a composite key.</li> <li>Fixed the possibility of a race condition when choosing the leader for <code>ReplicatedMergeTree</code> tables.</li> </ul> <h3 id=build-changes_5>Build changes:<a class=headerlink href=#build-changes_5 title="Permanent link">&para;</a></h3> <ul> <li>The build supports <code>ninja</code> instead of <code>make</code> and uses <code>ninja</code> by default for building releases.</li> <li>Renamed packages: <code>clickhouse-server-base</code> in <code>clickhouse-common-static</code>; <code>clickhouse-server-common</code> in <code>clickhouse-server</code>; <code>clickhouse-common-dbg</code> in <code>clickhouse-common-static-dbg</code>. To install, use <code>clickhouse-server clickhouse-client</code>. Packages with the old names will still load in the repositories for backward compatibility.</li> </ul> <h3 id=backward-incompatible-changes_12>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_12 title="Permanent link">&para;</a></h3> <ul> <li>Removed the special interpretation of an IN expression if an array is specified on the left side. Previously, the expression <code>arr IN (set)</code> was interpreted as "at least one <code>arr</code> element belongs to the <code>set</code>". To get the same behavior in the new version, write <code>arrayExists(x -&gt; x IN (set), arr)</code>.</li> <li>Disabled the incorrect use of the socket option <code>SO_REUSEPORT</code>, which was incorrectly enabled by default in the Poco library. Note that on Linux there is no longer any reason to simultaneously specify the addresses <code>::</code> and <code>0.0.0.0</code> for listen – use just <code>::</code>, which allows listening to the connection both over IPv4 and IPv6 (with the default kernel config settings). You can also revert to the behavior from previous versions by specifying <code>&lt;listen_reuse_port&gt;1&lt;/listen_reuse_port&gt;</code> in the config.</li> </ul> <h2 id=clickhouse-release-1-1-54370-2018-03-16>ClickHouse release 1.1.54370, 2018-03-16<a class=headerlink href=#clickhouse-release-1-1-54370-2018-03-16 title="Permanent link">&para;</a></h2> <h3 id=new-features_23>New features:<a class=headerlink href=#new-features_23 title="Permanent link">&para;</a></h3> <ul> <li>Added the <code>system.macros</code> table and auto updating of macros when the config file is changed.</li> <li>Added the <code>SYSTEM RELOAD CONFIG</code> query.</li> <li>Added the <code>maxIntersections(left_col, right_col)</code> aggregate function, which returns the maximum number of simultaneously intersecting intervals <code>[left; right]</code>. The <code>maxIntersectionsPosition(left, right)</code> function returns the beginning of the "maximum" interval. (<a href=https://github.com/ClickHouse/ClickHouse/pull/2012 rel="external nofollow noreferrer">Michael Furmur</a>).</li> </ul> <h3 id=improvements_21>Improvements:<a class=headerlink href=#improvements_21 title="Permanent link">&para;</a></h3> <ul> <li>When inserting data in a <code>Replicated</code> table, fewer requests are made to <code>ZooKeeper</code> (and most of the user-level errors have disappeared from the <code>ZooKeeper</code> log).</li> <li>Added the ability to create aliases for data sets. Example: <code>WITH (1, 2, 3) AS set SELECT number IN set FROM system.numbers LIMIT 10</code>.</li> </ul> <h3 id=bug-fixes_48>Bug fixes:<a class=headerlink href=#bug-fixes_48 title="Permanent link">&para;</a></h3> <ul> <li>Fixed the <code>Illegal PREWHERE</code> error when reading from Merge tables for <code>Distributed</code>tables.</li> <li>Added fixes that allow you to start clickhouse-server in IPv4-only Docker containers.</li> <li>Fixed a race condition when reading from system <code>system.parts_columns tables.</code></li> <li>Removed double buffering during a synchronous insert to a <code>Distributed</code> table, which could have caused the connection to timeout.</li> <li>Fixed a bug that caused excessively long waits for an unavailable replica before beginning a <code>SELECT</code> query.</li> <li>Fixed incorrect dates in the <code>system.parts</code> table.</li> <li>Fixed a bug that made it impossible to insert data in a <code>Replicated</code> table if <code>chroot</code> was non-empty in the configuration of the <code>ZooKeeper</code> cluster.</li> <li>Fixed the vertical merging algorithm for an empty <code>ORDER BY</code> table.</li> <li>Restored the ability to use dictionaries in queries to remote tables, even if these dictionaries are not present on the requestor server. This functionality was lost in release 1.1.54362.</li> <li>Restored the behavior for queries like <code>SELECT * FROM remote('server2', default.table) WHERE col IN (SELECT col2 FROM default.table)</code> when the right side of the <code>IN</code> should use a remote <code>default.table</code> instead of a local one. This behavior was broken in version 1.1.54358.</li> <li>Removed extraneous error-level logging of <code>Not found column ... in block</code>.</li> </ul> <h2 id=clickhouse-release-1-1-54362-2018-03-11>Clickhouse Release 1.1.54362, 2018-03-11<a class=headerlink href=#clickhouse-release-1-1-54362-2018-03-11 title="Permanent link">&para;</a></h2> <h3 id=new-features_24>New features:<a class=headerlink href=#new-features_24 title="Permanent link">&para;</a></h3> <ul> <li>Aggregation without <code>GROUP BY</code> for an empty set (such as <code>SELECT count(*) FROM table WHERE 0</code>) now returns a result with one row with null values for aggregate functions, in compliance with the SQL standard. To restore the old behavior (return an empty result), set <code>empty_result_for_aggregation_by_empty_set</code> to 1.</li> <li>Added type conversion for <code>UNION ALL</code>. Different alias names are allowed in <code>SELECT</code> positions in <code>UNION ALL</code>, in compliance with the SQL standard.</li> <li>Arbitrary expressions are supported in <code>LIMIT BY</code> clauses. Previously, it was only possible to use columns resulting from <code>SELECT</code>.</li> <li>An index of <code>MergeTree</code> tables is used when <code>IN</code> is applied to a tuple of expressions from the columns of the primary key. Example: <code>WHERE (UserID, EventDate) IN ((123, '2000-01-01'), ...)</code> (Anastasiya Tsarkova).</li> <li>Added the <code>clickhouse-copier</code> tool for copying between clusters and resharding data (beta).</li> <li>Added consistent hashing functions: <code>yandexConsistentHash</code>, <code>jumpConsistentHash</code>, <code>sumburConsistentHash</code>. They can be used as a sharding key in order to reduce the amount of network traffic during subsequent reshardings.</li> <li>Added functions: <code>arrayAny</code>, <code>arrayAll</code>, <code>hasAny</code>, <code>hasAll</code>, <code>arrayIntersect</code>, <code>arrayResize</code>.</li> <li>Added the <code>arrayCumSum</code> function (Javi Santana).</li> <li>Added the <code>parseDateTimeBestEffort</code>, <code>parseDateTimeBestEffortOrZero</code>, and <code>parseDateTimeBestEffortOrNull</code> functions to read the DateTime from a string containing text in a wide variety of possible formats.</li> <li>Data can be partially reloaded from external dictionaries during updating (load just the records in which the value of the specified field greater than in the previous download) (Arsen Hakobyan).</li> <li>Added the <code>cluster</code> table function. Example: <code>cluster(cluster_name, db, table)</code>. The <code>remote</code> table function can accept the cluster name as the first argument, if it is specified as an identifier.</li> <li>The <code>remote</code> and <code>cluster</code> table functions can be used in <code>INSERT</code> queries.</li> <li>Added the <code>create_table_query</code> and <code>engine_full</code> virtual columns to the <code>system.tables</code>table . The <code>metadata_modification_time</code> column is virtual.</li> <li>Added the <code>data_path</code> and <code>metadata_path</code> columns to <code>system.tables</code>and<code>system.databases</code> tables, and added the <code>path</code> column to the <code>system.parts</code> and <code>system.parts_columns</code> tables.</li> <li>Added additional information about merges in the <code>system.part_log</code> table.</li> <li>An arbitrary partitioning key can be used for the <code>system.query_log</code> table (Kirill Shvakov).</li> <li>The <code>SHOW TABLES</code> query now also shows temporary tables. Added temporary tables and the <code>is_temporary</code> column to <code>system.tables</code> (zhang2014).</li> <li>Added <code>DROP TEMPORARY TABLE</code> and <code>EXISTS TEMPORARY TABLE</code> queries (zhang2014).</li> <li>Support for <code>SHOW CREATE TABLE</code> for temporary tables (zhang2014).</li> <li>Added the <code>system_profile</code> configuration parameter for the settings used by internal processes.</li> <li>Support for loading <code>object_id</code> as an attribute in <code>MongoDB</code> dictionaries (Pavel Litvinenko).</li> <li>Reading <code>null</code> as the default value when loading data for an external dictionary with the <code>MongoDB</code> source (Pavel Litvinenko).</li> <li>Reading <code>DateTime</code> values in the <code>Values</code> format from a Unix timestamp without single quotes.</li> <li>Failover is supported in <code>remote</code> table functions for cases when some of the replicas are missing the requested table.</li> <li>Configuration settings can be overridden in the command line when you run <code>clickhouse-server</code>. Example: <code>clickhouse-server -- --logger.level=information</code>.</li> <li>Implemented the <code>empty</code> function from a <code>FixedString</code> argument: the function returns 1 if the string consists entirely of null bytes (zhang2014).</li> <li>Added the <code>listen_try</code>configuration parameter for listening to at least one of the listen addresses without quitting, if some of the addresses can't be listened to (useful for systems with disabled support for IPv4 or IPv6).</li> <li>Added the <code>VersionedCollapsingMergeTree</code> table engine.</li> <li>Support for rows and arbitrary numeric types for the <code>library</code> dictionary source.</li> <li><code>MergeTree</code> tables can be used without a primary key (you need to specify <code>ORDER BY tuple()</code>).</li> <li>A <code>Nullable</code> type can be <code>CAST</code> to a non-<code>Nullable</code> type if the argument is not <code>NULL</code>.</li> <li><code>RENAME TABLE</code> can be performed for <code>VIEW</code>.</li> <li>Added the <code>throwIf</code> function.</li> <li>Added the <code>odbc_default_field_size</code> option, which allows you to extend the maximum size of the value loaded from an ODBC source (by default, it is 1024).</li> <li>The <code>system.processes</code> table and <code>SHOW PROCESSLIST</code> now have the <code>is_cancelled</code> and <code>peak_memory_usage</code> columns.</li> </ul> <h3 id=improvements_22>Improvements:<a class=headerlink href=#improvements_22 title="Permanent link">&para;</a></h3> <ul> <li>Limits and quotas on the result are no longer applied to intermediate data for <code>INSERT SELECT</code> queries or for <code>SELECT</code> subqueries.</li> <li>Fewer false triggers of <code>force_restore_data</code> when checking the status of <code>Replicated</code> tables when the server starts.</li> <li>Added the <code>allow_distributed_ddl</code> option.</li> <li>Nondeterministic functions are not allowed in expressions for <code>MergeTree</code> table keys.</li> <li>Files with substitutions from <code>config.d</code> directories are loaded in alphabetical order.</li> <li>Improved performance of the <code>arrayElement</code> function in the case of a constant multidimensional array with an empty array as one of the elements. Example: <code>[[1], []][x]</code>.</li> <li>The server starts faster now when using configuration files with very large substitutions (for instance, very large lists of IP networks).</li> <li>When running a query, table valued functions run once. Previously, <code>remote</code> and <code>mysql</code> table valued functions performed the same query twice to retrieve the table structure from a remote server.</li> <li>The <code>MkDocs</code> documentation generator is used.</li> <li>When you try to delete a table column that <code>DEFAULT</code>/<code>MATERIALIZED</code> expressions of other columns depend on, an exception is thrown (zhang2014).</li> <li>Added the ability to parse an empty line in text formats as the number 0 for <code>Float</code> data types. This feature was previously available but was lost in release 1.1.54342.</li> <li><code>Enum</code> values can be used in <code>min</code>, <code>max</code>, <code>sum</code> and some other functions. In these cases, it uses the corresponding numeric values. This feature was previously available but was lost in the release 1.1.54337.</li> <li>Added <code>max_expanded_ast_elements</code> to restrict the size of the AST after recursively expanding aliases.</li> </ul> <h3 id=bug-fixes_49>Bug fixes:<a class=headerlink href=#bug-fixes_49 title="Permanent link">&para;</a></h3> <ul> <li>Fixed cases when unnecessary columns were removed from subqueries in error, or not removed from subqueries containing <code>UNION ALL</code>.</li> <li>Fixed a bug in merges for <code>ReplacingMergeTree</code> tables.</li> <li>Fixed synchronous insertions in <code>Distributed</code> tables (<code>insert_distributed_sync = 1</code>).</li> <li>Fixed segfault for certain uses of <code>FULL</code> and <code>RIGHT JOIN</code> with duplicate columns in subqueries.</li> <li>Fixed segfault for certain uses of <code>replace_running_query</code> and <code>KILL QUERY</code>.</li> <li>Fixed the order of the <code>source</code> and <code>last_exception</code> columns in the <code>system.dictionaries</code> table.</li> <li>Fixed a bug when the <code>DROP DATABASE</code> query did not delete the file with metadata.</li> <li>Fixed the <code>DROP DATABASE</code> query for <code>Dictionary</code> databases.</li> <li>Fixed the low precision of <code>uniqHLL12</code> and <code>uniqCombined</code> functions for cardinalities greater than 100 million items (Alex Bocharov).</li> <li>Fixed the calculation of implicit default values when necessary to simultaneously calculate default explicit expressions in <code>INSERT</code> queries (zhang2014).</li> <li>Fixed a rare case when a query to a <code>MergeTree</code> table couldn't finish (chenxing-xc).</li> <li>Fixed a crash that occurred when running a <code>CHECK</code> query for <code>Distributed</code> tables if all shards are local (chenxing.xc).</li> <li>Fixed a slight performance regression with functions that use regular expressions.</li> <li>Fixed a performance regression when creating multidimensional arrays from complex expressions.</li> <li>Fixed a bug that could cause an extra <code>FORMAT</code> section to appear in an <code>.sql</code> file with metadata.</li> <li>Fixed a bug that caused the <code>max_table_size_to_drop</code> limit to apply when trying to delete a <code>MATERIALIZED VIEW</code> looking at an explicitly specified table.</li> <li>Fixed incompatibility with old clients (old clients were sometimes sent data with the <code>DateTime('timezone')</code> type, which they do not understand).</li> <li>Fixed a bug when reading <code>Nested</code> column elements of structures that were added using <code>ALTER</code> but that are empty for the old partitions, when the conditions for these columns moved to <code>PREWHERE</code>.</li> <li>Fixed a bug when filtering tables by virtual <code>_table</code> columns in queries to <code>Merge</code> tables.</li> <li>Fixed a bug when using <code>ALIAS</code> columns in <code>Distributed</code> tables.</li> <li>Fixed a bug that made dynamic compilation impossible for queries with aggregate functions from the <code>quantile</code> family.</li> <li>Fixed a race condition in the query execution pipeline that occurred in very rare cases when using <code>Merge</code> tables with a large number of tables, and when using <code>GLOBAL</code> subqueries.</li> <li>Fixed a crash when passing arrays of different sizes to an <code>arrayReduce</code> function when using aggregate functions from multiple arguments.</li> <li>Prohibited the use of queries with <code>UNION ALL</code> in a <code>MATERIALIZED VIEW</code>.</li> <li>Fixed an error during initialization of the <code>part_log</code> system table when the server starts (by default, <code>part_log</code> is disabled).</li> </ul> <h3 id=backward-incompatible-changes_13>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_13 title="Permanent link">&para;</a></h3> <ul> <li>Removed the <code>distributed_ddl_allow_replicated_alter</code> option. This behavior is enabled by default.</li> <li>Removed the <code>strict_insert_defaults</code> setting. If you were using this functionality, write to <code>clickhouse-feedback@yandex-team.com</code>.</li> <li>Removed the <code>UnsortedMergeTree</code> engine.</li> </ul> <h2 id=clickhouse-release-1-1-54343-2018-02-05>Clickhouse Release 1.1.54343, 2018-02-05<a class=headerlink href=#clickhouse-release-1-1-54343-2018-02-05 title="Permanent link">&para;</a></h2> <ul> <li>Added macros support for defining cluster names in distributed DDL queries and constructors of Distributed tables: <code>CREATE TABLE distr ON CLUSTER '{cluster}' (...) ENGINE = Distributed('{cluster}', 'db', 'table')</code>.</li> <li>Now queries like <code>SELECT ... FROM table WHERE expr IN (subquery)</code> are processed using the <code>table</code> index.</li> <li>Improved processing of duplicates when inserting to Replicated tables, so they no longer slow down execution of the replication queue.</li> </ul> <h2 id=clickhouse-release-1-1-54342-2018-01-22>Clickhouse Release 1.1.54342, 2018-01-22<a class=headerlink href=#clickhouse-release-1-1-54342-2018-01-22 title="Permanent link">&para;</a></h2> <p>This release contains bug fixes for the previous release 1.1.54337:</p> <ul> <li>Fixed a regression in 1.1.54337: if the default user has readonly access, then the server refuses to start up with the message <code>Cannot create database in readonly mode</code>.</li> <li>Fixed a regression in 1.1.54337: on systems with systemd, logs are always written to syslog regardless of the configuration; the watchdog script still uses init.d.</li> <li>Fixed a regression in 1.1.54337: wrong default configuration in the Docker image.</li> <li>Fixed nondeterministic behavior of GraphiteMergeTree (you can see it in log messages <code>Data after merge is not byte-identical to the data on another replicas</code>).</li> <li>Fixed a bug that may lead to inconsistent merges after OPTIMIZE query to Replicated tables (you may see it in log messages <code>Part ... intersects the previous part</code>).</li> <li>Buffer tables now work correctly when MATERIALIZED columns are present in the destination table (by zhang2014).</li> <li>Fixed a bug in implementation of NULL.</li> </ul> <h2 id=clickhouse-release-1-1-54337-2018-01-18>Clickhouse Release 1.1.54337, 2018-01-18<a class=headerlink href=#clickhouse-release-1-1-54337-2018-01-18 title="Permanent link">&para;</a></h2> <h3 id=new-features_25>New features:<a class=headerlink href=#new-features_25 title="Permanent link">&para;</a></h3> <ul> <li>Added support for storage of multi-dimensional arrays and tuples (<code>Tuple</code> data type) in tables.</li> <li>Support for table functions for <code>DESCRIBE</code> and <code>INSERT</code> queries. Added support for subqueries in <code>DESCRIBE</code>. Examples: <code>DESC TABLE remote('host', default.hits)</code>; <code>DESC TABLE (SELECT 1)</code>; <code>INSERT INTO TABLE FUNCTION remote('host', default.hits)</code>. Support for <code>INSERT INTO TABLE</code> in addition to <code>INSERT INTO</code>.</li> <li>Improved support for time zones. The <code>DateTime</code> data type can be annotated with the timezone that is used for parsing and formatting in text formats. Example: <code>DateTime('Europe/Moscow')</code>. When timezones are specified in functions for <code>DateTime</code> arguments, the return type will track the timezone, and the value will be displayed as expected.</li> <li>Added the functions <code>toTimeZone</code>, <code>timeDiff</code>, <code>toQuarter</code>, <code>toRelativeQuarterNum</code>. The <code>toRelativeHour</code>/<code>Minute</code>/<code>Second</code> functions can take a value of type <code>Date</code> as an argument. The <code>now</code> function name is case-sensitive.</li> <li>Added the <code>toStartOfFifteenMinutes</code> function (Kirill Shvakov).</li> <li>Added the <code>clickhouse format</code> tool for formatting queries.</li> <li>Added the <code>format_schema_path</code> configuration parameter (Marek Vavruşa). It is used for specifying a schema in <code>Cap'n Proto</code> format. Schema files can be located only in the specified directory.</li> <li>Added support for config substitutions (<code>incl</code> and <code>conf.d</code>) for configuration of external dictionaries and models (Pavel Yakunin).</li> <li>Added a column with documentation for the <code>system.settings</code> table (Kirill Shvakov).</li> <li>Added the <code>system.parts_columns</code> table with information about column sizes in each data part of <code>MergeTree</code> tables.</li> <li>Added the <code>system.models</code> table with information about loaded <code>CatBoost</code> machine learning models.</li> <li>Added the <code>mysql</code> and <code>odbc</code> table function and corresponding <code>MySQL</code> and <code>ODBC</code> table engines for accessing remote databases. This functionality is in the beta stage.</li> <li>Added the possibility to pass an argument of type <code>AggregateFunction</code> for the <code>groupArray</code> aggregate function (so you can create an array of states of some aggregate function).</li> <li>Removed restrictions on various combinations of aggregate function combinators. For example, you can use <code>avgForEachIf</code> as well as <code>avgIfForEach</code> aggregate functions, which have different behaviors.</li> <li>The <code>-ForEach</code> aggregate function combinator is extended for the case of aggregate functions of multiple arguments.</li> <li>Added support for aggregate functions of <code>Nullable</code> arguments even for cases when the function returns a non-<code>Nullable</code> result (added with the contribution of Silviu Caragea). Example: <code>groupArray</code>, <code>groupUniqArray</code>, <code>topK</code>.</li> <li>Added the <code>max_client_network_bandwidth</code> for <code>clickhouse-client</code> (Kirill Shvakov).</li> <li>Users with the <code>readonly = 2</code> setting are allowed to work with TEMPORARY tables (CREATE, DROP, INSERT...) (Kirill Shvakov).</li> <li>Added support for using multiple consumers with the <code>Kafka</code> engine. Extended configuration options for <code>Kafka</code> (Marek Vavruša).</li> <li>Added the <code>intExp3</code> and <code>intExp4</code> functions.</li> <li>Added the <code>sumKahan</code> aggregate function.</li> <li>Added the to * Number<em> OrNull functions, where * Number</em> is a numeric type.</li> <li>Added support for <code>WITH</code> clauses for an <code>INSERT SELECT</code> query (author: zhang2014).</li> <li>Added settings: <code>http_connection_timeout</code>, <code>http_send_timeout</code>, <code>http_receive_timeout</code>. In particular, these settings are used for downloading data parts for replication. Changing these settings allows for faster failover if the network is overloaded.</li> <li>Added support for <code>ALTER</code> for tables of type <code>Null</code> (Anastasiya Tsarkova).</li> <li>The <code>reinterpretAsString</code> function is extended for all data types that are stored contiguously in memory.</li> <li>Added the <code>--silent</code> option for the <code>clickhouse-local</code> tool. It suppresses printing query execution info in stderr.</li> <li>Added support for reading values of type <code>Date</code> from text in a format where the month and/or day of the month is specified using a single digit instead of two digits (Amos Bird).</li> </ul> <h3 id=performance-optimizations>Performance optimizations:<a class=headerlink href=#performance-optimizations title="Permanent link">&para;</a></h3> <ul> <li>Improved performance of aggregate functions <code>min</code>, <code>max</code>, <code>any</code>, <code>anyLast</code>, <code>anyHeavy</code>, <code>argMin</code>, <code>argMax</code> from string arguments.</li> <li>Improved performance of the functions <code>isInfinite</code>, <code>isFinite</code>, <code>isNaN</code>, <code>roundToExp2</code>.</li> <li>Improved performance of parsing and formatting <code>Date</code> and <code>DateTime</code> type values in text format.</li> <li>Improved performance and precision of parsing floating point numbers.</li> <li>Lowered memory usage for <code>JOIN</code> in the case when the left and right parts have columns with identical names that are not contained in <code>USING</code> .</li> <li>Improved performance of aggregate functions <code>varSamp</code>, <code>varPop</code>, <code>stddevSamp</code>, <code>stddevPop</code>, <code>covarSamp</code>, <code>covarPop</code>, <code>corr</code> by reducing computational stability. The old functions are available under the names <code>varSampStable</code>, <code>varPopStable</code>, <code>stddevSampStable</code>, <code>stddevPopStable</code>, <code>covarSampStable</code>, <code>covarPopStable</code>, <code>corrStable</code>.</li> </ul> <h3 id=bug-fixes_50>Bug fixes:<a class=headerlink href=#bug-fixes_50 title="Permanent link">&para;</a></h3> <ul> <li>Fixed data deduplication after running a <code>DROP</code> or <code>DETACH PARTITION</code> query. In the previous version, dropping a partition and inserting the same data again was not working because inserted blocks were considered duplicates.</li> <li>Fixed a bug that could lead to incorrect interpretation of the <code>WHERE</code> clause for <code>CREATE MATERIALIZED VIEW</code> queries with <code>POPULATE</code> .</li> <li>Fixed a bug in using the <code>root_path</code> parameter in the <code>zookeeper_servers</code> configuration.</li> <li>Fixed unexpected results of passing the <code>Date</code> argument to <code>toStartOfDay</code> .</li> <li>Fixed the <code>addMonths</code> and <code>subtractMonths</code> functions and the arithmetic for <code>INTERVAL n MONTH</code> in cases when the result has the previous year.</li> <li>Added missing support for the <code>UUID</code> data type for <code>DISTINCT</code> , <code>JOIN</code> , and <code>uniq</code> aggregate functions and external dictionaries (Evgeniy Ivanov). Support for <code>UUID</code> is still incomplete.</li> <li>Fixed <code>SummingMergeTree</code> behavior in cases when the rows summed to zero.</li> <li>Various fixes for the <code>Kafka</code> engine (Marek Vavruša).</li> <li>Fixed incorrect behavior of the <code>Join</code> table engine (Amos Bird).</li> <li>Fixed incorrect allocator behavior under FreeBSD and OS X.</li> <li>The <code>extractAll</code> function now supports empty matches.</li> <li>Fixed an error that blocked usage of <code>libressl</code> instead of <code>openssl</code> .</li> <li>Fixed the <code>CREATE TABLE AS SELECT</code> query from temporary tables.</li> <li>Fixed non-atomicity of updating the replication queue. This could lead to replicas being out of sync until the server restarts.</li> <li>Fixed possible overflow in <code>gcd</code> , <code>lcm</code> and <code>modulo</code> (<code>%</code> operator) (Maks Skorokhod).</li> <li><code>-preprocessed</code> files are now created after changing <code>umask</code> (<code>umask</code> can be changed in the config).</li> <li>Fixed a bug in the background check of parts (<code>MergeTreePartChecker</code> ) when using a custom partition key.</li> <li>Fixed parsing of tuples (values of the <code>Tuple</code> data type) in text formats.</li> <li>Improved error messages about incompatible types passed to <code>multiIf</code> , <code>array</code> and some other functions.</li> <li>Redesigned support for <code>Nullable</code> types. Fixed bugs that may lead to a server crash. Fixed almost all other bugs related to <code>NULL</code> support: incorrect type conversions in INSERT SELECT, insufficient support for Nullable in HAVING and PREWHERE, <code>join_use_nulls</code> mode, Nullable types as arguments of <code>OR</code> operator, etc.</li> <li>Fixed various bugs related to internal semantics of data types. Examples: unnecessary summing of <code>Enum</code> type fields in <code>SummingMergeTree</code> ; alignment of <code>Enum</code> types in <code>Pretty</code> formats, etc.</li> <li>Stricter checks for allowed combinations of composite columns.</li> <li>Fixed the overflow when specifying a very large parameter for the <code>FixedString</code> data type.</li> <li>Fixed a bug in the <code>topK</code> aggregate function in a generic case.</li> <li>Added the missing check for equality of array sizes in arguments of n-ary variants of aggregate functions with an <code>-Array</code> combinator.</li> <li>Fixed a bug in <code>--pager</code> for <code>clickhouse-client</code> (author: ks1322).</li> <li>Fixed the precision of the <code>exp10</code> function.</li> <li>Fixed the behavior of the <code>visitParamExtract</code> function for better compliance with documentation.</li> <li>Fixed the crash when incorrect data types are specified.</li> <li>Fixed the behavior of <code>DISTINCT</code> in the case when all columns are constants.</li> <li>Fixed query formatting in the case of using the <code>tupleElement</code> function with a complex constant expression as the tuple element index.</li> <li>Fixed a bug in <code>Dictionary</code> tables for <code>range_hashed</code> dictionaries.</li> <li>Fixed a bug that leads to excessive rows in the result of <code>FULL</code> and <code>RIGHT JOIN</code> (Amos Bird).</li> <li>Fixed a server crash when creating and removing temporary files in <code>config.d</code> directories during config reload.</li> <li>Fixed the <code>SYSTEM DROP DNS CACHE</code> query: the cache was flushed but addresses of cluster nodes were not updated.</li> <li>Fixed the behavior of <code>MATERIALIZED VIEW</code> after executing <code>DETACH TABLE</code> for the table under the view (Marek Vavruša).</li> </ul> <h3 id=build-improvements_4>Build improvements:<a class=headerlink href=#build-improvements_4 title="Permanent link">&para;</a></h3> <ul> <li>The <code>pbuilder</code> tool is used for builds. The build process is almost completely independent of the build host environment.</li> <li>A single build is used for different OS versions. Packages and binaries have been made compatible with a wide range of Linux systems.</li> <li>Added the <code>clickhouse-test</code> package. It can be used to run functional tests.</li> <li>The source tarball can now be published to the repository. It can be used to reproduce the build without using GitHub.</li> <li>Added limited integration with Travis CI. Due to limits on build time in Travis, only the debug build is tested and a limited subset of tests are run.</li> <li>Added support for <code>Cap'n'Proto</code> in the default build.</li> <li>Changed the format of documentation sources from <code>Restricted Text</code> to <code>Markdown</code>.</li> <li>Added support for <code>systemd</code> (Vladimir Smirnov). It is disabled by default due to incompatibility with some OS images and can be enabled manually.</li> <li>For dynamic code generation, <code>clang</code> and <code>lld</code> are embedded into the <code>clickhouse</code> binary. They can also be invoked as <code>clickhouse clang</code> and <code>clickhouse lld</code> .</li> <li>Removed usage of GNU extensions from the code. Enabled the <code>-Wextra</code> option. When building with <code>clang</code> the default is <code>libc++</code> instead of <code>libstdc++</code>.</li> <li>Extracted <code>clickhouse_parsers</code> and <code>clickhouse_common_io</code> libraries to speed up builds of various tools.</li> </ul> <h3 id=backward-incompatible-changes_14>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_14 title="Permanent link">&para;</a></h3> <ul> <li>The format for marks in <code>Log</code> type tables that contain <code>Nullable</code> columns was changed in a backward incompatible way. If you have these tables, you should convert them to the <code>TinyLog</code> type before starting up the new server version. To do this, replace <code>ENGINE = Log</code> with <code>ENGINE = TinyLog</code> in the corresponding <code>.sql</code> file in the <code>metadata</code> directory. If your table doesn't have <code>Nullable</code> columns or if the type of your table is not <code>Log</code>, then you don't need to do anything.</li> <li>Removed the <code>experimental_allow_extended_storage_definition_syntax</code> setting. Now this feature is enabled by default.</li> <li>The <code>runningIncome</code> function was renamed to <code>runningDifferenceStartingWithFirstvalue</code> to avoid confusion.</li> <li>Removed the <code>FROM ARRAY JOIN arr</code> syntax when ARRAY JOIN is specified directly after FROM with no table (Amos Bird).</li> <li>Removed the <code>BlockTabSeparated</code> format that was used solely for demonstration purposes.</li> <li>Changed the state format for aggregate functions <code>varSamp</code>, <code>varPop</code>, <code>stddevSamp</code>, <code>stddevPop</code>, <code>covarSamp</code>, <code>covarPop</code>, <code>corr</code>. If you have stored states of these aggregate functions in tables (using the <code>AggregateFunction</code> data type or materialized views with corresponding states), please write to <a href=mailto:clickhouse-feedback@yandex-team.com>&#99;&#108;&#105;&#99;&#107;&#104;&#111;&#117;&#115;&#101;&#45;&#102;&#101;&#101;&#100;&#98;&#97;&#99;&#107;&#64;&#121;&#97;&#110;&#100;&#101;&#120;&#45;&#116;&#101;&#97;&#109;&#46;&#99;&#111;&#109;</a>.</li> <li>In previous server versions there was an undocumented feature: if an aggregate function depends on parameters, you can still specify it without parameters in the AggregateFunction data type. Example: <code>AggregateFunction(quantiles, UInt64)</code> instead of <code>AggregateFunction(quantiles(0.5, 0.9), UInt64)</code>. This feature was lost. Although it was undocumented, we plan to support it again in future releases.</li> <li>Enum data types cannot be used in min/max aggregate functions. This ability will be returned in the next release.</li> </ul> <h3 id=please-note-when-upgrading>Please note when upgrading:<a class=headerlink href=#please-note-when-upgrading title="Permanent link">&para;</a></h3> <ul> <li>When doing a rolling update on a cluster, at the point when some of the replicas are running the old version of ClickHouse and some are running the new version, replication is temporarily stopped and the message <code>unknown parameter 'shard'</code> appears in the log. Replication will continue after all replicas of the cluster are updated.</li> <li>If different versions of ClickHouse are running on the cluster servers, it is possible that distributed queries using the following functions will have incorrect results: <code>varSamp</code>, <code>varPop</code>, <code>stddevSamp</code>, <code>stddevPop</code>, <code>covarSamp</code>, <code>covarPop</code>, <code>corr</code>. You should update all cluster nodes.</li> </ul> <h2 id=clickhouse-release-1-1-54327-2017-12-21>ClickHouse release 1.1.54327, 2017-12-21<a class=headerlink href=#clickhouse-release-1-1-54327-2017-12-21 title="Permanent link">&para;</a></h2> <p>This release contains bug fixes for the previous release 1.1.54318:</p> <ul> <li>Fixed bug with possible race condition in replication that could lead to data loss. This issue affects versions 1.1.54310 and 1.1.54318. If you use one of these versions with Replicated tables, the update is strongly recommended. This issue shows in logs in Warning messages like <code>Part ... from own log doesn't exist.</code> The issue is relevant even if you don't see these messages in logs.</li> </ul> <h2 id=clickhouse-release-1-1-54318-2017-11-30>ClickHouse release 1.1.54318, 2017-11-30<a class=headerlink href=#clickhouse-release-1-1-54318-2017-11-30 title="Permanent link">&para;</a></h2> <p>This release contains bug fixes for the previous release 1.1.54310:</p> <ul> <li>Fixed incorrect row deletions during merges in the SummingMergeTree engine</li> <li>Fixed a memory leak in unreplicated MergeTree engines</li> <li>Fixed performance degradation with frequent inserts in MergeTree engines</li> <li>Fixed an issue that was causing the replication queue to stop running</li> <li>Fixed rotation and archiving of server logs</li> </ul> <h2 id=clickhouse-release-1-1-54310-2017-11-01>ClickHouse release 1.1.54310, 2017-11-01<a class=headerlink href=#clickhouse-release-1-1-54310-2017-11-01 title="Permanent link">&para;</a></h2> <h3 id=new-features_26>New features:<a class=headerlink href=#new-features_26 title="Permanent link">&para;</a></h3> <ul> <li>Custom partitioning key for the MergeTree family of table engines.</li> <li><a href=https://clickhouse.yandex/docs/en/operations/table_engines/kafka/ rel="external nofollow noreferrer">Kafka</a> table engine.</li> <li>Added support for loading <a href=https://catboost.yandex/ rel="external nofollow noreferrer">CatBoost</a> models and applying them to data stored in ClickHouse.</li> <li>Added support for time zones with non-integer offsets from UTC.</li> <li>Added support for arithmetic operations with time intervals.</li> <li>The range of values for the Date and DateTime types is extended to the year 2105.</li> <li>Added the <code>CREATE MATERIALIZED VIEW x TO y</code> query (specifies an existing table for storing the data of a materialized view).</li> <li>Added the <code>ATTACH TABLE</code> query without arguments.</li> <li>The processing logic for Nested columns with names ending in -Map in a SummingMergeTree table was extracted to the sumMap aggregate function. You can now specify such columns explicitly.</li> <li>Max size of the IP trie dictionary is increased to 128M entries.</li> <li>Added the getSizeOfEnumType function.</li> <li>Added the sumWithOverflow aggregate function.</li> <li>Added support for the Cap'n Proto input format.</li> <li>You can now customize compression level when using the zstd algorithm.</li> </ul> <h3 id=backward-incompatible-changes_15>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_15 title="Permanent link">&para;</a></h3> <ul> <li>Creation of temporary tables with an engine other than Memory is not allowed.</li> <li>Explicit creation of tables with the View or MaterializedView engine is not allowed.</li> <li>During table creation, a new check verifies that the sampling key expression is included in the primary key.</li> </ul> <h3 id=bug-fixes_51>Bug fixes:<a class=headerlink href=#bug-fixes_51 title="Permanent link">&para;</a></h3> <ul> <li>Fixed hangups when synchronously inserting into a Distributed table.</li> <li>Fixed nonatomic adding and removing of parts in Replicated tables.</li> <li>Data inserted into a materialized view is not subjected to unnecessary deduplication.</li> <li>Executing a query to a Distributed table for which the local replica is lagging and remote replicas are unavailable does not result in an error anymore.</li> <li>Users don't need access permissions to the <code>default</code> database to create temporary tables anymore.</li> <li>Fixed crashing when specifying the Array type without arguments.</li> <li>Fixed hangups when the disk volume containing server logs is full.</li> <li>Fixed an overflow in the toRelativeWeekNum function for the first week of the Unix epoch.</li> </ul> <h3 id=build-improvements_5>Build improvements:<a class=headerlink href=#build-improvements_5 title="Permanent link">&para;</a></h3> <ul> <li>Several third-party libraries (notably Poco) were updated and converted to git submodules.</li> </ul> <h2 id=clickhouse-release-1-1-54304-2017-10-19>ClickHouse release 1.1.54304, 2017-10-19<a class=headerlink href=#clickhouse-release-1-1-54304-2017-10-19 title="Permanent link">&para;</a></h2> <h3 id=new-features_27>New features:<a class=headerlink href=#new-features_27 title="Permanent link">&para;</a></h3> <ul> <li>TLS support in the native protocol (to enable, set <code>tcp_ssl_port</code> in <code>config.xml</code> ).</li> </ul> <h3 id=bug-fixes_52>Bug fixes:<a class=headerlink href=#bug-fixes_52 title="Permanent link">&para;</a></h3> <ul> <li><code>ALTER</code> for replicated tables now tries to start running as soon as possible.</li> <li>Fixed crashing when reading data with the setting <code>preferred_block_size_bytes=0.</code></li> <li>Fixed crashes of <code>clickhouse-client</code> when pressing <code>Page Down</code></li> <li>Correct interpretation of certain complex queries with <code>GLOBAL IN</code> and <code>UNION ALL</code></li> <li><code>FREEZE PARTITION</code> always works atomically now.</li> <li>Empty POST requests now return a response with code 411.</li> <li>Fixed interpretation errors for expressions like <code>CAST(1 AS Nullable(UInt8)).</code></li> <li>Fixed an error when reading <code>Array(Nullable(String))</code> columns from <code>MergeTree</code> tables.</li> <li>Fixed crashing when parsing queries like <code>SELECT dummy AS dummy, dummy AS b</code></li> <li>Users are updated correctly with invalid <code>users.xml</code></li> <li>Correct handling when an executable dictionary returns a non-zero response code.</li> </ul> <h2 id=clickhouse-release-1-1-54292-2017-09-20>ClickHouse release 1.1.54292, 2017-09-20<a class=headerlink href=#clickhouse-release-1-1-54292-2017-09-20 title="Permanent link">&para;</a></h2> <h3 id=new-features_28>New features:<a class=headerlink href=#new-features_28 title="Permanent link">&para;</a></h3> <ul> <li>Added the <code>pointInPolygon</code> function for working with coordinates on a coordinate plane.</li> <li>Added the <code>sumMap</code> aggregate function for calculating the sum of arrays, similar to <code>SummingMergeTree</code>.</li> <li>Added the <code>trunc</code> function. Improved performance of the rounding functions (<code>round</code>, <code>floor</code>, <code>ceil</code>, <code>roundToExp2</code>) and corrected the logic of how they work. Changed the logic of the <code>roundToExp2</code> function for fractions and negative numbers.</li> <li>The ClickHouse executable file is now less dependent on the libc version. The same ClickHouse executable file can run on a wide variety of Linux systems. There is still a dependency when using compiled queries (with the setting <code>compile = 1</code> , which is not used by default).</li> <li>Reduced the time needed for dynamic compilation of queries.</li> </ul> <h3 id=bug-fixes_53>Bug fixes:<a class=headerlink href=#bug-fixes_53 title="Permanent link">&para;</a></h3> <ul> <li>Fixed an error that sometimes produced <code>part ... intersects previous part</code> messages and weakened replica consistency.</li> <li>Fixed an error that caused the server to lock up if ZooKeeper was unavailable during shutdown.</li> <li>Removed excessive logging when restoring replicas.</li> <li>Fixed an error in the UNION ALL implementation.</li> <li>Fixed an error in the concat function that occurred if the first column in a block has the Array type.</li> <li>Progress is now displayed correctly in the system.merges table.</li> </ul> <h2 id=clickhouse-release-1-1-54289-2017-09-13>ClickHouse release 1.1.54289, 2017-09-13<a class=headerlink href=#clickhouse-release-1-1-54289-2017-09-13 title="Permanent link">&para;</a></h2> <h3 id=new-features_29>New features:<a class=headerlink href=#new-features_29 title="Permanent link">&para;</a></h3> <ul> <li><code>SYSTEM</code> queries for server administration: <code>SYSTEM RELOAD DICTIONARY</code>, <code>SYSTEM RELOAD DICTIONARIES</code>, <code>SYSTEM DROP DNS CACHE</code>, <code>SYSTEM SHUTDOWN</code>, <code>SYSTEM KILL</code>.</li> <li>Added functions for working with arrays: <code>concat</code>, <code>arraySlice</code>, <code>arrayPushBack</code>, <code>arrayPushFront</code>, <code>arrayPopBack</code>, <code>arrayPopFront</code>.</li> <li>Added <code>root</code> and <code>identity</code> parameters for the ZooKeeper configuration. This allows you to isolate individual users on the same ZooKeeper cluster.</li> <li>Added aggregate functions <code>groupBitAnd</code>, <code>groupBitOr</code>, and <code>groupBitXor</code> (for compatibility, they are also available under the names <code>BIT_AND</code>, <code>BIT_OR</code>, and <code>BIT_XOR</code>).</li> <li>External dictionaries can be loaded from MySQL by specifying a socket in the filesystem.</li> <li>External dictionaries can be loaded from MySQL over SSL (<code>ssl_cert</code>, <code>ssl_key</code>, <code>ssl_ca</code> parameters).</li> <li>Added the <code>max_network_bandwidth_for_user</code> setting to restrict the overall bandwidth use for queries per user.</li> <li>Support for <code>DROP TABLE</code> for temporary tables.</li> <li>Support for reading <code>DateTime</code> values in Unix timestamp format from the <code>CSV</code> and <code>JSONEachRow</code> formats.</li> <li>Lagging replicas in distributed queries are now excluded by default (the default threshold is 5 minutes).</li> <li>FIFO locking is used during ALTER: an ALTER query isn't blocked indefinitely for continuously running queries.</li> <li>Option to set <code>umask</code> in the config file.</li> <li>Improved performance for queries with <code>DISTINCT</code> .</li> </ul> <h3 id=bug-fixes_54>Bug fixes:<a class=headerlink href=#bug-fixes_54 title="Permanent link">&para;</a></h3> <ul> <li>Improved the process for deleting old nodes in ZooKeeper. Previously, old nodes sometimes didn't get deleted if there were very frequent inserts, which caused the server to be slow to shut down, among other things.</li> <li>Fixed randomization when choosing hosts for the connection to ZooKeeper.</li> <li>Fixed the exclusion of lagging replicas in distributed queries if the replica is localhost.</li> <li>Fixed an error where a data part in a <code>ReplicatedMergeTree</code> table could be broken after running <code>ALTER MODIFY</code> on an element in a <code>Nested</code> structure.</li> <li>Fixed an error that could cause SELECT queries to "hang".</li> <li>Improvements to distributed DDL queries.</li> <li>Fixed the query <code>CREATE TABLE ... AS &lt;materialized view&gt;</code>.</li> <li>Resolved the deadlock in the <code>ALTER ... CLEAR COLUMN IN PARTITION</code> query for <code>Buffer</code> tables.</li> <li>Fixed the invalid default value for <code>Enum</code> s (0 instead of the minimum) when using the <code>JSONEachRow</code> and <code>TSKV</code> formats.</li> <li>Resolved the appearance of zombie processes when using a dictionary with an <code>executable</code> source.</li> <li>Fixed segfault for the HEAD query.</li> </ul> <h3 id=improved-workflow-for-developing-and-assembling-clickhouse>Improved workflow for developing and assembling ClickHouse:<a class=headerlink href=#improved-workflow-for-developing-and-assembling-clickhouse title="Permanent link">&para;</a></h3> <ul> <li>You can use <code>pbuilder</code> to build ClickHouse.</li> <li>You can use <code>libc++</code> instead of <code>libstdc++</code> for builds on Linux.</li> <li>Added instructions for using static code analysis tools: <code>Coverage</code>, <code>clang-tidy</code>, <code>cppcheck</code>.</li> </ul> <h3 id=please-note-when-upgrading_1>Please note when upgrading:<a class=headerlink href=#please-note-when-upgrading_1 title="Permanent link">&para;</a></h3> <ul> <li>There is now a higher default value for the MergeTree setting <code>max_bytes_to_merge_at_max_space_in_pool</code> (the maximum total size of data parts to merge, in bytes): it has increased from 100 GiB to 150 GiB. This might result in large merges running after the server upgrade, which could cause an increased load on the disk subsystem. If the free space available on the server is less than twice the total amount of the merges that are running, this will cause all other merges to stop running, including merges of small data parts. As a result, INSERT queries will fail with the message "Merges are processing significantly slower than inserts." Use the <code>SELECT * FROM system.merges</code> query to monitor the situation. You can also check the <code>DiskSpaceReservedForMerge</code> metric in the <code>system.metrics</code> table, or in Graphite. You don't need to do anything to fix this, since the issue will resolve itself once the large merges finish. If you find this unacceptable, you can restore the previous value for the <code>max_bytes_to_merge_at_max_space_in_pool</code> setting. To do this, go to the <merge_tree> section in config.xml, set <code>&lt;merge_tree&gt;``&lt;max_bytes_to_merge_at_max_space_in_pool&gt;107374182400&lt;/max_bytes_to_merge_at_max_space_in_pool&gt;</code> and restart the server.</li> </ul> <h2 id=clickhouse-release-1-1-54284-2017-08-29>ClickHouse release 1.1.54284, 2017-08-29<a class=headerlink href=#clickhouse-release-1-1-54284-2017-08-29 title="Permanent link">&para;</a></h2> <ul> <li>This is a bugfix release for the previous 1.1.54282 release. It fixes leaks in the parts directory in ZooKeeper.</li> </ul> <h2 id=clickhouse-release-1-1-54282-2017-08-23>ClickHouse release 1.1.54282, 2017-08-23<a class=headerlink href=#clickhouse-release-1-1-54282-2017-08-23 title="Permanent link">&para;</a></h2> <p>This release contains bug fixes for the previous release 1.1.54276:</p> <ul> <li>Fixed <code>DB::Exception: Assertion violation: !_path.empty()</code> when inserting into a Distributed table.</li> <li>Fixed parsing when inserting in RowBinary format if input data starts with';'.</li> <li>Errors during runtime compilation of certain aggregate functions (e.g. <code>groupArray()</code>).</li> </ul> <h2 id=clickhouse-release-1-1-54276-2017-08-16>Clickhouse Release 1.1.54276, 2017-08-16<a class=headerlink href=#clickhouse-release-1-1-54276-2017-08-16 title="Permanent link">&para;</a></h2> <h3 id=new-features_30>New features:<a class=headerlink href=#new-features_30 title="Permanent link">&para;</a></h3> <ul> <li>Added an optional WITH section for a SELECT query. Example query: <code>WITH 1+1 AS a SELECT a, a*a</code></li> <li>INSERT can be performed synchronously in a Distributed table: OK is returned only after all the data is saved on all the shards. This is activated by the setting insert_distributed_sync=1.</li> <li>Added the UUID data type for working with 16-byte identifiers.</li> <li>Added aliases of CHAR, FLOAT and other types for compatibility with the Tableau.</li> <li>Added the functions toYYYYMM, toYYYYMMDD, and toYYYYMMDDhhmmss for converting time into numbers.</li> <li>You can use IP addresses (together with the hostname) to identify servers for clustered DDL queries.</li> <li>Added support for non-constant arguments and negative offsets in the function <code>substring(str, pos, len).</code></li> <li>Added the max_size parameter for the <code>groupArray(max_size)(column)</code> aggregate function, and optimized its performance.</li> </ul> <h3 id=main-changes>Main changes:<a class=headerlink href=#main-changes title="Permanent link">&para;</a></h3> <ul> <li>Security improvements: all server files are created with 0640 permissions (can be changed via <umask> config parameter).</li> <li>Improved error messages for queries with invalid syntax.</li> <li>Significantly reduced memory consumption and improved performance when merging large sections of MergeTree data.</li> <li>Significantly increased the performance of data merges for the ReplacingMergeTree engine.</li> <li>Improved performance for asynchronous inserts from a Distributed table by combining multiple source inserts. To enable this functionality, use the setting distributed_directory_monitor_batch_inserts=1.</li> </ul> <h3 id=backward-incompatible-changes_16>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_16 title="Permanent link">&para;</a></h3> <ul> <li>Changed the binary format of aggregate states of <code>groupArray(array_column)</code> functions for arrays.</li> </ul> <h3 id=complete-list-of-changes>Complete list of changes:<a class=headerlink href=#complete-list-of-changes title="Permanent link">&para;</a></h3> <ul> <li>Added the <code>output_format_json_quote_denormals</code> setting, which enables outputting nan and inf values in JSON format.</li> <li>Optimized stream allocation when reading from a Distributed table.</li> <li>Settings can be configured in readonly mode if the value doesn't change.</li> <li>Added the ability to retrieve non-integer granules of the MergeTree engine in order to meet restrictions on the block size specified in the preferred_block_size_bytes setting. The purpose is to reduce the consumption of RAM and increase cache locality when processing queries from tables with large columns.</li> <li>Efficient use of indexes that contain expressions like <code>toStartOfHour(x)</code> for conditions like <code>toStartOfHour(x) op сonstexpr.</code></li> <li>Added new settings for MergeTree engines (the merge_tree section in config.xml):</li> <li>replicated_deduplication_window_seconds sets the number of seconds allowed for deduplicating inserts in Replicated tables.</li> <li>cleanup_delay_period sets how often to start cleanup to remove outdated data.</li> <li>replicated_can_become_leader can prevent a replica from becoming the leader (and assigning merges).</li> <li>Accelerated cleanup to remove outdated data from ZooKeeper.</li> <li>Multiple improvements and fixes for clustered DDL queries. Of particular interest is the new setting distributed_ddl_task_timeout, which limits the time to wait for a response from the servers in the cluster. If a ddl request has not been performed on all hosts, a response will contain a timeout error and a request will be executed in an async mode.</li> <li>Improved display of stack traces in the server logs.</li> <li>Added the "none" value for the compression method.</li> <li>You can use multiple dictionaries_config sections in config.xml.</li> <li>It is possible to connect to MySQL through a socket in the file system.</li> <li>The system.parts table has a new column with information about the size of marks, in bytes.</li> </ul> <h3 id=bug-fixes_55>Bug fixes:<a class=headerlink href=#bug-fixes_55 title="Permanent link">&para;</a></h3> <ul> <li>Distributed tables using a Merge table now work correctly for a SELECT query with a condition on the <code>_table</code> field.</li> <li>Fixed a rare race condition in ReplicatedMergeTree when checking data parts.</li> <li>Fixed possible freezing on "leader election" when starting a server.</li> <li>The max_replica_delay_for_distributed_queries setting was ignored when using a local replica of the data source. This has been fixed.</li> <li>Fixed incorrect behavior of <code>ALTER TABLE CLEAR COLUMN IN PARTITION</code> when attempting to clean a non-existing column.</li> <li>Fixed an exception in the multiIf function when using empty arrays or strings.</li> <li>Fixed excessive memory allocations when deserializing Native format.</li> <li>Fixed incorrect auto-update of Trie dictionaries.</li> <li>Fixed an exception when running queries with a GROUP BY clause from a Merge table when using SAMPLE.</li> <li>Fixed a crash of GROUP BY when using distributed_aggregation_memory_efficient=1.</li> <li>Now you can specify the database.table in the right side of IN and JOIN.</li> <li>Too many threads were used for parallel aggregation. This has been fixed.</li> <li>Fixed how the "if" function works with FixedString arguments.</li> <li>SELECT worked incorrectly from a Distributed table for shards with a weight of 0. This has been fixed.</li> <li>Running <code>CREATE VIEW IF EXISTS no longer causes crashes.</code></li> <li>Fixed incorrect behavior when input_format_skip_unknown_fields=1 is set and there are negative numbers.</li> <li>Fixed an infinite loop in the <code>dictGetHierarchy()</code> function if there is some invalid data in the dictionary.</li> <li>Fixed <code>Syntax error: unexpected (...)</code> errors when running distributed queries with subqueries in an IN or JOIN clause and Merge tables.</li> <li>Fixed an incorrect interpretation of a SELECT query from Dictionary tables.</li> <li>Fixed the "Cannot mremap" error when using arrays in IN and JOIN clauses with more than 2 billion elements.</li> <li>Fixed the failover for dictionaries with MySQL as the source.</li> </ul> <h3 id=improved-workflow-for-developing-and-assembling-clickhouse_1>Improved workflow for developing and assembling ClickHouse:<a class=headerlink href=#improved-workflow-for-developing-and-assembling-clickhouse_1 title="Permanent link">&para;</a></h3> <ul> <li>Builds can be assembled in Arcadia.</li> <li>You can use gcc 7 to compile ClickHouse.</li> <li>Parallel builds using ccache+distcc are faster now.</li> </ul> <h2 id=clickhouse-release-1-1-54245-2017-07-04>ClickHouse release 1.1.54245, 2017-07-04<a class=headerlink href=#clickhouse-release-1-1-54245-2017-07-04 title="Permanent link">&para;</a></h2> <h3 id=new-features_31>New features:<a class=headerlink href=#new-features_31 title="Permanent link">&para;</a></h3> <ul> <li>Distributed DDL (for example, <code>CREATE TABLE ON CLUSTER</code>)</li> <li>The replicated query <code>ALTER TABLE CLEAR COLUMN IN PARTITION.</code></li> <li>The engine for Dictionary tables (access to dictionary data in the form of a table).</li> <li>Dictionary database engine (this type of database automatically has Dictionary tables available for all the connected external dictionaries).</li> <li>You can check for updates to the dictionary by sending a request to the source.</li> <li>Qualified column names</li> <li>Quoting identifiers using double quotation marks.</li> <li>Sessions in the HTTP interface.</li> <li>The OPTIMIZE query for a Replicated table can can run not only on the leader.</li> </ul> <h3 id=backward-incompatible-changes_17>Backward incompatible changes:<a class=headerlink href=#backward-incompatible-changes_17 title="Permanent link">&para;</a></h3> <ul> <li>Removed SET GLOBAL.</li> </ul> <h3 id=minor-changes>Minor changes:<a class=headerlink href=#minor-changes title="Permanent link">&para;</a></h3> <ul> <li>Now after an alert is triggered, the log prints the full stack trace.</li> <li>Relaxed the verification of the number of damaged/extra data parts at startup (there were too many false positives).</li> </ul> <h3 id=bug-fixes_56>Bug fixes:<a class=headerlink href=#bug-fixes_56 title="Permanent link">&para;</a></h3> <ul> <li>Fixed a bad connection "sticking" when inserting into a Distributed table.</li> <li>GLOBAL IN now works for a query from a Merge table that looks at a Distributed table.</li> <li>The incorrect number of cores was detected on a Google Compute Engine virtual machine. This has been fixed.</li> <li>Changes in how an executable source of cached external dictionaries works.</li> <li>Fixed the comparison of strings containing null characters.</li> <li>Fixed the comparison of Float32 primary key fields with constants.</li> <li>Previously, an incorrect estimate of the size of a field could lead to overly large allocations.</li> <li>Fixed a crash when querying a Nullable column added to a table using ALTER.</li> <li>Fixed a crash when sorting by a Nullable column, if the number of rows is less than LIMIT.</li> <li>Fixed an ORDER BY subquery consisting of only constant values.</li> <li>Previously, a Replicated table could remain in the invalid state after a failed DROP TABLE.</li> <li>Aliases for scalar subqueries with empty results are no longer lost.</li> <li>Now a query that used compilation does not fail with an error if the .so file gets damaged.</li> </ul> </div> <div id=content-footer class="text-muted pt-5"> <div class=float-right>©2016–2020 Yandex LLC</div> <div>ساخته شده از <a href=https://github.com/ClickHouse/ClickHouse/commit/d6653f1fdcabbf1f588ee132a5044c31df63261a rel="external nofollow noreferrer" target=_blank class=text-reset>d6653f1fdc</a></div> </div> </div> <div id=toc class="col-xl-2 d-none d-xl-block d-print-none p-3 overflow-auto toc-right mb-5"> <nav class="nav flex-column text-wrap"> <label for=toc>جدول محتویات</label> <a href=#clickhouse-release-v19-16-2-2-2019-10-30 title="ClickHouse release v19.16.2.2, 2019-10-30" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release v19.16.2.2, 2019-10-30 </a> <nav id=toc-toc-1 class="nav flex-column pl-2"> <a href=#backward-incompatible-change title="Backward Incompatible Change" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Change </a> <a href=#new-feature title="New Feature" class="nav-link text-wrap d-inline-block w-100"> New Feature </a> <a href=#bug-fix title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#improvement title=Improvement class="nav-link text-wrap d-inline-block w-100"> Improvement </a> <a href=#performance-improvement title="Performance Improvement" class="nav-link text-wrap d-inline-block w-100"> Performance Improvement </a> <a href=#build-testing-packaging-improvement title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> <a href=#code-cleanup title="Code cleanup" class="nav-link text-wrap d-inline-block w-100"> Code cleanup </a> </nav> <a href=#clickhouse-release-19-15-4-10-2019-10-31 title="ClickHouse release 19.15.4.10, 2019-10-31" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.15.4.10, 2019-10-31 </a> <nav id=toc-toc-2 class="nav flex-column pl-2"> <a href=#bug-fix_1 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-15-3-6-2019-10-09 title="ClickHouse release 19.15.3.6, 2019-10-09" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.15.3.6, 2019-10-09 </a> <nav id=toc-toc-3 class="nav flex-column pl-2"> <a href=#bug-fix_2 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-15-2-2-2019-10-01 title="ClickHouse release 19.15.2.2, 2019-10-01" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.15.2.2, 2019-10-01 </a> <nav id=toc-toc-4 class="nav flex-column pl-2"> <a href=#new-feature_1 title="New Feature" class="nav-link text-wrap d-inline-block w-100"> New Feature </a> <a href=#experimental-feature title="Experimental Feature" class="nav-link text-wrap d-inline-block w-100"> Experimental Feature </a> <a href=#improvement_1 title=Improvement class="nav-link text-wrap d-inline-block w-100"> Improvement </a> <a href=#build-testing-packaging-improvement_1 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> <a href=#bug-fix_3 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#backward-incompatible-change_1 title="Backward Incompatible Change" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Change </a> </nav> <a href=#clickhouse-release-19-14-7-15-2019-10-02 title="ClickHouse release 19.14.7.15, 2019-10-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.14.7.15, 2019-10-02 </a> <nav id=toc-toc-5 class="nav flex-column pl-2"> <a href=#bug-fix_4 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-14-6-12-2019-09-19 title="ClickHouse release 19.14.6.12, 2019-09-19" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.14.6.12, 2019-09-19 </a> <nav id=toc-toc-6 class="nav flex-column pl-2"> <a href=#bug-fix_5 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#build-testing-packaging-improvement_2 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> </nav> <a href=#clickhouse-release-19-14-3-3-2019-09-10 title="ClickHouse release 19.14.3.3, 2019-09-10" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.14.3.3, 2019-09-10 </a> <nav id=toc-toc-7 class="nav flex-column pl-2"> <a href=#new-feature_2 title="New Feature" class="nav-link text-wrap d-inline-block w-100"> New Feature </a> <a href=#experimental-feature_1 title="Experimental Feature" class="nav-link text-wrap d-inline-block w-100"> Experimental Feature </a> <a href=#bug-fix_6 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#security-fix title="Security Fix" class="nav-link text-wrap d-inline-block w-100"> Security Fix </a> <a href=#improvement_2 title=Improvement class="nav-link text-wrap d-inline-block w-100"> Improvement </a> <a href=#performance-improvement_1 title="Performance Improvement" class="nav-link text-wrap d-inline-block w-100"> Performance Improvement </a> <a href=#build-testing-packaging-improvement_3 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> <a href=#backward-incompatible-change_2 title="Backward Incompatible Change" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Change </a> </nav> <a href=#clickhouse-release-19-13-6-51-2019-10-02 title="ClickHouse release 19.13.6.51, 2019-10-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.13.6.51, 2019-10-02 </a> <nav id=toc-toc-8 class="nav flex-column pl-2"> <a href=#bug-fix_7 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-13-5-44-2019-09-20 title="ClickHouse release 19.13.5.44, 2019-09-20" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.13.5.44, 2019-09-20 </a> <nav id=toc-toc-9 class="nav flex-column pl-2"> <a href=#bug-fix_8 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-13-4-32-2019-09-10 title="ClickHouse release 19.13.4.32, 2019-09-10" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.13.4.32, 2019-09-10 </a> <nav id=toc-toc-10 class="nav flex-column pl-2"> <a href=#bug-fix_9 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#security-fix_1 title="Security Fix" class="nav-link text-wrap d-inline-block w-100"> Security Fix </a> </nav> <a href=#clickhouse-release-19-11-13-74-2019-11-01 title="ClickHouse release 19.11.13.74, 2019-11-01" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.11.13.74, 2019-11-01 </a> <nav id=toc-toc-11 class="nav flex-column pl-2"> <a href=#bug-fix_10 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-11-12-69-2019-10-02 title="ClickHouse release 19.11.12.69, 2019-10-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.11.12.69, 2019-10-02 </a> <nav id=toc-toc-12 class="nav flex-column pl-2"> <a href=#bug-fix_11 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-11-10-54-2019-09-10 title="ClickHouse release 19.11.10.54, 2019-09-10" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.11.10.54, 2019-09-10 </a> <nav id=toc-toc-13 class="nav flex-column pl-2"> <a href=#bug-fix_12 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-11-9-52-2019-09-6 title="ClickHouse release 19.11.9.52, 2019-09-6" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.11.9.52, 2019-09-6 </a> <nav id=toc-toc-14 class="nav flex-column pl-2"> <a href=#security-fix_2 title="Security Fix" class="nav-link text-wrap d-inline-block w-100"> Security Fix </a> </nav> <a href=#clickhouse-release-19-13-3-26-2019-08-22 title="ClickHouse release 19.13.3.26, 2019-08-22" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.13.3.26, 2019-08-22 </a> <nav id=toc-toc-15 class="nav flex-column pl-2"> <a href=#bug-fix_13 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#security-fix_3 title="Security Fix" class="nav-link text-wrap d-inline-block w-100"> Security Fix </a> </nav> <a href=#clickhouse-release-19-13-2-19-2019-08-14 title="ClickHouse release 19.13.2.19, 2019-08-14" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.13.2.19, 2019-08-14 </a> <nav id=toc-toc-16 class="nav flex-column pl-2"> <a href=#new-feature_3 title="New Feature" class="nav-link text-wrap d-inline-block w-100"> New Feature </a> <a href=#backward-incompatible-change_3 title="Backward Incompatible Change" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Change </a> <a href=#experimental-features title="Experimental features" class="nav-link text-wrap d-inline-block w-100"> Experimental features </a> <a href=#bug-fix_14 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#improvement_3 title=Improvement class="nav-link text-wrap d-inline-block w-100"> Improvement </a> <a href=#performance-improvement_2 title="Performance Improvement" class="nav-link text-wrap d-inline-block w-100"> Performance Improvement </a> <a href=#build-testing-packaging-improvement_4 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> </nav> <a href=#clickhouse-release-19-11-11-57-2019-09-13 title="ClickHouse release 19.11.11.57, 2019-09-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.11.11.57, 2019-09-13 </a> <a href=#clickhouse-release-19-11-8-46-2019-08-22 title="ClickHouse release 19.11.8.46, 2019-08-22" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.11.8.46, 2019-08-22 </a> <nav id=toc-toc-18 class="nav flex-column pl-2"> <a href=#bug-fix_15 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-11-7-40-2019-08-14 title="ClickHouse release 19.11.7.40, 2019-08-14" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.11.7.40, 2019-08-14 </a> <nav id=toc-toc-19 class="nav flex-column pl-2"> <a href=#bug-fix_16 title="Bug fix" class="nav-link text-wrap d-inline-block w-100"> Bug fix </a> <a href=#improvement_4 title=Improvement class="nav-link text-wrap d-inline-block w-100"> Improvement </a> </nav> <a href=#clickhouse-release-19-11-5-28-2019-08-05 title="ClickHouse release 19.11.5.28, 2019-08-05" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.11.5.28, 2019-08-05 </a> <nav id=toc-toc-20 class="nav flex-column pl-2"> <a href=#bug-fix_17 title="Bug fix" class="nav-link text-wrap d-inline-block w-100"> Bug fix </a> <a href=#backward-incompatible-change_4 title="Backward Incompatible Change" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Change </a> </nav> <a href=#clickhouse-release-19-11-4-24-2019-08-01 title="ClickHouse release 19.11.4.24, 2019-08-01" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.11.4.24, 2019-08-01 </a> <nav id=toc-toc-21 class="nav flex-column pl-2"> <a href=#bug-fix_18 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#build-testing-packaging-improvement_5 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> <a href=#backward-incompatible-change_5 title="Backward Incompatible Change" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Change </a> </nav> <a href=#clickhouse-release-19-11-3-11-2019-07-18 title="ClickHouse release 19.11.3.11, 2019-07-18" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.11.3.11, 2019-07-18 </a> <nav id=toc-toc-22 class="nav flex-column pl-2"> <a href=#new-feature_4 title="New Feature" class="nav-link text-wrap d-inline-block w-100"> New Feature </a> <a href=#bug-fix_19 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#improvement_5 title=Improvement class="nav-link text-wrap d-inline-block w-100"> Improvement </a> <a href=#performance-improvement_3 title="Performance Improvement" class="nav-link text-wrap d-inline-block w-100"> Performance Improvement </a> <a href=#build-testing-packaging-improvement_6 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> <a href=#backward-incompatible-change_6 title="Backward Incompatible Change" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Change </a> </nav> <a href=#clickhouse-release-19-10-1-5-2019-07-12 title="ClickHouse release 19.10.1.5, 2019-07-12" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.10.1.5, 2019-07-12 </a> <nav id=toc-toc-23 class="nav flex-column pl-2"> <a href=#new-feature_5 title="New Feature" class="nav-link text-wrap d-inline-block w-100"> New Feature </a> <a href=#bug-fix_20 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#improvement_6 title=Improvement class="nav-link text-wrap d-inline-block w-100"> Improvement </a> <a href=#performance-improvement_4 title="Performance Improvement" class="nav-link text-wrap d-inline-block w-100"> Performance Improvement </a> <a href=#build-testing-packaging-improvement_7 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> </nav> <a href=#clickhouse-release-19-9-3-31-2019-07-05 title="ClickHouse release 19.9.3.31, 2019-07-05" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.9.3.31, 2019-07-05 </a> <nav id=toc-toc-24 class="nav flex-column pl-2"> <a href=#bug-fix_21 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-7-5-29-2019-07-05 title="ClickHouse release 19.7.5.29, 2019-07-05" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.7.5.29, 2019-07-05 </a> <nav id=toc-toc-25 class="nav flex-column pl-2"> <a href=#bug-fix_22 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> </nav> <a href=#clickhouse-release-19-9-2-4-2019-06-24 title="ClickHouse release 19.9.2.4, 2019-06-24" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.9.2.4, 2019-06-24 </a> <nav id=toc-toc-26 class="nav flex-column pl-2"> <a href=#new-feature_6 title="New Feature" class="nav-link text-wrap d-inline-block w-100"> New Feature </a> <a href=#improvement_7 title=Improvement class="nav-link text-wrap d-inline-block w-100"> Improvement </a> <a href=#bug-fix_23 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#build-testing-packaging-improvement_8 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> </nav> <a href=#clickhouse-release-19-8-3-8-2019-06-11 title="ClickHouse release 19.8.3.8, 2019-06-11" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.8.3.8, 2019-06-11 </a> <nav id=toc-toc-27 class="nav flex-column pl-2"> <a href=#new-features title="New Features" class="nav-link text-wrap d-inline-block w-100"> New Features </a> <a href=#improvements title=Improvements class="nav-link text-wrap d-inline-block w-100"> Improvements </a> <a href=#performance-improvements title="Performance Improvements" class="nav-link text-wrap d-inline-block w-100"> Performance Improvements </a> <a href=#bug-fixes title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> <a href=#documentation title=Documentation class="nav-link text-wrap d-inline-block w-100"> Documentation </a> <a href=#build-testing-packaging-improvements title="Build/Testing/Packaging Improvements" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvements </a> </nav> <a href=#clickhouse-release-19-7-5-27-2019-06-09 title="ClickHouse release 19.7.5.27, 2019-06-09" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.7.5.27, 2019-06-09 </a> <nav id=toc-toc-28 class="nav flex-column pl-2"> <a href=#new-features_1 title="New features" class="nav-link text-wrap d-inline-block w-100"> New features </a> <a href=#bug-fixes_1 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> </nav> <a href=#clickhouse-release-19-7-3-9-2019-05-30 title="ClickHouse release 19.7.3.9, 2019-05-30" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.7.3.9, 2019-05-30 </a> <nav id=toc-toc-29 class="nav flex-column pl-2"> <a href=#new-features_2 title="New Features" class="nav-link text-wrap d-inline-block w-100"> New Features </a> <a href=#bug-fixes_2 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> <a href=#performance-improvements_1 title="Performance Improvements" class="nav-link text-wrap d-inline-block w-100"> Performance Improvements </a> <a href=#documentation_1 title=Documentation class="nav-link text-wrap d-inline-block w-100"> Documentation </a> <a href=#build-testing-packaging-improvements_1 title="Build/Testing/Packaging Improvements" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvements </a> </nav> <a href=#clickhouse-release-19-6-3-18-2019-06-13 title="ClickHouse release 19.6.3.18, 2019-06-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.6.3.18, 2019-06-13 </a> <nav id=toc-toc-30 class="nav flex-column pl-2"> <a href=#bug-fixes_3 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> </nav> <a href=#clickhouse-release-19-6-2-11-2019-05-13 title="ClickHouse release 19.6.2.11, 2019-05-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.6.2.11, 2019-05-13 </a> <nav id=toc-toc-31 class="nav flex-column pl-2"> <a href=#new-features_3 title="New Features" class="nav-link text-wrap d-inline-block w-100"> New Features </a> <a href=#experimental-features_1 title="Experimental Features" class="nav-link text-wrap d-inline-block w-100"> Experimental Features </a> <a href=#improvements_1 title=Improvements class="nav-link text-wrap d-inline-block w-100"> Improvements </a> <a href=#performance-improvements_2 title="Performance Improvements" class="nav-link text-wrap d-inline-block w-100"> Performance Improvements </a> <a href=#backward-incompatible-changes title="Backward Incompatible Changes" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Changes </a> <a href=#bug-fixes_4 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> <a href=#build-testing-packaging-improvements_2 title="Build/Testing/Packaging Improvements" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvements </a> </nav> <a href=#clickhouse-release-19-5-4-22-2019-05-13 title="ClickHouse release 19.5.4.22, 2019-05-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.5.4.22, 2019-05-13 </a> <nav id=toc-toc-32 class="nav flex-column pl-2"> <a href=#bug-fixes_5 title="Bug fixes" class="nav-link text-wrap d-inline-block w-100"> Bug fixes </a> </nav> <a href=#clickhouse-release-19-5-3-8-2019-04-18 title="ClickHouse release 19.5.3.8, 2019-04-18" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.5.3.8, 2019-04-18 </a> <nav id=toc-toc-33 class="nav flex-column pl-2"> <a href=#bug-fixes_6 title="Bug fixes" class="nav-link text-wrap d-inline-block w-100"> Bug fixes </a> </nav> <a href=#clickhouse-release-19-5-2-6-2019-04-15 title="ClickHouse release 19.5.2.6, 2019-04-15" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.5.2.6, 2019-04-15 </a> <nav id=toc-toc-34 class="nav flex-column pl-2"> <a href=#new-features_4 title="New Features" class="nav-link text-wrap d-inline-block w-100"> New Features </a> <a href=#improvement_8 title=Improvement class="nav-link text-wrap d-inline-block w-100"> Improvement </a> <a href=#bug-fix_24 title="Bug Fix" class="nav-link text-wrap d-inline-block w-100"> Bug Fix </a> <a href=#backward-incompatible-change_7 title="Backward Incompatible Change" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Change </a> <a href=#performance-improvement_5 title="Performance Improvement" class="nav-link text-wrap d-inline-block w-100"> Performance Improvement </a> <a href=#build-testing-packaging-improvement_9 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> </nav> <a href=#clickhouse-release-19-4-4-33-2019-04-17 title="ClickHouse release 19.4.4.33, 2019-04-17" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.4.4.33, 2019-04-17 </a> <nav id=toc-toc-35 class="nav flex-column pl-2"> <a href=#bug-fixes_7 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> <a href=#improvements_2 title=Improvements class="nav-link text-wrap d-inline-block w-100"> Improvements </a> </nav> <a href=#clickhouse-release-19-4-3-11-2019-04-02 title="ClickHouse release 19.4.3.11, 2019-04-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.4.3.11, 2019-04-02 </a> <nav id=toc-toc-36 class="nav flex-column pl-2"> <a href=#bug-fixes_8 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> <a href=#build-testing-packaging-improvement_10 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> </nav> <a href=#clickhouse-release-19-4-2-7-2019-03-30 title="ClickHouse release 19.4.2.7, 2019-03-30" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.4.2.7, 2019-03-30 </a> <nav id=toc-toc-37 class="nav flex-column pl-2"> <a href=#bug-fixes_9 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> </nav> <a href=#clickhouse-release-19-4-1-3-2019-03-19 title="ClickHouse release 19.4.1.3, 2019-03-19" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.4.1.3, 2019-03-19 </a> <nav id=toc-toc-38 class="nav flex-column pl-2"> <a href=#bug-fixes_10 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> </nav> <a href=#clickhouse-release-19-4-0-49-2019-03-09 title="ClickHouse release 19.4.0.49, 2019-03-09" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.4.0.49, 2019-03-09 </a> <nav id=toc-toc-39 class="nav flex-column pl-2"> <a href=#new-features_5 title="New Features" class="nav-link text-wrap d-inline-block w-100"> New Features </a> <a href=#bug-fixes_11 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> <a href=#improvements_3 title=Improvements class="nav-link text-wrap d-inline-block w-100"> Improvements </a> <a href=#performance-improvements_3 title="Performance Improvements" class="nav-link text-wrap d-inline-block w-100"> Performance Improvements </a> <a href=#build-testing-packaging-improvement_11 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> </nav> <a href=#clickhouse-release-19-3-9-1-2019-04-02 title="ClickHouse release 19.3.9.1, 2019-04-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.9.1, 2019-04-02 </a> <nav id=toc-toc-40 class="nav flex-column pl-2"> <a href=#bug-fixes_12 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> <a href=#build-testing-packaging-improvement_12 title="Build/Testing/Packaging Improvement" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvement </a> </nav> <a href=#clickhouse-release-19-3-7-2019-03-12 title="ClickHouse release 19.3.7, 2019-03-12" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.7, 2019-03-12 </a> <nav id=toc-toc-41 class="nav flex-column pl-2"> <a href=#bug-fixes_13 title="Bug fixes" class="nav-link text-wrap d-inline-block w-100"> Bug fixes </a> </nav> <a href=#clickhouse-release-19-3-6-2019-03-02 title="ClickHouse release 19.3.6, 2019-03-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.6, 2019-03-02 </a> <nav id=toc-toc-42 class="nav flex-column pl-2"> <a href=#bug-fixes_14 title="Bug fixes" class="nav-link text-wrap d-inline-block w-100"> Bug fixes </a> <a href=#build-testing-packaging-improvements_3 title="Build/Testing/Packaging Improvements" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvements </a> </nav> <a href=#clickhouse-release-19-3-5-2019-02-21 title="ClickHouse release 19.3.5, 2019-02-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.5, 2019-02-21 </a> <nav id=toc-toc-43 class="nav flex-column pl-2"> <a href=#bug-fixes_15 title="Bug fixes" class="nav-link text-wrap d-inline-block w-100"> Bug fixes </a> </nav> <a href=#clickhouse-release-19-3-4-2019-02-16 title="ClickHouse release 19.3.4, 2019-02-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.4, 2019-02-16 </a> <nav id=toc-toc-44 class="nav flex-column pl-2"> <a href=#improvements_4 title=Improvements class="nav-link text-wrap d-inline-block w-100"> Improvements </a> <a href=#bug-fixes_16 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> <a href=#build-testing-packaging-improvements_4 title="Build/Testing/Packaging Improvements" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvements </a> </nav> <a href=#clickhouse-release-19-3-3-2019-02-13 title="ClickHouse release 19.3.3, 2019-02-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.3.3, 2019-02-13 </a> <nav id=toc-toc-45 class="nav flex-column pl-2"> <a href=#new-features_6 title="New Features" class="nav-link text-wrap d-inline-block w-100"> New Features </a> <a href=#experimental-features_2 title="Experimental features" class="nav-link text-wrap d-inline-block w-100"> Experimental features </a> <a href=#bug-fixes_17 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> <a href=#build-testing-packaging-improvements_5 title="Build/Testing/Packaging Improvements" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvements </a> <a href=#backward-incompatible-changes_1 title="Backward Incompatible Changes" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Changes </a> <a href=#performance-improvements_4 title="Performance Improvements" class="nav-link text-wrap d-inline-block w-100"> Performance Improvements </a> <a href=#improvements_5 title=Improvements class="nav-link text-wrap d-inline-block w-100"> Improvements </a> </nav> <a href=#clickhouse-release-19-1-14-2019-03-14 title="ClickHouse release 19.1.14, 2019-03-14" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.14, 2019-03-14 </a> <a href=#clickhouse-release-19-1-13-2019-03-12 title="ClickHouse release 19.1.13, 2019-03-12" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.13, 2019-03-12 </a> <a href=#clickhouse-release-19-1-10-2019-03-03 title="ClickHouse release 19.1.10, 2019-03-03" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.10, 2019-03-03 </a> <a href=#clickhouse-release-19-1-9-2019-02-21 title="ClickHouse release 19.1.9, 2019-02-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.9, 2019-02-21 </a> <nav id=toc-toc-49 class="nav flex-column pl-2"> <a href=#bug-fixes_18 title="Bug fixes" class="nav-link text-wrap d-inline-block w-100"> Bug fixes </a> </nav> <a href=#clickhouse-release-19-1-8-2019-02-16 title="ClickHouse release 19.1.8, 2019-02-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.8, 2019-02-16 </a> <nav id=toc-toc-50 class="nav flex-column pl-2"> <a href=#bug-fixes_19 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> </nav> <a href=#clickhouse-release-19-1-7-2019-02-15 title="ClickHouse release 19.1.7, 2019-02-15" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.7, 2019-02-15 </a> <nav id=toc-toc-51 class="nav flex-column pl-2"> <a href=#bug-fixes_20 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> </nav> <a href=#clickhouse-release-19-1-6-2019-01-24 title="ClickHouse release 19.1.6, 2019-01-24" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 19.1.6, 2019-01-24 </a> <nav id=toc-toc-52 class="nav flex-column pl-2"> <a href=#new-features_7 title="New Features" class="nav-link text-wrap d-inline-block w-100"> New Features </a> <a href=#experimental-features_3 title="Experimental features" class="nav-link text-wrap d-inline-block w-100"> Experimental features </a> <a href=#bug-fixes_21 title="Bug Fixes" class="nav-link text-wrap d-inline-block w-100"> Bug Fixes </a> <a href=#improvements_6 title=Improvements class="nav-link text-wrap d-inline-block w-100"> Improvements </a> <a href=#performance-improvements_5 title="Performance Improvements" class="nav-link text-wrap d-inline-block w-100"> Performance Improvements </a> <a href=#backward-incompatible-changes_2 title="Backward Incompatible Changes" class="nav-link text-wrap d-inline-block w-100"> Backward Incompatible Changes </a> <a href=#build-testing-packaging-improvements_6 title="Build/Testing/Packaging Improvements" class="nav-link text-wrap d-inline-block w-100"> Build/Testing/Packaging Improvements </a> </nav> <a href=#clickhouse-release-18-16-1-2018-12-21 title="ClickHouse release 18.16.1, 2018-12-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.16.1, 2018-12-21 </a> <nav id=toc-toc-53 class="nav flex-column pl-2"> <a href=#bug-fixes_22 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#improvements_7 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#build-improvements title="Build improvements:" class="nav-link text-wrap d-inline-block w-100"> Build improvements: </a> </nav> <a href=#clickhouse-release-18-16-0-2018-12-14 title="ClickHouse release 18.16.0, 2018-12-14" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.16.0, 2018-12-14 </a> <nav id=toc-toc-54 class="nav flex-column pl-2"> <a href=#new-features_8 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#bug-fixes_23 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#improvements_8 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#build-improvements_1 title="Build improvements:" class="nav-link text-wrap d-inline-block w-100"> Build improvements: </a> <a href=#backward-incompatible-changes_3 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> </nav> <a href=#clickhouse-release-18-14-19-2018-12-19 title="ClickHouse release 18.14.19, 2018-12-19" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.19, 2018-12-19 </a> <nav id=toc-toc-55 class="nav flex-column pl-2"> <a href=#bug-fixes_24 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#build-improvements_2 title="Build improvements:" class="nav-link text-wrap d-inline-block w-100"> Build improvements: </a> </nav> <a href=#clickhouse-release-18-14-18-2018-12-04 title="ClickHouse release 18.14.18, 2018-12-04" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.18, 2018-12-04 </a> <nav id=toc-toc-56 class="nav flex-column pl-2"> <a href=#bug-fixes_25 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#build-changes title="Build changes:" class="nav-link text-wrap d-inline-block w-100"> Build changes: </a> </nav> <a href=#clickhouse-release-18-14-17-2018-11-30 title="ClickHouse release 18.14.17, 2018-11-30" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.17, 2018-11-30 </a> <nav id=toc-toc-57 class="nav flex-column pl-2"> <a href=#bug-fixes_26 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-18-14-15-2018-11-21 title="ClickHouse release 18.14.15, 2018-11-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.15, 2018-11-21 </a> <nav id=toc-toc-58 class="nav flex-column pl-2"> <a href=#bug-fixes_27 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-18-14-14-2018-11-20 title="ClickHouse release 18.14.14, 2018-11-20" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.14, 2018-11-20 </a> <nav id=toc-toc-59 class="nav flex-column pl-2"> <a href=#bug-fixes_28 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#build-changes_1 title="Build changes:" class="nav-link text-wrap d-inline-block w-100"> Build changes: </a> </nav> <a href=#clickhouse-release-18-14-13-2018-11-08 title="ClickHouse release 18.14.13, 2018-11-08" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.13, 2018-11-08 </a> <nav id=toc-toc-60 class="nav flex-column pl-2"> <a href=#bug-fixes_29 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#performance-improvements_6 title="Performance improvements:" class="nav-link text-wrap d-inline-block w-100"> Performance improvements: </a> <a href=#build-improvements_3 title="Build improvements:" class="nav-link text-wrap d-inline-block w-100"> Build improvements: </a> </nav> <a href=#clickhouse-release-18-14-12-2018-11-02 title="ClickHouse release 18.14.12, 2018-11-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.12, 2018-11-02 </a> <nav id=toc-toc-61 class="nav flex-column pl-2"> <a href=#bug-fixes_30 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-18-14-11-2018-10-29 title="ClickHouse release 18.14.11, 2018-10-29" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.11, 2018-10-29 </a> <nav id=toc-toc-62 class="nav flex-column pl-2"> <a href=#bug-fixes_31 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-18-14-10-2018-10-23 title="ClickHouse release 18.14.10, 2018-10-23" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.10, 2018-10-23 </a> <a href=#clickhouse-release-18-14-9-2018-10-16 title="ClickHouse release 18.14.9, 2018-10-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.14.9, 2018-10-16 </a> <nav id=toc-toc-64 class="nav flex-column pl-2"> <a href=#new-features_9 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#experimental-features_4 title="Experimental features:" class="nav-link text-wrap d-inline-block w-100"> Experimental features: </a> <a href=#improvements_9 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_32 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#backward-incompatible-changes_4 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> </nav> <a href=#clickhouse-release-18-12-17-2018-09-16 title="ClickHouse release 18.12.17, 2018-09-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.12.17, 2018-09-16 </a> <nav id=toc-toc-65 class="nav flex-column pl-2"> <a href=#new-features_10 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#bug-fixes_33 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#backward-incompatible-changes_5 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> </nav> <a href=#clickhouse-release-18-12-14-2018-09-13 title="ClickHouse release 18.12.14, 2018-09-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.12.14, 2018-09-13 </a> <nav id=toc-toc-66 class="nav flex-column pl-2"> <a href=#new-features_11 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_10 title=Improvements class="nav-link text-wrap d-inline-block w-100"> Improvements </a> <a href=#bug-fixes_34 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-18-12-13-2018-09-10 title="ClickHouse release 18.12.13, 2018-09-10" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.12.13, 2018-09-10 </a> <nav id=toc-toc-67 class="nav flex-column pl-2"> <a href=#new-features_12 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#experimental-features_5 title="Experimental features:" class="nav-link text-wrap d-inline-block w-100"> Experimental features: </a> <a href=#improvements_11 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_35 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#security-fix_4 title="Security fix:" class="nav-link text-wrap d-inline-block w-100"> Security fix: </a> <a href=#backward-incompatible-changes_6 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> <a href=#build-changes_2 title="Build changes:" class="nav-link text-wrap d-inline-block w-100"> Build changes: </a> </nav> <a href=#clickhouse-release-18-10-3-2018-08-13 title="ClickHouse release 18.10.3, 2018-08-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.10.3, 2018-08-13 </a> <nav id=toc-toc-68 class="nav flex-column pl-2"> <a href=#new-features_13 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_12 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_36 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#backward-incompatible-changes_7 title="Backward incompatible changes" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes </a> <a href=#build-changes_3 title="Build changes:" class="nav-link text-wrap d-inline-block w-100"> Build changes: </a> </nav> <a href=#clickhouse-release-18-6-0-2018-08-02 title="ClickHouse release 18.6.0, 2018-08-02" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.6.0, 2018-08-02 </a> <nav id=toc-toc-69 class="nav flex-column pl-2"> <a href=#new-features_14 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_13 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> </nav> <a href=#clickhouse-release-18-5-1-2018-07-31 title="ClickHouse release 18.5.1, 2018-07-31" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.5.1, 2018-07-31 </a> <nav id=toc-toc-70 class="nav flex-column pl-2"> <a href=#new-features_15 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_14 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_37 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-18-4-0-2018-07-28 title="ClickHouse release 18.4.0, 2018-07-28" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.4.0, 2018-07-28 </a> <nav id=toc-toc-71 class="nav flex-column pl-2"> <a href=#new-features_16 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_15 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_38 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#backward-incompatible-changes_8 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> </nav> <a href=#clickhouse-release-18-1-0-2018-07-23 title="ClickHouse release 18.1.0, 2018-07-23" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 18.1.0, 2018-07-23 </a> <nav id=toc-toc-72 class="nav flex-column pl-2"> <a href=#new-features_17 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_16 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_39 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#backward-incompatible-changes_9 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> </nav> <a href=#clickhouse-release-1-1-54394-2018-07-12 title="ClickHouse release 1.1.54394, 2018-07-12" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54394, 2018-07-12 </a> <nav id=toc-toc-73 class="nav flex-column pl-2"> <a href=#new-features_18 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#bug-fixes_40 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-1-1-54390-2018-07-06 title="ClickHouse release 1.1.54390, 2018-07-06" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54390, 2018-07-06 </a> <nav id=toc-toc-74 class="nav flex-column pl-2"> <a href=#new-features_19 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_17 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_41 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#security-fix_5 title="Security fix:" class="nav-link text-wrap d-inline-block w-100"> Security fix: </a> </nav> <a href=#clickhouse-release-1-1-54388-2018-06-28 title="ClickHouse release 1.1.54388, 2018-06-28" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54388, 2018-06-28 </a> <nav id=toc-toc-75 class="nav flex-column pl-2"> <a href=#new-features_20 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#experimental-features_6 title="Experimental features:" class="nav-link text-wrap d-inline-block w-100"> Experimental features: </a> <a href=#bug-fixes_42 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#improvements_18 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#build-changes_4 title="Build changes:" class="nav-link text-wrap d-inline-block w-100"> Build changes: </a> <a href=#backward-incompatible-changes_10 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> </nav> <a href=#clickhouse-release-1-1-54385-2018-06-01 title="ClickHouse release 1.1.54385, 2018-06-01" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54385, 2018-06-01 </a> <nav id=toc-toc-76 class="nav flex-column pl-2"> <a href=#bug-fixes_43 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-1-1-54383-2018-05-22 title="ClickHouse release 1.1.54383, 2018-05-22" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54383, 2018-05-22 </a> <nav id=toc-toc-77 class="nav flex-column pl-2"> <a href=#bug-fixes_44 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-1-1-54381-2018-05-14 title="ClickHouse release 1.1.54381, 2018-05-14" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54381, 2018-05-14 </a> <nav id=toc-toc-78 class="nav flex-column pl-2"> <a href=#bug-fixes_45 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-1-1-54380-2018-04-21 title="ClickHouse release 1.1.54380, 2018-04-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54380, 2018-04-21 </a> <nav id=toc-toc-79 class="nav flex-column pl-2"> <a href=#new-features_21 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_19 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_46 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#backward-incompatible-changes_11 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> </nav> <a href=#clickhouse-release-1-1-54378-2018-04-16 title="ClickHouse release 1.1.54378, 2018-04-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54378, 2018-04-16 </a> <nav id=toc-toc-80 class="nav flex-column pl-2"> <a href=#new-features_22 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_20 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_47 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#build-changes_5 title="Build changes:" class="nav-link text-wrap d-inline-block w-100"> Build changes: </a> <a href=#backward-incompatible-changes_12 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> </nav> <a href=#clickhouse-release-1-1-54370-2018-03-16 title="ClickHouse release 1.1.54370, 2018-03-16" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54370, 2018-03-16 </a> <nav id=toc-toc-81 class="nav flex-column pl-2"> <a href=#new-features_23 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_21 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_48 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-1-1-54362-2018-03-11 title="Clickhouse Release 1.1.54362, 2018-03-11" class="nav-link text-wrap d-inline-block w-100"> Clickhouse Release 1.1.54362, 2018-03-11 </a> <nav id=toc-toc-82 class="nav flex-column pl-2"> <a href=#new-features_24 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#improvements_22 title=Improvements: class="nav-link text-wrap d-inline-block w-100"> Improvements: </a> <a href=#bug-fixes_49 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#backward-incompatible-changes_13 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> </nav> <a href=#clickhouse-release-1-1-54343-2018-02-05 title="Clickhouse Release 1.1.54343, 2018-02-05" class="nav-link text-wrap d-inline-block w-100"> Clickhouse Release 1.1.54343, 2018-02-05 </a> <a href=#clickhouse-release-1-1-54342-2018-01-22 title="Clickhouse Release 1.1.54342, 2018-01-22" class="nav-link text-wrap d-inline-block w-100"> Clickhouse Release 1.1.54342, 2018-01-22 </a> <a href=#clickhouse-release-1-1-54337-2018-01-18 title="Clickhouse Release 1.1.54337, 2018-01-18" class="nav-link text-wrap d-inline-block w-100"> Clickhouse Release 1.1.54337, 2018-01-18 </a> <nav id=toc-toc-85 class="nav flex-column pl-2"> <a href=#new-features_25 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#performance-optimizations title="Performance optimizations:" class="nav-link text-wrap d-inline-block w-100"> Performance optimizations: </a> <a href=#bug-fixes_50 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#build-improvements_4 title="Build improvements:" class="nav-link text-wrap d-inline-block w-100"> Build improvements: </a> <a href=#backward-incompatible-changes_14 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> <a href=#please-note-when-upgrading title="Please note when upgrading:" class="nav-link text-wrap d-inline-block w-100"> Please note when upgrading: </a> </nav> <a href=#clickhouse-release-1-1-54327-2017-12-21 title="ClickHouse release 1.1.54327, 2017-12-21" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54327, 2017-12-21 </a> <a href=#clickhouse-release-1-1-54318-2017-11-30 title="ClickHouse release 1.1.54318, 2017-11-30" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54318, 2017-11-30 </a> <a href=#clickhouse-release-1-1-54310-2017-11-01 title="ClickHouse release 1.1.54310, 2017-11-01" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54310, 2017-11-01 </a> <nav id=toc-toc-88 class="nav flex-column pl-2"> <a href=#new-features_26 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#backward-incompatible-changes_15 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> <a href=#bug-fixes_51 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#build-improvements_5 title="Build improvements:" class="nav-link text-wrap d-inline-block w-100"> Build improvements: </a> </nav> <a href=#clickhouse-release-1-1-54304-2017-10-19 title="ClickHouse release 1.1.54304, 2017-10-19" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54304, 2017-10-19 </a> <nav id=toc-toc-89 class="nav flex-column pl-2"> <a href=#new-features_27 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#bug-fixes_52 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-1-1-54292-2017-09-20 title="ClickHouse release 1.1.54292, 2017-09-20" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54292, 2017-09-20 </a> <nav id=toc-toc-90 class="nav flex-column pl-2"> <a href=#new-features_28 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#bug-fixes_53 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> <a href=#clickhouse-release-1-1-54289-2017-09-13 title="ClickHouse release 1.1.54289, 2017-09-13" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54289, 2017-09-13 </a> <nav id=toc-toc-91 class="nav flex-column pl-2"> <a href=#new-features_29 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#bug-fixes_54 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#improved-workflow-for-developing-and-assembling-clickhouse title="Improved workflow for developing and assembling ClickHouse:" class="nav-link text-wrap d-inline-block w-100"> Improved workflow for developing and assembling ClickHouse: </a> <a href=#please-note-when-upgrading_1 title="Please note when upgrading:" class="nav-link text-wrap d-inline-block w-100"> Please note when upgrading: </a> </nav> <a href=#clickhouse-release-1-1-54284-2017-08-29 title="ClickHouse release 1.1.54284, 2017-08-29" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54284, 2017-08-29 </a> <a href=#clickhouse-release-1-1-54282-2017-08-23 title="ClickHouse release 1.1.54282, 2017-08-23" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54282, 2017-08-23 </a> <a href=#clickhouse-release-1-1-54276-2017-08-16 title="Clickhouse Release 1.1.54276, 2017-08-16" class="nav-link text-wrap d-inline-block w-100"> Clickhouse Release 1.1.54276, 2017-08-16 </a> <nav id=toc-toc-94 class="nav flex-column pl-2"> <a href=#new-features_30 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#main-changes title="Main changes:" class="nav-link text-wrap d-inline-block w-100"> Main changes: </a> <a href=#backward-incompatible-changes_16 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> <a href=#complete-list-of-changes title="Complete list of changes:" class="nav-link text-wrap d-inline-block w-100"> Complete list of changes: </a> <a href=#bug-fixes_55 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> <a href=#improved-workflow-for-developing-and-assembling-clickhouse_1 title="Improved workflow for developing and assembling ClickHouse:" class="nav-link text-wrap d-inline-block w-100"> Improved workflow for developing and assembling ClickHouse: </a> </nav> <a href=#clickhouse-release-1-1-54245-2017-07-04 title="ClickHouse release 1.1.54245, 2017-07-04" class="nav-link text-wrap d-inline-block w-100"> ClickHouse release 1.1.54245, 2017-07-04 </a> <nav id=toc-toc-95 class="nav flex-column pl-2"> <a href=#new-features_31 title="New features:" class="nav-link text-wrap d-inline-block w-100"> New features: </a> <a href=#backward-incompatible-changes_17 title="Backward incompatible changes:" class="nav-link text-wrap d-inline-block w-100"> Backward incompatible changes: </a> <a href=#minor-changes title="Minor changes:" class="nav-link text-wrap d-inline-block w-100"> Minor changes: </a> <a href=#bug-fixes_56 title="Bug fixes:" class="nav-link text-wrap d-inline-block w-100"> Bug fixes: </a> </nav> </nav> </div> </div> </div> <script async type=text/javascript src=/js/base.js?7bd05efd></script> <noscript> <div><img src=https://mc.yandex.ru/watch/18343495 alt=Yandex></div> </noscript> </body> </html>